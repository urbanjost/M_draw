<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="M_draw module">
    
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>M_draw.f90 &ndash; M_draw</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">M_draw </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../sourcefile/m_draw.f90.html">Source File</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../sourcefile/m_draw.f90.html">Source File</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>M_draw.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="100.0% of total for source files.">1785 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/M_draw.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">M_draw.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_draw.html">M_draw</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_draw.f90.html#src">M_draw.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
      

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/m_draw.html">M_draw</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/m_draw.f90.html#src">M_draw.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt;</span>
<a name="ln-2"></a><span class="c">!!##NAME</span>
<a name="ln-3"></a><span class="c">!!    M_draw(3fm) - [M_draw::INTRO] The M_draw graphics library</span>
<a name="ln-4"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5"></a><span class="c">!!</span>
<a name="ln-6"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7"></a><span class="c">!!</span>
<a name="ln-8"></a><span class="c">!!    M_draw is a portable public-domain device-independent graphics library</span>
<a name="ln-9"></a><span class="c">!!    intended for being called from Fortran that is based on VOGLE (from</span>
<a name="ln-10"></a><span class="c">!!    the University of Melbourne) that is loosely based on the Silicon</span>
<a name="ln-11"></a><span class="c">!!    Graphics Iris GL library. It was also partly inspired by the DIGS</span>
<a name="ln-12"></a><span class="c">!!    library developed at the U.S. Naval Academy under the guidance of</span>
<a name="ln-13"></a><span class="c">!!    Prof David Rogers.</span>
<a name="ln-14"></a><span class="c">!!</span>
<a name="ln-15"></a><span class="c">!!    Many output devices are available:</span>
<a name="ln-16"></a><span class="c">!!</span>
<a name="ln-17"></a><span class="c">!!      * FrameMaker MIF 3.0 (Maker Interchange File) driver.</span>
<a name="ln-18"></a><span class="c">!!      * Adobe PDF driver.</span>
<a name="ln-19"></a><span class="c">!!      * HTML5 Canvas driver.</span>
<a name="ln-20"></a><span class="c">!!      * SVG driver.</span>
<a name="ln-21"></a><span class="c">!!      * A PCL5/HPGL2 driver that supports prefsize() calls.</span>
<a name="ln-22"></a><span class="c">!!      * Monochrome PBM (Poskanzer bitmap P1 and P4 formats) and X11</span>
<a name="ln-23"></a><span class="c">!!        bitmap driver.</span>
<a name="ln-24"></a><span class="c">!!      * Color PBM (Poskanzer pixmap P3 and P6 formats). If you have the</span>
<a name="ln-25"></a><span class="c">!!        pbmplus package you can use it to make M_draw appear to write</span>
<a name="ln-26"></a><span class="c">!!        any format pbmplus writes (assuming your system supports the</span>
<a name="ln-27"></a><span class="c">!!        popen(3c) function).</span>
<a name="ln-28"></a><span class="c">!!      * A clear-text CGM (Computer Graphics Metafile) driver.</span>
<a name="ln-29"></a><span class="c">!!      * A different (color) PostScript driver.</span>
<a name="ln-30"></a><span class="c">!!      * A driver for Microsoft VML (Vector Markup Language)</span>
<a name="ln-31"></a><span class="c">!!</span>
<a name="ln-32"></a><span class="c">!!    M_draw is intended to produce simple graphics composed of line drawings and</span>
<a name="ln-33"></a><span class="c">!!    polygon fills in two and three dimensions. It handles circles, curves,</span>
<a name="ln-34"></a><span class="c">!!    arcs, patches, polygons, and software text in a device independent</span>
<a name="ln-35"></a><span class="c">!!    fashion. Simple hidden line removal is also available via polygon</span>
<a name="ln-36"></a><span class="c">!!    backfacing. Access to hardware text and double buffering of drawings</span>
<a name="ln-37"></a><span class="c">!!    depends on the driver.</span>
<a name="ln-38"></a><span class="c">!!</span>
<a name="ln-39"></a><span class="c">!!    M_draw is callable from C and Fortran, and Pascal;</span>
<a name="ln-40"></a><span class="c">!!    but M_draw is only supported in Fortran (the C components are being converted</span>
<a name="ln-41"></a><span class="c">!!    to Fortran).</span>
<a name="ln-42"></a><span class="c">!!</span>
<a name="ln-43"></a><span class="c">!!    The original VOGLE source&#39;s ownership statement</span>
<a name="ln-44"></a><span class="c">!!</span>
<a name="ln-45"></a><span class="c">!!       This software is public domain and may be used for any purpose commercial</span>
<a name="ln-46"></a><span class="c">!!       or otherwise. It is offered without any guarantee as to its suitability</span>
<a name="ln-47"></a><span class="c">!!       for any purpose or as to the sanity of its writers. The authors do ask</span>
<a name="ln-48"></a><span class="c">!!       that the source is passed on to anyone that requests a copy, and that</span>
<a name="ln-49"></a><span class="c">!!       people who get copies don&#39;t go round claiming they wrote it. Use at your</span>
<a name="ln-50"></a><span class="c">!!       own risk.</span>
<a name="ln-51"></a><span class="c">!!</span>
<a name="ln-52"></a><span class="c">!!##LIBRARY FUNCTION DESCRIPTIONS</span>
<a name="ln-53"></a><span class="c">!!</span>
<a name="ln-54"></a><span class="c">!!    DEVICE ROUTINES</span>
<a name="ln-55"></a><span class="c">!!    vinit(device)                    Initialise device</span>
<a name="ln-56"></a><span class="c">!!    vexit()                          Reset window/terminal (must be last routine called)</span>
<a name="ln-57"></a><span class="c">!!    voutput(path)                    Redirect output from *next* vinit to file</span>
<a name="ln-58"></a><span class="c">!!    vnewdev(device)                  Reinitialize to use new device without changing</span>
<a name="ln-59"></a><span class="c">!!    vgetdev(device)                  Get name of current device</span>
<a name="ln-60"></a><span class="c">!!    pushdev(device)                  push current device onto a stack</span>
<a name="ln-61"></a><span class="c">!!    popdev(device)                   pop device from stack created by pushdev.</span>
<a name="ln-62"></a><span class="c">!!    getdepth()                       Return number of bit planes (color planes)</span>
<a name="ln-63"></a><span class="c">!!</span>
<a name="ln-64"></a><span class="c">!!    ROUTINES FOR SETTING UP WINDOWS</span>
<a name="ln-65"></a><span class="c">!!    prefposition(x, y)               Specify preferred position of window</span>
<a name="ln-66"></a><span class="c">!!    prefsize(width, height)          Specify preferred width and height of window</span>
<a name="ln-67"></a><span class="c">!!</span>
<a name="ln-68"></a><span class="c">!!    Some devices are basically window oriented - like sunview and X11. You</span>
<a name="ln-69"></a><span class="c">!!    can give M_draw some information on the window that it will use with these</span>
<a name="ln-70"></a><span class="c">!!    routines. These can make your code very device independent. Both routines</span>
<a name="ln-71"></a><span class="c">!!    take arguments which are in device space. (0, 0) is the top left hand</span>
<a name="ln-72"></a><span class="c">!!    corner in device space. To have any effect these routines must be called</span>
<a name="ln-73"></a><span class="c">!!    before vinit. For the X11 device, an entry may be made in your .Xdefaults</span>
<a name="ln-74"></a><span class="c">!!    file or loaded in with the xrdb(1) command:</span>
<a name="ln-75"></a><span class="c">!!</span>
<a name="ln-76"></a><span class="c">!!       xrdb &lt;&lt;\end_of_file</span>
<a name="ln-77"></a><span class="c">!!       ! X11 Windows fonts to use for &quot;small&quot; and &quot;large&quot; fonts</span>
<a name="ln-78"></a><span class="c">!!       M_draw*smallfont: fixed</span>
<a name="ln-79"></a><span class="c">!!       M_draw*largefont: 9x15</span>
<a name="ln-80"></a><span class="c">!!       ! title on decoration bar for the window</span>
<a name="ln-81"></a><span class="c">!!       M_draw*title: My M_draw program</span>
<a name="ln-82"></a><span class="c">!!       ! window geometry and position,</span>
<a name="ln-83"></a><span class="c">!!       ! overridden by prefsize(3c) and prefposition(3c)</span>
<a name="ln-84"></a><span class="c">!!       M_draw.Geometry: =500x500-10+20</span>
<a name="ln-85"></a><span class="c">!!       end_of_file</span>
<a name="ln-86"></a><span class="c">!!</span>
<a name="ln-87"></a><span class="c">!!    (where you specify your geometry as you please).</span>
<a name="ln-88"></a><span class="c">!!</span>
<a name="ln-89"></a><span class="c">!!    CLIPPING ROUTINES</span>
<a name="ln-90"></a><span class="c">!!    clipping(onoff)                  Turn clipping on or off</span>
<a name="ln-91"></a><span class="c">!!</span>
<a name="ln-92"></a><span class="c">!!    COLOR ROUTINES</span>
<a name="ln-93"></a><span class="c">!!    clear()                          Clears screen to current color</span>
<a name="ln-94"></a><span class="c">!!    color(col)                       Set current color</span>
<a name="ln-95"></a><span class="c">!!    mapcolor(indx, red, green, blue) Set color map index</span>
<a name="ln-96"></a><span class="c">!!</span>
<a name="ln-97"></a><span class="c">!!    INTERACTIVE ROUTINES</span>
<a name="ln-98"></a><span class="c">!!    getkey()                         Return ASCII ordinal of next key typed</span>
<a name="ln-99"></a><span class="c">!!    checkkey()                       Returns zero if no key is pressed or ASCII ordinal</span>
<a name="ln-100"></a><span class="c">!!    getstring(bcol, string)          Read in a string, echoing it in current font</span>
<a name="ln-101"></a><span class="c">!!    locator(xaddr, yaddr)            Find out where cursor is</span>
<a name="ln-102"></a><span class="c">!!    slocator(xaddr, yaddr)           Find out where cursor is in screen coordinates</span>
<a name="ln-103"></a><span class="c">!!</span>
<a name="ln-104"></a><span class="c">!!    FLUSHING</span>
<a name="ln-105"></a><span class="c">!!    vsetflush(yesno)                 Set global flushing status</span>
<a name="ln-106"></a><span class="c">!!    vflush()                         Call device flush or syncronisation routine</span>
<a name="ln-107"></a><span class="c">!!</span>
<a name="ln-108"></a><span class="c">!!    On some devices (particularly X11) considerable speedups in display</span>
<a name="ln-109"></a><span class="c">!!    can be achieved by not flushing each graphics primitive call to the</span>
<a name="ln-110"></a><span class="c">!!    actual display until necessary. M_draw automatically delays flushing in</span>
<a name="ln-111"></a><span class="c">!!    the following cases:</span>
<a name="ln-112"></a><span class="c">!!</span>
<a name="ln-113"></a><span class="c">!!      * Within a callobj() call.</span>
<a name="ln-114"></a><span class="c">!!      * Within curves and patches.</span>
<a name="ln-115"></a><span class="c">!!      * Within Hershey software text.</span>
<a name="ln-116"></a><span class="c">!!      * When double buffering (the flush is only done within swapbuffers).</span>
<a name="ln-117"></a><span class="c">!!</span>
<a name="ln-118"></a><span class="c">!!    There are two user routines that can be used to control flushing.</span>
<a name="ln-119"></a><span class="c">!!</span>
<a name="ln-120"></a><span class="c">!!    VIEWPORT ROUTINES</span>
<a name="ln-121"></a><span class="c">!!    viewport(left, right, bottom, top)     Specify which part of screen to draw in</span>
<a name="ln-122"></a><span class="c">!!    pushviewport()                         Save current viewport</span>
<a name="ln-123"></a><span class="c">!!    popviewport()                          Retrieve last viewport</span>
<a name="ln-124"></a><span class="c">!!    getviewport(left, right, bottom,top)   Returns limits of current viewport in screen coordinates</span>
<a name="ln-125"></a><span class="c">!!    expandviewport()                       use the entire device viewport</span>
<a name="ln-126"></a><span class="c">!!    unexpandviewport()                     undo expandviewport(3f)</span>
<a name="ln-127"></a><span class="c">!!</span>
<a name="ln-128"></a><span class="c">!!    Viewpoint routines alter the current transformation matrix.</span>
<a name="ln-129"></a><span class="c">!!</span>
<a name="ln-130"></a><span class="c">!!    GETTING THE ASPECT DETAILS</span>
<a name="ln-131"></a><span class="c">!!    getaspect()                      Returns the ratio height over width of the display device.</span>
<a name="ln-132"></a><span class="c">!!    getfactors(wfact, hfact)         Returns width over min(width of device, height of device) and height over min(width of</span>
<a name="ln-133"></a><span class="c">!!                                     device, height of device).</span>
<a name="ln-134"></a><span class="c">!!    getdisplaysize(w, h)             Returns width and height of device in device units</span>
<a name="ln-135"></a><span class="c">!!</span>
<a name="ln-136"></a><span class="c">!!    Often the screen is not perfectly square and it would be nice to use</span>
<a name="ln-137"></a><span class="c">!!    the extra space without having to turn clipping off. The following</span>
<a name="ln-138"></a><span class="c">!!    routines are provided to get the values needed to adjust the calls</span>
<a name="ln-139"></a><span class="c">!!    to viewport, etc as needed.</span>
<a name="ln-140"></a><span class="c">!!</span>
<a name="ln-141"></a><span class="c">!!    ATTRIBUTE STACK ROUTINES</span>
<a name="ln-142"></a><span class="c">!!    pushattributes()                 Save the current attributes on the attribute stack.</span>
<a name="ln-143"></a><span class="c">!!    popattributes()                  Restore attributes to what they were at last pushattributes().</span>
<a name="ln-144"></a><span class="c">!!</span>
<a name="ln-145"></a><span class="c">!!    The attribute stack contains details such as current color, filling,</span>
<a name="ln-146"></a><span class="c">!!    hatching, centered, fixedwidth, text height, text width, and the</span>
<a name="ln-147"></a><span class="c">!!    current font. If you need to prevent object calls from changing these,</span>
<a name="ln-148"></a><span class="c">!!    use pushattributes before the call and popattributes after.</span>
<a name="ln-149"></a><span class="c">!!</span>
<a name="ln-150"></a><span class="c">!!    PROJECTION ROUTINES</span>
<a name="ln-151"></a><span class="c">!!    ortho(left, right, bottom, top,near,far)    Define x,y,z clipping planes.</span>
<a name="ln-152"></a><span class="c">!!    ortho2(left, right, bottom, top)            Define x and y clipping planes.</span>
<a name="ln-153"></a><span class="c">!!    perspective(fov, aspect, near, far)         Specify perspective viewing pyramid</span>
<a name="ln-154"></a><span class="c">!!    window(left, right, bot, top, near,far)     Specify a perspective viewing pyramid</span>
<a name="ln-155"></a><span class="c">!!</span>
<a name="ln-156"></a><span class="c">!!    PROJECTION AND VIEWPORT ROUTINES</span>
<a name="ln-157"></a><span class="c">!!    subroutine page (left, right, bottom, top)  create a window of the specified size and then</span>
<a name="ln-158"></a><span class="c">!!                                                set the viewport to the largest viewport with</span>
<a name="ln-159"></a><span class="c">!!                                                that aspect so that output acts much like a</span>
<a name="ln-160"></a><span class="c">!!                                                page of paper of the specified size without</span>
<a name="ln-161"></a><span class="c">!!                                                distortion.</span>
<a name="ln-162"></a><span class="c">!!</span>
<a name="ln-163"></a><span class="c">!!    All the projection routines define a new transformation matrix, and</span>
<a name="ln-164"></a><span class="c">!!    consequently the world units. Parallel projections are defined by</span>
<a name="ln-165"></a><span class="c">!!    ortho or ortho2. Perspective projections can be defined by perspective</span>
<a name="ln-166"></a><span class="c">!!    and window.</span>
<a name="ln-167"></a><span class="c">!!</span>
<a name="ln-168"></a><span class="c">!!    MATRIX STACK ROUTINES</span>
<a name="ln-169"></a><span class="c">!!    pushmatrix()                     Save the current transformation matrix on the matrix stack.</span>
<a name="ln-170"></a><span class="c">!!    popmatrix()                      Reinstall the last matrix pushed</span>
<a name="ln-171"></a><span class="c">!!</span>
<a name="ln-172"></a><span class="c">!!    VIEWPOINT ROUTINES</span>
<a name="ln-173"></a><span class="c">!!    polarview(dist, azim, inc, twist)      Specify the viewer&#39;s position in polar coordinates</span>
<a name="ln-174"></a><span class="c">!!    up(x, y, z)                            Specify the world up.</span>
<a name="ln-175"></a><span class="c">!!    lookat(vx, vy, vz, px, py, pz,twist)   Specify the viewer&#39;s position</span>
<a name="ln-176"></a><span class="c">!!</span>
<a name="ln-177"></a><span class="c">!!    MOVE ROUTINES</span>
<a name="ln-178"></a><span class="c">!!    move(x, y, z)                    Move current graphics position to (x, y, z)</span>
<a name="ln-179"></a><span class="c">!!    rmove(deltax, deltay, deltaz)    Relative move</span>
<a name="ln-180"></a><span class="c">!!    move2(x, y)                      Move graphics position to point (x, y)</span>
<a name="ln-181"></a><span class="c">!!    rmove2(deltax, deltay)           Relative move in world units.</span>
<a name="ln-182"></a><span class="c">!!    smove2(x, y)                     Move current graphics position in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-183"></a><span class="c">!!    rsmove2(deltax, deltay)          Relative move in screen units (-1.0 to 1.0).</span>
<a name="ln-184"></a><span class="c">!!</span>
<a name="ln-185"></a><span class="c">!!    LINESTYLE ROUTINES</span>
<a name="ln-186"></a><span class="c">!!    linewidth()                      set line width in rasters</span>
<a name="ln-187"></a><span class="c">!!    dashcode()                       set dash pattern length</span>
<a name="ln-188"></a><span class="c">!!    linestyle()                      set the line dash pattern</span>
<a name="ln-189"></a><span class="c">!!</span>
<a name="ln-190"></a><span class="c">!!    Linestyles are specified by giving a nominal length of a single</span>
<a name="ln-191"></a><span class="c">!!    dash and a character string consisting of 1&#39;s and 0&#39;s (zeros) that</span>
<a name="ln-192"></a><span class="c">!!    specify when to draw a dash and when not to draw a dash. Linestyles</span>
<a name="ln-193"></a><span class="c">!!    will follow curves and &quot;go around&quot; corners. If a linestyle is set or</span>
<a name="ln-194"></a><span class="c">!!    reset, the accumulated information as to where on a curve (or line)</span>
<a name="ln-195"></a><span class="c">!!    a dash is to be draw is also reset.</span>
<a name="ln-196"></a><span class="c">!!</span>
<a name="ln-197"></a><span class="c">!!    For EXAMPLE, with a nominal view of -1 to 1, setting the dash length</span>
<a name="ln-198"></a><span class="c">!!    to 0.5, and the linestyle to &#39;11010&#39; would draw a line(or curve) with</span>
<a name="ln-199"></a><span class="c">!!    a 1.0 unit solid part, followed by a 0.5 unit blank part followed by</span>
<a name="ln-200"></a><span class="c">!!    a 0.5 unit solid part followed by a 0.5 unit blank part. The linestyle</span>
<a name="ln-201"></a><span class="c">!!    would then repeat itself.</span>
<a name="ln-202"></a><span class="c">!!</span>
<a name="ln-203"></a><span class="c">!!    The dash sizes are affected by the current viewport/transformation</span>
<a name="ln-204"></a><span class="c">!!    scaling factors, meaning that in perspective, the dashes look smaller</span>
<a name="ln-205"></a><span class="c">!!    the farther away they are.</span>
<a name="ln-206"></a><span class="c">!!</span>
<a name="ln-207"></a><span class="c">!!    DRAW ROUTINES</span>
<a name="ln-208"></a><span class="c">!!    draw(x, y, z)                    Draw from current graphics position to (x, y, z)</span>
<a name="ln-209"></a><span class="c">!!    rdraw(deltax, deltay, deltaz)    Relative draw</span>
<a name="ln-210"></a><span class="c">!!    draw2(x, y)                      Draw from current graphics position to point (x, y)</span>
<a name="ln-211"></a><span class="c">!!    rdraw2(deltax,deltay)            Relative draw</span>
<a name="ln-212"></a><span class="c">!!    sdraw2(x, y)                     Draw in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-213"></a><span class="c">!!    rsdraw2(deltax, deltay)          Relative draw in screen units (-1.0 to 1.0).</span>
<a name="ln-214"></a><span class="c">!!</span>
<a name="ln-215"></a><span class="c">!!    ARCS AND CIRCLES</span>
<a name="ln-216"></a><span class="c">!!    circleprecision(nsegs)                  Set number of line segments in a circle. Default is 32.</span>
<a name="ln-217"></a><span class="c">!!    arc(x, y, radius, startang, endang)     Draw an arc in world units.</span>
<a name="ln-218"></a><span class="c">!!    sector(x, y, radius, startang,endang)   Draw a sector. Note: sectors are polygons.</span>
<a name="ln-219"></a><span class="c">!!    circle(x, y, radius)                    Draw a circle. Note: circles are polygons.</span>
<a name="ln-220"></a><span class="c">!!</span>
<a name="ln-221"></a><span class="c">!!    When creating arcs and sectors note that angles are</span>
<a name="ln-222"></a><span class="c">!!    measured in degrees; where zero(0) is the positive X axis in a</span>
<a name="ln-223"></a><span class="c">!!    right-handed Cartesian coordinate system and positive angles sweep</span>
<a name="ln-224"></a><span class="c">!!    counterclockwise. If filling sectors or circles (As described in the</span>
<a name="ln-225"></a><span class="c">!!    section on polygons) hatch pitch is measured in world coordinates</span>
<a name="ln-226"></a><span class="c">!!    and is initially set to 0.1. The initial hatch angle is zero(0).</span>
<a name="ln-227"></a><span class="c">!!</span>
<a name="ln-228"></a><span class="c">!!    CURVE ROUTINES</span>
<a name="ln-229"></a><span class="c">!!    curvebasis(basis)           Define a basis matrix for a curve.</span>
<a name="ln-230"></a><span class="c">!!    curveprecision(nsegs)       Define number of line segments used to draw a curve.</span>
<a name="ln-231"></a><span class="c">!!    rcurve(geom)                Draw a rational curve.</span>
<a name="ln-232"></a><span class="c">!!    curve(geom)                 Draw a curve.</span>
<a name="ln-233"></a><span class="c">!!    curven(n, geom)             Draw n - 3 overlapping curve segments. Note: n must be at least 4.</span>
<a name="ln-234"></a><span class="c">!!</span>
<a name="ln-235"></a><span class="c">!!    RECTANGLES AND GENERAL POLYGON ROUTINES</span>
<a name="ln-236"></a><span class="c">!!    rect(x1, y1, x2, y2)        Draw a rectangle.</span>
<a name="ln-237"></a><span class="c">!!    polyfill(onoff)             Set the polygon fill flag</span>
<a name="ln-238"></a><span class="c">!!    polyhatch(onoff)            Set the polygon hatch flag</span>
<a name="ln-239"></a><span class="c">!!    hatchang(angle)             Set the angle of the hatch lines.</span>
<a name="ln-240"></a><span class="c">!!    hatchpitch(pitch)           Set the distance between hatch lines.</span>
<a name="ln-241"></a><span class="c">!!    poly2(n, points)            Construct an (x, y) polygon from an array of points</span>
<a name="ln-242"></a><span class="c">!!    poly(n, points)             Construct a polygon from an array of points</span>
<a name="ln-243"></a><span class="c">!!    makepoly()                  opens polygon constructed by a series of move-draws and closed by closepoly</span>
<a name="ln-244"></a><span class="c">!!    closepoly()                 Terminates a polygon opened by makepoly.</span>
<a name="ln-245"></a><span class="c">!!    backface(onoff)             Turns on culling of backfacing polygons.</span>
<a name="ln-246"></a><span class="c">!!    backfacedir(clockwise)      Sets backfacing direction to clockwise or anti-clockwise</span>
<a name="ln-247"></a><span class="c">!!</span>
<a name="ln-248"></a><span class="c">!!    A polygon is composed of a number of coplanar line segments connected</span>
<a name="ln-249"></a><span class="c">!!    end to end to form a closed shape.</span>
<a name="ln-250"></a><span class="c">!!</span>
<a name="ln-251"></a><span class="c">!!    In M_draw curves are estimated by a series of line segments, and thus</span>
<a name="ln-252"></a><span class="c">!!    may be included easily into polygons.</span>
<a name="ln-253"></a><span class="c">!!</span>
<a name="ln-254"></a><span class="c">!!    Regular    A polygon with all sides and interior angles the same. Regular</span>
<a name="ln-255"></a><span class="c">!!               polygons are always convex. See Regular Polygons</span>
<a name="ln-256"></a><span class="c">!!    Irregular  Each side may a different length, each angle may be a different</span>
<a name="ln-257"></a><span class="c">!!               measure. The opposite of a regular polygon. See Irregular Polygons</span>
<a name="ln-258"></a><span class="c">!!    Convex     All interior angles less than 180 ,and all vertices &#39;point</span>
<a name="ln-259"></a><span class="c">!!               outwards&#39; away from the interior. The opposite of concave. Regular</span>
<a name="ln-260"></a><span class="c">!!               polygons are always convex. See Convex Polygons</span>
<a name="ln-261"></a><span class="c">!!    Concave    One or more interior angles greater than 180 . Some vertices</span>
<a name="ln-262"></a><span class="c">!!               push &#39;inwards&#39; towards the interior of the polygon. The opposite</span>
<a name="ln-263"></a><span class="c">!!               of convex.</span>
<a name="ln-264"></a><span class="c">!!    Self-intersecting or Crossed  A polygon where one or more sides crosses back over another side,</span>
<a name="ln-265"></a><span class="c">!!                                  creating multiple smaller polygons. Most of the properties and</span>
<a name="ln-266"></a><span class="c">!!                                  theorems concerning polygons do not apply to this shape. It is</span>
<a name="ln-267"></a><span class="c">!!                                  best considered as several separate polygons. A polygon that in</span>
<a name="ln-268"></a><span class="c">!!                                  not self-intersecting in this way is called a simple polygon.</span>
<a name="ln-269"></a><span class="c">!!</span>
<a name="ln-270"></a><span class="c">!!    TEXT ROUTINES</span>
<a name="ln-271"></a><span class="c">!!    font(fontname)                   set the current font</span>
<a name="ln-272"></a><span class="c">!!    numchars()                       return number of characters in the current SOFTWARE font.</span>
<a name="ln-273"></a><span class="c">!!    textsize(width, height)          set maximum size of a character in the current SOFTWARE font.</span>
<a name="ln-274"></a><span class="c">!!    textang(ang)                     set the SOFTWARE text angle.</span>
<a name="ln-275"></a><span class="c">!!    fixedwidth(onoff)                turns fixedwidth mode on or off for SOFTWARE fonts.</span>
<a name="ln-276"></a><span class="c">!!    getcharsize(c, width, height)    get the width and height of a character.</span>
<a name="ln-277"></a><span class="c">!!    getfontdec()                     return size of maximum font descender</span>
<a name="ln-278"></a><span class="c">!!    getfontsize(width, height)       get maximum width and height of a character in a font.</span>
<a name="ln-279"></a><span class="c">!!    drawchar(c)                      draw the character c and update current position.</span>
<a name="ln-280"></a><span class="c">!!    drawstr(str)                     draw the text in string at the current position.</span>
<a name="ln-281"></a><span class="c">!!    strlength(str)                   return the length of the string s</span>
<a name="ln-282"></a><span class="c">!!    boxtext(x, y, l, h, s)           stretch and draw the SOFTWARE string s so that it fits in the imaginary box</span>
<a name="ln-283"></a><span class="c">!!    boxfit(x, y, l, h, s)            resize the SOFTWARE text size so it fits in a box</span>
<a name="ln-284"></a><span class="c">!!</span>
<a name="ln-285"></a><span class="c">!!    textjustify(val)                 general text justification</span>
<a name="ln-286"></a><span class="c">!!</span>
<a name="ln-287"></a><span class="c">!!    leftjustify()                    left justify text</span>
<a name="ln-288"></a><span class="c">!!    rightjustify()                   right justify text</span>
<a name="ln-289"></a><span class="c">!!    topjustify()                     top justify text</span>
<a name="ln-290"></a><span class="c">!!    bottomjustify()                  bottom justify text</span>
<a name="ln-291"></a><span class="c">!!</span>
<a name="ln-292"></a><span class="c">!!    centertext(onoff)                turns centertext mode on or off for SOFTWARE fonts.</span>
<a name="ln-293"></a><span class="c">!!    xcentertext()                    center text in the X direction</span>
<a name="ln-294"></a><span class="c">!!    ycentertext()                    center text in the Y direction</span>
<a name="ln-295"></a><span class="c">!!</span>
<a name="ln-296"></a><span class="c">!!    textslant()                      defines the obliqueness of the fonts.</span>
<a name="ln-297"></a><span class="c">!!    textweight()                     defines the weight of the fonts.</span>
<a name="ln-298"></a><span class="c">!!</span>
<a name="ln-299"></a><span class="c">!!    M_draw supports hardware and software fonts. The software fonts are based</span>
<a name="ln-300"></a><span class="c">!!    on the character set digitized by Dr Allen V. Hershey while working at</span>
<a name="ln-301"></a><span class="c">!!    the U. S. National Bureau of Standards. Exactly what hardware fonts are</span>
<a name="ln-302"></a><span class="c">!!    supported depends on the device, but it is guaranteed that the names</span>
<a name="ln-303"></a><span class="c">!!    &quot;large&quot; and &quot;small&quot; will result in something readable. For X11 displays</span>
<a name="ln-304"></a><span class="c">!!    the default large and small fonts used by the program can be overridden</span>
<a name="ln-305"></a><span class="c">!!    by placing the following defaults in the ~/.Xdefaults file:</span>
<a name="ln-306"></a><span class="c">!!</span>
<a name="ln-307"></a><span class="c">!!      draw.smallfont: X11-font-name</span>
<a name="ln-308"></a><span class="c">!!      draw.largefont: X11-font-name</span>
<a name="ln-309"></a><span class="c">!!</span>
<a name="ln-310"></a><span class="c">!!    It is noted here that hardware text is always assumed to be drawn</span>
<a name="ln-311"></a><span class="c">!!    parallel to the (x, y) plane, using whatever the current z coordinate</span>
<a name="ln-312"></a><span class="c">!!    is. The following software fonts are supported:</span>
<a name="ln-313"></a><span class="c">!!</span>
<a name="ln-314"></a><span class="c">!!       astrology       cursive         cyrillic        futura.l</span>
<a name="ln-315"></a><span class="c">!!       futura.m        gothic.eng      gothic.ger      gothic.ita</span>
<a name="ln-316"></a><span class="c">!!       greek           markers         math.low        math.upp</span>
<a name="ln-317"></a><span class="c">!!       meteorology     music           script          symbolic</span>
<a name="ln-318"></a><span class="c">!!       times.g         times.i         times.ib        times.r</span>
<a name="ln-319"></a><span class="c">!!       times.rb        japanese</span>
<a name="ln-320"></a><span class="c">!!</span>
<a name="ln-321"></a><span class="c">!!    A markers font &quot;markers&quot; is also provided for doing markers - you need</span>
<a name="ln-322"></a><span class="c">!!    to have centertext mode on for this to give sensible results when placing</span>
<a name="ln-323"></a><span class="c">!!    the markers.</span>
<a name="ln-324"></a><span class="c">!!</span>
<a name="ln-325"></a><span class="c">!!    If the environment variable &quot;M_DRAW_FONTPATH&quot; is set M_draw looks for the software</span>
<a name="ln-326"></a><span class="c">!!    fonts in the directory given by this value.</span>
<a name="ln-327"></a><span class="c">!!</span>
<a name="ln-328"></a><span class="c">!!    the default font is futura.l</span>
<a name="ln-329"></a><span class="c">!!</span>
<a name="ln-330"></a><span class="c">!!    TRANSFORMATION ROUTINES</span>
<a name="ln-331"></a><span class="c">!!    translate(x, y, z)          Set up a translation.</span>
<a name="ln-332"></a><span class="c">!!    scale(x, y, z)              Set up scaling factors in x, y, and z axis.</span>
<a name="ln-333"></a><span class="c">!!    rotate(angle, axis)         Set up a rotation in axis axis where axis is one of &#39;x&#39;,&#39;y&#39;, or &#39;z&#39;.</span>
<a name="ln-334"></a><span class="c">!!</span>
<a name="ln-335"></a><span class="c">!!    All transformations are cumulative, so if you rotate something and</span>
<a name="ln-336"></a><span class="c">!!    then do a translate you are translating relative to the rotated</span>
<a name="ln-337"></a><span class="c">!!    axes. If you need to preserve the current transformation matrix use</span>
<a name="ln-338"></a><span class="c">!!    pushmatrix(), do the drawing, and then call popmatrix() to get back</span>
<a name="ln-339"></a><span class="c">!!    where you were before.</span>
<a name="ln-340"></a><span class="c">!!</span>
<a name="ln-341"></a><span class="c">!!    When doing transformations, ensure your objects remain in the viewing</span>
<a name="ln-342"></a><span class="c">!!    volume or they will be clipped. See routines such as ortho(3) for</span>
<a name="ln-343"></a><span class="c">!!    more information.</span>
<a name="ln-344"></a><span class="c">!!</span>
<a name="ln-345"></a><span class="c">!!    PATCH ROUTINES</span>
<a name="ln-346"></a><span class="c">!!    patchbasis(tbasis, ubasis)  Define the t and u basis matrices of a patch.</span>
<a name="ln-347"></a><span class="c">!!    patchprecision(tseg, useg)  Set minimum number of line segments making up curves in a patch.</span>
<a name="ln-348"></a><span class="c">!!    patchcurves(nt, nu)         Set the number of curves making up a patch.</span>
<a name="ln-349"></a><span class="c">!!    rpatch(gx, gy, gz, gw)      Draws a rational patch in the current basis, according to the geometry matrices gx, gy, gz, and gw.</span>
<a name="ln-350"></a><span class="c">!!    patch(gx, gy, gz)           Draws a patch in the current basis, according to the geometry matrices gx, gy, and gz.</span>
<a name="ln-351"></a><span class="c">!!</span>
<a name="ln-352"></a><span class="c">!!    POINT ROUTINES</span>
<a name="ln-353"></a><span class="c">!!    point(x, y, z)              Draw a point at x, y, z</span>
<a name="ln-354"></a><span class="c">!!    point2(x, y)                Draw a point at x, y.</span>
<a name="ln-355"></a><span class="c">!!</span>
<a name="ln-356"></a><span class="c">!!    points are drawn with the current color and linewidth. Points are</span>
<a name="ln-357"></a><span class="c">!!    currently device-specific and may appear as circles, squares, or</span>
<a name="ln-358"></a><span class="c">!!    not at all; as they are generated by a zero-length vector using the</span>
<a name="ln-359"></a><span class="c">!!    hardware line style.</span>
<a name="ln-360"></a><span class="c">!!</span>
<a name="ln-361"></a><span class="c">!!    OBJECT ROUTINES</span>
<a name="ln-362"></a><span class="c">!!    makeobj(n)                  Commence the object number n.</span>
<a name="ln-363"></a><span class="c">!!    closeobj()                  Close the current object.</span>
<a name="ln-364"></a><span class="c">!!    genobj()                    Returns a unique object identifier.</span>
<a name="ln-365"></a><span class="c">!!    getopenobj()                Return the number of the current object.</span>
<a name="ln-366"></a><span class="c">!!    callobj(n)                  Draw object number n.</span>
<a name="ln-367"></a><span class="c">!!    isobj(n)                    Returns non-zero if there is an object of number n.</span>
<a name="ln-368"></a><span class="c">!!    delobj(n)                   Delete the object number n.</span>
<a name="ln-369"></a><span class="c">!!    loadobj(n, filename)        Load the object in the file filename as object number n.</span>
<a name="ln-370"></a><span class="c">!!    saveobj(n, filename)        Save object number n into file filename. Does NOT save objects called inside object n.</span>
<a name="ln-371"></a><span class="c">!!</span>
<a name="ln-372"></a><span class="c">!!    invokeobj(xt,yt,zt,xs,ys,zs,xr,yr,zr,iobject)  push environment and do a transformation and then pop environment</span>
<a name="ln-373"></a><span class="c">!!</span>
<a name="ln-374"></a><span class="c">!!    Objects are graphical entities created by the drawing routines called</span>
<a name="ln-375"></a><span class="c">!!    between makeobj and closeobj. Objects may be called from within other</span>
<a name="ln-376"></a><span class="c">!!    objects. When an object is created most of the calculations required</span>
<a name="ln-377"></a><span class="c">!!    by the drawing routines called within it are done up to where the</span>
<a name="ln-378"></a><span class="c">!!    calculations involve the current transformation matrix. So if you need to</span>
<a name="ln-379"></a><span class="c">!!    draw the same thing several times on the screen but in different places</span>
<a name="ln-380"></a><span class="c">!!    it is faster to use objects than to call the appropriate drawing routines</span>
<a name="ln-381"></a><span class="c">!!    each time. Objects also have the advantage of being savable to a file,</span>
<a name="ln-382"></a><span class="c">!!    from where they can be reloaded for later reuse. Routines which draw</span>
<a name="ln-383"></a><span class="c">!!    or move in screen coordinates, or change device, cannot be included</span>
<a name="ln-384"></a><span class="c">!!    in objects.</span>
<a name="ln-385"></a><span class="c">!!</span>
<a name="ln-386"></a><span class="c">!!    DOUBLE BUFFERING</span>
<a name="ln-387"></a><span class="c">!!    backbuffer()                Draw in the backbuffer. Returns -1 if the device is not up to it.</span>
<a name="ln-388"></a><span class="c">!!    frontbuffer()               Draw in the front buffer. This will always work.</span>
<a name="ln-389"></a><span class="c">!!    swapbuffers()               Swap the front and back buffers.</span>
<a name="ln-390"></a><span class="c">!!</span>
<a name="ln-391"></a><span class="c">!!    Where possible M_draw allows for front and back buffers to enable</span>
<a name="ln-392"></a><span class="c">!!    things like animation and smooth updating of the screen. The routine</span>
<a name="ln-393"></a><span class="c">!!    backbuffer is used to initialise double buffering.</span>
<a name="ln-394"></a><span class="c">!!</span>
<a name="ln-395"></a><span class="c">!!    POSITION ROUTINES</span>
<a name="ln-396"></a><span class="c">!!    getgp(x, y, z)              Gets the current graphics position</span>
<a name="ln-397"></a><span class="c">!!    getgpt(x, y, z, w)          Gets the current transformed graphics position in world coords.</span>
<a name="ln-398"></a><span class="c">!!    getgp2(x, y)                Gets the current graphics position</span>
<a name="ln-399"></a><span class="c">!!    sgetgp2(x, y)               Gets the current screen graphics position in screen coords (-1 to 1)</span>
<a name="ln-400"></a><span class="c">!!</span>
<a name="ln-401"></a><span class="c">!!    GENERAL STACK ROUTINES</span>
<a name="ln-402"></a><span class="c">!!    subroutine pop()            pop</span>
<a name="ln-403"></a><span class="c">!!    subroutine push()           push</span>
<a name="ln-404"></a><span class="c">!!</span>
<a name="ln-405"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-406"></a><span class="c">!!</span>
<a name="ln-407"></a><span class="c">!!   Sample program:</span>
<a name="ln-408"></a><span class="c">!!</span>
<a name="ln-409"></a><span class="c">!!    program demo_M_draw</span>
<a name="ln-410"></a><span class="c">!!    use M_draw</span>
<a name="ln-411"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-412"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-413"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-414"></a><span class="c">!!    use M_units,    only : cosd, sind</span>
<a name="ln-415"></a><span class="c">!!    implicit none</span>
<a name="ln-416"></a><span class="c">!!    integer  :: ipaws</span>
<a name="ln-417"></a><span class="c">!!    real     :: x1, y1</span>
<a name="ln-418"></a><span class="c">!!    integer  :: icolor</span>
<a name="ln-419"></a><span class="c">!!    integer  :: i,j</span>
<a name="ln-420"></a><span class="c">!!</span>
<a name="ln-421"></a><span class="c">!!       ! initialize image</span>
<a name="ln-422"></a><span class="c">!!       call prefsize(400,400)  ! set size before starting</span>
<a name="ln-423"></a><span class="c">!!       call vinit(&#39; &#39;)         ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-424"></a><span class="c">!!       call textsize(10.0,10.0)</span>
<a name="ln-425"></a><span class="c">!!       call mapcolor( 0,   255,255,255 )  !white</span>
<a name="ln-426"></a><span class="c">!!       call mapcolor( 1,   255,  0,  0 )  !red</span>
<a name="ln-427"></a><span class="c">!!       call mapcolor( 2,     0,255,  0 )  !green</span>
<a name="ln-428"></a><span class="c">!!       call mapcolor( 3,   255,255,  0 )  !yellow</span>
<a name="ln-429"></a><span class="c">!!       call mapcolor( 4,     0,  0,255 )  !blue</span>
<a name="ln-430"></a><span class="c">!!       call mapcolor( 5,   255,  0,255 )  !magenta</span>
<a name="ln-431"></a><span class="c">!!       call mapcolor( 6,     0,255,255 )  !cyan</span>
<a name="ln-432"></a><span class="c">!!       call mapcolor( 7,     0,  0,  0 )  !black</span>
<a name="ln-433"></a><span class="c">!!       call mapcolor( 8,     0,155,  0 )</span>
<a name="ln-434"></a><span class="c">!!       call mapcolor( 9,   155,155,155 )</span>
<a name="ln-435"></a><span class="c">!!       call mapcolor(10,   155,255,255 )</span>
<a name="ln-436"></a><span class="c">!!       call mapcolor(11,   155,155,  0 )</span>
<a name="ln-437"></a><span class="c">!!       call mapcolor(12,     0,  0,155 )</span>
<a name="ln-438"></a><span class="c">!!       call mapcolor(13,   155,  0,155 )</span>
<a name="ln-439"></a><span class="c">!!       call mapcolor(14,     0,155,155 )</span>
<a name="ln-440"></a><span class="c">!!       call mapcolor(15,   100,100,100 )</span>
<a name="ln-441"></a><span class="c">!!       call mapcolor(16,   155,100,100 )</span>
<a name="ln-442"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-443"></a><span class="c">!!       call clear()            ! clear to color 0</span>
<a name="ln-444"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-445"></a><span class="c">!!</span>
<a name="ln-446"></a><span class="c">!!       ! map area of virtual world to specified device area</span>
<a name="ln-447"></a><span class="c">!!       ! notice Y-axis for viewport is zero at TOP</span>
<a name="ln-448"></a><span class="c">!!       ! define the virtual world area we want to work in</span>
<a name="ln-449"></a><span class="c">!!       call page(0.0,  400.0,    0.0, 400.0)</span>
<a name="ln-450"></a><span class="c">!!       ! the drawing routines use these world units</span>
<a name="ln-451"></a><span class="c">!!</span>
<a name="ln-452"></a><span class="c">!!       ! put some colored boxes into pixmap by address</span>
<a name="ln-453"></a><span class="c">!!       ! so show how the pixel map can be edited easily with</span>
<a name="ln-454"></a><span class="c">!!       ! other routines that can manipulate a pixel array.</span>
<a name="ln-455"></a><span class="c">!!       ! The P_pixel array was created when vinit(3f) was called</span>
<a name="ln-456"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-457"></a><span class="c">!!       icolor=1</span>
<a name="ln-458"></a><span class="c">!!       do i=0,3</span>
<a name="ln-459"></a><span class="c">!!          do j=0,3</span>
<a name="ln-460"></a><span class="c">!!             x1=j*100.0</span>
<a name="ln-461"></a><span class="c">!!             y1=i*100.0</span>
<a name="ln-462"></a><span class="c">!!             icolor=icolor+1</span>
<a name="ln-463"></a><span class="c">!!             call color(icolor)</span>
<a name="ln-464"></a><span class="c">!!             call rect(x1,y1,x1+100.0,y1+100.0)</span>
<a name="ln-465"></a><span class="c">!!          enddo</span>
<a name="ln-466"></a><span class="c">!!       enddo</span>
<a name="ln-467"></a><span class="c">!!       call polyfill(.false.)</span>
<a name="ln-468"></a><span class="c">!!</span>
<a name="ln-469"></a><span class="c">!!       ! draw polar grids</span>
<a name="ln-470"></a><span class="c">!!       call linewidth(100)</span>
<a name="ln-471"></a><span class="c">!!</span>
<a name="ln-472"></a><span class="c">!!       call linewidth(100)</span>
<a name="ln-473"></a><span class="c">!!       call color(14)</span>
<a name="ln-474"></a><span class="c">!!       call target(200.0,200.0,200.0)</span>
<a name="ln-475"></a><span class="c">!!</span>
<a name="ln-476"></a><span class="c">!!       call linewidth(75)</span>
<a name="ln-477"></a><span class="c">!!       call color(0)</span>
<a name="ln-478"></a><span class="c">!!       call target(100.0,200.0,50.0)</span>
<a name="ln-479"></a><span class="c">!!</span>
<a name="ln-480"></a><span class="c">!!       ! draw some lines</span>
<a name="ln-481"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-482"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-483"></a><span class="c">!!       call line(1.0,1.0,400.0,400.0)</span>
<a name="ln-484"></a><span class="c">!!</span>
<a name="ln-485"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-486"></a><span class="c">!!       call linewidth(250)</span>
<a name="ln-487"></a><span class="c">!!       call line(350.0,200.0,350.0,300.0)</span>
<a name="ln-488"></a><span class="c">!!</span>
<a name="ln-489"></a><span class="c">!!       ! print some text</span>
<a name="ln-490"></a><span class="c">!!       call color(1)</span>
<a name="ln-491"></a><span class="c">!!       call linewidth(125)</span>
<a name="ln-492"></a><span class="c">!!       call font(&#39;futura.l&#39;)</span>
<a name="ln-493"></a><span class="c">!!       call hershey(40.0, 40.0,35.0,&#39;Hello World&#39;,0.0)</span>
<a name="ln-494"></a><span class="c">!!       call color(7)</span>
<a name="ln-495"></a><span class="c">!!       call linewidth(25)</span>
<a name="ln-496"></a><span class="c">!!       call hershey(40.0, 80.0,35.0,&#39;Hello World&#39;,0.0)</span>
<a name="ln-497"></a><span class="c">!!       call linewidth(100)</span>
<a name="ln-498"></a><span class="c">!!       call hershey(40.0,120.0,35.0,&#39;Hello World&#39;,30.0)</span>
<a name="ln-499"></a><span class="c">!!</span>
<a name="ln-500"></a><span class="c">!!       call hershey(  40.0,350.0,35.0,&#39;Hello World&#39;,0.0)</span>
<a name="ln-501"></a><span class="c">!!       call font(&#39;futura.m&#39;)</span>
<a name="ln-502"></a><span class="c">!!       call hershey(  40.0,310.0,35.0,&#39;Hello World&#39;,0.0)</span>
<a name="ln-503"></a><span class="c">!!       call font(&#39;times.r&#39;)</span>
<a name="ln-504"></a><span class="c">!!       call hershey( 350.0,400.0,35.0,&#39;Hello World&#39;,90.0)</span>
<a name="ln-505"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-506"></a><span class="c">!!       call font(&#39;times.i&#39;)</span>
<a name="ln-507"></a><span class="c">!!       call hershey(200.0,120.0,15.0,&#39;Hello World&#39;,20.0)</span>
<a name="ln-508"></a><span class="c">!!</span>
<a name="ln-509"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-510"></a><span class="c">!!       call vexit()</span>
<a name="ln-511"></a><span class="c">!!</span>
<a name="ln-512"></a><span class="c">!!       contains</span>
<a name="ln-513"></a><span class="c">!!</span>
<a name="ln-514"></a><span class="c">!!       subroutine target(xc,yc,rc)</span>
<a name="ln-515"></a><span class="c">!!       use M_units,    only : cosd, sind</span>
<a name="ln-516"></a><span class="c">!!       real     :: xc,yc,rc</span>
<a name="ln-517"></a><span class="c">!!       integer  :: i</span>
<a name="ln-518"></a><span class="c">!!       real     :: x,y</span>
<a name="ln-519"></a><span class="c">!!          do i=0,360,10</span>
<a name="ln-520"></a><span class="c">!!             x=rc*cosd(i)</span>
<a name="ln-521"></a><span class="c">!!             y=rc*sind(i)</span>
<a name="ln-522"></a><span class="c">!!             call line(xc,yc,xc+x,yc+y)</span>
<a name="ln-523"></a><span class="c">!!          enddo</span>
<a name="ln-524"></a><span class="c">!!          do i=1,int(rc),10</span>
<a name="ln-525"></a><span class="c">!!             call circle(xc,yc,real(i))</span>
<a name="ln-526"></a><span class="c">!!          enddo</span>
<a name="ln-527"></a><span class="c">!!       end subroutine target</span>
<a name="ln-528"></a><span class="c">!!</span>
<a name="ln-529"></a><span class="c">!!       subroutine line(x1,y1,x2,y2)</span>
<a name="ln-530"></a><span class="c">!!       real,intent(in) :: x1,y1,x2,y2</span>
<a name="ln-531"></a><span class="c">!!       call move2(x1,y1)</span>
<a name="ln-532"></a><span class="c">!!       call draw2(x2,y2)</span>
<a name="ln-533"></a><span class="c">!!       end subroutine line</span>
<a name="ln-534"></a><span class="c">!!</span>
<a name="ln-535"></a><span class="c">!!       subroutine hershey(x,y,height,itext,theta)</span>
<a name="ln-536"></a><span class="c">!!       real,intent(in)               :: x,y</span>
<a name="ln-537"></a><span class="c">!!       real,intent(in)               :: height</span>
<a name="ln-538"></a><span class="c">!!       character(len=*),intent(in)   :: itext</span>
<a name="ln-539"></a><span class="c">!!       real,intent(in)               :: theta</span>
<a name="ln-540"></a><span class="c">!!       call move2(x,y)</span>
<a name="ln-541"></a><span class="c">!!       call textang(theta)</span>
<a name="ln-542"></a><span class="c">!!       call textsize(height,height)</span>
<a name="ln-543"></a><span class="c">!!       call drawstr(itext)</span>
<a name="ln-544"></a><span class="c">!!       end subroutine hershey</span>
<a name="ln-545"></a><span class="c">!!    end program demo_M_draw</span>
<a name="ln-546"></a><span class="c">!!</span>
<a name="ln-547"></a><span class="c">!!##BUGS</span>
<a name="ln-548"></a><span class="c">!!</span>
<a name="ln-549"></a><span class="c">!!    Polygon hatching will give unexpected results unless the polygon is</span>
<a name="ln-550"></a><span class="c">!!    initially defined in the X-Y plane.</span>
<a name="ln-551"></a><span class="c">!!</span>
<a name="ln-552"></a><span class="c">!!    Double buffering isn&#39;t supported on all devices.</span>
<a name="ln-553"></a><span class="c">!!</span>
<a name="ln-554"></a><span class="c">!!    We don&#39;t recommend the use of the smove/sdraw routines.</span>
<a name="ln-555"></a><span class="c">!!</span>
<a name="ln-556"></a><span class="c">!!    The yobbarays may be turned on or they may be turned off.</span>
<a name="ln-557"></a><span class="c">!!</span>
<a name="ln-558"></a><span class="c">!!    When creating an object, current position and text size are not</span>
<a name="ln-559"></a><span class="c">!!    actually changed so almost any query routine to get position or font</span>
<a name="ln-560"></a><span class="c">!!    size or whatever will not work properly.</span>
<a name="ln-561"></a><span class="c">!!</span>
<a name="ln-562"></a><span class="c">!!    If call vexit(3f) and then call vinit(3f) everything should probably</span>
<a name="ln-563"></a><span class="c">!!    be reset to initial values at program startup, such as linewidth,</span>
<a name="ln-564"></a><span class="c">!!    current font, and color. It is currently left up to the output device</span>
<a name="ln-565"></a><span class="c">!!    initialization routine. It should not be. To minimize the issue,</span>
<a name="ln-566"></a><span class="c">!!    call all the push* routines after a vinit(3f) and call all the pop*</span>
<a name="ln-567"></a><span class="c">!!    routines before vexit(3f).</span>
<a name="ln-568"></a><span class="c">!!</span>
<a name="ln-569"></a><span class="c">!!    Exactly what attributes should and should not be reset with a</span>
<a name="ln-570"></a><span class="c">!!    vnewdev(3f) is questionable.</span>
<a name="ln-571"></a><span class="c">!&gt;</span>
<a name="ln-572"></a><span class="c">!!##NAME</span>
<a name="ln-573"></a><span class="c">!!    prefposition(3f) - [M_draw:WINDOW_SETUP] Specify preferred position of window</span>
<a name="ln-574"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-575"></a><span class="c">!!</span>
<a name="ln-576"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-577"></a><span class="c">!!</span>
<a name="ln-578"></a><span class="c">!!    subroutine prefposition(x, y)</span>
<a name="ln-579"></a><span class="c">!!</span>
<a name="ln-580"></a><span class="c">!!     integer,intent(in) :: x, y</span>
<a name="ln-581"></a><span class="c">!!</span>
<a name="ln-582"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-583"></a><span class="c">!!    Specify the preferred position of the window opened by the *next*</span>
<a name="ln-584"></a><span class="c">!!    vinit in raster units or units of resolution, depending on the output</span>
<a name="ln-585"></a><span class="c">!!    device. The physical size of the units are generally device-specific --</span>
<a name="ln-586"></a><span class="c">!!    For X11 Windows and PPM pixmaps the values would represent rasters.</span>
<a name="ln-587"></a><span class="c">!!    For vector output devices the number of &quot;rasters&quot; per inch varies.</span>
<a name="ln-588"></a><span class="c">!!</span>
<a name="ln-589"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-590"></a><span class="c">!!</span>
<a name="ln-591"></a><span class="c">!!   Sample program:</span>
<a name="ln-592"></a><span class="c">!!</span>
<a name="ln-593"></a><span class="c">!!      program demo_prefposition</span>
<a name="ln-594"></a><span class="c">!!      use M_draw, only    : prefsize, vinit, ortho2, clear, getkey, prefposition</span>
<a name="ln-595"></a><span class="c">!!      use M_draw, only    : move2, draw2, vexit, color</span>
<a name="ln-596"></a><span class="c">!!      use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-597"></a><span class="c">!!      use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-598"></a><span class="c">!!      use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-599"></a><span class="c">!!      implicit none</span>
<a name="ln-600"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-601"></a><span class="c">!!</span>
<a name="ln-602"></a><span class="c">!!      call prefsize(60,40)</span>
<a name="ln-603"></a><span class="c">!!      call prefposition(100,100)</span>
<a name="ln-604"></a><span class="c">!!</span>
<a name="ln-605"></a><span class="c">!!      call vinit(&#39; &#39;)         ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-606"></a><span class="c">!!      call ortho2(-300.0,300.0,-200.0,200.0)</span>
<a name="ln-607"></a><span class="c">!!      call color(D_BLACK)</span>
<a name="ln-608"></a><span class="c">!!      call clear()</span>
<a name="ln-609"></a><span class="c">!!      call color(D_RED)</span>
<a name="ln-610"></a><span class="c">!!      call move2(-300.0,-200.0)</span>
<a name="ln-611"></a><span class="c">!!      call draw2(300.0,200.0)</span>
<a name="ln-612"></a><span class="c">!!      call move2(300.0,-200.0)</span>
<a name="ln-613"></a><span class="c">!!      call draw2(-300.0,200.0)</span>
<a name="ln-614"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-615"></a><span class="c">!!      call vexit()</span>
<a name="ln-616"></a><span class="c">!!</span>
<a name="ln-617"></a><span class="c">!!      end program demo_prefposition</span>
<a name="ln-618"></a><span class="c">!&gt;</span>
<a name="ln-619"></a><span class="c">!!##NAME</span>
<a name="ln-620"></a><span class="c">!!    prefsize(3f) - [M_draw:WINDOW_SETUP] Specify preferred width and height of window in physical units</span>
<a name="ln-621"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-622"></a><span class="c">!!</span>
<a name="ln-623"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-624"></a><span class="c">!!</span>
<a name="ln-625"></a><span class="c">!!         subroutine prefsize(width, height)</span>
<a name="ln-626"></a><span class="c">!!         integer,intent(in) :: width, height</span>
<a name="ln-627"></a><span class="c">!!</span>
<a name="ln-628"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-629"></a><span class="c">!!</span>
<a name="ln-630"></a><span class="c">!!    Specify the preferred width and height of the device output surface</span>
<a name="ln-631"></a><span class="c">!!    opened by the *next* vinit(3f).</span>
<a name="ln-632"></a><span class="c">!!</span>
<a name="ln-633"></a><span class="c">!!##OPTIONS</span>
<a name="ln-634"></a><span class="c">!!    WIDTH   width of device to create when vinit(3f) is called</span>
<a name="ln-635"></a><span class="c">!!    HEIGHT  height of device to create when vinit(3f) is called</span>
<a name="ln-636"></a><span class="c">!!</span>
<a name="ln-637"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-638"></a><span class="c">!!</span>
<a name="ln-639"></a><span class="c">!!   Sample program:</span>
<a name="ln-640"></a><span class="c">!!</span>
<a name="ln-641"></a><span class="c">!!      program demo_prefsize</span>
<a name="ln-642"></a><span class="c">!!      use M_draw, only: prefsize, vinit, ortho2, clear, getkey</span>
<a name="ln-643"></a><span class="c">!!      use M_draw, only: move2, draw2, vexit, color</span>
<a name="ln-644"></a><span class="c">!!      use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-645"></a><span class="c">!!      use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-646"></a><span class="c">!!      use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-647"></a><span class="c">!!      implicit none</span>
<a name="ln-648"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-649"></a><span class="c">!!         ! make first file with one size</span>
<a name="ln-650"></a><span class="c">!!         call prefsize(60*2,40*2)</span>
<a name="ln-651"></a><span class="c">!!         call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-652"></a><span class="c">!!         call picture()</span>
<a name="ln-653"></a><span class="c">!!         ipaws=getkey()</span>
<a name="ln-654"></a><span class="c">!!         call vexit()</span>
<a name="ln-655"></a><span class="c">!!</span>
<a name="ln-656"></a><span class="c">!!         ! make second file with another size</span>
<a name="ln-657"></a><span class="c">!!         call prefsize(60*3,40*3)</span>
<a name="ln-658"></a><span class="c">!!         call vinit(&#39; &#39;)</span>
<a name="ln-659"></a><span class="c">!!         call picture()</span>
<a name="ln-660"></a><span class="c">!!         ipaws=getkey()</span>
<a name="ln-661"></a><span class="c">!!         call vexit()</span>
<a name="ln-662"></a><span class="c">!!      contains</span>
<a name="ln-663"></a><span class="c">!!      subroutine picture</span>
<a name="ln-664"></a><span class="c">!!         call ortho2(-300.0,300.0,-200.0,200.0)</span>
<a name="ln-665"></a><span class="c">!!         call color(D_BLACK)</span>
<a name="ln-666"></a><span class="c">!!         call clear()</span>
<a name="ln-667"></a><span class="c">!!         call color(D_RED)</span>
<a name="ln-668"></a><span class="c">!!         call move2(-300.0,-200.0)</span>
<a name="ln-669"></a><span class="c">!!         call draw2(300.0,200.0)</span>
<a name="ln-670"></a><span class="c">!!         call move2(300.0,-200.0)</span>
<a name="ln-671"></a><span class="c">!!         call draw2(-300.0,200.0)</span>
<a name="ln-672"></a><span class="c">!!      end subroutine picture</span>
<a name="ln-673"></a><span class="c">!!      end program demo_prefsize</span>
<a name="ln-674"></a><span class="c">!&gt;</span>
<a name="ln-675"></a><span class="c">!!##NAME</span>
<a name="ln-676"></a><span class="c">!!    vinit(3f) - [M_draw:DEVICE] Initialise device</span>
<a name="ln-677"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-678"></a><span class="c">!!</span>
<a name="ln-679"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-680"></a><span class="c">!!</span>
<a name="ln-681"></a><span class="c">!!          subroutine vinit(device)</span>
<a name="ln-682"></a><span class="c">!!          character(len=*),intent(in) :: device</span>
<a name="ln-683"></a><span class="c">!!</span>
<a name="ln-684"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-685"></a><span class="c">!!    Initialise the device.</span>
<a name="ln-686"></a><span class="c">!!</span>
<a name="ln-687"></a><span class="c">!!</span>
<a name="ln-688"></a><span class="c">!!  Note 1 : Currently available devices are:</span>
<a name="ln-689"></a><span class="c">!!</span>
<a name="ln-690"></a><span class="c">!!        INTERACTIVE DEVICES</span>
<a name="ln-691"></a><span class="c">!!</span>
<a name="ln-692"></a><span class="c">!!        PC   - native MSW PC driver; only tested from CygWin</span>
<a name="ln-693"></a><span class="c">!!        X11  - X11 windows (Black background)</span>
<a name="ln-694"></a><span class="c">!!        x11  - X11 windows (White background)</span>
<a name="ln-695"></a><span class="c">!!        tek  - tektronix 4010 and compatibles</span>
<a name="ln-696"></a><span class="c">!!        xtek - X11 xterm Tektronix 4010 emulator</span>
<a name="ln-697"></a><span class="c">!!</span>
<a name="ln-698"></a><span class="c">!!        PRINTERS AND PLOTTERS</span>
<a name="ln-699"></a><span class="c">!!</span>
<a name="ln-700"></a><span class="c">!!           PostScript:</span>
<a name="ln-701"></a><span class="c">!!              [p]psm or [p]postscript - monochrome PostScript</span>
<a name="ln-702"></a><span class="c">!!              [p]psg - grayscale PostScript</span>
<a name="ln-703"></a><span class="c">!!              [p]psc - color PostScript</span>
<a name="ln-704"></a><span class="c">!!           HPGL:</span>
<a name="ln-705"></a><span class="c">!!              hpgl - HP Graphics language and compatibles</span>
<a name="ln-706"></a><span class="c">!!              [p]hpgl2 - HPGL level 2 (obeys prefsize calls)</span>
<a name="ln-707"></a><span class="c">!!           PCL:</span>
<a name="ln-708"></a><span class="c">!!              [p]pclland  - monochrome PCL5 (obeys prefsize calls)</span>
<a name="ln-709"></a><span class="c">!!              [p]pclport  - monochrome PCL5 (obeys prefsize calls)</span>
<a name="ln-710"></a><span class="c">!!              pcl5land (color PCL5 landscape)</span>
<a name="ln-711"></a><span class="c">!!              pcl5port (color PCL5 portrait)</span>
<a name="ln-712"></a><span class="c">!!</span>
<a name="ln-713"></a><span class="c">!!        PIXMAPS (COLOR) AND BITMAPS (MONOCHROME)</span>
<a name="ln-714"></a><span class="c">!!</span>
<a name="ln-715"></a><span class="c">!!        char     An ASCII file that can be displayed to most</span>
<a name="ln-716"></a><span class="c">!!                 xterm(1) terminal emulators that support</span>
<a name="ln-717"></a><span class="c">!!                 color</span>
<a name="ln-718"></a><span class="c">!!        p1/pbm   Poskanzer (pbmplus/netplus) portable</span>
<a name="ln-719"></a><span class="c">!!                 ASCII bitmap file</span>
<a name="ln-720"></a><span class="c">!!        p3/ppm   Poskanzer portable ASCII pixmap file</span>
<a name="ln-721"></a><span class="c">!!        p4       Poskanzer portable binary bitmap file</span>
<a name="ln-722"></a><span class="c">!!        p6       Poskanzer portable binary pixmap file</span>
<a name="ln-723"></a><span class="c">!!        xbm      X11 bitmap file</span>
<a name="ln-724"></a><span class="c">!!        bm       bitmap format for atobm(1)</span>
<a name="ln-725"></a><span class="c">!!</span>
<a name="ln-726"></a><span class="c">!!        PRODUCT INPUT FILES</span>
<a name="ln-727"></a><span class="c">!!</span>
<a name="ln-728"></a><span class="c">!!        mif        FrameMaker Interchange Format 3.0 (MIF) files</span>
<a name="ln-729"></a><span class="c">!!                   (16 colors)</span>
<a name="ln-730"></a><span class="c">!!        mif4       FrameMaker Interchange Format 4.0 (MIF) files</span>
<a name="ln-731"></a><span class="c">!!                   (user-definable colors, but breaks a MIF rule)</span>
<a name="ln-732"></a><span class="c">!!        xfig       X11 xfig(1) figure utility</span>
<a name="ln-733"></a><span class="c">!!</span>
<a name="ln-734"></a><span class="c">!!        METAFILES WITH POST_PROCESSORS/CONVERTERS</span>
<a name="ln-735"></a><span class="c">!!</span>
<a name="ln-736"></a><span class="c">!!        cgmt      a clear-text CGM (Computer Graphics Metafile)</span>
<a name="ln-737"></a><span class="c">!!        gnu       GNU plot(1) metafile</span>
<a name="ln-738"></a><span class="c">!!        pdf       Adobe Public Document Format</span>
<a name="ln-739"></a><span class="c">!!        unixplot  Unix plot(1) metafile</span>
<a name="ln-740"></a><span class="c">!!</span>
<a name="ln-741"></a><span class="c">!!        BROWSER FILES</span>
<a name="ln-742"></a><span class="c">!!</span>
<a name="ln-743"></a><span class="c">!!        canvas    HTML5 CANVAS graphics element file</span>
<a name="ln-744"></a><span class="c">!!        svg       Scalable Vector Graphics</span>
<a name="ln-745"></a><span class="c">!!        usemap    HTML image map</span>
<a name="ln-746"></a><span class="c">!!        vml       Microsoft Vector Markup Language</span>
<a name="ln-747"></a><span class="c">!!</span>
<a name="ln-748"></a><span class="c">!!        FILES</span>
<a name="ln-749"></a><span class="c">!!        vog       M_draw low level call record (debug)</span>
<a name="ln-750"></a><span class="c">!!</span>
<a name="ln-751"></a><span class="c">!!        OTHER</span>
<a name="ln-752"></a><span class="c">!!        fti       SGI vector-based icons</span>
<a name="ln-753"></a><span class="c">!!        null      no output</span>
<a name="ln-754"></a><span class="c">!!</span>
<a name="ln-755"></a><span class="c">!!      :- Drivers I&#39;ve dropped but code is there for</span>
<a name="ln-756"></a><span class="c">!!      ---------------------------------------------</span>
<a name="ln-757"></a><span class="c">!!</span>
<a name="ln-758"></a><span class="c">!!        grwin - (minGW GRwin PC interface)</span>
<a name="ln-759"></a><span class="c">!!        decX11 - the decstation window manager</span>
<a name="ln-760"></a><span class="c">!!        dxy - roland DXY plotter language</span>
<a name="ln-761"></a><span class="c">!!        sun - Sun workstations running sunview</span>
<a name="ln-762"></a><span class="c">!!        next - NeXTStep and other NeXT platforms</span>
<a name="ln-763"></a><span class="c">!!        apollo - Apollo workstations</span>
<a name="ln-764"></a><span class="c">!!</span>
<a name="ln-765"></a><span class="c">!!      :- Drivers I&#39;ve dropped but are in the original distribution</span>
<a name="ln-766"></a><span class="c">!!      ------------------------------------------------------------</span>
<a name="ln-767"></a><span class="c">!!</span>
<a name="ln-768"></a><span class="c">!!        hercules - IBM PC hercules graphics card</span>
<a name="ln-769"></a><span class="c">!!        cga - IBM PC cga graphics card</span>
<a name="ln-770"></a><span class="c">!!        ega - IBM PC ega graphics card</span>
<a name="ln-771"></a><span class="c">!!        vga - IBM PC vga graphics card</span>
<a name="ln-772"></a><span class="c">!!        sigma - IBM PC sigma graphics card.</span>
<a name="ln-773"></a><span class="c">!!        mswin - IBM PC Microsoft Windows.</span>
<a name="ln-774"></a><span class="c">!!</span>
<a name="ln-775"></a><span class="c">!!     Note 2 : If device is a NULL or a null string the value</span>
<a name="ln-776"></a><span class="c">!!          of the environment variable &quot;M_DRAW_DEVICE&quot; is taken as the</span>
<a name="ln-777"></a><span class="c">!!          device type to be opened. The format of the variable is</span>
<a name="ln-778"></a><span class="c">!!</span>
<a name="ln-779"></a><span class="c">!!             M_DRAW_DEVICE [ xsize [ ysize [ xoffset [ yoffset ] ] ]</span>
<a name="ln-780"></a><span class="c">!!</span>
<a name="ln-781"></a><span class="c">!!          That is, if present xsize and ysize will be used</span>
<a name="ln-782"></a><span class="c">!!          in a call to prefsize(3c), and xoffset and yoffset will</span>
<a name="ln-783"></a><span class="c">!!          be used in a call to preposition(3c).</span>
<a name="ln-784"></a><span class="c">!!</span>
<a name="ln-785"></a><span class="c">!!     Note 3 : after vinit() it is wise to explicitly clear the screen.</span>
<a name="ln-786"></a><span class="c">!!     e.g.:</span>
<a name="ln-787"></a><span class="c">!!</span>
<a name="ln-788"></a><span class="c">!!          call color(D_BLACK)</span>
<a name="ln-789"></a><span class="c">!!          call clear()</span>
<a name="ln-790"></a><span class="c">!!</span>
<a name="ln-791"></a><span class="c">!!##NOTES</span>
<a name="ln-792"></a><span class="c">!!</span>
<a name="ln-793"></a><span class="c">!! gnu</span>
<a name="ln-794"></a><span class="c">!!</span>
<a name="ln-795"></a><span class="c">!!    The GNU plotutils package includes a program called plot(1) that</span>
<a name="ln-796"></a><span class="c">!!    can read in the gnu metafile and render images on an X11 display, PNG</span>
<a name="ln-797"></a><span class="c">!!    (Portable Network Graphics) format, portable anymap format (PBM/PGM/PPM),</span>
<a name="ln-798"></a><span class="c">!!    a pseudo-GIF format that does not use LZW encoding, the new XML-based</span>
<a name="ln-799"></a><span class="c">!!    Scalable Vector Graphics format, the format used by Adobe Illustrator,</span>
<a name="ln-800"></a><span class="c">!!    Postscript or Encapsulated Postscript (EPS) that can be edited with</span>
<a name="ln-801"></a><span class="c">!!    idraw(1), CGM format (by default, confirming to the WebCGM profile),</span>
<a name="ln-802"></a><span class="c">!!    the format used by the xfig(1) drawing editor, the Hewlett-Packard PCL 5</span>
<a name="ln-803"></a><span class="c">!!    printer language, the Hewlett-Packard Graphics Language, ReGIS graphics</span>
<a name="ln-804"></a><span class="c">!!    format (which can be displayed by the dxterm(1) terminal emulator or</span>
<a name="ln-805"></a><span class="c">!!    by a VT330 or VT340 terminal), Tektronix format (which can be displayed</span>
<a name="ln-806"></a><span class="c">!!    by the xterm(1) terminal emulator), and device-independent GNU metafile</span>
<a name="ln-807"></a><span class="c">!!    format itself.</span>
<a name="ln-808"></a><span class="c">!!</span>
<a name="ln-809"></a><span class="c">!! pdf</span>
<a name="ln-810"></a><span class="c">!!</span>
<a name="ln-811"></a><span class="c">!!    Popular PDF readers are the Adobe PDF viewer, which is often callable from</span>
<a name="ln-812"></a><span class="c">!!    Web browsers; the GhostScript-based gv(1) utility; or the xpdf program.</span>
<a name="ln-813"></a><span class="c">!!</span>
<a name="ln-814"></a><span class="c">!!        The xpdf(1) software , related utilities ( pdftops(1), pdftotext(1),</span>
<a name="ln-815"></a><span class="c">!!        pdfinfo(1), pdffonts(1), pdftoppm(1), pdfimages(1), xpdfrc (5))</span>
<a name="ln-816"></a><span class="c">!!        and documentation are copyright 1996-2004 Glyph &amp; Cog, LLC. at</span>
<a name="ln-817"></a><span class="c">!!        http://www.foolabs.com/xpdf/</span>
<a name="ln-818"></a><span class="c">!!</span>
<a name="ln-819"></a><span class="c">!!    The GhostScript-based tools can convert PDF files to PostScript as</span>
<a name="ln-820"></a><span class="c">!!    well as view the files.</span>
<a name="ln-821"></a><span class="c">!!</span>
<a name="ln-822"></a><span class="c">!! cgmt</span>
<a name="ln-823"></a><span class="c">!!</span>
<a name="ln-824"></a><span class="c">!!    The ralcgm(1) and gplot(1) packages are two very complete CGM viewers.</span>
<a name="ln-825"></a><span class="c">!!</span>
<a name="ln-826"></a><span class="c">!!    ppm,pbm (and p1,p3,p4,p6)</span>
<a name="ln-827"></a><span class="c">!!</span>
<a name="ln-828"></a><span class="c">!!      * p1/pbm - Poskanzer (pbmplus/netplus) portable ASCII bitmap file</span>
<a name="ln-829"></a><span class="c">!!      * p3/ppm - Poskanzer portable ASCII pixmap file</span>
<a name="ln-830"></a><span class="c">!!      * p4 - Poskanzer portable binary bitmap file</span>
<a name="ln-831"></a><span class="c">!!      * p6 - Poskanzer portable binary pixmap file</span>
<a name="ln-832"></a><span class="c">!!</span>
<a name="ln-833"></a><span class="c">!!    The NetPBM package is available for almost every platform and lets</span>
<a name="ln-834"></a><span class="c">!!    you convert the Poskanzer portable pixmap (PPM) files to just about</span>
<a name="ln-835"></a><span class="c">!!    any pixmap or bitmap format, including PNG, JPEG, GIF/PseudoGIF, BPM,</span>
<a name="ln-836"></a><span class="c">!!    ..... Other popular pixmap products such as ImageMagick, gv, ... can</span>
<a name="ln-837"></a><span class="c">!!    read PPM files, convert them, and often edit them.</span>
<a name="ln-838"></a><span class="c">!!</span>
<a name="ln-839"></a><span class="c">!!##HTML:</span>
<a name="ln-840"></a><span class="c">!!</span>
<a name="ln-841"></a><span class="c">!!    The vml, canvas, svg, and usemap drivers are primarily used to generate</span>
<a name="ln-842"></a><span class="c">!!    graphics for inclusion in HTML documents. Browsers such as Opera, Safari,</span>
<a name="ln-843"></a><span class="c">!!    Foxfire, and Chrome can easily incorporate graphics generated using the</span>
<a name="ln-844"></a><span class="c">!!    SVG (Scalable Vector Graphics) format or the HTML5 CANVAS element.</span>
<a name="ln-845"></a><span class="c">!!</span>
<a name="ln-846"></a><span class="c">!! usemap</span>
<a name="ln-847"></a><span class="c">!!</span>
<a name="ln-848"></a><span class="c">!!    This driver writes out the edges of any polygon in a format that can be</span>
<a name="ln-849"></a><span class="c">!!    used with an HTML image map; if the same sizes are used a plot generated</span>
<a name="ln-850"></a><span class="c">!!    with the ppm driver; you will have clickable regions in your pixmap when</span>
<a name="ln-851"></a><span class="c">!!    converted to a GIF image.</span>
<a name="ln-852"></a><span class="c">!!</span>
<a name="ln-853"></a><span class="c">!!    If the polygons overlap you need to reverse the order of the polygon</span>
<a name="ln-854"></a><span class="c">!!    definitions in the output file. The numeric field in the&lt;AREA&gt; titles</span>
<a name="ln-855"></a><span class="c">!!    should help.</span>
<a name="ln-856"></a><span class="c">!!</span>
<a name="ln-857"></a><span class="c">!! vml</span>
<a name="ln-858"></a><span class="c">!!</span>
<a name="ln-859"></a><span class="c">!!    The VML format can be read in by any MicroSoft Office 2000+ product and</span>
<a name="ln-860"></a><span class="c">!!    MicroSoft&#39;s web browser Internet Explorer. If the plots contain more than</span>
<a name="ln-861"></a><span class="c">!!    about 9766 vectors MicroSoft Word starts choking (still true in 2005),</span>
<a name="ln-862"></a><span class="c">!!    but otherwise this is a very nice way to generate input for MicroSoft</span>
<a name="ln-863"></a><span class="c">!!    products.</span>
<a name="ln-864"></a><span class="c">!!</span>
<a name="ln-865"></a><span class="c">!!    I generally use this on a machine running MicroSoft Windows by installing</span>
<a name="ln-866"></a><span class="c">!!    CygWin with the X11 options (and ralcgm, the GhostScript software,</span>
<a name="ln-867"></a><span class="c">!!    the GNU plotutils packages and netpbm).</span>
<a name="ln-868"></a><span class="c">!!</span>
<a name="ln-869"></a><span class="c">!! xfig</span>
<a name="ln-870"></a><span class="c">!!</span>
<a name="ln-871"></a><span class="c">!!    The xfig(1) command can be used to edit graphics generated with the</span>
<a name="ln-872"></a><span class="c">!!    M_draw graphics library; and to convert the xfig(1)-format file to</span>
<a name="ln-873"></a><span class="c">!!    many other output formats. If you are generating pixmaps with the PPM</span>
<a name="ln-874"></a><span class="c">!!    driver and want to use them as image maps in your HTML documents the</span>
<a name="ln-875"></a><span class="c">!!    usemap driver can be used.</span>
<a name="ln-876"></a><span class="c">!!</span>
<a name="ln-877"></a><span class="c">!!    If you have xfig(1) installed, you will find that calling fig2dev(1)</span>
<a name="ln-878"></a><span class="c">!!    allows you to generate many output formats from a single file,</span>
<a name="ln-879"></a><span class="c">!!    including LaTex and encapsulated PostScript.</span>
<a name="ln-880"></a><span class="c">!!</span>
<a name="ln-881"></a><span class="c">!!    xfig(1) is an X11 Windows application that can be used to interactively</span>
<a name="ln-882"></a><span class="c">!!    edit figures. The HELP utility of xfig(1) provides a description of the</span>
<a name="ln-883"></a><span class="c">!!    xfig(1) file format (as well as a user guide and many other documents).</span>
<a name="ln-884"></a><span class="c">!!</span>
<a name="ln-885"></a><span class="c">!!    Unfortunately, the manual indicates the user defined colors must</span>
<a name="ln-886"></a><span class="c">!!    be defined before any other Fig objects. By default, 16 colors are</span>
<a name="ln-887"></a><span class="c">!!    defined. If undefined colors are used they are assigned a dash pattern</span>
<a name="ln-888"></a><span class="c">!!    or a fill pattern to help distinguish them. Use of hardware dash and</span>
<a name="ln-889"></a><span class="c">!!    M_draw software dash could get confusing.</span>
<a name="ln-890"></a><span class="c">!!</span>
<a name="ln-891"></a><span class="c">!!    Also, in the current driver version all lines are drawn as a series</span>
<a name="ln-892"></a><span class="c">!!    of move-draw vectors, which can make the files relatively very large.</span>
<a name="ln-893"></a><span class="c">!!</span>
<a name="ln-894"></a><span class="c">!!    multiple pages appear to only work with the PostScript and PDF drivers</span>
<a name="ln-895"></a><span class="c">!!    of xfig(1); and even then pages must be all positive numbers from left</span>
<a name="ln-896"></a><span class="c">!!    to right and top to bottom, printing all pages in a rectangular area.</span>
<a name="ln-897"></a><span class="c">!!</span>
<a name="ln-898"></a><span class="c">!!    Alternatively, could use depth to keep up to 999 pages separate</span>
<a name="ln-899"></a><span class="c">!!</span>
<a name="ln-900"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-901"></a><span class="c">!!</span>
<a name="ln-902"></a><span class="c">!!  Sample program:</span>
<a name="ln-903"></a><span class="c">!!</span>
<a name="ln-904"></a><span class="c">!!       program demo_vinit</span>
<a name="ln-905"></a><span class="c">!!       use M_draw</span>
<a name="ln-906"></a><span class="c">!!       use ISO_C_BINDING</span>
<a name="ln-907"></a><span class="c">!!       integer :: ios</span>
<a name="ln-908"></a><span class="c">!!       character(len=50) :: device</span>
<a name="ln-909"></a><span class="c">!!</span>
<a name="ln-910"></a><span class="c">!!       ! read in device name and start graphics mode</span>
<a name="ln-911"></a><span class="c">!!       print*,&#39;Enter output device:&#39;</span>
<a name="ln-912"></a><span class="c">!!       read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-913"></a><span class="c">!!       if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-914"></a><span class="c">!!       call vinit(device)</span>
<a name="ln-915"></a><span class="c">!!       ! by default the drawing surface is</span>
<a name="ln-916"></a><span class="c">!!       ! a square ranging from -1 to 1 in both</span>
<a name="ln-917"></a><span class="c">!!       ! the X and Y axis</span>
<a name="ln-918"></a><span class="c">!!</span>
<a name="ln-919"></a><span class="c">!!       ! set font to large hardware font</span>
<a name="ln-920"></a><span class="c">!!       call font(&#39;large&#39;)</span>
<a name="ln-921"></a><span class="c">!!</span>
<a name="ln-922"></a><span class="c">!!       ! set current color to black</span>
<a name="ln-923"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-924"></a><span class="c">!!</span>
<a name="ln-925"></a><span class="c">!!       ! clear to current color</span>
<a name="ln-926"></a><span class="c">!!       call clear()</span>
<a name="ln-927"></a><span class="c">!!</span>
<a name="ln-928"></a><span class="c">!!       ! we want to draw in green</span>
<a name="ln-929"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-930"></a><span class="c">!!</span>
<a name="ln-931"></a><span class="c">!!       ! draw a horizontal line at y = 0</span>
<a name="ln-932"></a><span class="c">!!       call move2(-1.0, 0.0)</span>
<a name="ln-933"></a><span class="c">!!       call draw2(1.0, 0.0)</span>
<a name="ln-934"></a><span class="c">!!</span>
<a name="ln-935"></a><span class="c">!!       ! pause for some input</span>
<a name="ln-936"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-937"></a><span class="c">!!</span>
<a name="ln-938"></a><span class="c">!!       ! draw a line along x = 0</span>
<a name="ln-939"></a><span class="c">!!       call move2(0.0, 0.0)</span>
<a name="ln-940"></a><span class="c">!!       call draw2(0.0, 1.0)</span>
<a name="ln-941"></a><span class="c">!!</span>
<a name="ln-942"></a><span class="c">!!       ! move to the middle of the screen</span>
<a name="ln-943"></a><span class="c">!!       call move2(0.0, 0.0)</span>
<a name="ln-944"></a><span class="c">!!</span>
<a name="ln-945"></a><span class="c">!!       ! draw &#39;Hello&#39; starting at the origin</span>
<a name="ln-946"></a><span class="c">!!       call drawstr(&#39;Hello&#39;)</span>
<a name="ln-947"></a><span class="c">!!</span>
<a name="ln-948"></a><span class="c">!!       ! pause again</span>
<a name="ln-949"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-950"></a><span class="c">!!</span>
<a name="ln-951"></a><span class="c">!!       !  wrap up and exit graphics mode</span>
<a name="ln-952"></a><span class="c">!!       call vexit()</span>
<a name="ln-953"></a><span class="c">!!</span>
<a name="ln-954"></a><span class="c">!!       end program demo_vinit</span>
<a name="ln-955"></a><span class="c">!&gt;</span>
<a name="ln-956"></a><span class="c">!!##NAME</span>
<a name="ln-957"></a><span class="c">!!    vexit(3f) - [M_draw:DEVICE] Reset window/terminal and exit graphics mode. Must be last routine called.</span>
<a name="ln-958"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-959"></a><span class="c">!!</span>
<a name="ln-960"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-961"></a><span class="c">!!</span>
<a name="ln-962"></a><span class="c">!!          subroutine vexit()</span>
<a name="ln-963"></a><span class="c">!!</span>
<a name="ln-964"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-965"></a><span class="c">!!</span>
<a name="ln-966"></a><span class="c">!!    Reset the window/terminal and terminate graphics mode. Required to</span>
<a name="ln-967"></a><span class="c">!!    properly close out most output devices. Must be called before any</span>
<a name="ln-968"></a><span class="c">!!    second call to vinit(3f). Must be the last M_draw routine called.</span>
<a name="ln-969"></a><span class="c">!!</span>
<a name="ln-970"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-971"></a><span class="c">!!</span>
<a name="ln-972"></a><span class="c">!!   Sample program:</span>
<a name="ln-973"></a><span class="c">!!</span>
<a name="ln-974"></a><span class="c">!!      program demo_vexit</span>
<a name="ln-975"></a><span class="c">!!      use M_draw, only: vinit, vexit, voutput, circle, linewidth, color</span>
<a name="ln-976"></a><span class="c">!!      use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-977"></a><span class="c">!!      use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-978"></a><span class="c">!!      use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-979"></a><span class="c">!!      implicit none</span>
<a name="ln-980"></a><span class="c">!!      integer :: i</span>
<a name="ln-981"></a><span class="c">!!</span>
<a name="ln-982"></a><span class="c">!!      ! assuming you have the NetPBM package installed</span>
<a name="ln-983"></a><span class="c">!!      ! set up output to create a GIF file called one.gif</span>
<a name="ln-984"></a><span class="c">!!      call voutput(&#39;|ppmtogif &gt;vexit.3m_draw.gif&#39;)</span>
<a name="ln-985"></a><span class="c">!!</span>
<a name="ln-986"></a><span class="c">!!      call vinit(&#39;p6&#39;) ! start graphics</span>
<a name="ln-987"></a><span class="c">!!      ! default window is -1 &lt;= x &lt;= 1, -1 &lt;= y &lt;= 1</span>
<a name="ln-988"></a><span class="c">!!      ! default viewport is left bottom justified square</span>
<a name="ln-989"></a><span class="c">!!      ! so essentially you have a square drawing surface</span>
<a name="ln-990"></a><span class="c">!!      ! with the point &lt;0,0&gt; at the center of the square</span>
<a name="ln-991"></a><span class="c">!!      ! with X and Y ranging from -1 to 1.</span>
<a name="ln-992"></a><span class="c">!!</span>
<a name="ln-993"></a><span class="c">!!      call color(D_RED)</span>
<a name="ln-994"></a><span class="c">!!      call linewidth(100)</span>
<a name="ln-995"></a><span class="c">!!      ! this loop draws outside the current window</span>
<a name="ln-996"></a><span class="c">!!      ! but by default clipping is on</span>
<a name="ln-997"></a><span class="c">!!      do i=1,30</span>
<a name="ln-998"></a><span class="c">!!         call circle((real(i)-1)*0.04,0.0,1.0/real(i))</span>
<a name="ln-999"></a><span class="c">!!      enddo</span>
<a name="ln-1000"></a><span class="c">!!</span>
<a name="ln-1001"></a><span class="c">!!      call vexit() ! exited graphics so can start again</span>
<a name="ln-1002"></a><span class="c">!!</span>
<a name="ln-1003"></a><span class="c">!!      ! start second graphics session with new output</span>
<a name="ln-1004"></a><span class="c">!!      ! device and output file</span>
<a name="ln-1005"></a><span class="c">!!      call voutput(&#39;|ppmtogif &gt;vexit2.3m_draw.gif&#39;)</span>
<a name="ln-1006"></a><span class="c">!!      call vinit(&#39;p6&#39;)</span>
<a name="ln-1007"></a><span class="c">!!</span>
<a name="ln-1008"></a><span class="c">!!      do i=10,1,-1</span>
<a name="ln-1009"></a><span class="c">!!         call color(i)</span>
<a name="ln-1010"></a><span class="c">!!         call circle(0.0,0.0,1.0/real(i))</span>
<a name="ln-1011"></a><span class="c">!!      enddo</span>
<a name="ln-1012"></a><span class="c">!!</span>
<a name="ln-1013"></a><span class="c">!!      call vexit()</span>
<a name="ln-1014"></a><span class="c">!!</span>
<a name="ln-1015"></a><span class="c">!!      end program demo_vexit</span>
<a name="ln-1016"></a><span class="c">!&gt;</span>
<a name="ln-1017"></a><span class="c">!!##NAME</span>
<a name="ln-1018"></a><span class="c">!!    voutput(3f) - [M_draw:DEVICE] Redirect output from *next* vinit to file</span>
<a name="ln-1019"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1020"></a><span class="c">!!</span>
<a name="ln-1021"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1022"></a><span class="c">!!</span>
<a name="ln-1023"></a><span class="c">!!          subroutine voutput(path)</span>
<a name="ln-1024"></a><span class="c">!!          character*(*) path</span>
<a name="ln-1025"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1026"></a><span class="c">!!</span>
<a name="ln-1027"></a><span class="c">!!       Redirect output from *next* vinit() to file given by path. This routine</span>
<a name="ln-1028"></a><span class="c">!!       only applies to device drivers that write to stdout e.g. PostScript and</span>
<a name="ln-1029"></a><span class="c">!!       hpgl.</span>
<a name="ln-1030"></a><span class="c">!!</span>
<a name="ln-1031"></a><span class="c">!!       The special file names are</span>
<a name="ln-1032"></a><span class="c">!!</span>
<a name="ln-1033"></a><span class="c">!!         * -  is standard output</span>
<a name="ln-1034"></a><span class="c">!!         * +  is standard error</span>
<a name="ln-1035"></a><span class="c">!!         * |  command will create a pipe to &quot;command&quot;</span>
<a name="ln-1036"></a><span class="c">!!</span>
<a name="ln-1037"></a><span class="c">!!       If the open of the file fails, an attempt is made to append to file</span>
<a name="ln-1038"></a><span class="c">!!       &quot;M_DRAW_OUTPUT&quot;. If this fails, standard output is used.</span>
<a name="ln-1039"></a><span class="c">!!</span>
<a name="ln-1040"></a><span class="c">!!       When vinit() is called if voutput() has not been called then the</span>
<a name="ln-1041"></a><span class="c">!!       environment variable M_DRAW_OUTPUT is checked and if it is defined and not a</span>
<a name="ln-1042"></a><span class="c">!!       null string then voutput() is called with the M_DRAW_OUTPUT variable&#39;s value.</span>
<a name="ln-1043"></a><span class="c">!!</span>
<a name="ln-1044"></a><span class="c">!!       A common use of the |command option is to automatically call programs</span>
<a name="ln-1045"></a><span class="c">!!       that convert PPM files to other common pixmap formats or converts the GNU</span>
<a name="ln-1046"></a><span class="c">!!       metafile to other formats (typically via the GNU plotutils plot program).</span>
<a name="ln-1047"></a><span class="c">!!</span>
<a name="ln-1048"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1049"></a><span class="c">!!</span>
<a name="ln-1050"></a><span class="c">!!   Sample program:</span>
<a name="ln-1051"></a><span class="c">!!</span>
<a name="ln-1052"></a><span class="c">!!    program demo_voutput</span>
<a name="ln-1053"></a><span class="c">!!    use M_draw</span>
<a name="ln-1054"></a><span class="c">!!    implicit none</span>
<a name="ln-1055"></a><span class="c">!!    ! want a 400x400 raster output</span>
<a name="ln-1056"></a><span class="c">!!    call prefsize(400,400)</span>
<a name="ln-1057"></a><span class="c">!!    ! convert PPM to a GIF file using ppmtogif(1)</span>
<a name="ln-1058"></a><span class="c">!!    call voutput(&#39;|ppmtogif &gt;voutput.3m_draw.gif&#39;)</span>
<a name="ln-1059"></a><span class="c">!!    ! start graphics using PPM device</span>
<a name="ln-1060"></a><span class="c">!!    call vinit(&#39;p6&#39;)</span>
<a name="ln-1061"></a><span class="c">!!    ! draw a filled circle</span>
<a name="ln-1062"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-1063"></a><span class="c">!!    call polyfill(.true.)</span>
<a name="ln-1064"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-1065"></a><span class="c">!!    !</span>
<a name="ln-1066"></a><span class="c">!!    call vexit()</span>
<a name="ln-1067"></a><span class="c">!!    end program demo_voutput</span>
<a name="ln-1068"></a><span class="c">!&gt;</span>
<a name="ln-1069"></a><span class="c">!!##NAME</span>
<a name="ln-1070"></a><span class="c">!!    vnewdev(3f) - [M_draw:DEVICE] Reinitialize to use new device without changing</span>
<a name="ln-1071"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1072"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1073"></a><span class="c">!!</span>
<a name="ln-1074"></a><span class="c">!!          subroutine vnewdev(device)</span>
<a name="ln-1075"></a><span class="c">!!          character *(*) device</span>
<a name="ln-1076"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1077"></a><span class="c">!!</span>
<a name="ln-1078"></a><span class="c">!!    Reinitialize M_draw to use a new device without changing attributes,</span>
<a name="ln-1079"></a><span class="c">!!    viewport etc. (eg. window and viewport specifications)</span>
<a name="ln-1080"></a><span class="c">!&gt;</span>
<a name="ln-1081"></a><span class="c">!!##NAME</span>
<a name="ln-1082"></a><span class="c">!!    vgetdev(3f) - [M_draw:DEVICE] Get name of current device</span>
<a name="ln-1083"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1084"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1085"></a><span class="c">!!</span>
<a name="ln-1086"></a><span class="c">!!          subroutine vgetdev(device)</span>
<a name="ln-1087"></a><span class="c">!!          character *(*) device</span>
<a name="ln-1088"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1089"></a><span class="c">!!</span>
<a name="ln-1090"></a><span class="c">!!    Gets the name of the current M_draw device. The C version of the routine</span>
<a name="ln-1091"></a><span class="c">!!    also returns a pointer to its argument.</span>
<a name="ln-1092"></a><span class="c">!&gt;</span>
<a name="ln-1093"></a><span class="c">!!##NAME</span>
<a name="ln-1094"></a><span class="c">!!    getdepth(3f) - [M_draw:DEVICE] Return number of bit planes (color planes)</span>
<a name="ln-1095"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1096"></a><span class="c">!!</span>
<a name="ln-1097"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1098"></a><span class="c">!!</span>
<a name="ln-1099"></a><span class="c">!!          integer function getdepth()</span>
<a name="ln-1100"></a><span class="c">!!</span>
<a name="ln-1101"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1102"></a><span class="c">!!    Returns the number of bit planes (or color planes) for a particular</span>
<a name="ln-1103"></a><span class="c">!!    device. The number of colors displayable by the device is then</span>
<a name="ln-1104"></a><span class="c">!!    2**(nplanes); ie. if nplanes=1,then there are two colors (black and</span>
<a name="ln-1105"></a><span class="c">!!    white).</span>
<a name="ln-1106"></a><span class="c">!&gt;</span>
<a name="ln-1107"></a><span class="c">!!##NAME</span>
<a name="ln-1108"></a><span class="c">!!    pushdev(3f) - [M_draw:DEVICE] push current device onto a stack</span>
<a name="ln-1109"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1110"></a><span class="c">!!</span>
<a name="ln-1111"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1112"></a><span class="c">!!</span>
<a name="ln-1113"></a><span class="c">!!          subroutine pushdev(device)</span>
<a name="ln-1114"></a><span class="c">!!          character *(*) device</span>
<a name="ln-1115"></a><span class="c">!!</span>
<a name="ln-1116"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1117"></a><span class="c">!!    Initialize a new device without changing attributes, viewport etc,</span>
<a name="ln-1118"></a><span class="c">!!    but save the previously initialised device on a stack.</span>
<a name="ln-1119"></a><span class="c">!!</span>
<a name="ln-1120"></a><span class="c">!!    Note, this is intended to completely change the device, it will not work</span>
<a name="ln-1121"></a><span class="c">!!    if you pushdev() the same device that you are already running. (This will</span>
<a name="ln-1122"></a><span class="c">!!    be fixed at a later date).</span>
<a name="ln-1123"></a><span class="c">!&gt;</span>
<a name="ln-1124"></a><span class="c">!!##NAME</span>
<a name="ln-1125"></a><span class="c">!!    popdev(3f) - [M_draw:DEVICE] pop device from stack created by pushdev.</span>
<a name="ln-1126"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1127"></a><span class="c">!!</span>
<a name="ln-1128"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1129"></a><span class="c">!!</span>
<a name="ln-1130"></a><span class="c">!!           subroutine popdev()</span>
<a name="ln-1131"></a><span class="c">!!</span>
<a name="ln-1132"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1133"></a><span class="c">!!</span>
<a name="ln-1134"></a><span class="c">!!    Pops a device off the device stack and reinstates the previously pushed</span>
<a name="ln-1135"></a><span class="c">!!    device.</span>
<a name="ln-1136"></a><span class="c">!&gt;</span>
<a name="ln-1137"></a><span class="c">!!##NAME</span>
<a name="ln-1138"></a><span class="c">!!    move(3f) - [M_draw:MOVE] Move current graphics position to (x, y, z)</span>
<a name="ln-1139"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1140"></a><span class="c">!!</span>
<a name="ln-1141"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1142"></a><span class="c">!!</span>
<a name="ln-1143"></a><span class="c">!!          subroutine move(x, y, z)</span>
<a name="ln-1144"></a><span class="c">!!          real x, y, z</span>
<a name="ln-1145"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1146"></a><span class="c">!!</span>
<a name="ln-1147"></a><span class="c">!!    Move current graphics position to (x, y, z). (x, y, z) is a point in</span>
<a name="ln-1148"></a><span class="c">!!    world coordinates.</span>
<a name="ln-1149"></a><span class="c">!&gt;</span>
<a name="ln-1150"></a><span class="c">!!##NAME</span>
<a name="ln-1151"></a><span class="c">!!    rmove(3f) - [M_draw:MOVE] Relative move</span>
<a name="ln-1152"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1153"></a><span class="c">!!</span>
<a name="ln-1154"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1155"></a><span class="c">!!</span>
<a name="ln-1156"></a><span class="c">!!          subroutine rmove(deltax, deltay, deltaz)</span>
<a name="ln-1157"></a><span class="c">!!          real deltax, deltay, deltaz</span>
<a name="ln-1158"></a><span class="c">!!</span>
<a name="ln-1159"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1160"></a><span class="c">!!</span>
<a name="ln-1161"></a><span class="c">!!    Relative move. deltax, deltay, and deltaz are offsets in world units.</span>
<a name="ln-1162"></a><span class="c">!&gt;</span>
<a name="ln-1163"></a><span class="c">!!##NAME</span>
<a name="ln-1164"></a><span class="c">!!    move2(3f) - [M_draw:MOVE] Move graphics position to point (x, y)</span>
<a name="ln-1165"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1166"></a><span class="c">!!</span>
<a name="ln-1167"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1168"></a><span class="c">!!</span>
<a name="ln-1169"></a><span class="c">!!          subroutine move2(x, y)</span>
<a name="ln-1170"></a><span class="c">!!          real,intent(in) :: x, y</span>
<a name="ln-1171"></a><span class="c">!!</span>
<a name="ln-1172"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1173"></a><span class="c">!!</span>
<a name="ln-1174"></a><span class="c">!!    Update current position.</span>
<a name="ln-1175"></a><span class="c">!!    Move graphics position to point (x, y). (x, y) is a point in world</span>
<a name="ln-1176"></a><span class="c">!!    coordinates.</span>
<a name="ln-1177"></a><span class="c">!!</span>
<a name="ln-1178"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1179"></a><span class="c">!!    X  new X position</span>
<a name="ln-1180"></a><span class="c">!!    Y  new Y position</span>
<a name="ln-1181"></a><span class="c">!!</span>
<a name="ln-1182"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1183"></a><span class="c">!!</span>
<a name="ln-1184"></a><span class="c">!!   Sample program:</span>
<a name="ln-1185"></a><span class="c">!!</span>
<a name="ln-1186"></a><span class="c">!!      program demo_move2</span>
<a name="ln-1187"></a><span class="c">!!      use M_draw, only : prefsize, vinit, ortho2, clear, getkey</span>
<a name="ln-1188"></a><span class="c">!!      use M_draw, only : move2, draw2, vexit, color</span>
<a name="ln-1189"></a><span class="c">!!      use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1190"></a><span class="c">!!      use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1191"></a><span class="c">!!      use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1192"></a><span class="c">!!      implicit none</span>
<a name="ln-1193"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-1194"></a><span class="c">!!      call prefsize(60,40)</span>
<a name="ln-1195"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1196"></a><span class="c">!!      call ortho2(-300.0,300.0,-200.0,200.0)</span>
<a name="ln-1197"></a><span class="c">!!      call color(D_BLACK)</span>
<a name="ln-1198"></a><span class="c">!!      call clear()</span>
<a name="ln-1199"></a><span class="c">!!      call color(D_WHITE)</span>
<a name="ln-1200"></a><span class="c">!!      call move2(-300.0,-200.0)</span>
<a name="ln-1201"></a><span class="c">!!      call draw2(300.0,200.0)</span>
<a name="ln-1202"></a><span class="c">!!      call move2(300.0,-200.0)</span>
<a name="ln-1203"></a><span class="c">!!      call draw2(-300.0,200.0)</span>
<a name="ln-1204"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-1205"></a><span class="c">!!      call vexit()</span>
<a name="ln-1206"></a><span class="c">!!      end program demo_move2</span>
<a name="ln-1207"></a><span class="c">!&gt;</span>
<a name="ln-1208"></a><span class="c">!!##NAME</span>
<a name="ln-1209"></a><span class="c">!!    rmove2(3f) - [M_draw:MOVE] Relative move in world units.</span>
<a name="ln-1210"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1211"></a><span class="c">!!</span>
<a name="ln-1212"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1213"></a><span class="c">!!</span>
<a name="ln-1214"></a><span class="c">!!     subroutine rmove2(deltax, deltay)</span>
<a name="ln-1215"></a><span class="c">!!     real,intent(in) :: deltax, deltay</span>
<a name="ln-1216"></a><span class="c">!!</span>
<a name="ln-1217"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1218"></a><span class="c">!!    Update current position.</span>
<a name="ln-1219"></a><span class="c">!!    Relative move2. deltax and deltay are offsets in world units.</span>
<a name="ln-1220"></a><span class="c">!!</span>
<a name="ln-1221"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1222"></a><span class="c">!!    X  new X position</span>
<a name="ln-1223"></a><span class="c">!!    Y  new Y position</span>
<a name="ln-1224"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1225"></a><span class="c">!!</span>
<a name="ln-1226"></a><span class="c">!!   Sample program:</span>
<a name="ln-1227"></a><span class="c">!!</span>
<a name="ln-1228"></a><span class="c">!!      program demo_rmove2</span>
<a name="ln-1229"></a><span class="c">!!      use M_draw, only: prefsize, vinit, ortho2, clear, getkey</span>
<a name="ln-1230"></a><span class="c">!!      use M_draw, only: move2, rmove2, rdraw2, vexit</span>
<a name="ln-1231"></a><span class="c">!!      use M_draw, only: linewidth</span>
<a name="ln-1232"></a><span class="c">!!      implicit none</span>
<a name="ln-1233"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-1234"></a><span class="c">!!      integer :: i</span>
<a name="ln-1235"></a><span class="c">!!      call prefsize(500,500)</span>
<a name="ln-1236"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1237"></a><span class="c">!!      call ortho2(-110.0,110.0,-110.0,110.0)</span>
<a name="ln-1238"></a><span class="c">!!      call move2(-100.0,-100.0)</span>
<a name="ln-1239"></a><span class="c">!!      call linewidth(70)</span>
<a name="ln-1240"></a><span class="c">!!      do i=1,20</span>
<a name="ln-1241"></a><span class="c">!!         call rmove2(10.0, 0.0)</span>
<a name="ln-1242"></a><span class="c">!!         call rdraw2( 0.0,10.0)</span>
<a name="ln-1243"></a><span class="c">!!      enddo</span>
<a name="ln-1244"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-1245"></a><span class="c">!!      call vexit()</span>
<a name="ln-1246"></a><span class="c">!!      end program demo_rmove2</span>
<a name="ln-1247"></a><span class="c">!&gt;</span>
<a name="ln-1248"></a><span class="c">!!##NAME</span>
<a name="ln-1249"></a><span class="c">!!    smove2(3f) - [M_draw:MOVE] Move current graphics position in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-1250"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1251"></a><span class="c">!!</span>
<a name="ln-1252"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1253"></a><span class="c">!!</span>
<a name="ln-1254"></a><span class="c">!!          subroutine smove2(x, y)</span>
<a name="ln-1255"></a><span class="c">!!          real x, y</span>
<a name="ln-1256"></a><span class="c">!!</span>
<a name="ln-1257"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1258"></a><span class="c">!!    Move current graphics position in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-1259"></a><span class="c">!&gt;</span>
<a name="ln-1260"></a><span class="c">!!##NAME</span>
<a name="ln-1261"></a><span class="c">!!    rsmove2(3f) - [M_draw:MOVE] Relative move in screen units (-1.0 to 1.0).</span>
<a name="ln-1262"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1263"></a><span class="c">!!</span>
<a name="ln-1264"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1265"></a><span class="c">!!</span>
<a name="ln-1266"></a><span class="c">!!          subroutine rsmove2(deltax, deltay)</span>
<a name="ln-1267"></a><span class="c">!!          real deltax, deltay</span>
<a name="ln-1268"></a><span class="c">!!</span>
<a name="ln-1269"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1270"></a><span class="c">!!</span>
<a name="ln-1271"></a><span class="c">!!    Relative smove2. deltax, and deltay are offsets in screen units</span>
<a name="ln-1272"></a><span class="c">!!    (-1.0 to 1.0).</span>
<a name="ln-1273"></a><span class="c">!&gt;</span>
<a name="ln-1274"></a><span class="c">!!##NAME</span>
<a name="ln-1275"></a><span class="c">!!    draw(3f) - [M_draw:DRAW] Draw from current graphics position to (x, y, z)</span>
<a name="ln-1276"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1277"></a><span class="c">!!</span>
<a name="ln-1278"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1279"></a><span class="c">!!</span>
<a name="ln-1280"></a><span class="c">!!          subroutine draw(x, y, z)</span>
<a name="ln-1281"></a><span class="c">!!          real x, y, z</span>
<a name="ln-1282"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1283"></a><span class="c">!!</span>
<a name="ln-1284"></a><span class="c">!!    Draw from current graphics position to (x, y, z). (x, y, z) is a</span>
<a name="ln-1285"></a><span class="c">!!    point in world coordinates.</span>
<a name="ln-1286"></a><span class="c">!&gt;</span>
<a name="ln-1287"></a><span class="c">!!##NAME</span>
<a name="ln-1288"></a><span class="c">!!    rdraw(3f) - [M_draw:DRAW] Relative draw</span>
<a name="ln-1289"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1290"></a><span class="c">!!</span>
<a name="ln-1291"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1292"></a><span class="c">!!</span>
<a name="ln-1293"></a><span class="c">!!     subroutine rdraw(deltax, deltay, deltaz)</span>
<a name="ln-1294"></a><span class="c">!!     real deltax, deltay, deltaz</span>
<a name="ln-1295"></a><span class="c">!!</span>
<a name="ln-1296"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1297"></a><span class="c">!!    Relative draw. deltax, deltay, and deltaz are offsets in world units.</span>
<a name="ln-1298"></a><span class="c">!&gt;</span>
<a name="ln-1299"></a><span class="c">!!##NAME</span>
<a name="ln-1300"></a><span class="c">!!    draw2(3f) - [M_draw:DRAW] Draw from current graphics position to given point (x, y)</span>
<a name="ln-1301"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1302"></a><span class="c">!!</span>
<a name="ln-1303"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1304"></a><span class="c">!!</span>
<a name="ln-1305"></a><span class="c">!!     subroutine draw2(x, y)</span>
<a name="ln-1306"></a><span class="c">!!     real,intent(in) :: x, y</span>
<a name="ln-1307"></a><span class="c">!!</span>
<a name="ln-1308"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1309"></a><span class="c">!!    Draw from current position to specified point using current</span>
<a name="ln-1310"></a><span class="c">!!    color and line width. Updates current position to new point.</span>
<a name="ln-1311"></a><span class="c">!!    (x, y) is a point in world coordinates.</span>
<a name="ln-1312"></a><span class="c">!!</span>
<a name="ln-1313"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1314"></a><span class="c">!!    X  new X position</span>
<a name="ln-1315"></a><span class="c">!!    Y  new Y position</span>
<a name="ln-1316"></a><span class="c">!!</span>
<a name="ln-1317"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1318"></a><span class="c">!!</span>
<a name="ln-1319"></a><span class="c">!!   Sample program:</span>
<a name="ln-1320"></a><span class="c">!!</span>
<a name="ln-1321"></a><span class="c">!!    program demo_draw2</span>
<a name="ln-1322"></a><span class="c">!!    use M_draw,    only : prefsize, vinit, ortho2, clear, getkey</span>
<a name="ln-1323"></a><span class="c">!!    use M_draw,    only : move2, draw2, vexit, color,linewidth</span>
<a name="ln-1324"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1325"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1326"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1327"></a><span class="c">!!    use M_units,   only : d2r, polar_to_cartesian</span>
<a name="ln-1328"></a><span class="c">!!    !</span>
<a name="ln-1329"></a><span class="c">!!    ! The Archimedean spiral is the locus of points corresponding</span>
<a name="ln-1330"></a><span class="c">!!    ! to the locations over time of a point moving away from a</span>
<a name="ln-1331"></a><span class="c">!!    ! fixed point with a constant speed along a line which rotates</span>
<a name="ln-1332"></a><span class="c">!!    ! with constant angular velocity.</span>
<a name="ln-1333"></a><span class="c">!!    !    r=A+B*theta</span>
<a name="ln-1334"></a><span class="c">!!    ! Changing the parameter A will turn the spiral,</span>
<a name="ln-1335"></a><span class="c">!!    ! while B controls the distance between successive turnings.</span>
<a name="ln-1336"></a><span class="c">!!    !</span>
<a name="ln-1337"></a><span class="c">!!       implicit none</span>
<a name="ln-1338"></a><span class="c">!!       integer        :: i</span>
<a name="ln-1339"></a><span class="c">!!       real           :: x,y,radius,theta</span>
<a name="ln-1340"></a><span class="c">!!       real,parameter :: rotate=0.0, gap=2.0</span>
<a name="ln-1341"></a><span class="c">!!       integer        :: ipaws</span>
<a name="ln-1342"></a><span class="c">!!</span>
<a name="ln-1343"></a><span class="c">!!       call prefsize(400,400)</span>
<a name="ln-1344"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1345"></a><span class="c">!!       call ortho2(-150.0,150.0,-150.0,150.0)</span>
<a name="ln-1346"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-1347"></a><span class="c">!!       call clear()</span>
<a name="ln-1348"></a><span class="c">!!       call move2(0.0,0.0)</span>
<a name="ln-1349"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-1350"></a><span class="c">!!       call linewidth(40)</span>
<a name="ln-1351"></a><span class="c">!!       do i=0,360*10,5</span>
<a name="ln-1352"></a><span class="c">!!          theta=d2r(i)</span>
<a name="ln-1353"></a><span class="c">!!          ! equation in polar coordinates</span>
<a name="ln-1354"></a><span class="c">!!          radius=rotate+gap*theta</span>
<a name="ln-1355"></a><span class="c">!!          ! convert polar coordinates to cartesian</span>
<a name="ln-1356"></a><span class="c">!!          call polar_to_cartesian(radius,theta,x,y)</span>
<a name="ln-1357"></a><span class="c">!!          ! draw from current position to end of next segment</span>
<a name="ln-1358"></a><span class="c">!!          call draw2(x,y)</span>
<a name="ln-1359"></a><span class="c">!!       enddo</span>
<a name="ln-1360"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-1361"></a><span class="c">!!       ! exit graphics mode</span>
<a name="ln-1362"></a><span class="c">!!       call vexit()</span>
<a name="ln-1363"></a><span class="c">!!    end program demo_draw2</span>
<a name="ln-1364"></a><span class="c">!&gt;</span>
<a name="ln-1365"></a><span class="c">!!##NAME</span>
<a name="ln-1366"></a><span class="c">!!    rdraw2(3f) - [M_draw:DRAW] Relative draw from current position to given point</span>
<a name="ln-1367"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1368"></a><span class="c">!!</span>
<a name="ln-1369"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1370"></a><span class="c">!!</span>
<a name="ln-1371"></a><span class="c">!!          subroutine rdraw2(deltax, deltay)</span>
<a name="ln-1372"></a><span class="c">!!          real,intent(in) :: deltax, deltay</span>
<a name="ln-1373"></a><span class="c">!!</span>
<a name="ln-1374"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1375"></a><span class="c">!!    Relative draw from current position to specified point using current</span>
<a name="ln-1376"></a><span class="c">!!    color and line width. Updates current position to new point.</span>
<a name="ln-1377"></a><span class="c">!!    (x, y) is a point in world coordinates.</span>
<a name="ln-1378"></a><span class="c">!!</span>
<a name="ln-1379"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1380"></a><span class="c">!!    deltax and deltay are offsets in world units.</span>
<a name="ln-1381"></a><span class="c">!!</span>
<a name="ln-1382"></a><span class="c">!!    X  new X position</span>
<a name="ln-1383"></a><span class="c">!!    Y  new Y position</span>
<a name="ln-1384"></a><span class="c">!!</span>
<a name="ln-1385"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1386"></a><span class="c">!!</span>
<a name="ln-1387"></a><span class="c">!!   Sample program:</span>
<a name="ln-1388"></a><span class="c">!!</span>
<a name="ln-1389"></a><span class="c">!!      program demo_rdraw2</span>
<a name="ln-1390"></a><span class="c">!!      use M_draw, only: vinit, prefsize, ortho2,linewidth,getkey</span>
<a name="ln-1391"></a><span class="c">!!      use M_draw, only: clear, move2, rdraw2, vexit,color</span>
<a name="ln-1392"></a><span class="c">!!      use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1393"></a><span class="c">!!      use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1394"></a><span class="c">!!      use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1395"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-1396"></a><span class="c">!!</span>
<a name="ln-1397"></a><span class="c">!!      call prefsize(200,200)</span>
<a name="ln-1398"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1399"></a><span class="c">!!      call ortho2(-55.0, 55.0, -55.0, 55.0)</span>
<a name="ln-1400"></a><span class="c">!!      call linewidth(400)</span>
<a name="ln-1401"></a><span class="c">!!      call color(D_WHITE)</span>
<a name="ln-1402"></a><span class="c">!!      call clear()</span>
<a name="ln-1403"></a><span class="c">!!</span>
<a name="ln-1404"></a><span class="c">!!      call color(D_RED)</span>
<a name="ln-1405"></a><span class="c">!!      call move2(-50.0,0.0)</span>
<a name="ln-1406"></a><span class="c">!!      call square(50.0)</span>
<a name="ln-1407"></a><span class="c">!!</span>
<a name="ln-1408"></a><span class="c">!!      call linewidth(200)</span>
<a name="ln-1409"></a><span class="c">!!      call color(D_GREEN)</span>
<a name="ln-1410"></a><span class="c">!!      call move2(  0.0,-50.0)</span>
<a name="ln-1411"></a><span class="c">!!      call square(50.0)</span>
<a name="ln-1412"></a><span class="c">!!</span>
<a name="ln-1413"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-1414"></a><span class="c">!!      call vexit()</span>
<a name="ln-1415"></a><span class="c">!!</span>
<a name="ln-1416"></a><span class="c">!!      contains</span>
<a name="ln-1417"></a><span class="c">!!</span>
<a name="ln-1418"></a><span class="c">!!      subroutine square(side)</span>
<a name="ln-1419"></a><span class="c">!!      call rdraw2( side,   0.0)</span>
<a name="ln-1420"></a><span class="c">!!      call rdraw2(  0.0,  side)</span>
<a name="ln-1421"></a><span class="c">!!      call rdraw2(-side,   0.0)</span>
<a name="ln-1422"></a><span class="c">!!      call rdraw2(  0.0, -side)</span>
<a name="ln-1423"></a><span class="c">!!      end subroutine square</span>
<a name="ln-1424"></a><span class="c">!!</span>
<a name="ln-1425"></a><span class="c">!!      end program demo_rdraw2</span>
<a name="ln-1426"></a><span class="c">!&gt;</span>
<a name="ln-1427"></a><span class="c">!!##NAME</span>
<a name="ln-1428"></a><span class="c">!!    sdraw2(3f) - [M_draw:DRAW] Draw in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-1429"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1430"></a><span class="c">!!</span>
<a name="ln-1431"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1432"></a><span class="c">!!</span>
<a name="ln-1433"></a><span class="c">!!          subroutine sdraw2(x, y)</span>
<a name="ln-1434"></a><span class="c">!!          real x, y</span>
<a name="ln-1435"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1436"></a><span class="c">!!    Draw in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-1437"></a><span class="c">!&gt;</span>
<a name="ln-1438"></a><span class="c">!!##NAME</span>
<a name="ln-1439"></a><span class="c">!!    rsdraw2(3f) - [M_draw:DRAW] Relative draw in screen units (-1.0 to 1.0).</span>
<a name="ln-1440"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1441"></a><span class="c">!!</span>
<a name="ln-1442"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1443"></a><span class="c">!!</span>
<a name="ln-1444"></a><span class="c">!!          subroutine rsdraw2(deltax, deltay)</span>
<a name="ln-1445"></a><span class="c">!!          real deltax, deltay</span>
<a name="ln-1446"></a><span class="c">!!</span>
<a name="ln-1447"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1448"></a><span class="c">!!    Relative sdraw2. delatx and deltay are in screen units (-1.0 to 1.0).</span>
<a name="ln-1449"></a><span class="c">!&gt;</span>
<a name="ln-1450"></a><span class="c">!!##NAME</span>
<a name="ln-1451"></a><span class="c">!!    rect(3f) - [M_draw:POLYGONS] Draw a rectangle given two corners</span>
<a name="ln-1452"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1453"></a><span class="c">!!</span>
<a name="ln-1454"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1455"></a><span class="c">!!</span>
<a name="ln-1456"></a><span class="c">!!       subroutine rect(x1, y1, x2, y2)</span>
<a name="ln-1457"></a><span class="c">!!       real,intent(in) :: x1,y1,x2,y2</span>
<a name="ln-1458"></a><span class="c">!!</span>
<a name="ln-1459"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1460"></a><span class="c">!!    Draw rectangle given two opposite corners.</span>
<a name="ln-1461"></a><span class="c">!!</span>
<a name="ln-1462"></a><span class="c">!!    Note: rectangles are regarded as polygons, so if</span>
<a name="ln-1463"></a><span class="c">!!    polyfill or polyhatch has been called with .TRUE., the rectangle will</span>
<a name="ln-1464"></a><span class="c">!!    be filled or hatched accordingly.</span>
<a name="ln-1465"></a><span class="c">!!</span>
<a name="ln-1466"></a><span class="c">!!##OPTIONS</span>
<a name="ln-1467"></a><span class="c">!!   Given</span>
<a name="ln-1468"></a><span class="c">!!</span>
<a name="ln-1469"></a><span class="c">!!       x1,y1 ############ x2,y1</span>
<a name="ln-1470"></a><span class="c">!!             #          #</span>
<a name="ln-1471"></a><span class="c">!!             #          #</span>
<a name="ln-1472"></a><span class="c">!!             #          #</span>
<a name="ln-1473"></a><span class="c">!!       x1,y2 ############ x2,y2</span>
<a name="ln-1474"></a><span class="c">!!</span>
<a name="ln-1475"></a><span class="c">!!    X1,Y1  coordinates of a corner of the rectangle</span>
<a name="ln-1476"></a><span class="c">!!    X2,Y2  coordinates of corner point opposite first point</span>
<a name="ln-1477"></a><span class="c">!!</span>
<a name="ln-1478"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1479"></a><span class="c">!!</span>
<a name="ln-1480"></a><span class="c">!!   Sample program:</span>
<a name="ln-1481"></a><span class="c">!!</span>
<a name="ln-1482"></a><span class="c">!!    program demo_rect</span>
<a name="ln-1483"></a><span class="c">!!    use M_draw</span>
<a name="ln-1484"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1485"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1486"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1487"></a><span class="c">!!    implicit none</span>
<a name="ln-1488"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-1489"></a><span class="c">!!    real    :: b=0.2</span>
<a name="ln-1490"></a><span class="c">!!</span>
<a name="ln-1491"></a><span class="c">!!    !! set up graphics area</span>
<a name="ln-1492"></a><span class="c">!!    call prefsize(1000,200)</span>
<a name="ln-1493"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1494"></a><span class="c">!!    call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-1495"></a><span class="c">!!</span>
<a name="ln-1496"></a><span class="c">!!    call linewidth(150)</span>
<a name="ln-1497"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-1498"></a><span class="c">!!    call rect(-24.0, -4.0, -12.0, 4.0)</span>
<a name="ln-1499"></a><span class="c">!!    call polyfill(.true.)</span>
<a name="ln-1500"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-1501"></a><span class="c">!!    call rect(-10.0, -4.0, -2.0, 4.0)</span>
<a name="ln-1502"></a><span class="c">!!    call polyhatch(.true.)</span>
<a name="ln-1503"></a><span class="c">!!    call hatchpitch(0.4)</span>
<a name="ln-1504"></a><span class="c">!!    call hatchang(30.0)</span>
<a name="ln-1505"></a><span class="c">!!    call linewidth(20)</span>
<a name="ln-1506"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-1507"></a><span class="c">!!    call rect(0.0, -4.0, 20.0, 3.0)</span>
<a name="ln-1508"></a><span class="c">!!    call linewidth(200)</span>
<a name="ln-1509"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-1510"></a><span class="c">!!    call move2(-25.0, -5.0)</span>
<a name="ln-1511"></a><span class="c">!!    call draw2(-25.0, 5.0)</span>
<a name="ln-1512"></a><span class="c">!!    call draw2(25.0, 5.0)</span>
<a name="ln-1513"></a><span class="c">!!    call draw2(25.0, -5.0)</span>
<a name="ln-1514"></a><span class="c">!!    call draw2(-25.0, -5.0)</span>
<a name="ln-1515"></a><span class="c">!!</span>
<a name="ln-1516"></a><span class="c">!!    !! pause</span>
<a name="ln-1517"></a><span class="c">!!    call vflush()</span>
<a name="ln-1518"></a><span class="c">!!    ipaws=getkey()</span>
<a name="ln-1519"></a><span class="c">!!</span>
<a name="ln-1520"></a><span class="c">!!    !! wrap up graphics</span>
<a name="ln-1521"></a><span class="c">!!    call vexit()</span>
<a name="ln-1522"></a><span class="c">!!</span>
<a name="ln-1523"></a><span class="c">!!    end program demo_rect</span>
<a name="ln-1524"></a><span class="c">!&gt;</span>
<a name="ln-1525"></a><span class="c">!!##NAME</span>
<a name="ln-1526"></a><span class="c">!!      polyfill(3f) - [M_draw:POLYGONS] Set the polygon fill flag</span>
<a name="ln-1527"></a><span class="c">!!      (LICENSE:PD)</span>
<a name="ln-1528"></a><span class="c">!!</span>
<a name="ln-1529"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1530"></a><span class="c">!!</span>
<a name="ln-1531"></a><span class="c">!!       subroutine polyfill(onoff)</span>
<a name="ln-1532"></a><span class="c">!!       logical onoff</span>
<a name="ln-1533"></a><span class="c">!!</span>
<a name="ln-1534"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1535"></a><span class="c">!!    Set the polygon fill flag. This will always turn off hatching. A</span>
<a name="ln-1536"></a><span class="c">!!    LOGICAL .true. turns polyfill on.</span>
<a name="ln-1537"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1538"></a><span class="c">!!</span>
<a name="ln-1539"></a><span class="c">!!   Sample program:</span>
<a name="ln-1540"></a><span class="c">!!</span>
<a name="ln-1541"></a><span class="c">!!    program demo_polyfill</span>
<a name="ln-1542"></a><span class="c">!!    ! Using polygons, hatching, and filling.</span>
<a name="ln-1543"></a><span class="c">!!       use M_draw, only : vinit, color, clear, ortho, boxtext, vexit</span>
<a name="ln-1544"></a><span class="c">!!       use M_draw, only : polyfill</span>
<a name="ln-1545"></a><span class="c">!!       use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1546"></a><span class="c">!!       use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1547"></a><span class="c">!!       use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1548"></a><span class="c">!!       integer           :: ios</span>
<a name="ln-1549"></a><span class="c">!!       character(len=50) :: device</span>
<a name="ln-1550"></a><span class="c">!!       print*,&#39;Enter output device:&#39;</span>
<a name="ln-1551"></a><span class="c">!!       read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-1552"></a><span class="c">!!       if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-1553"></a><span class="c">!!       call vinit(device)</span>
<a name="ln-1554"></a><span class="c">!!    ! clear to black</span>
<a name="ln-1555"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-1556"></a><span class="c">!!       call clear()</span>
<a name="ln-1557"></a><span class="c">!!    ! world coordinates are now in the range -10 to 10</span>
<a name="ln-1558"></a><span class="c">!!    ! in x, y, and z. Note that positive z is towards us.</span>
<a name="ln-1559"></a><span class="c">!!       call ortho(-10.0, 10.0, -10.0, 10.0, 10.0, -10.0)</span>
<a name="ln-1560"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-1561"></a><span class="c">!!    ! write out the string &quot;Polygon from poly()&quot; in the</span>
<a name="ln-1562"></a><span class="c">!!    ! starting at (-8.0, -4.0) and scaled to be 4.0 units long,</span>
<a name="ln-1563"></a><span class="c">!!    ! 0.5 units high.</span>
<a name="ln-1564"></a><span class="c">!!       call boxtext(-8.0, -4.0, 4.0, 0.5, &#39;Polygon from poly()&#39;)</span>
<a name="ln-1565"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-1566"></a><span class="c">!!    ! write out a scaled string starting at (0.0, 6.0)</span>
<a name="ln-1567"></a><span class="c">!!       call boxtext(0.0, 6.0, 4.0, 0.5, &#39;Polygon from move()/ draw()&#39;)</span>
<a name="ln-1568"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-1569"></a><span class="c">!!    ! write out a scaled string starting at (0.0, 6.0)</span>
<a name="ln-1570"></a><span class="c">!!       call boxtext(3.5, -3.5, 1.9, 0.5, &#39;Sector&#39;)</span>
<a name="ln-1571"></a><span class="c">!!    ! turn on polygon filling - this automatically turns off hatching</span>
<a name="ln-1572"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-1573"></a><span class="c">!!    ! draw some polygons with filling</span>
<a name="ln-1574"></a><span class="c">!!       call my_drawpoly()</span>
<a name="ln-1575"></a><span class="c">!!       call vexit()</span>
<a name="ln-1576"></a><span class="c">!!    contains</span>
<a name="ln-1577"></a><span class="c">!!    subroutine my_drawpoly()</span>
<a name="ln-1578"></a><span class="c">!!       use M_draw, only : color, move, draw, closepoly, sector, getkey</span>
<a name="ln-1579"></a><span class="c">!!       use M_draw, only : poly, closepoly, sector, makepoly</span>
<a name="ln-1580"></a><span class="c">!!       use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1581"></a><span class="c">!!       use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1582"></a><span class="c">!!       use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1583"></a><span class="c">!!</span>
<a name="ln-1584"></a><span class="c">!!       real parray(3,4)                   ! An array of points for a polygon</span>
<a name="ln-1585"></a><span class="c">!!       data parray/ -8.0, -8.0, 0.0,  &amp;</span>
<a name="ln-1586"></a><span class="c">!!       &amp; -5.0, -8.0, 0.0,  &amp;</span>
<a name="ln-1587"></a><span class="c">!!       &amp; -5.0, -5.0, 0.0,  &amp;</span>
<a name="ln-1588"></a><span class="c">!!       &amp; -8.0, -5.0, 0.0 /</span>
<a name="ln-1589"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-1590"></a><span class="c">!!    ! Draw a polygon using poly, parray is our array of</span>
<a name="ln-1591"></a><span class="c">!!    ! points and 4 is the number of points in it.</span>
<a name="ln-1592"></a><span class="c">!!       call poly(4, parray)</span>
<a name="ln-1593"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-1594"></a><span class="c">!!    ! Draw a 5 sided figure by using move, draw and closepoly.</span>
<a name="ln-1595"></a><span class="c">!!       call makepoly()</span>
<a name="ln-1596"></a><span class="c">!!       call move(0.0, 0.0, 0.0)</span>
<a name="ln-1597"></a><span class="c">!!       call draw(3.0, 0.0, 0.0)</span>
<a name="ln-1598"></a><span class="c">!!       call draw(3.0, 4.0, 0.0)</span>
<a name="ln-1599"></a><span class="c">!!       call draw(-1.0, 5.0, 0.0)</span>
<a name="ln-1600"></a><span class="c">!!       call draw(-2.0, 2.0, 0.0)</span>
<a name="ln-1601"></a><span class="c">!!       call closepoly()</span>
<a name="ln-1602"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-1603"></a><span class="c">!!    ! draw a sector representing a 1/4 circle</span>
<a name="ln-1604"></a><span class="c">!!       call sector(1.5, -7.0, 3.0, 0.0, 90.0)</span>
<a name="ln-1605"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-1606"></a><span class="c">!!    end subroutine my_drawpoly</span>
<a name="ln-1607"></a><span class="c">!!    end program demo_polyfill</span>
<a name="ln-1608"></a><span class="c">!&gt;</span>
<a name="ln-1609"></a><span class="c">!!##NAME</span>
<a name="ln-1610"></a><span class="c">!!    polyhatch(3f) - [M_draw:POLYGONS] Set the polygon hatch flag</span>
<a name="ln-1611"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1612"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1613"></a><span class="c">!!</span>
<a name="ln-1614"></a><span class="c">!!     subroutine polyhatch(onoff)</span>
<a name="ln-1615"></a><span class="c">!!     logical onoff</span>
<a name="ln-1616"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1617"></a><span class="c">!!</span>
<a name="ln-1618"></a><span class="c">!!    Set the polygon hatch flag. This will always turn off fill. A</span>
<a name="ln-1619"></a><span class="c">!!    LOGICAL .true. turns polyhatch on. Note that hatched polygons</span>
<a name="ln-1620"></a><span class="c">!!    must initially be defined parallel to the X-Y plane.</span>
<a name="ln-1621"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1622"></a><span class="c">!!</span>
<a name="ln-1623"></a><span class="c">!!   Sample program:</span>
<a name="ln-1624"></a><span class="c">!!</span>
<a name="ln-1625"></a><span class="c">!!    program demo_polyhatch</span>
<a name="ln-1626"></a><span class="c">!!    use M_draw</span>
<a name="ln-1627"></a><span class="c">!!    use M_drawplus, only : spirograph</span>
<a name="ln-1628"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-1629"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-1630"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-1631"></a><span class="c">!!    real :: N=11</span>
<a name="ln-1632"></a><span class="c">!!    call prefsize(600*10/6,200*10/6)</span>
<a name="ln-1633"></a><span class="c">!!    call vinit(&#39; &#39;)</span>
<a name="ln-1634"></a><span class="c">!!    call page( -15.0, 15.0, -5.0, 5.0)</span>
<a name="ln-1635"></a><span class="c">!!    call linewidth(100)</span>
<a name="ln-1636"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-1637"></a><span class="c">!!    call clear()</span>
<a name="ln-1638"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-1639"></a><span class="c">!!    call spirograph(-10.0, 0.0, N, 1.0, N, 5.0, 1000, 0.0, 0.0, 0)</span>
<a name="ln-1640"></a><span class="c">!!    call polyhatch(.true.) ! turn on polygon hatching</span>
<a name="ln-1641"></a><span class="c">!!    call hatchang(45.0)</span>
<a name="ln-1642"></a><span class="c">!!    call hatchpitch(0.3)</span>
<a name="ln-1643"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-1644"></a><span class="c">!!    call spirograph(10.0, 0.0, N, 1.0, N, 5.0, 1000, 0.0, 0.0, 2)</span>
<a name="ln-1645"></a><span class="c">!!    call vflush()</span>
<a name="ln-1646"></a><span class="c">!!    key=getkey()</span>
<a name="ln-1647"></a><span class="c">!!    call vexit()</span>
<a name="ln-1648"></a><span class="c">!!    end program demo_polyhatch</span>
<a name="ln-1649"></a>
<a name="ln-1650"></a><span class="c">!&gt;</span>
<a name="ln-1651"></a><span class="c">!!##NAME</span>
<a name="ln-1652"></a><span class="c">!!    hatchang(3f) - [M_draw:POLYGONS] Set the angle of the hatch lines.</span>
<a name="ln-1653"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1654"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1655"></a><span class="c">!!</span>
<a name="ln-1656"></a><span class="c">!!       subroutine hatchang(angle)</span>
<a name="ln-1657"></a><span class="c">!!       real,intent(in) :: angle</span>
<a name="ln-1658"></a><span class="c">!!</span>
<a name="ln-1659"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1660"></a><span class="c">!!</span>
<a name="ln-1661"></a><span class="c">!!    Set the angle of the hatch lines. The angle is in degrees. Zero degrees</span>
<a name="ln-1662"></a><span class="c">!!    is on the negative X axis. Positive values are counterclockwise. The</span>
<a name="ln-1663"></a><span class="c">!!    value is 0 at program initialization. The last value set is retained</span>
<a name="ln-1664"></a><span class="c">!!    even if hatching is not active or is turned on and off.</span>
<a name="ln-1665"></a><span class="c">!!</span>
<a name="ln-1666"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1667"></a><span class="c">!!</span>
<a name="ln-1668"></a><span class="c">!!   Sample program:</span>
<a name="ln-1669"></a><span class="c">!!</span>
<a name="ln-1670"></a><span class="c">!!    program demo_hatchang</span>
<a name="ln-1671"></a><span class="c">!!    use M_drawplus, only : draw_interpret</span>
<a name="ln-1672"></a><span class="c">!!    character(len=:),allocatable :: draw_cmds(:)</span>
<a name="ln-1673"></a><span class="c">!!</span>
<a name="ln-1674"></a><span class="c">!!    DRAW_CMDS=[ CHARACTER(LEN=128) :: &amp;</span>
<a name="ln-1675"></a><span class="c">!!    &#39;prefsize 1000 200; vinit                                     &#39;,&amp;</span>
<a name="ln-1676"></a><span class="c">!!    &#39;set b=.4; page -25-b 25+b -5-b 5+b; color 0;clear            &#39;,&amp;</span>
<a name="ln-1677"></a><span class="c">!!    &#39;textsize .6 .7;font futura.l;centertext .true.               &#39;,&amp;</span>
<a name="ln-1678"></a><span class="c">!!    &#39;leftjustify; linewidth 50; polyhatch .true.; hatchpitch 1/2  &#39;,&amp;</span>
<a name="ln-1679"></a><span class="c">!!    &#39;# draw circles with hatching                                 &#39;,&amp;</span>
<a name="ln-1680"></a><span class="c">!!    &#39;linewidth 90;hatchang  90.1; color  7;  circle X=-20  Y=0  5 &#39;,&amp;</span>
<a name="ln-1681"></a><span class="c">!!    &#39;move2  X-4.9 Y=-4.9;color 7;linewidth 60;drawstr  90 degrees &#39;,&amp;</span>
<a name="ln-1682"></a><span class="c">!!    &#39;linewidth 90;hatchang  45  ; color  2;  circle X=-10  Y=0  5 &#39;,&amp;</span>
<a name="ln-1683"></a><span class="c">!!    &#39;move2  X-4.9 Y=-4.9;color 7;linewidth 60;drawstr  45 degrees &#39;,&amp;</span>
<a name="ln-1684"></a><span class="c">!!    &#39;linewidth 90;hatchang   0  ; color  6;  circle X=-0   Y=0  5 &#39;,&amp;</span>
<a name="ln-1685"></a><span class="c">!!    &#39;move2  X-4.9 Y=-4.9;color 7;linewidth 60;drawstr   0 degrees &#39;,&amp;</span>
<a name="ln-1686"></a><span class="c">!!    &#39;linewidth 90;hatchang -45  ; color  5;  circle X=10   Y=0  5 &#39;,&amp;</span>
<a name="ln-1687"></a><span class="c">!!    &#39;move2  X-4.9 Y=-4.9;color 7;linewidth 60;drawstr -45 degrees &#39;,&amp;</span>
<a name="ln-1688"></a><span class="c">!!    &#39;linewidth 90;hatchang -90  ; color  4;  circle X=20   Y=0  5 &#39;,&amp;</span>
<a name="ln-1689"></a><span class="c">!!    &#39;move2  X-4.9 Y=-4.9;color 7;linewidth 60;drawstr -90 degrees &#39;,&amp;</span>
<a name="ln-1690"></a><span class="c">!!    &#39;linewidth 130                                                &#39;,&amp;</span>
<a name="ln-1691"></a><span class="c">!!    &#39;move2 0 0;draw2 -5 0                                         &#39;,&amp;</span>
<a name="ln-1692"></a><span class="c">!!    &#39;move2 -5 0;draw2 -4.4  0.3                                   &#39;,&amp;</span>
<a name="ln-1693"></a><span class="c">!!    &#39;move2 -5 0;draw2 -4.4 -0.3                                   &#39;,&amp;</span>
<a name="ln-1694"></a><span class="c">!!    &#39;rightjustify                                                 &#39;,&amp;</span>
<a name="ln-1695"></a><span class="c">!!    &#39;linewidth 60                                                 &#39;,&amp;</span>
<a name="ln-1696"></a><span class="c">!!    &#39;move2 -5 0;drawstr 0 degrees                                 &#39;,&amp;</span>
<a name="ln-1697"></a><span class="c">!!    &#39;getkey                                                       &#39;,&amp;</span>
<a name="ln-1698"></a><span class="c">!!    &#39;vexit                                                        &#39;,&amp;</span>
<a name="ln-1699"></a><span class="c">!!    &#39;&#39;]</span>
<a name="ln-1700"></a><span class="c">!!</span>
<a name="ln-1701"></a><span class="c">!!    call draw_interpret(DRAW_CMDS,delimiters=&#39;;&#39;)</span>
<a name="ln-1702"></a><span class="c">!!    end program demo_hatchang</span>
<a name="ln-1703"></a><span class="c">!&gt;</span>
<a name="ln-1704"></a><span class="c">!!##NAME</span>
<a name="ln-1705"></a><span class="c">!!    hatchpitch(3f) - [M_draw:POLYGONS] Set the distance between hatch lines.</span>
<a name="ln-1706"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1707"></a><span class="c">!!</span>
<a name="ln-1708"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1709"></a><span class="c">!!</span>
<a name="ln-1710"></a><span class="c">!!       subroutine hatchpitch(pitch)</span>
<a name="ln-1711"></a><span class="c">!!       real,intent(in) :: pitch</span>
<a name="ln-1712"></a><span class="c">!!</span>
<a name="ln-1713"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1714"></a><span class="c">!!    Set the distance between hatch lines. The distance is measured in</span>
<a name="ln-1715"></a><span class="c">!!    window units (as opposed to viewport or device units).</span>
<a name="ln-1716"></a><span class="c">!!</span>
<a name="ln-1717"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1718"></a><span class="c">!!</span>
<a name="ln-1719"></a><span class="c">!!   Sample program:</span>
<a name="ln-1720"></a><span class="c">!!</span>
<a name="ln-1721"></a><span class="c">!!    program demo_hatchpitch</span>
<a name="ln-1722"></a><span class="c">!!    use M_drawplus, only : draw_interpret</span>
<a name="ln-1723"></a><span class="c">!!    character(len=:),allocatable :: draw_cmds(:)</span>
<a name="ln-1724"></a><span class="c">!!</span>
<a name="ln-1725"></a><span class="c">!!    DRAW_CMDS=[ CHARACTER(LEN=128) :: &amp;</span>
<a name="ln-1726"></a><span class="c">!!    &#39;prefsize 1000 200; vinit                                                    &#39;,&amp;</span>
<a name="ln-1727"></a><span class="c">!!    &#39;set b=.1; page -25-b 25+b -5-b 5+b;color 0;clear                            &#39;,&amp;</span>
<a name="ln-1728"></a><span class="c">!!    &#39;textsize .5 .6;font futura.l; leftjustify                                   &#39;,&amp;</span>
<a name="ln-1729"></a><span class="c">!!    &#39;circleprecision 3                                                           &#39;,&amp;</span>
<a name="ln-1730"></a><span class="c">!!    &#39;# draw circles with hatching                                                &#39;,&amp;</span>
<a name="ln-1731"></a><span class="c">!!    &#39;linewidth 150; polyhatch .true.; hatchang 30                                &#39;,&amp;</span>
<a name="ln-1732"></a><span class="c">!!    &#39;hatchpitch 1/3 ; color 7; circle X=-20 0 5; move2 X-4.9 -4.9;color 7;drawstr 1/3&#39;,&amp;</span>
<a name="ln-1733"></a><span class="c">!!    &#39;hatchpitch 1/2 ; color 2; circle X=-10 0 5; move2 X-4.9 -4.9;color 7;drawstr 1/2&#39;,&amp;</span>
<a name="ln-1734"></a><span class="c">!!    &#39;hatchpitch  1  ; color 6; circle X=-0  0 5; move2 X-4.9 -4.9;color 7;drawstr 1&#39;,&amp;</span>
<a name="ln-1735"></a><span class="c">!!    &#39;hatchpitch  2  ; color 5; circle X=10  0 5; move2 X-4.9 -4.9;color 7;drawstr 2&#39;,&amp;</span>
<a name="ln-1736"></a><span class="c">!!    &#39;hatchpitch  3  ; color 4; circle X=20  0 5; move2 X-4.9 -4.9;color 7;drawstr 3&#39;,&amp;</span>
<a name="ln-1737"></a><span class="c">!!    &#39;getkey                                                                      &#39;,&amp;</span>
<a name="ln-1738"></a><span class="c">!!    &#39;vexit                                                                       &#39;,&amp;</span>
<a name="ln-1739"></a><span class="c">!!    &#39;&#39;]</span>
<a name="ln-1740"></a><span class="c">!!</span>
<a name="ln-1741"></a><span class="c">!!    call draw_interpret(DRAW_CMDS,delimiters=&#39;;&#39;)</span>
<a name="ln-1742"></a><span class="c">!!    end program demo_hatchpitch</span>
<a name="ln-1743"></a><span class="c">!&gt;</span>
<a name="ln-1744"></a><span class="c">!!##NAME</span>
<a name="ln-1745"></a><span class="c">!!    poly2(3f) - [M_draw:POLYGONS] Construct an (x, y) polygon from an array of points</span>
<a name="ln-1746"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1747"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1748"></a><span class="c">!!</span>
<a name="ln-1749"></a><span class="c">!!       subroutine poly2(n, points)</span>
<a name="ln-1750"></a><span class="c">!!       integer,intent(in) :: n</span>
<a name="ln-1751"></a><span class="c">!!       real,intent(in) :: points(2, n)</span>
<a name="ln-1752"></a><span class="c">!!</span>
<a name="ln-1753"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1754"></a><span class="c">!!    Construct an (x, y) polygon from an array of points provided by the user.</span>
<a name="ln-1755"></a><span class="c">!!</span>
<a name="ln-1756"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1757"></a><span class="c">!!</span>
<a name="ln-1758"></a><span class="c">!!   Sample program:</span>
<a name="ln-1759"></a><span class="c">!!</span>
<a name="ln-1760"></a><span class="c">!!    program demo_poly2</span>
<a name="ln-1761"></a><span class="c">!!    use M_draw</span>
<a name="ln-1762"></a><span class="c">!!    integer :: i,j</span>
<a name="ln-1763"></a><span class="c">!!    integer :: ipaws, icolor</span>
<a name="ln-1764"></a><span class="c">!!    real    :: xx,yy</span>
<a name="ln-1765"></a><span class="c">!!       call prefsize(512,512)</span>
<a name="ln-1766"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1767"></a><span class="c">!!       call ortho2(0.0,256.0,0.0,256.0)</span>
<a name="ln-1768"></a><span class="c">!!       call linewidth(1)</span>
<a name="ln-1769"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-1770"></a><span class="c">!!       ! step thru a series of rectangular cells</span>
<a name="ln-1771"></a><span class="c">!!       icolor=0</span>
<a name="ln-1772"></a><span class="c">!!       xx=0.0</span>
<a name="ln-1773"></a><span class="c">!!       do i=1,16</span>
<a name="ln-1774"></a><span class="c">!!          yy=0.0</span>
<a name="ln-1775"></a><span class="c">!!          do j=1,16</span>
<a name="ln-1776"></a><span class="c">!!             yy=yy+16.0</span>
<a name="ln-1777"></a><span class="c">!!             icolor=icolor+1</span>
<a name="ln-1778"></a><span class="c">!!             call setcolor(icolor,xx,yy)</span>
<a name="ln-1779"></a><span class="c">!!          enddo</span>
<a name="ln-1780"></a><span class="c">!!          xx=xx+16.0</span>
<a name="ln-1781"></a><span class="c">!!       enddo</span>
<a name="ln-1782"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-1783"></a><span class="c">!!       call vexit()</span>
<a name="ln-1784"></a><span class="c">!!    contains</span>
<a name="ln-1785"></a><span class="c">!!</span>
<a name="ln-1786"></a><span class="c">!!    subroutine setcolor(iset,xx,yy)</span>
<a name="ln-1787"></a><span class="c">!!    use M_strings, only : v2s</span>
<a name="ln-1788"></a><span class="c">!!    use M_color,  only : color_name2rgb</span>
<a name="ln-1789"></a><span class="c">!!    integer,intent(in) :: iset</span>
<a name="ln-1790"></a><span class="c">!!    real,intent(in)    :: xx,yy</span>
<a name="ln-1791"></a><span class="c">!!    character(len=80)  :: echoname</span>
<a name="ln-1792"></a><span class="c">!!    real    :: points(2,100)</span>
<a name="ln-1793"></a><span class="c">!!    if(iset.gt.255)return</span>
<a name="ln-1794"></a><span class="c">!!    ! determine coordinates of next square</span>
<a name="ln-1795"></a><span class="c">!!    points(1:2,1)=[xx,      yy      ]</span>
<a name="ln-1796"></a><span class="c">!!    points(1:2,2)=[xx,      yy+16.0 ]</span>
<a name="ln-1797"></a><span class="c">!!    points(1:2,3)=[xx+16.0, yy+16.0 ]</span>
<a name="ln-1798"></a><span class="c">!!    points(1:2,4)=[xx+16.0, yy      ]</span>
<a name="ln-1799"></a><span class="c">!!    points(1:2,5)=[xx,      yy      ]</span>
<a name="ln-1800"></a><span class="c">!!    ! get some nice RGB values to try from named colors known by M_color module</span>
<a name="ln-1801"></a><span class="c">!!    call color_name2rgb(v2s(icolor),red,green,blue,echoname)</span>
<a name="ln-1802"></a><span class="c">!!    if(echoname.eq.&#39;Unknown&#39;) return</span>
<a name="ln-1803"></a><span class="c">!!    ! set a color number to the new RGB values</span>
<a name="ln-1804"></a><span class="c">!!    write(*,*)icolor, nint(red*2.55), nint(green*2.55), nint(blue*2.55),trim(echoname)</span>
<a name="ln-1805"></a><span class="c">!!    call mapcolor(icolor, nint(red*2.55), nint(green*2.55), nint(blue*2.55))</span>
<a name="ln-1806"></a><span class="c">!!    ! set to the new color</span>
<a name="ln-1807"></a><span class="c">!!    call color(icolor)</span>
<a name="ln-1808"></a><span class="c">!!    ! fill the rectangle in that color</span>
<a name="ln-1809"></a><span class="c">!!    call poly2(5,points)</span>
<a name="ln-1810"></a><span class="c">!!    end subroutine setcolor</span>
<a name="ln-1811"></a><span class="c">!!</span>
<a name="ln-1812"></a><span class="c">!!    end program demo_poly2</span>
<a name="ln-1813"></a><span class="c">!&gt;</span>
<a name="ln-1814"></a><span class="c">!!##NAME</span>
<a name="ln-1815"></a><span class="c">!!    poly(3f) - [M_draw:POLYGONS] Construct a polygon from an array of points</span>
<a name="ln-1816"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1817"></a><span class="c">!!</span>
<a name="ln-1818"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1819"></a><span class="c">!!</span>
<a name="ln-1820"></a><span class="c">!!       subroutine poly(n, points)</span>
<a name="ln-1821"></a><span class="c">!!       integer,intent(in) :: n</span>
<a name="ln-1822"></a><span class="c">!!       real,intent(in) :: points(3, n)</span>
<a name="ln-1823"></a><span class="c">!!</span>
<a name="ln-1824"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1825"></a><span class="c">!!</span>
<a name="ln-1826"></a><span class="c">!!    Construct a polygon from an array of points provided by the user.</span>
<a name="ln-1827"></a><span class="c">!!</span>
<a name="ln-1828"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1829"></a><span class="c">!!</span>
<a name="ln-1830"></a><span class="c">!!  Sample program:</span>
<a name="ln-1831"></a><span class="c">!!</span>
<a name="ln-1832"></a><span class="c">!!    program demo_poly</span>
<a name="ln-1833"></a><span class="c">!!    use M_draw</span>
<a name="ln-1834"></a><span class="c">!!    ! Using polygons, hatching, and filling.</span>
<a name="ln-1835"></a><span class="c">!!    integer           :: ios</span>
<a name="ln-1836"></a><span class="c">!!    character(len=50) :: device</span>
<a name="ln-1837"></a><span class="c">!!       print*,&#39;Enter output device:&#39;</span>
<a name="ln-1838"></a><span class="c">!!       read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-1839"></a><span class="c">!!       if(ios.ne.0)then</span>
<a name="ln-1840"></a><span class="c">!!          call prefsize(1000,1000)</span>
<a name="ln-1841"></a><span class="c">!!          device=&#39; &#39;</span>
<a name="ln-1842"></a><span class="c">!!       endif</span>
<a name="ln-1843"></a><span class="c">!!       call vinit(device)</span>
<a name="ln-1844"></a><span class="c">!!    ! clear to black</span>
<a name="ln-1845"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-1846"></a><span class="c">!!       call clear()</span>
<a name="ln-1847"></a><span class="c">!!    ! world coordinates are now in the range -10 to 10</span>
<a name="ln-1848"></a><span class="c">!!    ! in x, y, and z. Note that positive z is towards us.</span>
<a name="ln-1849"></a><span class="c">!!       call ortho(-10.0, 10.0, -10.0, 10.0, 10.0, -10.0)</span>
<a name="ln-1850"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-1851"></a><span class="c">!!    ! write out the string &quot;Polygon from poly()&quot; in the</span>
<a name="ln-1852"></a><span class="c">!!    ! starting at (-8.0, -4.0) and scaled to be 4.0 units long,</span>
<a name="ln-1853"></a><span class="c">!!    ! 0.5 units high.</span>
<a name="ln-1854"></a><span class="c">!!       call boxtext(-8.0, -4.0, 4.0, 0.5, &#39;Polygon from poly()&#39;)</span>
<a name="ln-1855"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-1856"></a><span class="c">!!    ! write out a scaled string starting at (0.0, 6.0)</span>
<a name="ln-1857"></a><span class="c">!!       call boxtext(0.0, 6.0, 4.0, 0.5, &#39;Polygon from move()/ draw()&#39;)</span>
<a name="ln-1858"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-1859"></a><span class="c">!!    ! write out a scaled string starting at (0.0, 6.0)</span>
<a name="ln-1860"></a><span class="c">!!       call boxtext(3.5, -3.5, 1.9, 0.5, &#39;Sector&#39;)</span>
<a name="ln-1861"></a><span class="c">!!    ! draw some polygons</span>
<a name="ln-1862"></a><span class="c">!!       call drawpoly()</span>
<a name="ln-1863"></a><span class="c">!!    ! turn on polygon hatching</span>
<a name="ln-1864"></a><span class="c">!!       call polyhatch(.true.)</span>
<a name="ln-1865"></a><span class="c">!!       call hatchang(45.0)</span>
<a name="ln-1866"></a><span class="c">!!       call hatchpitch(0.3)</span>
<a name="ln-1867"></a><span class="c">!!    !  Rotate 20 degrees around x and 30 around y</span>
<a name="ln-1868"></a><span class="c">!!       call rotate(20.0, &#39;x&#39;)</span>
<a name="ln-1869"></a><span class="c">!!       call rotate(30.0, &#39;y&#39;)</span>
<a name="ln-1870"></a><span class="c">!!    ! draw some polygons with hatching</span>
<a name="ln-1871"></a><span class="c">!!       call drawpoly()</span>
<a name="ln-1872"></a><span class="c">!!    ! turn on polygon filling - this automatically turns off hatching</span>
<a name="ln-1873"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-1874"></a><span class="c">!!    !  Do another set of rotations.</span>
<a name="ln-1875"></a><span class="c">!!       call rotate(20.0, &#39;x&#39;)</span>
<a name="ln-1876"></a><span class="c">!!       call rotate(30.0, &#39;y&#39;)</span>
<a name="ln-1877"></a><span class="c">!!    ! draw some polygons with filling</span>
<a name="ln-1878"></a><span class="c">!!       call drawpoly()</span>
<a name="ln-1879"></a><span class="c">!!       call vexit()</span>
<a name="ln-1880"></a><span class="c">!!    contains</span>
<a name="ln-1881"></a><span class="c">!!    subroutine drawpoly()</span>
<a name="ln-1882"></a><span class="c">!!       real parray(3,4)                   ! An array of points for a polygon</span>
<a name="ln-1883"></a><span class="c">!!       data parray/ -8.0, -8.0, 0.0,  &amp;</span>
<a name="ln-1884"></a><span class="c">!!                  &amp; -5.0, -8.0, 0.0,  &amp;</span>
<a name="ln-1885"></a><span class="c">!!                  &amp; -5.0, -5.0, 0.0,  &amp;</span>
<a name="ln-1886"></a><span class="c">!!                  &amp; -8.0, -5.0, 0.0 /</span>
<a name="ln-1887"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-1888"></a><span class="c">!!    ! Draw a polygon using poly, parray is our array of</span>
<a name="ln-1889"></a><span class="c">!!    ! points and 4 is the number of points in it.</span>
<a name="ln-1890"></a><span class="c">!!       call poly(4, parray)</span>
<a name="ln-1891"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-1892"></a><span class="c">!!    ! Draw a 5 sided figure by using move, draw and closepoly.</span>
<a name="ln-1893"></a><span class="c">!!       call makepoly()</span>
<a name="ln-1894"></a><span class="c">!!          call move(0.0, 0.0, 0.0)</span>
<a name="ln-1895"></a><span class="c">!!          call draw(3.0, 0.0, 0.0)</span>
<a name="ln-1896"></a><span class="c">!!          call draw(3.0, 4.0, 0.0)</span>
<a name="ln-1897"></a><span class="c">!!          call draw(-1.0, 5.0, 0.0)</span>
<a name="ln-1898"></a><span class="c">!!          call draw(-2.0, 2.0, 0.0)</span>
<a name="ln-1899"></a><span class="c">!!       call closepoly()</span>
<a name="ln-1900"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-1901"></a><span class="c">!!    ! draw a sector representing a 1/4 circle</span>
<a name="ln-1902"></a><span class="c">!!       call sector(1.5, -7.0, 3.0, 0.0, 90.0)</span>
<a name="ln-1903"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-1904"></a><span class="c">!!    end subroutine drawpoly</span>
<a name="ln-1905"></a><span class="c">!!</span>
<a name="ln-1906"></a><span class="c">!!    end program demo_poly</span>
<a name="ln-1907"></a><span class="c">!&gt;</span>
<a name="ln-1908"></a><span class="c">!!##NAME</span>
<a name="ln-1909"></a><span class="c">!!    makepoly(3f) - [M_draw:POLYGONS] opens polygon constructed by a series of move-draws and closed by closepoly</span>
<a name="ln-1910"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-1911"></a><span class="c">!!</span>
<a name="ln-1912"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-1913"></a><span class="c">!!</span>
<a name="ln-1914"></a><span class="c">!!       subroutine makepoly()</span>
<a name="ln-1915"></a><span class="c">!!</span>
<a name="ln-1916"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-1917"></a><span class="c">!!    makepoly(3f)  opens up a polygon which will then be constructed by a series</span>
<a name="ln-1918"></a><span class="c">!!    of move-draws and closed by a closepoly.</span>
<a name="ln-1919"></a><span class="c">!!</span>
<a name="ln-1920"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-1921"></a><span class="c">!!</span>
<a name="ln-1922"></a><span class="c">!!  Sample program:</span>
<a name="ln-1923"></a><span class="c">!!</span>
<a name="ln-1924"></a><span class="c">!!    program demo_makepoly</span>
<a name="ln-1925"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-1926"></a><span class="c">!!    implicit none</span>
<a name="ln-1927"></a><span class="c">!!    integer,parameter :: wide=640, tall=640</span>
<a name="ln-1928"></a><span class="c">!!    integer :: rows, xoff, yoff, box_sz</span>
<a name="ln-1929"></a><span class="c">!!    integer :: i20, i30, ncols, nrows, ilines</span>
<a name="ln-1930"></a><span class="c">!!    real    :: bottom, left, sun_radius, planet_radius, planet_offset</span>
<a name="ln-1931"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-1932"></a><span class="c">!!       call prefsize(wide,tall)</span>
<a name="ln-1933"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-1934"></a><span class="c">!!       call ortho2(0.0, real(wide), 0.0, real(tall) )</span>
<a name="ln-1935"></a><span class="c">!!       ! call linewidth(3) ! really slows down pbm driver because all lines are polygons</span>
<a name="ln-1936"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-1937"></a><span class="c">!!       call clear()</span>
<a name="ln-1938"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-1939"></a><span class="c">!!       rows=1</span>
<a name="ln-1940"></a><span class="c">!!       box_sz=MIN(wide,tall)/rows       ! size of biggest box to use and get specified number of rows</span>
<a name="ln-1941"></a><span class="c">!!       nrows = tall/box_sz              ! number of rows of objects to draw</span>
<a name="ln-1942"></a><span class="c">!!       ncols = wide/box_sz              ! number of columns of objects to draw</span>
<a name="ln-1943"></a><span class="c">!!       xoff = (wide - ncols * box_sz)/2 ! initial x offset to begin row at to center drawings</span>
<a name="ln-1944"></a><span class="c">!!       yoff = (tall - nrows * box_sz)/2 ! initial x offset to begin column at to center drawings</span>
<a name="ln-1945"></a><span class="c">!!       sun_radius = 148</span>
<a name="ln-1946"></a><span class="c">!!       planet_radius = 1</span>
<a name="ln-1947"></a><span class="c">!!       do ilines = 1, 300</span>
<a name="ln-1948"></a><span class="c">!!          do i20 = 1, ncols</span>
<a name="ln-1949"></a><span class="c">!!             left = (i20-1)*box_sz+xoff</span>
<a name="ln-1950"></a><span class="c">!!             do i30 = 1, nrows</span>
<a name="ln-1951"></a><span class="c">!!                bottom = (i30-1)*box_sz+yoff</span>
<a name="ln-1952"></a><span class="c">!!                call color(D_BLACK)</span>
<a name="ln-1953"></a><span class="c">!!             call makepoly()</span>
<a name="ln-1954"></a><span class="c">!!                call rect(left,bottom,left+box_sz,bottom+box_sz)</span>
<a name="ln-1955"></a><span class="c">!!             call closepoly()</span>
<a name="ln-1956"></a><span class="c">!!                planet_offset= sun_radius</span>
<a name="ln-1957"></a><span class="c">!!                   call color(mod(ilines,15)+1)</span>
<a name="ln-1958"></a><span class="c">!!                   call hypoc(left + box_sz/2.0, bottom + box_sz/2.0, &amp;</span>
<a name="ln-1959"></a><span class="c">!!                &amp; sun_radius, planet_radius, planet_offset, &amp;</span>
<a name="ln-1960"></a><span class="c">!!                &amp; box_sz/2.0, ilines,  &amp;</span>
<a name="ln-1961"></a><span class="c">!!                &amp; 0.0, 0.0, 1)</span>
<a name="ln-1962"></a><span class="c">!!             enddo</span>
<a name="ln-1963"></a><span class="c">!!          enddo</span>
<a name="ln-1964"></a><span class="c">!!          ipaws=getkey()</span>
<a name="ln-1965"></a><span class="c">!!       enddo</span>
<a name="ln-1966"></a><span class="c">!!       call vexit()</span>
<a name="ln-1967"></a><span class="c">!!    contains</span>
<a name="ln-1968"></a><span class="c">!!    !</span>
<a name="ln-1969"></a><span class="c">!!    !  Make shapes using hypocycloidal curves.</span>
<a name="ln-1970"></a><span class="c">!!    !</span>
<a name="ln-1971"></a><span class="c">!!    subroutine hypoc(xcenter,ycenter,sunr0,planet0,offset0,radius,ilines,ang,angs,ifill)</span>
<a name="ln-1972"></a><span class="c">!!    use M_draw</span>
<a name="ln-1973"></a><span class="c">!!    implicit none</span>
<a name="ln-1974"></a><span class="c">!!    real,parameter     :: PI= 3.14159265358979323846264338327950288419716939937510</span>
<a name="ln-1975"></a><span class="c">!!    real,intent(in)    :: xcenter, ycenter      ! center of curve</span>
<a name="ln-1976"></a><span class="c">!!    real,intent(in)    :: sunr0,planet0,offset0 ! radii of sun, planet, and planet offset</span>
<a name="ln-1977"></a><span class="c">!!    real,intent(in)    :: radius                ! radius to fit the shape to (no fit if radius is 0)</span>
<a name="ln-1978"></a><span class="c">!!    integer,intent(in) :: ilines                ! number of points to sample along curve</span>
<a name="ln-1979"></a><span class="c">!!    real,intent(in)    :: ang                   ! angle to rotate the shape by, to orientate it.</span>
<a name="ln-1980"></a><span class="c">!!    real,intent(in)    :: angs                  ! angle to start sampling points at; ccw is +; 0 is East</span>
<a name="ln-1981"></a><span class="c">!!    integer,intent(in) :: ifill                 ! 1 make a filled polygon, 2 make a hatched polygon</span>
<a name="ln-1982"></a><span class="c">!!    integer            :: i10</span>
<a name="ln-1983"></a><span class="c">!!    real               :: ang1, con1, con2, factor</span>
<a name="ln-1984"></a><span class="c">!!    real               :: offset, planet, r, sunr, u</span>
<a name="ln-1985"></a><span class="c">!!    real               :: xpoin, xpoin1, ypoin, ypoin1</span>
<a name="ln-1986"></a><span class="c">!!       sunr=sunr0</span>
<a name="ln-1987"></a><span class="c">!!       offset=offset0</span>
<a name="ln-1988"></a><span class="c">!!       planet=planet0</span>
<a name="ln-1989"></a><span class="c">!!       if(ilines.eq.0.0) return</span>
<a name="ln-1990"></a><span class="c">!!       if(planet.eq.0.0) return</span>
<a name="ln-1991"></a><span class="c">!!       if(sunr.eq.0.0)   return</span>
<a name="ln-1992"></a><span class="c">!!       if(radius.ne.0.and.sunr-planet+offset.ne.0)then</span>
<a name="ln-1993"></a><span class="c">!!          factor=radius/(sunr-planet+offset)</span>
<a name="ln-1994"></a><span class="c">!!          sunr=factor*sunr</span>
<a name="ln-1995"></a><span class="c">!!          planet=factor*planet</span>
<a name="ln-1996"></a><span class="c">!!          offset=factor*offset</span>
<a name="ln-1997"></a><span class="c">!!       endif</span>
<a name="ln-1998"></a><span class="c">!!       u=0.0+ang</span>
<a name="ln-1999"></a><span class="c">!!       con1=PI*2.*(sunr/planet)/real(ilines)</span>
<a name="ln-2000"></a><span class="c">!!       con2=(1.0-planet/sunr)*u</span>
<a name="ln-2001"></a><span class="c">!!       xpoin1=(sunr-planet)*cos(planet*u/sunr)+offset*cos(con2)</span>
<a name="ln-2002"></a><span class="c">!!       ypoin1=(sunr-planet)*sin(planet*u/sunr)-offset*sin(con2)</span>
<a name="ln-2003"></a><span class="c">!!       ang1=atan2(ypoin1,xpoin1)+angs</span>
<a name="ln-2004"></a><span class="c">!!       r=sqrt(xpoin1**2+ypoin1**2)</span>
<a name="ln-2005"></a><span class="c">!!       xpoin1=r*cos(ang1)+xcenter</span>
<a name="ln-2006"></a><span class="c">!!       ypoin1=r*sin(ang1)+ycenter</span>
<a name="ln-2007"></a><span class="c">!!       select case(ifill)</span>
<a name="ln-2008"></a><span class="c">!!       case(:0)</span>
<a name="ln-2009"></a><span class="c">!!       case(1:)</span>
<a name="ln-2010"></a><span class="c">!!          call makepoly()</span>
<a name="ln-2011"></a><span class="c">!!       end select</span>
<a name="ln-2012"></a><span class="c">!!       call move2(xpoin1,ypoin1)</span>
<a name="ln-2013"></a><span class="c">!!       do i10=1,ilines</span>
<a name="ln-2014"></a><span class="c">!!          u=con1*i10+ang</span>
<a name="ln-2015"></a><span class="c">!!          con2=(1.0-planet/sunr)*u</span>
<a name="ln-2016"></a><span class="c">!!          if(con2.ge.2**24) con2=amod(con2,PI)</span>
<a name="ln-2017"></a><span class="c">!!          xpoin=(sunr-planet)*cos(planet*u/sunr)+offset*cos(con2)</span>
<a name="ln-2018"></a><span class="c">!!          ypoin=(sunr-planet)*sin(planet*u/sunr)-offset*sin(con2)</span>
<a name="ln-2019"></a><span class="c">!!          ang1=atan2(ypoin,xpoin)+angs</span>
<a name="ln-2020"></a><span class="c">!!          r=sqrt(xpoin**2+ypoin**2)</span>
<a name="ln-2021"></a><span class="c">!!          xpoin=r*cos(ang1)+xcenter</span>
<a name="ln-2022"></a><span class="c">!!          ypoin=r*sin(ang1)+ycenter</span>
<a name="ln-2023"></a><span class="c">!!          call draw2(xpoin,ypoin)</span>
<a name="ln-2024"></a><span class="c">!!       enddo</span>
<a name="ln-2025"></a><span class="c">!!       call draw2(xpoin1,ypoin1)</span>
<a name="ln-2026"></a><span class="c">!!       if(ifill.gt.0)then</span>
<a name="ln-2027"></a><span class="c">!!         call closepoly()</span>
<a name="ln-2028"></a><span class="c">!!       endif</span>
<a name="ln-2029"></a><span class="c">!!    end subroutine hypoc</span>
<a name="ln-2030"></a><span class="c">!!    end program demo_makepoly</span>
<a name="ln-2031"></a><span class="c">!&gt;</span>
<a name="ln-2032"></a><span class="c">!!##NAME</span>
<a name="ln-2033"></a><span class="c">!!    closepoly(3f) - [M_draw:POLYGONS] Terminates a polygon opened by makepoly(3f)</span>
<a name="ln-2034"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2035"></a><span class="c">!!</span>
<a name="ln-2036"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2037"></a><span class="c">!!</span>
<a name="ln-2038"></a><span class="c">!!       subroutine closepoly()</span>
<a name="ln-2039"></a><span class="c">!!</span>
<a name="ln-2040"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2041"></a><span class="c">!!</span>
<a name="ln-2042"></a><span class="c">!!    Terminates a polygon opened by makepoly(3f).</span>
<a name="ln-2043"></a><span class="c">!&gt;</span>
<a name="ln-2044"></a><span class="c">!!##NAME</span>
<a name="ln-2045"></a><span class="c">!!    backface(3f) - [M_draw:POLYGONS] Turns on culling of backfacing polygons.</span>
<a name="ln-2046"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2047"></a><span class="c">!!</span>
<a name="ln-2048"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2049"></a><span class="c">!!</span>
<a name="ln-2050"></a><span class="c">!!       subroutine backface(onoff)</span>
<a name="ln-2051"></a><span class="c">!!       logical onoff</span>
<a name="ln-2052"></a><span class="c">!!</span>
<a name="ln-2053"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2054"></a><span class="c">!!    Turns on culling of backfacing polygons. A polygon is backfacing if</span>
<a name="ln-2055"></a><span class="c">!!    its orientation in *screen* coords is clockwise, unless a call</span>
<a name="ln-2056"></a><span class="c">!!    to backfacedir is made.</span>
<a name="ln-2057"></a><span class="c">!!</span>
<a name="ln-2058"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2059"></a><span class="c">!!</span>
<a name="ln-2060"></a><span class="c">!!   Sample program:</span>
<a name="ln-2061"></a><span class="c">!!</span>
<a name="ln-2062"></a><span class="c">!!    program demo_backface</span>
<a name="ln-2063"></a><span class="c">!!    !      demonstrate double buffering and what happens when you hit clipping plane</span>
<a name="ln-2064"></a><span class="c">!!    !</span>
<a name="ln-2065"></a><span class="c">!!    !      Specifying an extra argument turns on the filling.</span>
<a name="ln-2066"></a><span class="c">!!    !</span>
<a name="ln-2067"></a><span class="c">!!    use M_draw</span>
<a name="ln-2068"></a><span class="c">!!    character(len=30) :: device</span>
<a name="ln-2069"></a><span class="c">!!    character(len=1)  :: c</span>
<a name="ln-2070"></a><span class="c">!!    real    r, t, dr, dt</span>
<a name="ln-2071"></a><span class="c">!!    integer nplanes</span>
<a name="ln-2072"></a><span class="c">!!    logical fill, back, backdir</span>
<a name="ln-2073"></a><span class="c">!!    integer :: ios</span>
<a name="ln-2074"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-2075"></a><span class="c">!!</span>
<a name="ln-2076"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-2077"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-2078"></a><span class="c">!!    if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-2079"></a><span class="c">!!</span>
<a name="ln-2080"></a><span class="c">!!    dr = 0.3</span>
<a name="ln-2081"></a><span class="c">!!    dt = 0.2</span>
<a name="ln-2082"></a><span class="c">!!    print*,&#39;Enter delta in degrees (0.333 is typical):&#39;</span>
<a name="ln-2083"></a><span class="c">!!    read(*,*,iostat=ios) dr</span>
<a name="ln-2084"></a><span class="c">!!    if(ios.ne.0)dr=0.333</span>
<a name="ln-2085"></a><span class="c">!!    write(*,*)&#39;DR=&#39;,dr</span>
<a name="ln-2086"></a><span class="c">!!</span>
<a name="ln-2087"></a><span class="c">!!    call prefsize(300, 300)</span>
<a name="ln-2088"></a><span class="c">!!</span>
<a name="ln-2089"></a><span class="c">!!    call vinit(device)</span>
<a name="ln-2090"></a><span class="c">!!</span>
<a name="ln-2091"></a><span class="c">!!    nplanes = getdepth()</span>
<a name="ln-2092"></a><span class="c">!!</span>
<a name="ln-2093"></a><span class="c">!!    fill = .true.</span>
<a name="ln-2094"></a><span class="c">!!    back = .true.</span>
<a name="ln-2095"></a><span class="c">!!    backdir = .true.</span>
<a name="ln-2096"></a><span class="c">!!</span>
<a name="ln-2097"></a><span class="c">!!    call polyfill(fill)</span>
<a name="ln-2098"></a><span class="c">!!    call backface(back)</span>
<a name="ln-2099"></a><span class="c">!!    call backfacedir(backdir)</span>
<a name="ln-2100"></a><span class="c">!!</span>
<a name="ln-2101"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-2102"></a><span class="c">!!    call clear()</span>
<a name="ln-2103"></a><span class="c">!!</span>
<a name="ln-2104"></a><span class="c">!!    call window(-1.5, 1.5, -1.5, 1.5, 9.0, -5.0)</span>
<a name="ln-2105"></a><span class="c">!!    call lookat(0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-2106"></a><span class="c">!!</span>
<a name="ln-2107"></a><span class="c">!!    t = 0.0</span>
<a name="ln-2108"></a><span class="c">!!    r = 30.0</span>
<a name="ln-2109"></a><span class="c">!!    !</span>
<a name="ln-2110"></a><span class="c">!!    ! Setup drawing into the backbuffer....</span>
<a name="ln-2111"></a><span class="c">!!    !</span>
<a name="ln-2112"></a><span class="c">!!    if (backbuffer().lt.0) then</span>
<a name="ln-2113"></a><span class="c">!!       write(*,*)&#39;Device can&#39;&#39;t support doublebuffering&#39;</span>
<a name="ln-2114"></a><span class="c">!!       ! draw a single view so at least the cube is displayed</span>
<a name="ln-2115"></a><span class="c">!!       call frontbuffer()</span>
<a name="ln-2116"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2117"></a><span class="c">!!       call clear()</span>
<a name="ln-2118"></a><span class="c">!!       call translate(0.0, 0.0, t)</span>
<a name="ln-2119"></a><span class="c">!!       call rotate(r, &#39;y&#39;)</span>
<a name="ln-2120"></a><span class="c">!!       call rotate(r, &#39;z&#39;)</span>
<a name="ln-2121"></a><span class="c">!!       call rotate(r, &#39;x&#39;)</span>
<a name="ln-2122"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2123"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-2124"></a><span class="c">!!       call drawcube(nplanes)</span>
<a name="ln-2125"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2126"></a><span class="c">!!       call polyfill(.false.)</span>
<a name="ln-2127"></a><span class="c">!!       call drawcube(nplanes)</span>
<a name="ln-2128"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-2129"></a><span class="c">!!       call vexit()</span>
<a name="ln-2130"></a><span class="c">!!       stop</span>
<a name="ln-2131"></a><span class="c">!!</span>
<a name="ln-2132"></a><span class="c">!!    endif</span>
<a name="ln-2133"></a><span class="c">!!</span>
<a name="ln-2134"></a><span class="c">!!    do</span>
<a name="ln-2135"></a><span class="c">!!       if(r.ge.360) r = 0.0</span>
<a name="ln-2136"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2137"></a><span class="c">!!       call clear()</span>
<a name="ln-2138"></a><span class="c">!!</span>
<a name="ln-2139"></a><span class="c">!!       call pushmatrix()</span>
<a name="ln-2140"></a><span class="c">!!</span>
<a name="ln-2141"></a><span class="c">!!       call translate(0.0, 0.0, t)</span>
<a name="ln-2142"></a><span class="c">!!       call rotate(r, &#39;y&#39;)</span>
<a name="ln-2143"></a><span class="c">!!       call rotate(r, &#39;z&#39;)</span>
<a name="ln-2144"></a><span class="c">!!       call rotate(r, &#39;x&#39;)</span>
<a name="ln-2145"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2146"></a><span class="c">!!</span>
<a name="ln-2147"></a><span class="c">!!       call drawcube(nplanes)</span>
<a name="ln-2148"></a><span class="c">!!</span>
<a name="ln-2149"></a><span class="c">!!       if (nplanes .eq. 1 .and. fill) then</span>
<a name="ln-2150"></a><span class="c">!!          call polyfill(.false.)</span>
<a name="ln-2151"></a><span class="c">!!          call color(D_BLACK)</span>
<a name="ln-2152"></a><span class="c">!!          call drawcube(nplanes)</span>
<a name="ln-2153"></a><span class="c">!!          call polyfill(fill)</span>
<a name="ln-2154"></a><span class="c">!!       endif</span>
<a name="ln-2155"></a><span class="c">!!</span>
<a name="ln-2156"></a><span class="c">!!       call popmatrix()</span>
<a name="ln-2157"></a><span class="c">!!</span>
<a name="ln-2158"></a><span class="c">!!       t = t + dt</span>
<a name="ln-2159"></a><span class="c">!!       if (t.gt.3.0 .or. t.lt.-18.0) dt = -dt</span>
<a name="ln-2160"></a><span class="c">!!</span>
<a name="ln-2161"></a><span class="c">!!       call swapbuffers()</span>
<a name="ln-2162"></a><span class="c">!!</span>
<a name="ln-2163"></a><span class="c">!!       c = char(checkkey())</span>
<a name="ln-2164"></a><span class="c">!!       if (c .eq. &#39;f&#39;) then</span>
<a name="ln-2165"></a><span class="c">!!          fill = .not. fill</span>
<a name="ln-2166"></a><span class="c">!!          call polyfill(fill)</span>
<a name="ln-2167"></a><span class="c">!!       elseif (c .eq. &#39;b&#39;) then</span>
<a name="ln-2168"></a><span class="c">!!          back = .not. back</span>
<a name="ln-2169"></a><span class="c">!!          call backface(back)</span>
<a name="ln-2170"></a><span class="c">!!       elseif (c .eq. &#39;d&#39;) then</span>
<a name="ln-2171"></a><span class="c">!!          backdir = .not. backdir</span>
<a name="ln-2172"></a><span class="c">!!          call backfacedir(backdir)</span>
<a name="ln-2173"></a><span class="c">!!       elseif (c .ne. char(0)) then</span>
<a name="ln-2174"></a><span class="c">!!          call vexit()</span>
<a name="ln-2175"></a><span class="c">!!          stop</span>
<a name="ln-2176"></a><span class="c">!!       endif</span>
<a name="ln-2177"></a><span class="c">!!</span>
<a name="ln-2178"></a><span class="c">!!       r = r + dr</span>
<a name="ln-2179"></a><span class="c">!!    enddo</span>
<a name="ln-2180"></a><span class="c">!!</span>
<a name="ln-2181"></a><span class="c">!!    contains</span>
<a name="ln-2182"></a><span class="c">!!    ! this routine draws the cube, using colours if available</span>
<a name="ln-2183"></a><span class="c">!!    !</span>
<a name="ln-2184"></a><span class="c">!!    subroutine drawcube(nplanes)</span>
<a name="ln-2185"></a><span class="c">!!       integer nplanes</span>
<a name="ln-2186"></a><span class="c">!!</span>
<a name="ln-2187"></a><span class="c">!!       real carray(3, 8)</span>
<a name="ln-2188"></a><span class="c">!!       data carray/            &amp;</span>
<a name="ln-2189"></a><span class="c">!!       &amp;   -1.0,  -1.0,   1.0,  &amp;</span>
<a name="ln-2190"></a><span class="c">!!       &amp;    1.0,  -1.0,   1.0,  &amp;</span>
<a name="ln-2191"></a><span class="c">!!       &amp;    1.0,   1.0,   1.0,  &amp;</span>
<a name="ln-2192"></a><span class="c">!!       &amp;   -1.0,   1.0,   1.0,  &amp;</span>
<a name="ln-2193"></a><span class="c">!!       &amp;   -1.0,  -1.0,  -1.0,  &amp;</span>
<a name="ln-2194"></a><span class="c">!!       &amp;    1.0,  -1.0,  -1.0,  &amp;</span>
<a name="ln-2195"></a><span class="c">!!       &amp;    1.0,   1.0,  -1.0,  &amp;</span>
<a name="ln-2196"></a><span class="c">!!       &amp;   -1.0,   1.0,  -1.0/</span>
<a name="ln-2197"></a><span class="c">!!       save carray</span>
<a name="ln-2198"></a><span class="c">!!</span>
<a name="ln-2199"></a><span class="c">!!       if (nplanes.gt.1) call color(D_RED)</span>
<a name="ln-2200"></a><span class="c">!!</span>
<a name="ln-2201"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2202"></a><span class="c">!!       call move(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2203"></a><span class="c">!!       call draw(carray(1,2), carray(2,2), carray(3,2))</span>
<a name="ln-2204"></a><span class="c">!!       call draw(carray(1,3), carray(2,3), carray(3,3))</span>
<a name="ln-2205"></a><span class="c">!!       call draw(carray(1,4), carray(2,4), carray(3,4))</span>
<a name="ln-2206"></a><span class="c">!!       call draw(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2207"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2208"></a><span class="c">!!</span>
<a name="ln-2209"></a><span class="c">!!       if (nplanes.gt.1) call color(D_GREEN)</span>
<a name="ln-2210"></a><span class="c">!!</span>
<a name="ln-2211"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2212"></a><span class="c">!!       call move(carray(1,6), carray(2,6), carray(3,6))</span>
<a name="ln-2213"></a><span class="c">!!       call draw(carray(1,5), carray(2,5), carray(3,5))</span>
<a name="ln-2214"></a><span class="c">!!       call draw(carray(1,8), carray(2,8), carray(3,8))</span>
<a name="ln-2215"></a><span class="c">!!       call draw(carray(1,7), carray(2,7), carray(3,7))</span>
<a name="ln-2216"></a><span class="c">!!       call draw(carray(1,6), carray(2,6), carray(3,6))</span>
<a name="ln-2217"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2218"></a><span class="c">!!</span>
<a name="ln-2219"></a><span class="c">!!       if (nplanes.gt.1) call color(D_YELLOW)</span>
<a name="ln-2220"></a><span class="c">!!</span>
<a name="ln-2221"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2222"></a><span class="c">!!       call move(carray(1,2), carray(2,2), carray(3,2))</span>
<a name="ln-2223"></a><span class="c">!!       call draw(carray(1,6), carray(2,6), carray(3,6))</span>
<a name="ln-2224"></a><span class="c">!!       call draw(carray(1,7), carray(2,7), carray(3,7))</span>
<a name="ln-2225"></a><span class="c">!!       call draw(carray(1,3), carray(2,3), carray(3,3))</span>
<a name="ln-2226"></a><span class="c">!!       call draw(carray(1,2), carray(2,2), carray(3,2))</span>
<a name="ln-2227"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2228"></a><span class="c">!!</span>
<a name="ln-2229"></a><span class="c">!!       if (nplanes.gt.1) call color(D_BLUE)</span>
<a name="ln-2230"></a><span class="c">!!</span>
<a name="ln-2231"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2232"></a><span class="c">!!       call move(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2233"></a><span class="c">!!       call draw(carray(1,4), carray(2,4), carray(3,4))</span>
<a name="ln-2234"></a><span class="c">!!       call draw(carray(1,8), carray(2,8), carray(3,8))</span>
<a name="ln-2235"></a><span class="c">!!       call draw(carray(1,5), carray(2,5), carray(3,5))</span>
<a name="ln-2236"></a><span class="c">!!       call draw(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2237"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2238"></a><span class="c">!!</span>
<a name="ln-2239"></a><span class="c">!!       if (nplanes.gt.1) call color(D_MAGENTA)</span>
<a name="ln-2240"></a><span class="c">!!</span>
<a name="ln-2241"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2242"></a><span class="c">!!       call move(carray(1,3), carray(2,3), carray(3,3))</span>
<a name="ln-2243"></a><span class="c">!!       call draw(carray(1,7), carray(2,7), carray(3,7))</span>
<a name="ln-2244"></a><span class="c">!!       call draw(carray(1,8), carray(2,8), carray(3,8))</span>
<a name="ln-2245"></a><span class="c">!!       call draw(carray(1,4), carray(2,4), carray(3,4))</span>
<a name="ln-2246"></a><span class="c">!!       call draw(carray(1,3), carray(2,3), carray(3,3))</span>
<a name="ln-2247"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2248"></a><span class="c">!!</span>
<a name="ln-2249"></a><span class="c">!!       if (nplanes.gt.1) call color(D_CYAN)</span>
<a name="ln-2250"></a><span class="c">!!</span>
<a name="ln-2251"></a><span class="c">!!       call makepoly()</span>
<a name="ln-2252"></a><span class="c">!!       call move(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2253"></a><span class="c">!!       call draw(carray(1,5), carray(2,5), carray(3,5))</span>
<a name="ln-2254"></a><span class="c">!!       call draw(carray(1,6), carray(2,6), carray(3,6))</span>
<a name="ln-2255"></a><span class="c">!!       call draw(carray(1,2), carray(2,2), carray(3,2))</span>
<a name="ln-2256"></a><span class="c">!!       call draw(carray(1,1), carray(2,1), carray(3,1))</span>
<a name="ln-2257"></a><span class="c">!!       call closepoly()</span>
<a name="ln-2258"></a><span class="c">!!</span>
<a name="ln-2259"></a><span class="c">!!    end subroutine drawcube</span>
<a name="ln-2260"></a><span class="c">!!</span>
<a name="ln-2261"></a><span class="c">!!    end program demo_backface</span>
<a name="ln-2262"></a><span class="c">!!</span>
<a name="ln-2263"></a><span class="c">!! !</span>
<a name="ln-2264"></a><span class="c">!&gt;</span>
<a name="ln-2265"></a><span class="c">!!##NAME</span>
<a name="ln-2266"></a><span class="c">!!    backfacedir(3f) - [M_draw:POLYGONS] Sets backfacing direction to clockwise or anti-clockwise</span>
<a name="ln-2267"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2268"></a><span class="c">!!</span>
<a name="ln-2269"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2270"></a><span class="c">!!</span>
<a name="ln-2271"></a><span class="c">!!       subroutine backfacedir(clockwise)</span>
<a name="ln-2272"></a><span class="c">!!       integer,intent(in) :: clockwise</span>
<a name="ln-2273"></a><span class="c">!!</span>
<a name="ln-2274"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2275"></a><span class="c">!!    Sets the backfacing direction to clockwise or anti-clockwise depending</span>
<a name="ln-2276"></a><span class="c">!!    on whether clockwise is 1 or 0. 1 = clockwise (in screen coords)</span>
<a name="ln-2277"></a><span class="c">!!    0 = anticlockwise.</span>
<a name="ln-2278"></a><span class="c">!!</span>
<a name="ln-2279"></a><span class="c">!&gt;</span>
<a name="ln-2280"></a><span class="c">!!##NAME</span>
<a name="ln-2281"></a><span class="c">!!     circleprecision(3f) - [M_draw:ARCS] Set number of line segments used to approximate a circle</span>
<a name="ln-2282"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-2283"></a><span class="c">!!</span>
<a name="ln-2284"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2285"></a><span class="c">!!</span>
<a name="ln-2286"></a><span class="c">!!         subroutine circleprecision(nsegs)</span>
<a name="ln-2287"></a><span class="c">!!         integer,intent(in) :: nsegs</span>
<a name="ln-2288"></a><span class="c">!!</span>
<a name="ln-2289"></a><span class="c">!!    Set the number of line segments making up a circle. Default is</span>
<a name="ln-2290"></a><span class="c">!!    currently 32. The number of segments in an arc or sector is calculated</span>
<a name="ln-2291"></a><span class="c">!!    from the variable &quot;nsegs&quot; according to the span of the arc or sector.</span>
<a name="ln-2292"></a><span class="c">!!</span>
<a name="ln-2293"></a><span class="c">!!##OPTIONS</span>
<a name="ln-2294"></a><span class="c">!!    NSEGS   number of line segments making up a circle</span>
<a name="ln-2295"></a><span class="c">!!</span>
<a name="ln-2296"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2297"></a><span class="c">!!</span>
<a name="ln-2298"></a><span class="c">!!   Sample program:</span>
<a name="ln-2299"></a><span class="c">!!</span>
<a name="ln-2300"></a><span class="c">!!    program demo_circleprecision</span>
<a name="ln-2301"></a><span class="c">!!    use M_draw</span>
<a name="ln-2302"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2303"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2304"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2305"></a><span class="c">!!    real    :: b=0.5</span>
<a name="ln-2306"></a><span class="c">!!    real    :: y1,y2,ym,x1,x2</span>
<a name="ln-2307"></a><span class="c">!!    real    :: width=50.0/8.0,width2</span>
<a name="ln-2308"></a><span class="c">!!    integer,parameter :: ivals(*)=[3,5,7,10,20,30,60,100]</span>
<a name="ln-2309"></a><span class="c">!!    integer :: i</span>
<a name="ln-2310"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-2311"></a><span class="c">!!       !! set up long bar as plotting area</span>
<a name="ln-2312"></a><span class="c">!!       call prefsize(1000,200)</span>
<a name="ln-2313"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-2314"></a><span class="c">!!       call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-2315"></a><span class="c">!!       call textsize( 2.5/2.0, 3.0/2.0)</span>
<a name="ln-2316"></a><span class="c">!!       call font(&#39;futura.l&#39;)</span>
<a name="ln-2317"></a><span class="c">!!       call centertext(.true.)</span>
<a name="ln-2318"></a><span class="c">!!       call linewidth(30)</span>
<a name="ln-2319"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-2320"></a><span class="c">!!       y1=-5</span>
<a name="ln-2321"></a><span class="c">!!       y2=5</span>
<a name="ln-2322"></a><span class="c">!!       ym=0</span>
<a name="ln-2323"></a><span class="c">!!       x1=-25+.05*width</span>
<a name="ln-2324"></a><span class="c">!!       ! draw colored rectangle and a circle and label center of circle repeat</span>
<a name="ln-2325"></a><span class="c">!!       width2=width*0.95</span>
<a name="ln-2326"></a><span class="c">!!       do i=1,size(ivals)</span>
<a name="ln-2327"></a><span class="c">!!          x2=x1+width2</span>
<a name="ln-2328"></a><span class="c">!!          call move2((x1+x2)/2.0,ym)</span>
<a name="ln-2329"></a><span class="c">!!          call circleprecision(ivals(i))</span>
<a name="ln-2330"></a><span class="c">!!          call print(ivals(i))     ! convert number to string and draw it</span>
<a name="ln-2331"></a><span class="c">!!          call circle((x1+x2)/2.0, ym, (x2-x1)/2.10)</span>
<a name="ln-2332"></a><span class="c">!!          x1=x1+width</span>
<a name="ln-2333"></a><span class="c">!!       enddo</span>
<a name="ln-2334"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-2335"></a><span class="c">!!       call vexit()</span>
<a name="ln-2336"></a><span class="c">!!    end program demo_circleprecision</span>
<a name="ln-2337"></a><span class="c">!!</span>
<a name="ln-2338"></a><span class="c">!!##IMAGE</span>
<a name="ln-2339"></a><span class="c">!!    circles are drawn with various circle precision values.</span>
<a name="ln-2340"></a><span class="c">!&gt;</span>
<a name="ln-2341"></a><span class="c">!!##NAME</span>
<a name="ln-2342"></a><span class="c">!!     arc(3f) - [M_draw:ARCS] Draw an arc in world units.</span>
<a name="ln-2343"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-2344"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2345"></a><span class="c">!!</span>
<a name="ln-2346"></a><span class="c">!!         subroutine arc(x, y, radius, startang, endang)</span>
<a name="ln-2347"></a><span class="c">!!         real,intent(in) :: x</span>
<a name="ln-2348"></a><span class="c">!!         real,intent(in) :: y</span>
<a name="ln-2349"></a><span class="c">!!         real,intent(in) :: radius</span>
<a name="ln-2350"></a><span class="c">!!         real,intent(in) :: startang</span>
<a name="ln-2351"></a><span class="c">!!         real,intent(in) :: endang</span>
<a name="ln-2352"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2353"></a><span class="c">!!</span>
<a name="ln-2354"></a><span class="c">!!    Draw an arc. x, y, and radius are values in world units</span>
<a name="ln-2355"></a><span class="c">!!    using current line width and color</span>
<a name="ln-2356"></a><span class="c">!!</span>
<a name="ln-2357"></a><span class="c">!!    Angles are in degrees, positive measured counterclockwise from the</span>
<a name="ln-2358"></a><span class="c">!!    +X axis. The current position after the arc is drawn is at the end</span>
<a name="ln-2359"></a><span class="c">!!    of the arc.</span>
<a name="ln-2360"></a><span class="c">!!</span>
<a name="ln-2361"></a><span class="c">!!##OPTIONS</span>
<a name="ln-2362"></a><span class="c">!!    X,Y        Coordinates for the center of the circle</span>
<a name="ln-2363"></a><span class="c">!!    RADIUS     Radius of the circle</span>
<a name="ln-2364"></a><span class="c">!!    STARTANG   Start angle</span>
<a name="ln-2365"></a><span class="c">!!    ENDANG     End angle</span>
<a name="ln-2366"></a><span class="c">!!</span>
<a name="ln-2367"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2368"></a><span class="c">!!</span>
<a name="ln-2369"></a><span class="c">!!   Sample program:</span>
<a name="ln-2370"></a><span class="c">!!</span>
<a name="ln-2371"></a><span class="c">!!    program demo_arc</span>
<a name="ln-2372"></a><span class="c">!!       use M_draw</span>
<a name="ln-2373"></a><span class="c">!!       use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2374"></a><span class="c">!!       use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2375"></a><span class="c">!!       use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2376"></a><span class="c">!!       implicit none</span>
<a name="ln-2377"></a><span class="c">!!       integer        :: icolor</span>
<a name="ln-2378"></a><span class="c">!!       real           :: b=0.5</span>
<a name="ln-2379"></a><span class="c">!!       real           :: R=4.9</span>
<a name="ln-2380"></a><span class="c">!!       real           :: X, Y, A, YY</span>
<a name="ln-2381"></a><span class="c">!!       integer        :: key</span>
<a name="ln-2382"></a><span class="c">!!       call prefsize(1000,200)</span>
<a name="ln-2383"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-2384"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2385"></a><span class="c">!!       call clear()</span>
<a name="ln-2386"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-2387"></a><span class="c">!!       call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-2388"></a><span class="c">!!       call textsize(1.0,1.4)</span>
<a name="ln-2389"></a><span class="c">!!       call font(&quot;futura.l&quot;)</span>
<a name="ln-2390"></a><span class="c">!!       call centertext(.true.)</span>
<a name="ln-2391"></a><span class="c">!!       ! draw arcs with various start and end angles</span>
<a name="ln-2392"></a><span class="c">!!</span>
<a name="ln-2393"></a><span class="c">!!       X=-20.0; Y=0.0; A=0.0; B=30.0;  icolor=7; YY=4</span>
<a name="ln-2394"></a><span class="c">!!       call drawit(&quot;0 to 30 deg.&quot;)</span>
<a name="ln-2395"></a><span class="c">!!</span>
<a name="ln-2396"></a><span class="c">!!       X=-10.0; YY=-4; A=0.0; B=-45.0; icolor=1</span>
<a name="ln-2397"></a><span class="c">!!       call drawit(&quot;0 to -45 deg.&quot;)</span>
<a name="ln-2398"></a><span class="c">!!</span>
<a name="ln-2399"></a><span class="c">!!       X=0.0; YY=-4; A=100.0; B=200.0; icolor=2</span>
<a name="ln-2400"></a><span class="c">!!       call drawit(&quot;100 to 200 deg.&quot;)</span>
<a name="ln-2401"></a><span class="c">!!</span>
<a name="ln-2402"></a><span class="c">!!       X=10.0; YY=-4; A=-30.0; B=30.0;icolor=5</span>
<a name="ln-2403"></a><span class="c">!!       call drawit(&quot;-30 to 30 deg.&quot;)</span>
<a name="ln-2404"></a><span class="c">!!</span>
<a name="ln-2405"></a><span class="c">!!       YY=4; X=20.0; A=45.0; B=-45.0; icolor=6</span>
<a name="ln-2406"></a><span class="c">!!       call drawit(&quot;45 to -45 deg.&quot;)</span>
<a name="ln-2407"></a><span class="c">!!</span>
<a name="ln-2408"></a><span class="c">!!       call vflush()</span>
<a name="ln-2409"></a><span class="c">!!       key=getkey()</span>
<a name="ln-2410"></a><span class="c">!!       call vexit()</span>
<a name="ln-2411"></a><span class="c">!!    contains</span>
<a name="ln-2412"></a><span class="c">!!       subroutine drawit(label)</span>
<a name="ln-2413"></a><span class="c">!!          character(len=*) :: label</span>
<a name="ln-2414"></a><span class="c">!!          call linewidth(150)</span>
<a name="ln-2415"></a><span class="c">!!          call color(icolor)</span>
<a name="ln-2416"></a><span class="c">!!          call arc(X,Y,R,A,B)</span>
<a name="ln-2417"></a><span class="c">!!          call draw2(X,Y)</span>
<a name="ln-2418"></a><span class="c">!!          call move2(X,YY)</span>
<a name="ln-2419"></a><span class="c">!!          call linewidth(50)</span>
<a name="ln-2420"></a><span class="c">!!          call color(D_WHITE)</span>
<a name="ln-2421"></a><span class="c">!!          call drawstr(label)</span>
<a name="ln-2422"></a><span class="c">!!       end subroutine drawit</span>
<a name="ln-2423"></a><span class="c">!!</span>
<a name="ln-2424"></a><span class="c">!!    end program demo_arc</span>
<a name="ln-2425"></a><span class="c">!&gt;</span>
<a name="ln-2426"></a><span class="c">!!##NAME</span>
<a name="ln-2427"></a><span class="c">!!    sector(3f) - [M_draw:ARCS] Draw a sector. Note: sectors are polygons.</span>
<a name="ln-2428"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2429"></a><span class="c">!!</span>
<a name="ln-2430"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2431"></a><span class="c">!!</span>
<a name="ln-2432"></a><span class="c">!!         subroutine sector(x, y, radius, startang, endang)</span>
<a name="ln-2433"></a><span class="c">!!         REAL x, y, radius, startang, endang</span>
<a name="ln-2434"></a><span class="c">!!</span>
<a name="ln-2435"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2436"></a><span class="c">!!</span>
<a name="ln-2437"></a><span class="c">!!    Draw a sector. x, y, and radius are values in world units. Note: sectors</span>
<a name="ln-2438"></a><span class="c">!!    are regarded as polygons, so if polyfill or polyhatch has been called</span>
<a name="ln-2439"></a><span class="c">!!    with 1, the sectors will be filled or hatched accordingly.</span>
<a name="ln-2440"></a><span class="c">!!</span>
<a name="ln-2441"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2442"></a><span class="c">!!</span>
<a name="ln-2443"></a><span class="c">!!   Sample program:</span>
<a name="ln-2444"></a><span class="c">!!</span>
<a name="ln-2445"></a><span class="c">!!    program demo_sector</span>
<a name="ln-2446"></a><span class="c">!!    use M_draw</span>
<a name="ln-2447"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2448"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2449"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2450"></a><span class="c">!!    implicit none</span>
<a name="ln-2451"></a><span class="c">!!    real           :: b=0.5</span>
<a name="ln-2452"></a><span class="c">!!    real           :: R=4.9</span>
<a name="ln-2453"></a><span class="c">!!    real           :: X, Y, A</span>
<a name="ln-2454"></a><span class="c">!!    integer        :: key</span>
<a name="ln-2455"></a><span class="c">!!       call prefsize(1000,200)</span>
<a name="ln-2456"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-2457"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2458"></a><span class="c">!!       call clear()</span>
<a name="ln-2459"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-2460"></a><span class="c">!!       call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-2461"></a><span class="c">!!       call textsize(1.0,1.4)</span>
<a name="ln-2462"></a><span class="c">!!       call font(&quot;futura.l&quot;)</span>
<a name="ln-2463"></a><span class="c">!!       call centertext(.true.)</span>
<a name="ln-2464"></a><span class="c">!!</span>
<a name="ln-2465"></a><span class="c">!!       ! draw sectors with various start and end angles</span>
<a name="ln-2466"></a><span class="c">!!</span>
<a name="ln-2467"></a><span class="c">!!       call linewidth(150)</span>
<a name="ln-2468"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2469"></a><span class="c">!!       X=-20; Y=0; R=5.0; A=0; B=30</span>
<a name="ln-2470"></a><span class="c">!!       call sector(X,Y,R,A,B)</span>
<a name="ln-2471"></a><span class="c">!!       call move2(X, 4.0)</span>
<a name="ln-2472"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-2473"></a><span class="c">!!       call drawstr(&quot;0 to 30 deg.&quot;)</span>
<a name="ln-2474"></a><span class="c">!!</span>
<a name="ln-2475"></a><span class="c">!!       call linewidth(150)</span>
<a name="ln-2476"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-2477"></a><span class="c">!!       X=-10; Y=0; R=5; A=0; B=-45</span>
<a name="ln-2478"></a><span class="c">!!       call sector(X,Y,R,A,B)</span>
<a name="ln-2479"></a><span class="c">!!       call move2(X,-4.0)</span>
<a name="ln-2480"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-2481"></a><span class="c">!!       call drawstr(&quot;0 to -45 deg.&quot;)</span>
<a name="ln-2482"></a><span class="c">!!</span>
<a name="ln-2483"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-2484"></a><span class="c">!!</span>
<a name="ln-2485"></a><span class="c">!!       call linewidth(150)</span>
<a name="ln-2486"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-2487"></a><span class="c">!!       X=-0; Y=0; R=5; A=100; B=200</span>
<a name="ln-2488"></a><span class="c">!!       call sector(X,Y,R,A,B)</span>
<a name="ln-2489"></a><span class="c">!!       call move2(X,-4.0)</span>
<a name="ln-2490"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-2491"></a><span class="c">!!       call drawstr(&quot;100 to 200 deg.&quot;)</span>
<a name="ln-2492"></a><span class="c">!!</span>
<a name="ln-2493"></a><span class="c">!!       call polyhatch(.true.)</span>
<a name="ln-2494"></a><span class="c">!!       call hatchpitch(1.0/2.0)</span>
<a name="ln-2495"></a><span class="c">!!       call hatchang(90.0)</span>
<a name="ln-2496"></a><span class="c">!!</span>
<a name="ln-2497"></a><span class="c">!!       call linewidth(150)</span>
<a name="ln-2498"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-2499"></a><span class="c">!!       X=10; Y=0; R=5; A=-30; B=30</span>
<a name="ln-2500"></a><span class="c">!!       call sector(X,Y,R,A,B)</span>
<a name="ln-2501"></a><span class="c">!!       call move2(X,-4.0)</span>
<a name="ln-2502"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-2503"></a><span class="c">!!       call drawstr(&quot;-30 to 30 deg.&quot;)</span>
<a name="ln-2504"></a><span class="c">!!</span>
<a name="ln-2505"></a><span class="c">!!       call hatchang(30.0)</span>
<a name="ln-2506"></a><span class="c">!!       call linewidth(150)</span>
<a name="ln-2507"></a><span class="c">!!       call color(D_CYAN)</span>
<a name="ln-2508"></a><span class="c">!!       X=20; Y=0; R=5; A=45; B=-45</span>
<a name="ln-2509"></a><span class="c">!!       call sector(X,Y,R,A,B)</span>
<a name="ln-2510"></a><span class="c">!!       call move2(X, 4.0)</span>
<a name="ln-2511"></a><span class="c">!!       call linewidth(50)</span>
<a name="ln-2512"></a><span class="c">!!       call drawstr(&quot; 45 to -45 deg.&quot;)</span>
<a name="ln-2513"></a><span class="c">!!</span>
<a name="ln-2514"></a><span class="c">!!       key=getkey()</span>
<a name="ln-2515"></a><span class="c">!!       call vexit()</span>
<a name="ln-2516"></a><span class="c">!!    end program demo_sector</span>
<a name="ln-2517"></a><span class="c">!&gt;</span>
<a name="ln-2518"></a><span class="c">!!##NAME</span>
<a name="ln-2519"></a><span class="c">!!    circle(3f) - [M_draw:ARCS] Draw a circle.</span>
<a name="ln-2520"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2521"></a><span class="c">!!</span>
<a name="ln-2522"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2523"></a><span class="c">!!</span>
<a name="ln-2524"></a><span class="c">!!         subroutine circle(x, y, radius)</span>
<a name="ln-2525"></a><span class="c">!!         real,intent(in) :: x</span>
<a name="ln-2526"></a><span class="c">!!         real,intent(in) :: y</span>
<a name="ln-2527"></a><span class="c">!!         real,intent(in) :: radius</span>
<a name="ln-2528"></a><span class="c">!!</span>
<a name="ln-2529"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2530"></a><span class="c">!!</span>
<a name="ln-2531"></a><span class="c">!!    Draw a circle. x, y, and radius are values in world units.</span>
<a name="ln-2532"></a><span class="c">!!</span>
<a name="ln-2533"></a><span class="c">!!    Draw a circle using current line width and color</span>
<a name="ln-2534"></a><span class="c">!!</span>
<a name="ln-2535"></a><span class="c">!!    NOTE</span>
<a name="ln-2536"></a><span class="c">!!</span>
<a name="ln-2537"></a><span class="c">!!    circles are regarded as polygons, so if polyfill or polyhatch has been</span>
<a name="ln-2538"></a><span class="c">!!    called with .true., the circle will be filled or hatched accordingly.</span>
<a name="ln-2539"></a><span class="c">!!</span>
<a name="ln-2540"></a><span class="c">!!##OPTIONS</span>
<a name="ln-2541"></a><span class="c">!!    X,Y        Coordinates for the center of the circle</span>
<a name="ln-2542"></a><span class="c">!!    RADIUS     Radius of the circle</span>
<a name="ln-2543"></a><span class="c">!!</span>
<a name="ln-2544"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2545"></a><span class="c">!!</span>
<a name="ln-2546"></a><span class="c">!!   Sample program:</span>
<a name="ln-2547"></a><span class="c">!!</span>
<a name="ln-2548"></a><span class="c">!!    program demo_circle</span>
<a name="ln-2549"></a><span class="c">!!       use M_draw</span>
<a name="ln-2550"></a><span class="c">!!       use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2551"></a><span class="c">!!       use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2552"></a><span class="c">!!       use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2553"></a><span class="c">!!       implicit none</span>
<a name="ln-2554"></a><span class="c">!!       real :: b=0.5</span>
<a name="ln-2555"></a><span class="c">!!       real :: R=5</span>
<a name="ln-2556"></a><span class="c">!!       integer :: ipaws</span>
<a name="ln-2557"></a><span class="c">!!    ! set up drawing surface</span>
<a name="ln-2558"></a><span class="c">!!       call prefsize(1000,200)</span>
<a name="ln-2559"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-2560"></a><span class="c">!!       call page(-25.0-b,25.0+b,-R-b,R+b)</span>
<a name="ln-2561"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-2562"></a><span class="c">!!       call color(D_CYAN)</span>
<a name="ln-2563"></a><span class="c">!!       call clear()</span>
<a name="ln-2564"></a><span class="c">!!    ! draw circles with hatching and fill</span>
<a name="ln-2565"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2566"></a><span class="c">!!       call circle(-20.0,0.0, R)</span>
<a name="ln-2567"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-2568"></a><span class="c">!!       call circle(-10.0,0.0, R)</span>
<a name="ln-2569"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-2570"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-2571"></a><span class="c">!!       call circle(0.0,0.0,R)</span>
<a name="ln-2572"></a><span class="c">!!       call linewidth(20)</span>
<a name="ln-2573"></a><span class="c">!!       call polyhatch(.true.)</span>
<a name="ln-2574"></a><span class="c">!!       call hatchpitch(1.0/2.0)</span>
<a name="ln-2575"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-2576"></a><span class="c">!!       call circle(10.0,0.0,R)</span>
<a name="ln-2577"></a><span class="c">!!    ! layer calls to get a filled crosshatched circle</span>
<a name="ln-2578"></a><span class="c">!!    ! first a solid colored circle</span>
<a name="ln-2579"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-2580"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-2581"></a><span class="c">!!       call circle(20.0,0.0,R)</span>
<a name="ln-2582"></a><span class="c">!!</span>
<a name="ln-2583"></a><span class="c">!!    ! draw hatch lines at 45 degrees</span>
<a name="ln-2584"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-2585"></a><span class="c">!!       call linewidth(80)</span>
<a name="ln-2586"></a><span class="c">!!       call polyhatch(.true.)</span>
<a name="ln-2587"></a><span class="c">!!       call hatchpitch(2.0/3.0)</span>
<a name="ln-2588"></a><span class="c">!!       call hatchang(45.0)</span>
<a name="ln-2589"></a><span class="c">!!       call circle(20.0,0.0,R)</span>
<a name="ln-2590"></a><span class="c">!!    ! draw hatch lines at -45 degrees</span>
<a name="ln-2591"></a><span class="c">!!       call hatchang(-45.0)</span>
<a name="ln-2592"></a><span class="c">!!       call circle(20.0,0.0,R)</span>
<a name="ln-2593"></a><span class="c">!!</span>
<a name="ln-2594"></a><span class="c">!!    ! outline circle with a thick border</span>
<a name="ln-2595"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2596"></a><span class="c">!!       call linewidth(160)</span>
<a name="ln-2597"></a><span class="c">!!       call polyhatch(.false.)</span>
<a name="ln-2598"></a><span class="c">!!       call circle(20.0,0.0,R)</span>
<a name="ln-2599"></a><span class="c">!!</span>
<a name="ln-2600"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-2601"></a><span class="c">!!    ! exit graphics mode</span>
<a name="ln-2602"></a><span class="c">!!       call vexit()</span>
<a name="ln-2603"></a><span class="c">!!    end program demo_circle</span>
<a name="ln-2604"></a><span class="c">!&gt;</span>
<a name="ln-2605"></a><span class="c">!!##NAME</span>
<a name="ln-2606"></a><span class="c">!!    point(3f) - [M_draw:POINT] Draw a point at x, y, z</span>
<a name="ln-2607"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2608"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2609"></a><span class="c">!!</span>
<a name="ln-2610"></a><span class="c">!!         subroutine point(x, y, z)</span>
<a name="ln-2611"></a><span class="c">!!         real,intent(in) :: x, y, z</span>
<a name="ln-2612"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2613"></a><span class="c">!!    Draw a point at x, y, z. The size of the point is not affected by</span>
<a name="ln-2614"></a><span class="c">!!    perspective. Draw a polygon if you want perspective to be applied.</span>
<a name="ln-2615"></a><span class="c">!!    The size of the point is controlled by the current linewidth.</span>
<a name="ln-2616"></a><span class="c">!!</span>
<a name="ln-2617"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2618"></a><span class="c">!!</span>
<a name="ln-2619"></a><span class="c">!!   Sample program:</span>
<a name="ln-2620"></a><span class="c">!!</span>
<a name="ln-2621"></a><span class="c">!!    program demo_point</span>
<a name="ln-2622"></a><span class="c">!!    use M_draw</span>
<a name="ln-2623"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2624"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2625"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2626"></a><span class="c">!!    implicit none</span>
<a name="ln-2627"></a><span class="c">!!    integer :: i</span>
<a name="ln-2628"></a><span class="c">!!    integer :: ikey</span>
<a name="ln-2629"></a><span class="c">!!       call prefsize(1000,200)</span>
<a name="ln-2630"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-2631"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-2632"></a><span class="c">!!       call clear()</span>
<a name="ln-2633"></a><span class="c">!!       call page(-25.0, 25.0, -5.0, 5.0)</span>
<a name="ln-2634"></a><span class="c">!!</span>
<a name="ln-2635"></a><span class="c">!!       ! draw points using various linewidths and colors</span>
<a name="ln-2636"></a><span class="c">!!       do i=1,300</span>
<a name="ln-2637"></a><span class="c">!!          call randpoint()</span>
<a name="ln-2638"></a><span class="c">!!       enddo</span>
<a name="ln-2639"></a><span class="c">!!</span>
<a name="ln-2640"></a><span class="c">!!       ikey=getkey()</span>
<a name="ln-2641"></a><span class="c">!!       call vexit()</span>
<a name="ln-2642"></a><span class="c">!!</span>
<a name="ln-2643"></a><span class="c">!!    contains</span>
<a name="ln-2644"></a><span class="c">!!       subroutine randpoint()</span>
<a name="ln-2645"></a><span class="c">!!          real :: r1, r2</span>
<a name="ln-2646"></a><span class="c">!!          call random_number(r1)</span>
<a name="ln-2647"></a><span class="c">!!          call random_number(r2)</span>
<a name="ln-2648"></a><span class="c">!!          call linewidth(int(r1*500+200))</span>
<a name="ln-2649"></a><span class="c">!!          call color(nint(r2*7))</span>
<a name="ln-2650"></a><span class="c">!!          call point(r1*50.0-25.0,r2*10.0-5.0,0.0)</span>
<a name="ln-2651"></a><span class="c">!!       end subroutine randpoint</span>
<a name="ln-2652"></a><span class="c">!!</span>
<a name="ln-2653"></a><span class="c">!!    end program demo_point</span>
<a name="ln-2654"></a><span class="c">!&gt;</span>
<a name="ln-2655"></a><span class="c">!!##NAME</span>
<a name="ln-2656"></a><span class="c">!!    point2(3f) - [M_draw:POINT] Draw a point at x, y.</span>
<a name="ln-2657"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2658"></a><span class="c">!!</span>
<a name="ln-2659"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2660"></a><span class="c">!!</span>
<a name="ln-2661"></a><span class="c">!!         subroutine point2(x, y)</span>
<a name="ln-2662"></a><span class="c">!!         real,intent(in) :: x, y</span>
<a name="ln-2663"></a><span class="c">!!</span>
<a name="ln-2664"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2665"></a><span class="c">!!    Draw a point at x, y. Points are device-dependent and may not appear</span>
<a name="ln-2666"></a><span class="c">!!    at all. Generally points are drawn with the current color as a circle</span>
<a name="ln-2667"></a><span class="c">!!    with a diameter equal to the current linewidth.</span>
<a name="ln-2668"></a><span class="c">!!</span>
<a name="ln-2669"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2670"></a><span class="c">!!</span>
<a name="ln-2671"></a><span class="c">!!   Sample program:</span>
<a name="ln-2672"></a><span class="c">!!</span>
<a name="ln-2673"></a><span class="c">!!    program demo_point2</span>
<a name="ln-2674"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-2675"></a><span class="c">!!    implicit none</span>
<a name="ln-2676"></a><span class="c">!!    integer :: i</span>
<a name="ln-2677"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-2678"></a><span class="c">!!    call prefsize(300,300)</span>
<a name="ln-2679"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-2680"></a><span class="c">!!    call ortho2(0.0, 20.0, 0.0, 20.0)</span>
<a name="ln-2681"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-2682"></a><span class="c">!!    do i=1,20</span>
<a name="ln-2683"></a><span class="c">!!       call linewidth(20*i)</span>
<a name="ln-2684"></a><span class="c">!!       call point2(real(i),real(i))</span>
<a name="ln-2685"></a><span class="c">!!    enddo</span>
<a name="ln-2686"></a><span class="c">!!    ipaws=getkey()</span>
<a name="ln-2687"></a><span class="c">!!    call vexit()</span>
<a name="ln-2688"></a><span class="c">!!    end program demo_point2</span>
<a name="ln-2689"></a><span class="c">!&gt;</span>
<a name="ln-2690"></a><span class="c">!!##NAME</span>
<a name="ln-2691"></a><span class="c">!!    curvebasis(3f) - [M_draw:CURVE] Define a basis matrix for a curve.</span>
<a name="ln-2692"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2693"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2694"></a><span class="c">!!</span>
<a name="ln-2695"></a><span class="c">!!          subroutine curvebasis(basis)</span>
<a name="ln-2696"></a><span class="c">!!          real,intent(in) :: basis(4,4)</span>
<a name="ln-2697"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2698"></a><span class="c">!!    Define a basis matrix for a curve.</span>
<a name="ln-2699"></a><span class="c">!&gt;</span>
<a name="ln-2700"></a><span class="c">!!##NAME</span>
<a name="ln-2701"></a><span class="c">!!    curveprecision(3f) - [M_draw:CURVE] Define number of line segments used to draw a curve.</span>
<a name="ln-2702"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2703"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2704"></a><span class="c">!!</span>
<a name="ln-2705"></a><span class="c">!!          subroutine curveprecision(nsegs)</span>
<a name="ln-2706"></a><span class="c">!!          integer nsegs</span>
<a name="ln-2707"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2708"></a><span class="c">!!    Define the number of line segments used to draw a curve.</span>
<a name="ln-2709"></a><span class="c">!&gt;</span>
<a name="ln-2710"></a><span class="c">!!##NAME</span>
<a name="ln-2711"></a><span class="c">!!    rcurve(3f) - [M_draw:CURVE] Draw a rational curve.</span>
<a name="ln-2712"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2713"></a><span class="c">!!</span>
<a name="ln-2714"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2715"></a><span class="c">!!</span>
<a name="ln-2716"></a><span class="c">!!          subroutine rcurve(geom)</span>
<a name="ln-2717"></a><span class="c">!!          real geom(4,4)</span>
<a name="ln-2718"></a><span class="c">!!</span>
<a name="ln-2719"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2720"></a><span class="c">!!    Draw a rational curve.</span>
<a name="ln-2721"></a><span class="c">!&gt;</span>
<a name="ln-2722"></a><span class="c">!!##NAME</span>
<a name="ln-2723"></a><span class="c">!!    curve(3f) - [M_draw:CURVE] Draw a curve.</span>
<a name="ln-2724"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2725"></a><span class="c">!!</span>
<a name="ln-2726"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2727"></a><span class="c">!!</span>
<a name="ln-2728"></a><span class="c">!!    subroutine curve(geom)</span>
<a name="ln-2729"></a><span class="c">!!    real geom(3,4)</span>
<a name="ln-2730"></a><span class="c">!!</span>
<a name="ln-2731"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2732"></a><span class="c">!!    Draw a curve.</span>
<a name="ln-2733"></a><span class="c">!!</span>
<a name="ln-2734"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2735"></a><span class="c">!!</span>
<a name="ln-2736"></a><span class="c">!!   Sample Program:</span>
<a name="ln-2737"></a><span class="c">!!</span>
<a name="ln-2738"></a><span class="c">!!    program demo_curve</span>
<a name="ln-2739"></a><span class="c">!!    !</span>
<a name="ln-2740"></a><span class="c">!!    !      using curves</span>
<a name="ln-2741"></a><span class="c">!!    !</span>
<a name="ln-2742"></a><span class="c">!!    use M_draw</span>
<a name="ln-2743"></a><span class="c">!!</span>
<a name="ln-2744"></a><span class="c">!!    integer i</span>
<a name="ln-2745"></a><span class="c">!!    character(len=50) :: buf</span>
<a name="ln-2746"></a><span class="c">!!    real bezier(4, 4), cardinal(4, 4), bspline(4, 4)</span>
<a name="ln-2747"></a><span class="c">!!    real geom1(3, 4), geom2(3, 6)</span>
<a name="ln-2748"></a><span class="c">!!    !</span>
<a name="ln-2749"></a><span class="c">!!    ! curve basis types</span>
<a name="ln-2750"></a><span class="c">!!    !</span>
<a name="ln-2751"></a><span class="c">!!    data bezier /                                            &amp;</span>
<a name="ln-2752"></a><span class="c">!!    &amp;          -1.0,   3.0,    -3.0,   1.0,                  &amp;</span>
<a name="ln-2753"></a><span class="c">!!    &amp;          3.0,    -6.0,   3.0,    0.0,                  &amp;</span>
<a name="ln-2754"></a><span class="c">!!    &amp;          -3.0,   3.0,    0.0,    0.0,                  &amp;</span>
<a name="ln-2755"></a><span class="c">!!    &amp;          1.0,    0.0,    0.0,    0.0                   &amp;</span>
<a name="ln-2756"></a><span class="c">!!    &amp;  /</span>
<a name="ln-2757"></a><span class="c">!!</span>
<a name="ln-2758"></a><span class="c">!!    data cardinal /                                          &amp;</span>
<a name="ln-2759"></a><span class="c">!!    &amp;          -0.5,   1.5,    -1.5,   0.5,                  &amp;</span>
<a name="ln-2760"></a><span class="c">!!    &amp;          1.0,    -2.5,   2.0,    -0.5,                 &amp;</span>
<a name="ln-2761"></a><span class="c">!!    &amp;          -0.5,   0.0,    0.5,    0.0,                  &amp;</span>
<a name="ln-2762"></a><span class="c">!!    &amp;          0.0,    1.0,    0.0,    0.0                   &amp;</span>
<a name="ln-2763"></a><span class="c">!!    &amp;  /</span>
<a name="ln-2764"></a><span class="c">!!</span>
<a name="ln-2765"></a><span class="c">!!    data bspline /                                           &amp;</span>
<a name="ln-2766"></a><span class="c">!!    &amp;          -0.166666,     0.5,     -0.5,     0.166666,   &amp;</span>
<a name="ln-2767"></a><span class="c">!!    &amp;           0.5,         -1.0,      0.5,     0.0,        &amp;</span>
<a name="ln-2768"></a><span class="c">!!    &amp;          -0.5,          0.0,      0.5,     0.0,        &amp;</span>
<a name="ln-2769"></a><span class="c">!!    &amp;           0.166666,     0.666666, 0.166666, 0.0        &amp;</span>
<a name="ln-2770"></a><span class="c">!!    &amp;  /</span>
<a name="ln-2771"></a><span class="c">!!</span>
<a name="ln-2772"></a><span class="c">!!    !</span>
<a name="ln-2773"></a><span class="c">!!    ! Geometry matrix to demonstrate basic spline segments</span>
<a name="ln-2774"></a><span class="c">!!    !</span>
<a name="ln-2775"></a><span class="c">!!    data geom1 /                      &amp;</span>
<a name="ln-2776"></a><span class="c">!!    &amp;           -180.0, 10.0, 0.0,    &amp;</span>
<a name="ln-2777"></a><span class="c">!!    &amp;           -100.0, 110.0, 0.0,   &amp;</span>
<a name="ln-2778"></a><span class="c">!!    &amp;           -100.0, -90.0, 0.0,   &amp;</span>
<a name="ln-2779"></a><span class="c">!!    &amp;           0.0, 50.0, 0.0        &amp;</span>
<a name="ln-2780"></a><span class="c">!!    &amp;  /</span>
<a name="ln-2781"></a><span class="c">!!</span>
<a name="ln-2782"></a><span class="c">!!    !</span>
<a name="ln-2783"></a><span class="c">!!    ! Geometry matrix to demonstrate overlapping control points to</span>
<a name="ln-2784"></a><span class="c">!!    ! produce continuous (Well, except for the bezier ones) curves</span>
<a name="ln-2785"></a><span class="c">!!    ! from spline segments</span>
<a name="ln-2786"></a><span class="c">!!    !</span>
<a name="ln-2787"></a><span class="c">!!    data geom2 /                      &amp;</span>
<a name="ln-2788"></a><span class="c">!!    &amp;          200.0, 480.0, 0.0,     &amp;</span>
<a name="ln-2789"></a><span class="c">!!    &amp;          380.0, 180.0, 0.0,     &amp;</span>
<a name="ln-2790"></a><span class="c">!!    &amp;          250.0, 430.0, 0.0,     &amp;</span>
<a name="ln-2791"></a><span class="c">!!    &amp;          100.0, 130.0, 0.0,     &amp;</span>
<a name="ln-2792"></a><span class="c">!!    &amp;          50.0,  280.0, 0.0,     &amp;</span>
<a name="ln-2793"></a><span class="c">!!    &amp;          150.0, 380.0, 0.0      &amp;</span>
<a name="ln-2794"></a><span class="c">!!    &amp;  /</span>
<a name="ln-2795"></a><span class="c">!!</span>
<a name="ln-2796"></a><span class="c">!!</span>
<a name="ln-2797"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-2798"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios) buf</span>
<a name="ln-2799"></a><span class="c">!!    if(ios.ne.0)buf=&#39; &#39;</span>
<a name="ln-2800"></a><span class="c">!!</span>
<a name="ln-2801"></a><span class="c">!!    call vinit(buf)</span>
<a name="ln-2802"></a><span class="c">!!</span>
<a name="ln-2803"></a><span class="c">!!    call ortho2(-200.0, 400.0, -100.0, 500.0)</span>
<a name="ln-2804"></a><span class="c">!!</span>
<a name="ln-2805"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-2806"></a><span class="c">!!    call clear()</span>
<a name="ln-2807"></a><span class="c">!!</span>
<a name="ln-2808"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-2809"></a><span class="c">!!</span>
<a name="ln-2810"></a><span class="c">!!    call textsize(10.0, 10.0)</span>
<a name="ln-2811"></a><span class="c">!!    !</span>
<a name="ln-2812"></a><span class="c">!!    ! label the control points in geom1</span>
<a name="ln-2813"></a><span class="c">!!    !</span>
<a name="ln-2814"></a><span class="c">!!    do i = 1, 4</span>
<a name="ln-2815"></a><span class="c">!!       call move2(geom1(1, i), geom1(2, i))</span>
<a name="ln-2816"></a><span class="c">!!       write(buf, &#39;(i1)&#39;)i</span>
<a name="ln-2817"></a><span class="c">!!       call drawstr(buf)</span>
<a name="ln-2818"></a><span class="c">!!    enddo</span>
<a name="ln-2819"></a><span class="c">!!    !</span>
<a name="ln-2820"></a><span class="c">!!    ! label the control points in geom2</span>
<a name="ln-2821"></a><span class="c">!!    !</span>
<a name="ln-2822"></a><span class="c">!!    do i = 1, 6</span>
<a name="ln-2823"></a><span class="c">!!       call move2(geom2(1, i), geom2(2, i))</span>
<a name="ln-2824"></a><span class="c">!!       write(buf, &#39;(i1)&#39;)i</span>
<a name="ln-2825"></a><span class="c">!!       call drawstr(buf)</span>
<a name="ln-2826"></a><span class="c">!!    enddo</span>
<a name="ln-2827"></a><span class="c">!!    !</span>
<a name="ln-2828"></a><span class="c">!!    ! scale the current font so that 30 of the largest characters</span>
<a name="ln-2829"></a><span class="c">!!    ! in the current font will fit in a region 300 world units wide,</span>
<a name="ln-2830"></a><span class="c">!!    ! 20 high.</span>
<a name="ln-2831"></a><span class="c">!!    !</span>
<a name="ln-2832"></a><span class="c">!!    call boxfit(300.0, 20.0, 30)</span>
<a name="ln-2833"></a><span class="c">!!</span>
<a name="ln-2834"></a><span class="c">!!    !</span>
<a name="ln-2835"></a><span class="c">!!    ! set the number of line segments appearing in each curve to 20</span>
<a name="ln-2836"></a><span class="c">!!    !</span>
<a name="ln-2837"></a><span class="c">!!    call curveprecision(20)</span>
<a name="ln-2838"></a><span class="c">!!</span>
<a name="ln-2839"></a><span class="c">!!    !</span>
<a name="ln-2840"></a><span class="c">!!    ! copy the bezier basis matrix into the curve basis matrix.</span>
<a name="ln-2841"></a><span class="c">!!    !</span>
<a name="ln-2842"></a><span class="c">!!    call curvebasis(bezier)</span>
<a name="ln-2843"></a><span class="c">!!</span>
<a name="ln-2844"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-2845"></a><span class="c">!!</span>
<a name="ln-2846"></a><span class="c">!!    !</span>
<a name="ln-2847"></a><span class="c">!!    ! draw a curve using the current basis matrix (bezier in this case)</span>
<a name="ln-2848"></a><span class="c">!!    ! and the control points in geom1</span>
<a name="ln-2849"></a><span class="c">!!    !</span>
<a name="ln-2850"></a><span class="c">!!    call curve(geom1)</span>
<a name="ln-2851"></a><span class="c">!!</span>
<a name="ln-2852"></a><span class="c">!!    call move2(70.0, 60.0)</span>
<a name="ln-2853"></a><span class="c">!!    call drawstr(&#39;Bezier Curve Segment&#39;)</span>
<a name="ln-2854"></a><span class="c">!!</span>
<a name="ln-2855"></a><span class="c">!!    call move2(-190.0, 450.0)</span>
<a name="ln-2856"></a><span class="c">!!    call drawstr(&#39;Three overlapping Bezier Curves&#39;)</span>
<a name="ln-2857"></a><span class="c">!!</span>
<a name="ln-2858"></a><span class="c">!!    !</span>
<a name="ln-2859"></a><span class="c">!!    ! curven draws overlapping curve segments according to geom2, the</span>
<a name="ln-2860"></a><span class="c">!!    ! number of curve segments drawn is three less than the number of</span>
<a name="ln-2861"></a><span class="c">!!    ! points passed, assuming there are a least four points in the</span>
<a name="ln-2862"></a><span class="c">!!    ! geometry matrix (in this case geom2). This call will draw 3</span>
<a name="ln-2863"></a><span class="c">!!    ! overlapping curve segments in the current basis matrix - still</span>
<a name="ln-2864"></a><span class="c">!!    ! bezier.</span>
<a name="ln-2865"></a><span class="c">!!    !</span>
<a name="ln-2866"></a><span class="c">!!    call curven(6, geom2)</span>
<a name="ln-2867"></a><span class="c">!!</span>
<a name="ln-2868"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-2869"></a><span class="c">!!    !</span>
<a name="ln-2870"></a><span class="c">!!    ! load in the cardinal basis matrix</span>
<a name="ln-2871"></a><span class="c">!!    !</span>
<a name="ln-2872"></a><span class="c">!!    call curvebasis(cardinal)</span>
<a name="ln-2873"></a><span class="c">!!</span>
<a name="ln-2874"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-2875"></a><span class="c">!!</span>
<a name="ln-2876"></a><span class="c">!!    call move2(70.0, 10.0)</span>
<a name="ln-2877"></a><span class="c">!!    call drawstr(&#39;Cardinal Curve Segment&#39;)</span>
<a name="ln-2878"></a><span class="c">!!    !</span>
<a name="ln-2879"></a><span class="c">!!    ! plot out a curve segment using the cardinal basis matrix</span>
<a name="ln-2880"></a><span class="c">!!    !</span>
<a name="ln-2881"></a><span class="c">!!    call curve(geom1)</span>
<a name="ln-2882"></a><span class="c">!!</span>
<a name="ln-2883"></a><span class="c">!!    call move2(-190.0, 400.0)</span>
<a name="ln-2884"></a><span class="c">!!    call drawstr(&#39;Three overlapping Cardinal Curves&#39;)</span>
<a name="ln-2885"></a><span class="c">!!    !</span>
<a name="ln-2886"></a><span class="c">!!    ! now draw a bunch of them again.</span>
<a name="ln-2887"></a><span class="c">!!    !</span>
<a name="ln-2888"></a><span class="c">!!    call curven(6, geom2)</span>
<a name="ln-2889"></a><span class="c">!!</span>
<a name="ln-2890"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-2891"></a><span class="c">!!    !</span>
<a name="ln-2892"></a><span class="c">!!    ! change the basis matrix again</span>
<a name="ln-2893"></a><span class="c">!!    !</span>
<a name="ln-2894"></a><span class="c">!!    call curvebasis(bspline)</span>
<a name="ln-2895"></a><span class="c">!!</span>
<a name="ln-2896"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-2897"></a><span class="c">!!</span>
<a name="ln-2898"></a><span class="c">!!    call move2(70.0, -40.0)</span>
<a name="ln-2899"></a><span class="c">!!    call drawstr(&#39;Bspline Curve Segment&#39;)</span>
<a name="ln-2900"></a><span class="c">!!    !</span>
<a name="ln-2901"></a><span class="c">!!    ! now draw our curve segment in the new basis...</span>
<a name="ln-2902"></a><span class="c">!!    !</span>
<a name="ln-2903"></a><span class="c">!!    call curve(geom1)</span>
<a name="ln-2904"></a><span class="c">!!</span>
<a name="ln-2905"></a><span class="c">!!    call move2(-190.0, 350.0)</span>
<a name="ln-2906"></a><span class="c">!!    call drawstr(&#39;Three overlapping Bspline Curves&#39;)</span>
<a name="ln-2907"></a><span class="c">!!    !</span>
<a name="ln-2908"></a><span class="c">!!    ! ...and do some overlapping ones</span>
<a name="ln-2909"></a><span class="c">!!    !</span>
<a name="ln-2910"></a><span class="c">!!    call curven(6, geom2)</span>
<a name="ln-2911"></a><span class="c">!!</span>
<a name="ln-2912"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-2913"></a><span class="c">!!</span>
<a name="ln-2914"></a><span class="c">!!    call vexit()</span>
<a name="ln-2915"></a><span class="c">!!</span>
<a name="ln-2916"></a><span class="c">!!    end program demo_curve</span>
<a name="ln-2917"></a><span class="c">!&gt;</span>
<a name="ln-2918"></a><span class="c">!!##NAME</span>
<a name="ln-2919"></a><span class="c">!!    curven(3f) - [M_draw:CURVE] Draw n-3 overlapping curve segments. Note: n must be at least 4.</span>
<a name="ln-2920"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2921"></a><span class="c">!!</span>
<a name="ln-2922"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2923"></a><span class="c">!!</span>
<a name="ln-2924"></a><span class="c">!!          subroutine curven(n, geom)</span>
<a name="ln-2925"></a><span class="c">!!          integer n</span>
<a name="ln-2926"></a><span class="c">!!          real geom(3,n)</span>
<a name="ln-2927"></a><span class="c">!!</span>
<a name="ln-2928"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2929"></a><span class="c">!!    Draw n-3 overlapping curve segments. Note: n must be at least 4.</span>
<a name="ln-2930"></a><span class="c">!&gt;</span>
<a name="ln-2931"></a><span class="c">!!</span>
<a name="ln-2932"></a><span class="c">!!##NAME</span>
<a name="ln-2933"></a><span class="c">!!    font(3f) - [M_draw:TEXT] Set the current font by name</span>
<a name="ln-2934"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-2935"></a><span class="c">!!</span>
<a name="ln-2936"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-2937"></a><span class="c">!!</span>
<a name="ln-2938"></a><span class="c">!!         subroutine font(fontname)</span>
<a name="ln-2939"></a><span class="c">!!         character(len=*),intent(in) :: fontname</span>
<a name="ln-2940"></a><span class="c">!!</span>
<a name="ln-2941"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-2942"></a><span class="c">!!    Set the current font.</span>
<a name="ln-2943"></a><span class="c">!!</span>
<a name="ln-2944"></a><span class="c">!!    M_draw supports hardware and software fonts. The software fonts are based</span>
<a name="ln-2945"></a><span class="c">!!    on the character set digitized by Dr Allen V. Hershey while working at</span>
<a name="ln-2946"></a><span class="c">!!    the U. S. National Bureau of Standards. Exactly what hardware fonts are</span>
<a name="ln-2947"></a><span class="c">!!    supported depends on the device, but it is guaranteed that the names</span>
<a name="ln-2948"></a><span class="c">!!    &quot;large&quot; and &quot;small&quot; will result in something readable. For X11 displays</span>
<a name="ln-2949"></a><span class="c">!!    the default large and small fonts used by the program can be overridden</span>
<a name="ln-2950"></a><span class="c">!!    by placing the following defaults in the ~/.Xdefaults file:</span>
<a name="ln-2951"></a><span class="c">!!</span>
<a name="ln-2952"></a><span class="c">!!      draw.smallfont: X11-font-name</span>
<a name="ln-2953"></a><span class="c">!!      draw.largefont: X11-font-name</span>
<a name="ln-2954"></a><span class="c">!!</span>
<a name="ln-2955"></a><span class="c">!!    It is noted here that hardware text is always assumed to be drawn</span>
<a name="ln-2956"></a><span class="c">!!    parallel to the (x, y) plane, using whatever the current z coordinate</span>
<a name="ln-2957"></a><span class="c">!!    is. The following software fonts are supported:</span>
<a name="ln-2958"></a><span class="c">!!</span>
<a name="ln-2959"></a><span class="c">!!       astrology       cursive         cyrillic        futura.l</span>
<a name="ln-2960"></a><span class="c">!!       futura.m        gothic.eng      gothic.ger      gothic.ita</span>
<a name="ln-2961"></a><span class="c">!!       greek           markers         math.low        math.upp</span>
<a name="ln-2962"></a><span class="c">!!       meteorology     music           script          symbolic</span>
<a name="ln-2963"></a><span class="c">!!       times.g         times.i         times.ib        times.r</span>
<a name="ln-2964"></a><span class="c">!!       times.rb        japanese</span>
<a name="ln-2965"></a><span class="c">!!</span>
<a name="ln-2966"></a><span class="c">!!    A markers font &quot;markers&quot; is also provided for doing markers - you need</span>
<a name="ln-2967"></a><span class="c">!!    to have centertext mode on for this to give sensible results when placing</span>
<a name="ln-2968"></a><span class="c">!!    the markers.</span>
<a name="ln-2969"></a><span class="c">!!</span>
<a name="ln-2970"></a><span class="c">!!    If the environment variable &quot;M_DRAW_FONTPATH&quot; is set M_draw looks for the software</span>
<a name="ln-2971"></a><span class="c">!!    fonts in the directory given by this value.</span>
<a name="ln-2972"></a><span class="c">!!</span>
<a name="ln-2973"></a><span class="c">!!    WHEN ASKED FOR NON-EXISTENT FONT NAMES, FONT(3f) STOPS THE PROGRAM.</span>
<a name="ln-2974"></a><span class="c">!!</span>
<a name="ln-2975"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-2976"></a><span class="c">!!</span>
<a name="ln-2977"></a><span class="c">!!   Sample Program:</span>
<a name="ln-2978"></a><span class="c">!!</span>
<a name="ln-2979"></a><span class="c">!!    program demo_font</span>
<a name="ln-2980"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-2981"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-2982"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-2983"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-2984"></a><span class="c">!!    real    :: left</span>
<a name="ln-2985"></a><span class="c">!!    real    :: baseline=80.0</span>
<a name="ln-2986"></a><span class="c">!!    integer :: icolor=1</span>
<a name="ln-2987"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-2988"></a><span class="c">!!       !! set up drawing surface</span>
<a name="ln-2989"></a><span class="c">!!       call prefsize(400, 400)</span>
<a name="ln-2990"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-2991"></a><span class="c">!!       call page(-100.0, 100.0, -100.0, 100.0)</span>
<a name="ln-2992"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-2993"></a><span class="c">!!       call clear()</span>
<a name="ln-2994"></a><span class="c">!!       call textsize(10.0, 10.0)</span>
<a name="ln-2995"></a><span class="c">!!       !! place a vertical line along the edge</span>
<a name="ln-2996"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-2997"></a><span class="c">!!       call move2(-90.0, -90.0)</span>
<a name="ln-2998"></a><span class="c">!!       call draw2(-90.0, 90.0)</span>
<a name="ln-2999"></a><span class="c">!!       !! make a centered title at top a bit bolder and bigger</span>
<a name="ln-3000"></a><span class="c">!!       call xcentertext()</span>
<a name="ln-3001"></a><span class="c">!!       call textsize(13.0, 13.0)</span>
<a name="ln-3002"></a><span class="c">!!       call linewidth(90)</span>
<a name="ln-3003"></a><span class="c">!!       left=0</span>
<a name="ln-3004"></a><span class="c">!!       call nextline(&#39;Font Samples&#39;)</span>
<a name="ln-3005"></a><span class="c">!!       !! print the font samples</span>
<a name="ln-3006"></a><span class="c">!!       left=-90</span>
<a name="ln-3007"></a><span class="c">!!       call linewidth(40)</span>
<a name="ln-3008"></a><span class="c">!!       call textsize(10.0, 10.0)</span>
<a name="ln-3009"></a><span class="c">!!       call centertext(.false.)</span>
<a name="ln-3010"></a><span class="c">!!       icolor=icolor-1</span>
<a name="ln-3011"></a><span class="c">!!       call nextline(&#39;DEFAULT (ie. futura.l)&#39;)</span>
<a name="ln-3012"></a><span class="c">!!       icolor=icolor-1</span>
<a name="ln-3013"></a><span class="c">!!       call nextline(&#39;now call font(3f) ...&#39;)</span>
<a name="ln-3014"></a><span class="c">!!       call nextline(&#39;A nice SIMPLEX font, futura.l&#39;)</span>
<a name="ln-3015"></a><span class="c">!!       call nextline(&#39;A COMPLEX font, times.r&#39;)</span>
<a name="ln-3016"></a><span class="c">!!       call nextline(&#39;ITALIC letters,  times.i&#39;)</span>
<a name="ln-3017"></a><span class="c">!!       call nextline(&#39;DUPLEX is in between, futura.m&#39;)</span>
<a name="ln-3018"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-3019"></a><span class="c">!!       call vexit()</span>
<a name="ln-3020"></a><span class="c">!!    contains</span>
<a name="ln-3021"></a><span class="c">!!    subroutine nextline(string)</span>
<a name="ln-3022"></a><span class="c">!!    character(len=*) :: string</span>
<a name="ln-3023"></a><span class="c">!!    !! reduce some duplicate code; very specific to this EXAMPLE</span>
<a name="ln-3024"></a><span class="c">!!       integer :: iend</span>
<a name="ln-3025"></a><span class="c">!!       iend=index(string,&#39;,&#39;)  ! if comma, assume font name found</span>
<a name="ln-3026"></a><span class="c">!!       write(*,*)&#39;FONT=&#39;,string(iend+1:),iend</span>
<a name="ln-3027"></a><span class="c">!!       if(iend.ne.0)call font(trim(adjustl(string(iend+1:)))) ! change font</span>
<a name="ln-3028"></a><span class="c">!!       icolor=icolor+1         ! set pen color</span>
<a name="ln-3029"></a><span class="c">!!       call color(icolor)</span>
<a name="ln-3030"></a><span class="c">!!       baseline=baseline-20    ! move down before drawing line</span>
<a name="ln-3031"></a><span class="c">!!       call move2(left, baseline)</span>
<a name="ln-3032"></a><span class="c">!!       call drawstr(string)    ! draw string</span>
<a name="ln-3033"></a><span class="c">!!    end subroutine nextline</span>
<a name="ln-3034"></a><span class="c">!!</span>
<a name="ln-3035"></a><span class="c">!!    end program demo_font</span>
<a name="ln-3036"></a><span class="c">!&gt;</span>
<a name="ln-3037"></a><span class="c">!!##NAME</span>
<a name="ln-3038"></a><span class="c">!!    numchars(3f) - [M_draw:TEXT] Return number of characters in the current SOFTWARE font.</span>
<a name="ln-3039"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3040"></a><span class="c">!!</span>
<a name="ln-3041"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3042"></a><span class="c">!!</span>
<a name="ln-3043"></a><span class="c">!!         integer function numchars()</span>
<a name="ln-3044"></a><span class="c">!!</span>
<a name="ln-3045"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3046"></a><span class="c">!!    Return the number of characters in the current font. Applicable only to</span>
<a name="ln-3047"></a><span class="c">!!    software fonts.</span>
<a name="ln-3048"></a><span class="c">!&gt;</span>
<a name="ln-3049"></a><span class="c">!!##NAME</span>
<a name="ln-3050"></a><span class="c">!!    textsize(3f) - [M_draw:TEXT] Set text size of a character in the current SOFTWARE font in world units.</span>
<a name="ln-3051"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3052"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3053"></a><span class="c">!!</span>
<a name="ln-3054"></a><span class="c">!!         subroutine textsize(width, height)</span>
<a name="ln-3055"></a><span class="c">!!         real,intent(in) :: width</span>
<a name="ln-3056"></a><span class="c">!!         real,intent(in) :: height</span>
<a name="ln-3057"></a><span class="c">!!</span>
<a name="ln-3058"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3059"></a><span class="c">!!</span>
<a name="ln-3060"></a><span class="c">!! Set the maximum size of a character in the current font. Width and height</span>
<a name="ln-3061"></a><span class="c">!! are values in world units. This applies to software text, but may not apply</span>
<a name="ln-3062"></a><span class="c">!! to hardware fonts depending upon the output device. This must</span>
<a name="ln-3063"></a><span class="c">!! be done after the font being scaled is loaded. To keep text of different</span>
<a name="ln-3064"></a><span class="c">!! sizes aligned along the same baseline not that you typically need to</span>
<a name="ln-3065"></a><span class="c">!! subtract the descender height from the Y position</span>
<a name="ln-3066"></a><span class="c">!!</span>
<a name="ln-3067"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3068"></a><span class="c">!!</span>
<a name="ln-3069"></a><span class="c">!!   Sample program:</span>
<a name="ln-3070"></a><span class="c">!!</span>
<a name="ln-3071"></a><span class="c">!!    program demo_textsize</span>
<a name="ln-3072"></a><span class="c">!!    use M_draw</span>
<a name="ln-3073"></a><span class="c">!!    implicit none</span>
<a name="ln-3074"></a><span class="c">!!    integer :: i,ii</span>
<a name="ln-3075"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-3076"></a><span class="c">!!       !! set up long bar as plotting area</span>
<a name="ln-3077"></a><span class="c">!!       call prefsize(900,150)</span>
<a name="ln-3078"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-3079"></a><span class="c">!!       call ortho2(-30.0, 30.0, -5.0, 5.0)</span>
<a name="ln-3080"></a><span class="c">!!       call font(&#39;times.r&#39;)</span>
<a name="ln-3081"></a><span class="c">!!</span>
<a name="ln-3082"></a><span class="c">!!       call move2(-23.0,-4.5)</span>
<a name="ln-3083"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-3084"></a><span class="c">!!       call textsize(2.0,2.0)</span>
<a name="ln-3085"></a><span class="c">!!       call move2(-27.5,-3.0)</span>
<a name="ln-3086"></a><span class="c">!!       call draw2( 27.5,-3.0)</span>
<a name="ln-3087"></a><span class="c">!!       call move2(-27.5,-3.0)</span>
<a name="ln-3088"></a><span class="c">!!</span>
<a name="ln-3089"></a><span class="c">!!       do i=1,7</span>
<a name="ln-3090"></a><span class="c">!!          ii=nint((i*20)*0.30)</span>
<a name="ln-3091"></a><span class="c">!!          call linewidth(nint(ii*2.35))</span>
<a name="ln-3092"></a><span class="c">!!          call textsize(real(i),real(i))</span>
<a name="ln-3093"></a><span class="c">!!          call color(D_MAGENTA)</span>
<a name="ln-3094"></a><span class="c">!!          call drawstr(&#39;aA&#39;)</span>
<a name="ln-3095"></a><span class="c">!!       enddo</span>
<a name="ln-3096"></a><span class="c">!!</span>
<a name="ln-3097"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-3098"></a><span class="c">!!</span>
<a name="ln-3099"></a><span class="c">!!       call vexit()</span>
<a name="ln-3100"></a><span class="c">!!</span>
<a name="ln-3101"></a><span class="c">!!    end program demo_textsize</span>
<a name="ln-3102"></a><span class="c">!&gt;</span>
<a name="ln-3103"></a><span class="c">!!##NAME</span>
<a name="ln-3104"></a><span class="c">!!    textang(3f) - [M_draw:TEXT] Set the SOFTWARE text angle.</span>
<a name="ln-3105"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3106"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3107"></a><span class="c">!!</span>
<a name="ln-3108"></a><span class="c">!!         subroutine textang(ang)</span>
<a name="ln-3109"></a><span class="c">!!         real,intent(in) :: ang</span>
<a name="ln-3110"></a><span class="c">!!</span>
<a name="ln-3111"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3112"></a><span class="c">!!    Set the text angle. This angles strings and chars. This routine only</span>
<a name="ln-3113"></a><span class="c">!!    affects software text. Angle is in degrees</span>
<a name="ln-3114"></a><span class="c">!!</span>
<a name="ln-3115"></a><span class="c">!!##OPTIONS</span>
<a name="ln-3116"></a><span class="c">!!    ANG   The angle in degrees to draw text with when using drawstr(3f).</span>
<a name="ln-3117"></a><span class="c">!!          Angles are measured counterclockwise with zero degrees at the horizontal</span>
<a name="ln-3118"></a><span class="c">!!          line to the right of the original.</span>
<a name="ln-3119"></a><span class="c">!!</span>
<a name="ln-3120"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3121"></a><span class="c">!!</span>
<a name="ln-3122"></a><span class="c">!!   Sample program:</span>
<a name="ln-3123"></a><span class="c">!!</span>
<a name="ln-3124"></a><span class="c">!!    program demo_textang</span>
<a name="ln-3125"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-3126"></a><span class="c">!!    use :: M_units, only : cosd, sind</span>
<a name="ln-3127"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-3128"></a><span class="c">!!</span>
<a name="ln-3129"></a><span class="c">!!    !! set up drawing environment</span>
<a name="ln-3130"></a><span class="c">!!    call prefsize(600,600)</span>
<a name="ln-3131"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-3132"></a><span class="c">!!    call ortho2(-100.0,100.0,-100.0,100.0)</span>
<a name="ln-3133"></a><span class="c">!!    call textsize(7.0,7.0)</span>
<a name="ln-3134"></a><span class="c">!!    call linewidth(20)</span>
<a name="ln-3135"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-3136"></a><span class="c">!!    call clear()</span>
<a name="ln-3137"></a><span class="c">!!</span>
<a name="ln-3138"></a><span class="c">!!    do i=1,30</span>
<a name="ln-3139"></a><span class="c">!!       !! draw radial lines</span>
<a name="ln-3140"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3141"></a><span class="c">!!       call move2(0.0,0.0)</span>
<a name="ln-3142"></a><span class="c">!!       call draw2(100.0*cosd(i*12),100.0*sind(i*12))</span>
<a name="ln-3143"></a><span class="c">!!       !! draw rotated text</span>
<a name="ln-3144"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-3145"></a><span class="c">!!       call move2(30.0*cosd(i*12),30.0*sind(i*12))</span>
<a name="ln-3146"></a><span class="c">!!       call textang(i*12.0)</span>
<a name="ln-3147"></a><span class="c">!!       call drawstr(&#39;angled text&#39;)</span>
<a name="ln-3148"></a><span class="c">!!    enddo</span>
<a name="ln-3149"></a><span class="c">!!</span>
<a name="ln-3150"></a><span class="c">!!    ipaws=getkey()</span>
<a name="ln-3151"></a><span class="c">!!</span>
<a name="ln-3152"></a><span class="c">!!    call vexit()</span>
<a name="ln-3153"></a><span class="c">!!</span>
<a name="ln-3154"></a><span class="c">!!    end program demo_textang</span>
<a name="ln-3155"></a><span class="c">!&gt;</span>
<a name="ln-3156"></a><span class="c">!!##NAME</span>
<a name="ln-3157"></a><span class="c">!!    fixedwidth(3f) - [M_draw:TEXT] Turns fixedwidth mode on or off for SOFTWARE fonts.</span>
<a name="ln-3158"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3159"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3160"></a><span class="c">!!</span>
<a name="ln-3161"></a><span class="c">!!         subroutine fixedwidth(onoff)</span>
<a name="ln-3162"></a><span class="c">!!         logical onoff</span>
<a name="ln-3163"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3164"></a><span class="c">!!</span>
<a name="ln-3165"></a><span class="c">!!    Turns fixedwidth text on or off. .TRUE. causes all text to</span>
<a name="ln-3166"></a><span class="c">!!    be printed with a fixed width for each character. Otherwise, the text</span>
<a name="ln-3167"></a><span class="c">!!    is spaced proportionally, where each character has a unique width less</span>
<a name="ln-3168"></a><span class="c">!!    than or equal to the current fixed font width. This routine only affects</span>
<a name="ln-3169"></a><span class="c">!!    software text.</span>
<a name="ln-3170"></a><span class="c">!!</span>
<a name="ln-3171"></a><span class="c">!!    The default at program initialization is fixedwidth(.false.)</span>
<a name="ln-3172"></a><span class="c">!!</span>
<a name="ln-3173"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3174"></a><span class="c">!!</span>
<a name="ln-3175"></a><span class="c">!!   Sample program:</span>
<a name="ln-3176"></a><span class="c">!!</span>
<a name="ln-3177"></a><span class="c">!!    program demo_fixedwidth</span>
<a name="ln-3178"></a><span class="c">!!       use M_draw</span>
<a name="ln-3179"></a><span class="c">!!       implicit none</span>
<a name="ln-3180"></a><span class="c">!!       real,parameter :: x1=0.0,  x2=40.0,  y1=0.0,  y2=4.0</span>
<a name="ln-3181"></a><span class="c">!!       real,parameter :: scl=3*0.7</span>
<a name="ln-3182"></a><span class="c">!!       integer :: idum</span>
<a name="ln-3183"></a><span class="c">!!    ! set up display</span>
<a name="ln-3184"></a><span class="c">!!       call prefsize(1000,100)</span>
<a name="ln-3185"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3186"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3187"></a><span class="c">!!    ! set font appearance</span>
<a name="ln-3188"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3189"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3190"></a><span class="c">!!    ! draw a string using proportional and fixed spacing</span>
<a name="ln-3191"></a><span class="c">!!       call move2(x1+0.3,y1+0.4)</span>
<a name="ln-3192"></a><span class="c">!!       call textsize(0.8*scl,1.2*scl)</span>
<a name="ln-3193"></a><span class="c">!!       call color(1)</span>
<a name="ln-3194"></a><span class="c">!!       call fixedwidth(.false.)</span>
<a name="ln-3195"></a><span class="c">!!       call drawstr(&quot;fixedwidth(.false.)&quot;)</span>
<a name="ln-3196"></a><span class="c">!!       call textsize(0.6*scl,1.2*scl)</span>
<a name="ln-3197"></a><span class="c">!!       call color(2)</span>
<a name="ln-3198"></a><span class="c">!!       call fixedwidth(.true.)</span>
<a name="ln-3199"></a><span class="c">!!       call drawstr(&quot; fixedwidth(.true.)&quot;)</span>
<a name="ln-3200"></a><span class="c">!!    ! wrap up</span>
<a name="ln-3201"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-3202"></a><span class="c">!!       call vexit()</span>
<a name="ln-3203"></a><span class="c">!!    end program demo_fixedwidth</span>
<a name="ln-3204"></a><span class="c">!&gt;</span>
<a name="ln-3205"></a><span class="c">!!##NAME</span>
<a name="ln-3206"></a><span class="c">!!    centertext(3f) - [M_draw:TEXT] Turns centertext mode on or off for SOFTWARE fonts.</span>
<a name="ln-3207"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3208"></a><span class="c">!!</span>
<a name="ln-3209"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3210"></a><span class="c">!!</span>
<a name="ln-3211"></a><span class="c">!!         subroutine centertext(onoff)</span>
<a name="ln-3212"></a><span class="c">!!         logical,intent(in) :: onoff</span>
<a name="ln-3213"></a><span class="c">!!</span>
<a name="ln-3214"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3215"></a><span class="c">!!</span>
<a name="ln-3216"></a><span class="c">!!    Turns centertext text on or off. .TRUE. is on. This centers</span>
<a name="ln-3217"></a><span class="c">!!    strings and chars. This routine only affects software text.</span>
<a name="ln-3218"></a><span class="c">!!</span>
<a name="ln-3219"></a><span class="c">!!##OPTIONS</span>
<a name="ln-3220"></a><span class="c">!!    ONOFF  set centering mode on or off</span>
<a name="ln-3221"></a><span class="c">!!</span>
<a name="ln-3222"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3223"></a><span class="c">!!</span>
<a name="ln-3224"></a><span class="c">!!   Sample program:</span>
<a name="ln-3225"></a><span class="c">!!</span>
<a name="ln-3226"></a><span class="c">!!    program demo_centertext</span>
<a name="ln-3227"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-3228"></a><span class="c">!!    use :: M_units, only : cosd, sind</span>
<a name="ln-3229"></a><span class="c">!!    !! set up drawing environment</span>
<a name="ln-3230"></a><span class="c">!!    call prefsize(600,600)</span>
<a name="ln-3231"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-3232"></a><span class="c">!!    call ortho2(-300.0,300.0,-300.0,300.0)</span>
<a name="ln-3233"></a><span class="c">!!    call textsize(8.0,8.0)</span>
<a name="ln-3234"></a><span class="c">!!    call linewidth(30)</span>
<a name="ln-3235"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-3236"></a><span class="c">!!    call clear()</span>
<a name="ln-3237"></a><span class="c">!!</span>
<a name="ln-3238"></a><span class="c">!!    x1=-150</span>
<a name="ln-3239"></a><span class="c">!!    y1=-150</span>
<a name="ln-3240"></a><span class="c">!!    do j=1,4</span>
<a name="ln-3241"></a><span class="c">!!       select case(j)</span>
<a name="ln-3242"></a><span class="c">!!       case(1);  call  xcentertext();        x1=-150;  y1=-150;  r=100</span>
<a name="ln-3243"></a><span class="c">!!       case(2);  call  ycentertext();        x1=+150;  y1=-150;  r= 30</span>
<a name="ln-3244"></a><span class="c">!!       case(3);  call  centertext(.true.);   x1=-150;  y1=+150;  r=100</span>
<a name="ln-3245"></a><span class="c">!!       case(4);  call  centertext(.false.);  x1=+150;  y1=+150;  r= 30</span>
<a name="ln-3246"></a><span class="c">!!       end select</span>
<a name="ln-3247"></a><span class="c">!!       !! draw radial lines</span>
<a name="ln-3248"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3249"></a><span class="c">!!       do i=1,80</span>
<a name="ln-3250"></a><span class="c">!!          call move2(x1,y1)</span>
<a name="ln-3251"></a><span class="c">!!          call draw2(x1+150.0*cosd(i*12), y1+150.0*sind(i*12))</span>
<a name="ln-3252"></a><span class="c">!!       enddo</span>
<a name="ln-3253"></a><span class="c">!!</span>
<a name="ln-3254"></a><span class="c">!!       !! draw rotated text</span>
<a name="ln-3255"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-3256"></a><span class="c">!!       do i=1,30</span>
<a name="ln-3257"></a><span class="c">!!          ang=i*12.0</span>
<a name="ln-3258"></a><span class="c">!!          xx=x1+r*cosd(ang)</span>
<a name="ln-3259"></a><span class="c">!!          yy=y1+r*sind(ang)</span>
<a name="ln-3260"></a><span class="c">!!          call move2(xx,yy)</span>
<a name="ln-3261"></a><span class="c">!!          call textang(ang)</span>
<a name="ln-3262"></a><span class="c">!!          call color(D_WHITE)</span>
<a name="ln-3263"></a><span class="c">!!          call drawstr(&#39;This is angled text&#39;)</span>
<a name="ln-3264"></a><span class="c">!!          call color(D_RED)</span>
<a name="ln-3265"></a><span class="c">!!       enddo</span>
<a name="ln-3266"></a><span class="c">!!    enddo</span>
<a name="ln-3267"></a><span class="c">!!</span>
<a name="ln-3268"></a><span class="c">!!    ipaws=getkey()</span>
<a name="ln-3269"></a><span class="c">!!</span>
<a name="ln-3270"></a><span class="c">!!    call vexit()</span>
<a name="ln-3271"></a><span class="c">!!</span>
<a name="ln-3272"></a><span class="c">!!    end program demo_centertext</span>
<a name="ln-3273"></a><span class="c">!&gt;</span>
<a name="ln-3274"></a><span class="c">!!##NAME</span>
<a name="ln-3275"></a><span class="c">!!    getcharsize(3f) - [M_draw:TEXT] Get the width and height of a character.</span>
<a name="ln-3276"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3277"></a><span class="c">!!</span>
<a name="ln-3278"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3279"></a><span class="c">!!</span>
<a name="ln-3280"></a><span class="c">!!         subroutine getcharsize(c, width, height)</span>
<a name="ln-3281"></a><span class="c">!!         character*1 c</span>
<a name="ln-3282"></a><span class="c">!!         real width, height</span>
<a name="ln-3283"></a><span class="c">!!</span>
<a name="ln-3284"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3285"></a><span class="c">!!    Get the width and height of a character. At the moment the height</span>
<a name="ln-3286"></a><span class="c">!!    returned is always that of the difference between the maximum descender</span>
<a name="ln-3287"></a><span class="c">!!    and ascender.</span>
<a name="ln-3288"></a><span class="c">!&gt;</span>
<a name="ln-3289"></a><span class="c">!!##NAME</span>
<a name="ln-3290"></a><span class="c">!!    getfontdec(3f) - [M_draw:TEXT] Return size of maximum font descender</span>
<a name="ln-3291"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3292"></a><span class="c">!!</span>
<a name="ln-3293"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3294"></a><span class="c">!!</span>
<a name="ln-3295"></a><span class="c">!!         real function getfontdec()</span>
<a name="ln-3296"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3297"></a><span class="c">!!    Get the descender size of a character in a font.</span>
<a name="ln-3298"></a><span class="c">!&gt;</span>
<a name="ln-3299"></a><span class="c">!!##NAME</span>
<a name="ln-3300"></a><span class="c">!!    getfontsize(3f) - [M_draw:TEXT] Get maximum width and height of a character in a font.</span>
<a name="ln-3301"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3302"></a><span class="c">!!</span>
<a name="ln-3303"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3304"></a><span class="c">!!</span>
<a name="ln-3305"></a><span class="c">!!         subroutine getfontsize(width, height)</span>
<a name="ln-3306"></a><span class="c">!!         real width, height</span>
<a name="ln-3307"></a><span class="c">!!</span>
<a name="ln-3308"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3309"></a><span class="c">!!</span>
<a name="ln-3310"></a><span class="c">!!    Get the maximum width and height of a character in a font.</span>
<a name="ln-3311"></a><span class="c">!&gt;</span>
<a name="ln-3312"></a><span class="c">!!##NAME</span>
<a name="ln-3313"></a><span class="c">!!    drawchar(3f) - [M_draw:TEXT] Draw the character c and update current position.</span>
<a name="ln-3314"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3315"></a><span class="c">!!</span>
<a name="ln-3316"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3317"></a><span class="c">!!</span>
<a name="ln-3318"></a><span class="c">!!         subroutine drawchar(ch)</span>
<a name="ln-3319"></a><span class="c">!!         character(len=1),intent(in) :: ch</span>
<a name="ln-3320"></a><span class="c">!!</span>
<a name="ln-3321"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3322"></a><span class="c">!!</span>
<a name="ln-3323"></a><span class="c">!!    Draw the character c at the current position. The current graphics</span>
<a name="ln-3324"></a><span class="c">!!    position represents the bottom left hand corner of the character space.</span>
<a name="ln-3325"></a><span class="c">!!</span>
<a name="ln-3326"></a><span class="c">!!    Uses current line color and thickness and text justification mode.</span>
<a name="ln-3327"></a><span class="c">!!</span>
<a name="ln-3328"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3329"></a><span class="c">!!</span>
<a name="ln-3330"></a><span class="c">!!   Sample program:</span>
<a name="ln-3331"></a><span class="c">!!</span>
<a name="ln-3332"></a><span class="c">!!    program demo_drawchar</span>
<a name="ln-3333"></a><span class="c">!!    !</span>
<a name="ln-3334"></a><span class="c">!!    !      display all the hershey fonts and demonstrate textang</span>
<a name="ln-3335"></a><span class="c">!!    !</span>
<a name="ln-3336"></a><span class="c">!!</span>
<a name="ln-3337"></a><span class="c">!!    use M_draw, only: vinit, vsetflush, color, clear, font, vexit, vflush</span>
<a name="ln-3338"></a><span class="c">!!    use M_draw, only: ortho2, textang, boxtext, rect, textsize, getkey</span>
<a name="ln-3339"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-3340"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3341"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3342"></a><span class="c">!!    use M_draw</span>
<a name="ln-3343"></a><span class="c">!!</span>
<a name="ln-3344"></a><span class="c">!!    character(len=40)   :: str1, str2, str3, str4, fonts(22)</span>
<a name="ln-3345"></a><span class="c">!!    character(len=100)  :: buf</span>
<a name="ln-3346"></a><span class="c">!!    character(len=1)    :: c</span>
<a name="ln-3347"></a><span class="c">!!    integer             :: i</span>
<a name="ln-3348"></a><span class="c">!!    data fonts/ &#39;astrology&#39;, &#39;cursive&#39;,    &#39;futura.l&#39;,               &amp;</span>
<a name="ln-3349"></a><span class="c">!!    &amp;      &#39;futura.m&#39;,  &#39;gothic.eng&#39;, &#39;gothic.ger&#39;,             &amp;</span>
<a name="ln-3350"></a><span class="c">!!    &amp;      &#39;gothic.ita&#39;,&#39;greek&#39;,      &#39;japanese&#39;,    &#39;markers&#39;, &amp;</span>
<a name="ln-3351"></a><span class="c">!!    &amp;      &#39;math.low&#39;,  &#39;math.upp&#39;,   &#39;meteorology&#39;, &#39;music&#39;,   &amp;</span>
<a name="ln-3352"></a><span class="c">!!    &amp;      &#39;cyrillic&#39;,  &#39;script&#39;,     &#39;symbolic&#39;,    &#39;times.g&#39;, &amp;</span>
<a name="ln-3353"></a><span class="c">!!    &amp;      &#39;times.ib&#39;,  &#39;times.i&#39;,    &#39;times.r&#39;,     &#39;times.rb&#39; /</span>
<a name="ln-3354"></a><span class="c">!!</span>
<a name="ln-3355"></a><span class="c">!!    data str1/ &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39; /</span>
<a name="ln-3356"></a><span class="c">!!    data str2/ &#39;abcdefghijklmnopqrstuvwxyz&#39; /</span>
<a name="ln-3357"></a><span class="c">!!    data str3/ &#39;1234567890+-=!@#$%^&amp;*(){}[]&#39; /</span>
<a name="ln-3358"></a><span class="c">!!    data str4/ &#39;&lt;&gt;,./?~`\|_BONK,blark&#39; /</span>
<a name="ln-3359"></a><span class="c">!!    integer :: idum</span>
<a name="ln-3360"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-3361"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios)buf</span>
<a name="ln-3362"></a><span class="c">!!    if(ios.ne.0)buf=&#39; &#39;</span>
<a name="ln-3363"></a><span class="c">!!    call prefsize(1000,1000)</span>
<a name="ln-3364"></a><span class="c">!!    call vinit(buf)</span>
<a name="ln-3365"></a><span class="c">!!    call vsetflush(.false.)</span>
<a name="ln-3366"></a><span class="c">!!    call linewidth(20)</span>
<a name="ln-3367"></a><span class="c">!!    call clear()</span>
<a name="ln-3368"></a><span class="c">!!    ! define the world space</span>
<a name="ln-3369"></a><span class="c">!!    call ortho2(-14.0, 14.0, -14.0, 14.0)</span>
<a name="ln-3370"></a><span class="c">!!    do i = 1, 22</span>
<a name="ln-3371"></a><span class="c">!!       ! do the title</span>
<a name="ln-3372"></a><span class="c">!!       call textang(0.0)                 ! reset text angle so title is straight</span>
<a name="ln-3373"></a><span class="c">!!       call color(D_CYAN)</span>
<a name="ln-3374"></a><span class="c">!!       call font(&#39;futura.m&#39;)</span>
<a name="ln-3375"></a><span class="c">!!       write(buf, &#39;(&#39;&#39;This is Hershey font &#39;&#39;,a)&#39;) fonts(i)</span>
<a name="ln-3376"></a><span class="c">!!       !call printattribs(&#39;before&#39;)</span>
<a name="ln-3377"></a><span class="c">!!       call boxtext(-11.0, 12.0, 20.0, 1.0, buf)</span>
<a name="ln-3378"></a><span class="c">!!       !call printattribs(&#39;after&#39;)</span>
<a name="ln-3379"></a><span class="c">!!       call rect(-11.0, 12.0, 9.0, 13.0) ! draw a box around the title</span>
<a name="ln-3380"></a><span class="c">!!       call font(fonts(i))               ! grab a font from the table</span>
<a name="ln-3381"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-3382"></a><span class="c">!!       ! show the outer ring</span>
<a name="ln-3383"></a><span class="c">!!       call textsize(1.5, 1.5)</span>
<a name="ln-3384"></a><span class="c">!!       call ShowCircularText(11.0, str1)</span>
<a name="ln-3385"></a><span class="c">!!       ! show the second ring</span>
<a name="ln-3386"></a><span class="c">!!       call textsize(1.3, 1.3)</span>
<a name="ln-3387"></a><span class="c">!!       call ShowCircularText(8.5, str2)</span>
<a name="ln-3388"></a><span class="c">!!       ! show the third ring</span>
<a name="ln-3389"></a><span class="c">!!       call textsize(1.1, 1.1)</span>
<a name="ln-3390"></a><span class="c">!!       call ShowCircularText(7.0, str3)</span>
<a name="ln-3391"></a><span class="c">!!       ! show the inside ring</span>
<a name="ln-3392"></a><span class="c">!!       call textsize(0.9, 0.9)</span>
<a name="ln-3393"></a><span class="c">!!       call ShowCircularText(5.0, str4)</span>
<a name="ln-3394"></a><span class="c">!!       call vflush()</span>
<a name="ln-3395"></a><span class="c">!!</span>
<a name="ln-3396"></a><span class="c">!!       idum= getkey()</span>
<a name="ln-3397"></a><span class="c">!!       select case(idum)</span>
<a name="ln-3398"></a><span class="c">!!        case(:-1,ichar(&#39;q&#39;),ichar(&#39;Q&#39;))</span>
<a name="ln-3399"></a><span class="c">!!          exit</span>
<a name="ln-3400"></a><span class="c">!!       end select</span>
<a name="ln-3401"></a><span class="c">!!</span>
<a name="ln-3402"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-3403"></a><span class="c">!!       call clear()</span>
<a name="ln-3404"></a><span class="c">!!    enddo</span>
<a name="ln-3405"></a><span class="c">!!    call vexit()</span>
<a name="ln-3406"></a><span class="c">!!    contains</span>
<a name="ln-3407"></a><span class="c">!!</span>
<a name="ln-3408"></a><span class="c">!!    subroutine ShowCircularText(r, str)  ! show a ring of text</span>
<a name="ln-3409"></a><span class="c">!!       use M_draw, only : move2, textang, drawchar</span>
<a name="ln-3410"></a><span class="c">!!</span>
<a name="ln-3411"></a><span class="c">!!       real              :: r</span>
<a name="ln-3412"></a><span class="c">!!       character(len=*)  :: str</span>
<a name="ln-3413"></a><span class="c">!!       real              :: i, inc, x, y, a</span>
<a name="ln-3414"></a><span class="c">!!       integer           :: j</span>
<a name="ln-3415"></a><span class="c">!!       character(len=1)  :: c</span>
<a name="ln-3416"></a><span class="c">!!       real,parameter    :: pi = 3.1415926535</span>
<a name="ln-3417"></a><span class="c">!!</span>
<a name="ln-3418"></a><span class="c">!!       j = 1</span>
<a name="ln-3419"></a><span class="c">!!       inc = 360.0 / len_trim(str)</span>
<a name="ln-3420"></a><span class="c">!!</span>
<a name="ln-3421"></a><span class="c">!!       i=0.0</span>
<a name="ln-3422"></a><span class="c">!!       do i10 = 1,len_trim(str)</span>
<a name="ln-3423"></a><span class="c">!!          !</span>
<a name="ln-3424"></a><span class="c">!!          ! calculate the next drawing position</span>
<a name="ln-3425"></a><span class="c">!!          c = str(j:j)</span>
<a name="ln-3426"></a><span class="c">!!          x = r * cos(i * pi / 180.0)</span>
<a name="ln-3427"></a><span class="c">!!          y = r * sin(i * pi / 180.0)</span>
<a name="ln-3428"></a><span class="c">!!          call move2(x, y)</span>
<a name="ln-3429"></a><span class="c">!!          !</span>
<a name="ln-3430"></a><span class="c">!!          ! calculate angle for next character</span>
<a name="ln-3431"></a><span class="c">!!          a = 90.0 + i</span>
<a name="ln-3432"></a><span class="c">!!          !</span>
<a name="ln-3433"></a><span class="c">!!          ! set the orientation of the next character</span>
<a name="ln-3434"></a><span class="c">!!          call textang(a)</span>
<a name="ln-3435"></a><span class="c">!!          !</span>
<a name="ln-3436"></a><span class="c">!!          ! draw the character</span>
<a name="ln-3437"></a><span class="c">!!          call drawchar(c)</span>
<a name="ln-3438"></a><span class="c">!!          j = j + 1</span>
<a name="ln-3439"></a><span class="c">!!          i=i+inc</span>
<a name="ln-3440"></a><span class="c">!!       enddo</span>
<a name="ln-3441"></a><span class="c">!!</span>
<a name="ln-3442"></a><span class="c">!!    end subroutine ShowCircularText</span>
<a name="ln-3443"></a><span class="c">!!</span>
<a name="ln-3444"></a><span class="c">!!    end program demo_drawchar</span>
<a name="ln-3445"></a><span class="c">!&gt;</span>
<a name="ln-3446"></a><span class="c">!!##NAME</span>
<a name="ln-3447"></a><span class="c">!!    drawstr(3f) - [M_draw:TEXT] Draw the text in string at the current position.</span>
<a name="ln-3448"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3449"></a><span class="c">!!</span>
<a name="ln-3450"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3451"></a><span class="c">!!</span>
<a name="ln-3452"></a><span class="c">!!         subroutine drawstr(str)</span>
<a name="ln-3453"></a><span class="c">!!         character(len=*),intent(in) :: str</span>
<a name="ln-3454"></a><span class="c">!!</span>
<a name="ln-3455"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3456"></a><span class="c">!!    Draw a text string at the current position. Uses current line color</span>
<a name="ln-3457"></a><span class="c">!!    and thickness and text centering mode.</span>
<a name="ln-3458"></a><span class="c">!!</span>
<a name="ln-3459"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3460"></a><span class="c">!!</span>
<a name="ln-3461"></a><span class="c">!!  Sample program:</span>
<a name="ln-3462"></a><span class="c">!!</span>
<a name="ln-3463"></a><span class="c">!!       program demo_drawstr</span>
<a name="ln-3464"></a><span class="c">!!       use M_draw</span>
<a name="ln-3465"></a><span class="c">!!       call vinit(&#39;&#39;)</span>
<a name="ln-3466"></a><span class="c">!!       ! by default the drawing surface is</span>
<a name="ln-3467"></a><span class="c">!!       ! a square ranging from -1 to 1 in both</span>
<a name="ln-3468"></a><span class="c">!!       ! the X and Y axis</span>
<a name="ln-3469"></a><span class="c">!!</span>
<a name="ln-3470"></a><span class="c">!!       call color(D_BLACK)    ! set current color to black</span>
<a name="ln-3471"></a><span class="c">!!       call clear()           ! clear to current color</span>
<a name="ln-3472"></a><span class="c">!!</span>
<a name="ln-3473"></a><span class="c">!!       ! SET COMMON TEXT ATTRIBUTES</span>
<a name="ln-3474"></a><span class="c">!!       call color(D_GREEN)    ! we want to draw in green</span>
<a name="ln-3475"></a><span class="c">!!       call font(&#39;futura.m&#39;)  ! set font</span>
<a name="ln-3476"></a><span class="c">!!       call textsize(0.1,0.1) ! font size</span>
<a name="ln-3477"></a><span class="c">!!</span>
<a name="ln-3478"></a><span class="c">!!       ! DRAW A STRING</span>
<a name="ln-3479"></a><span class="c">!!       call move2(-1.0, 0.0)</span>
<a name="ln-3480"></a><span class="c">!!       call drawstr(&#39;Hello&#39;)  ! draw string at current position</span>
<a name="ln-3481"></a><span class="c">!!       ! note that current position is now at end of this string</span>
<a name="ln-3482"></a><span class="c">!!</span>
<a name="ln-3483"></a><span class="c">!!       ! CHANGE SOME TEXT ATTRIBUTES AGAIN</span>
<a name="ln-3484"></a><span class="c">!!       call linewidth(20)     ! set line width</span>
<a name="ln-3485"></a><span class="c">!!       call color(D_RED)      ! change color</span>
<a name="ln-3486"></a><span class="c">!!       call textang(45.0)     ! change text angle</span>
<a name="ln-3487"></a><span class="c">!!</span>
<a name="ln-3488"></a><span class="c">!!       call drawstr(&#39; World!&#39;)! draw string at current position</span>
<a name="ln-3489"></a><span class="c">!!       idum=getkey()          ! pause</span>
<a name="ln-3490"></a><span class="c">!!</span>
<a name="ln-3491"></a><span class="c">!!       call vexit()           !  wrap up and exit graphics mode</span>
<a name="ln-3492"></a><span class="c">!!</span>
<a name="ln-3493"></a><span class="c">!!       end program demo_drawstr</span>
<a name="ln-3494"></a><span class="c">!&gt;</span>
<a name="ln-3495"></a><span class="c">!!##NAME</span>
<a name="ln-3496"></a><span class="c">!!    strlength(3f) - [M_draw:TEXT] return length of string</span>
<a name="ln-3497"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3498"></a><span class="c">!!</span>
<a name="ln-3499"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3500"></a><span class="c">!!</span>
<a name="ln-3501"></a><span class="c">!!</span>
<a name="ln-3502"></a><span class="c">!!       real function strlength(string)</span>
<a name="ln-3503"></a><span class="c">!!       character(len=*),intent(in) :: string</span>
<a name="ln-3504"></a><span class="c">!!</span>
<a name="ln-3505"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3506"></a><span class="c">!!    Return the length of the string &quot;STRING&quot; in world units.</span>
<a name="ln-3507"></a><span class="c">!!</span>
<a name="ln-3508"></a><span class="c">!!##RETURNS</span>
<a name="ln-3509"></a><span class="c">!!    STRLENGTH  length of string using current font size</span>
<a name="ln-3510"></a><span class="c">!!</span>
<a name="ln-3511"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3512"></a><span class="c">!!</span>
<a name="ln-3513"></a><span class="c">!!   Sample Program:</span>
<a name="ln-3514"></a><span class="c">!!</span>
<a name="ln-3515"></a><span class="c">!!    program demo_strlength</span>
<a name="ln-3516"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-3517"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-3518"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3519"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3520"></a><span class="c">!!    real    :: left</span>
<a name="ln-3521"></a><span class="c">!!    real    :: baseline</span>
<a name="ln-3522"></a><span class="c">!!    integer :: icolor=0</span>
<a name="ln-3523"></a><span class="c">!!    real    :: texth=10.0</span>
<a name="ln-3524"></a><span class="c">!!       !! set up drawing surface</span>
<a name="ln-3525"></a><span class="c">!!       call prefsize(800, 400)</span>
<a name="ln-3526"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-3527"></a><span class="c">!!       call page(-100.0, 300.0, -100.0, 100.0)</span>
<a name="ln-3528"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-3529"></a><span class="c">!!       call clear()</span>
<a name="ln-3530"></a><span class="c">!!       call linewidth(40)</span>
<a name="ln-3531"></a><span class="c">!!       call textsize(texth, texth)</span>
<a name="ln-3532"></a><span class="c">!!       call xcentertext()</span>
<a name="ln-3533"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3534"></a><span class="c">!!</span>
<a name="ln-3535"></a><span class="c">!!       baseline=85.0</span>
<a name="ln-3536"></a><span class="c">!!       call move2(0.0,baseline)</span>
<a name="ln-3537"></a><span class="c">!!       call drawstr(&#39;If I Can Stop One Heart&#39;)</span>
<a name="ln-3538"></a><span class="c">!!       baseline= baseline-texth*1.20</span>
<a name="ln-3539"></a><span class="c">!!       call move2(0.0,baseline)</span>
<a name="ln-3540"></a><span class="c">!!       call drawstr(&#39;by Emily Dickinson&#39;)</span>
<a name="ln-3541"></a><span class="c">!!       call centertext(.false.)</span>
<a name="ln-3542"></a><span class="c">!!</span>
<a name="ln-3543"></a><span class="c">!!       texth=8.5</span>
<a name="ln-3544"></a><span class="c">!!       baseline=baseline-texth*1.50</span>
<a name="ln-3545"></a><span class="c">!!       call textsize(texth, texth)</span>
<a name="ln-3546"></a><span class="c">!!       left=-90.0</span>
<a name="ln-3547"></a><span class="c">!!</span>
<a name="ln-3548"></a><span class="c">!!       call nextline(&#39;If I can stop one heart from breaking,&#39;)</span>
<a name="ln-3549"></a><span class="c">!!       call nextline(&#39;I shall not live in vain;&#39;)</span>
<a name="ln-3550"></a><span class="c">!!       call nextline(&#39;If I can ease one life the aching,&#39;)</span>
<a name="ln-3551"></a><span class="c">!!       call nextline(&#39;Or cool one pain,&#39;)</span>
<a name="ln-3552"></a><span class="c">!!       call nextline(&#39;Or help one fainting robin&#39;)</span>
<a name="ln-3553"></a><span class="c">!!       call nextline(&#39;Unto his nest again,&#39;)</span>
<a name="ln-3554"></a><span class="c">!!       call nextline(&#39;I shall not live in vain.&#39;)</span>
<a name="ln-3555"></a><span class="c">!!</span>
<a name="ln-3556"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-3557"></a><span class="c">!!       call vexit()</span>
<a name="ln-3558"></a><span class="c">!!    contains</span>
<a name="ln-3559"></a><span class="c">!!    subroutine nextline(string)</span>
<a name="ln-3560"></a><span class="c">!!    character(len=*) :: string</span>
<a name="ln-3561"></a><span class="c">!!    real :: xx</span>
<a name="ln-3562"></a><span class="c">!!    !! reduce some duplicate code; very specific to this EXAMPLE</span>
<a name="ln-3563"></a><span class="c">!!       call color(icolor)</span>
<a name="ln-3564"></a><span class="c">!!       baseline=baseline-texth*1.5    ! move down before drawing line</span>
<a name="ln-3565"></a><span class="c">!!          call polyfill(.true.)</span>
<a name="ln-3566"></a><span class="c">!!             call makepoly()</span>
<a name="ln-3567"></a><span class="c">!!                xx=strlength(string)</span>
<a name="ln-3568"></a><span class="c">!!                call rect(left,baseline-texth*0.3,left+xx,baseline+texth)</span>
<a name="ln-3569"></a><span class="c">!!             call closepoly()</span>
<a name="ln-3570"></a><span class="c">!!          call polyfill(.false.)</span>
<a name="ln-3571"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-3572"></a><span class="c">!!       call move2(left, baseline)</span>
<a name="ln-3573"></a><span class="c">!!       call drawstr(string)    ! draw string</span>
<a name="ln-3574"></a><span class="c">!!       icolor=icolor+1         ! set pen color</span>
<a name="ln-3575"></a><span class="c">!!    end subroutine nextline</span>
<a name="ln-3576"></a><span class="c">!!</span>
<a name="ln-3577"></a><span class="c">!!    end program demo_strlength</span>
<a name="ln-3578"></a><span class="c">!&gt;</span>
<a name="ln-3579"></a><span class="c">!!##NAME</span>
<a name="ln-3580"></a><span class="c">!!    boxtext(3f) - [M_draw:TEXT] stretch and draw the SOFTWARE string s so that it fits in the imaginary box</span>
<a name="ln-3581"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3582"></a><span class="c">!!</span>
<a name="ln-3583"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3584"></a><span class="c">!!</span>
<a name="ln-3585"></a><span class="c">!!         subroutine boxtext(x, y, l, h, s)</span>
<a name="ln-3586"></a><span class="c">!!         real x, y, l, h, s</span>
<a name="ln-3587"></a><span class="c">!!</span>
<a name="ln-3588"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3589"></a><span class="c">!!    Draw the string S so that it fits in the imaginary box defined with</span>
<a name="ln-3590"></a><span class="c">!!    bottom left hand corner at (x, y), length l, and height h. This only</span>
<a name="ln-3591"></a><span class="c">!!    applies to software text. The textsize is temporarily resized so that</span>
<a name="ln-3592"></a><span class="c">!!    the string fills the specified box.</span>
<a name="ln-3593"></a><span class="c">!!##OPTIONS</span>
<a name="ln-3594"></a><span class="c">!!    X,Y   position of lower left corner of box in world coordinates</span>
<a name="ln-3595"></a><span class="c">!!    L     length of box in world coordinates</span>
<a name="ln-3596"></a><span class="c">!!    H     height of box in world coordinates</span>
<a name="ln-3597"></a><span class="c">!!    S     string to stretch into box and draw</span>
<a name="ln-3598"></a><span class="c">!!</span>
<a name="ln-3599"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3600"></a><span class="c">!!</span>
<a name="ln-3601"></a><span class="c">!!   Simple program:</span>
<a name="ln-3602"></a><span class="c">!!</span>
<a name="ln-3603"></a><span class="c">!!     program demo_boxtext</span>
<a name="ln-3604"></a><span class="c">!!     use M_draw,     only : vinit,vexit,prefsize,vgetdev,clear,page</span>
<a name="ln-3605"></a><span class="c">!!     use M_draw,     only : centertext,polyfill,font,linewidth,color</span>
<a name="ln-3606"></a><span class="c">!!     use M_draw,     only : getkey</span>
<a name="ln-3607"></a><span class="c">!!     use M_draw,     only : color,rect,boxtext</span>
<a name="ln-3608"></a><span class="c">!!     use M_draw,     only : D_BLACK,   D_WHITE</span>
<a name="ln-3609"></a><span class="c">!!     use M_draw,     only : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3610"></a><span class="c">!!     use M_draw,     only : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3611"></a><span class="c">!!     implicit none</span>
<a name="ln-3612"></a><span class="c">!!     real              :: x1=0.0,    x2=40.0,    y1=0.0,    y2=7.0</span>
<a name="ln-3613"></a><span class="c">!!     real              :: xmin=1.0,  xmax=39.0,  ymin=1.0,  ymax=6.0</span>
<a name="ln-3614"></a><span class="c">!!     integer           :: idum</span>
<a name="ln-3615"></a><span class="c">!!        call prefsize(int(x2-x1)*25,int(y2-y1)*25)</span>
<a name="ln-3616"></a><span class="c">!!        call vinit(&#39; &#39;)</span>
<a name="ln-3617"></a><span class="c">!!        call page(x1,x2,y1,y2)</span>
<a name="ln-3618"></a><span class="c">!!        call centertext(.true.)</span>
<a name="ln-3619"></a><span class="c">!!        call font(&quot;times.rb&quot;)</span>
<a name="ln-3620"></a><span class="c">!!        call color(D_GREEN)</span>
<a name="ln-3621"></a><span class="c">!!        call clear()</span>
<a name="ln-3622"></a><span class="c">!!        call linewidth(200)</span>
<a name="ln-3623"></a><span class="c">!!        call color(D_CYAN); call polyfill(.false.); call rect(xmin,ymin,xmax,ymax)</span>
<a name="ln-3624"></a><span class="c">!!        call color(D_WHITE); call polyfill(.true.);  call rect(xmin,ymin,xmax,ymax)</span>
<a name="ln-3625"></a><span class="c">!!        call color(D_BLACK)</span>
<a name="ln-3626"></a><span class="c">!!        call boxtext(xmin,ymin,xmax-xmin,ymax-ymin,&quot;This text is in the box&quot;)</span>
<a name="ln-3627"></a><span class="c">!!        idum=getkey()</span>
<a name="ln-3628"></a><span class="c">!!        call vexit()</span>
<a name="ln-3629"></a><span class="c">!!     end program demo_boxtext</span>
<a name="ln-3630"></a><span class="c">!&gt;</span>
<a name="ln-3631"></a><span class="c">!!##NAME</span>
<a name="ln-3632"></a><span class="c">!!    boxfit(3f) - [M_draw:TEXT] resize the SOFTWARE text size so it fits in a box</span>
<a name="ln-3633"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3634"></a><span class="c">!!</span>
<a name="ln-3635"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3636"></a><span class="c">!!</span>
<a name="ln-3637"></a><span class="c">!!         subroutine boxfit(l, h, nchars)</span>
<a name="ln-3638"></a><span class="c">!!         real l, h</span>
<a name="ln-3639"></a><span class="c">!!         integer nchars</span>
<a name="ln-3640"></a><span class="c">!!</span>
<a name="ln-3641"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3642"></a><span class="c">!!    Set scale for text so that a string of the biggest characters in</span>
<a name="ln-3643"></a><span class="c">!!    the font will fit in a box l by h. l and h are real values in world</span>
<a name="ln-3644"></a><span class="c">!!    dimensions. This only applies to software text.</span>
<a name="ln-3645"></a><span class="c">!&gt;</span>
<a name="ln-3646"></a><span class="c">!!##NAME</span>
<a name="ln-3647"></a><span class="c">!!    textjustify(3f) - [M_draw:TEXT] general text justification (C only)</span>
<a name="ln-3648"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3649"></a><span class="c">!!</span>
<a name="ln-3650"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3651"></a><span class="c">!!</span>
<a name="ln-3652"></a><span class="c">!!        subroutine textjustify(val)</span>
<a name="ln-3653"></a><span class="c">!!        character(kind=c_short) :: ival</span>
<a name="ln-3654"></a><span class="c">!!        character(kind=c_char) :: val</span>
<a name="ln-3655"></a><span class="c">!!</span>
<a name="ln-3656"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3657"></a><span class="c">!!    General (direct) control of text justification. The value of val is made</span>
<a name="ln-3658"></a><span class="c">!!    up of the logical OR of the following predefined constants in draw.h</span>
<a name="ln-3659"></a><span class="c">!!    (FOR C and Fortran only). D_LEFT, D_RIGHT, D_XCENTERED, D_TOP, D_BOTTOM,</span>
<a name="ln-3660"></a><span class="c">!!    D_YCENTERED. Centering takes priority, as does RIGHT and TOP justification</span>
<a name="ln-3661"></a><span class="c">!!    (if you were silly enough to set it to D_LEFT|D_RIGHT for EXAMPLE that</span>
<a name="ln-3662"></a><span class="c">!!    is). A value of 0 (zero) (in all languages) resets the textjustification</span>
<a name="ln-3663"></a><span class="c">!!    to the default.</span>
<a name="ln-3664"></a><span class="c">!!</span>
<a name="ln-3665"></a><span class="c">!!        ! from Fortran, use IANY() to OR the array of options, and CHAR()</span>
<a name="ln-3666"></a><span class="c">!!        ! to convert the integer result to a C_CHAR type. KIND C_CHAR is</span>
<a name="ln-3667"></a><span class="c">!!        ! defined by loading a the intrinsic module for C bindings (&quot;USE ISO_C_BINDING&quot;).</span>
<a name="ln-3668"></a><span class="c">!!        ival=iany([D_XCENTERED,D_YCENTERED])</span>
<a name="ln-3669"></a><span class="c">!!        val=char(ival)</span>
<a name="ln-3670"></a><span class="c">!!        call textjustify(val)</span>
<a name="ln-3671"></a><span class="c">!!</span>
<a name="ln-3672"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3673"></a><span class="c">!!</span>
<a name="ln-3674"></a><span class="c">!!   Sample program:</span>
<a name="ln-3675"></a><span class="c">!!</span>
<a name="ln-3676"></a><span class="c">!!    program demo_textjustify</span>
<a name="ln-3677"></a><span class="c">!!    use M_draw</span>
<a name="ln-3678"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-3679"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3680"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3681"></a><span class="c">!!    use iso_c_binding</span>
<a name="ln-3682"></a><span class="c">!!    implicit none</span>
<a name="ln-3683"></a><span class="c">!!    real :: x1=-20.0, x2=20.0, y1=-20.0, y2=20.0</span>
<a name="ln-3684"></a><span class="c">!!       call prefsize(int(x2-x1)*30,int(y2-y1)*30)</span>
<a name="ln-3685"></a><span class="c">!!       !!call voutput(&#39;|ppmtogif &gt;textjustify.3M_draw.gif&#39;)</span>
<a name="ln-3686"></a><span class="c">!!       !!call vinit(&#39;p6&#39;)</span>
<a name="ln-3687"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3688"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3689"></a><span class="c">!!       call clear()</span>
<a name="ln-3690"></a><span class="c">!!       call textsize(0.9, 1.4)</span>
<a name="ln-3691"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3692"></a><span class="c">!!       call linewidth(20)</span>
<a name="ln-3693"></a><span class="c">!!       call seejustify( &quot;right|top&quot;,           iany([d_right,d_top]),           -10.0, -10.0 )</span>
<a name="ln-3694"></a><span class="c">!!       call seejustify( &quot;right|ycentered&quot;,     iany([d_right,d_ycentered]),     -10.0,   0.0 )</span>
<a name="ln-3695"></a><span class="c">!!       call seejustify( &quot;right|bottom&quot;,        iany([d_right,d_bottom]),        -10.0, +10.0 )</span>
<a name="ln-3696"></a><span class="c">!!       call seejustify( &quot;xcentered|top&quot;,       iany([d_xcentered,d_top]),         0.0, -10.0 )</span>
<a name="ln-3697"></a><span class="c">!!       call seejustify( &quot;xcentered|ycentered&quot;, iany([d_xcentered,d_ycentered]),   0.0,   0.0 )</span>
<a name="ln-3698"></a><span class="c">!!       call seejustify( &quot;xcentered|bottom&quot;,    iany([d_xcentered,d_bottom]),      0.0, +10.0 )</span>
<a name="ln-3699"></a><span class="c">!!       call seejustify( &quot;left|top&quot;,            iany([d_left,d_top]),            +10.0, -10.0 )</span>
<a name="ln-3700"></a><span class="c">!!       call seejustify( &quot;left|ycentered&quot;,      iany([d_left,d_ycentered]),      +10.0,   0.0 )</span>
<a name="ln-3701"></a><span class="c">!!       call seejustify( &quot;left|bottom&quot;,         iany([d_left,d_bottom]),         +10.0, +10.0 )</span>
<a name="ln-3702"></a><span class="c">!!       call vexit()</span>
<a name="ln-3703"></a><span class="c">!!    contains</span>
<a name="ln-3704"></a><span class="c">!!       subroutine seejustify(string,justify,x,y)</span>
<a name="ln-3705"></a><span class="c">!!          implicit none</span>
<a name="ln-3706"></a><span class="c">!!          real                    :: x, y</span>
<a name="ln-3707"></a><span class="c">!!          real                    :: height, width</span>
<a name="ln-3708"></a><span class="c">!!          integer(kind=c_short)   :: justify</span>
<a name="ln-3709"></a><span class="c">!!          character(len=*)        :: string</span>
<a name="ln-3710"></a><span class="c">!!          character(kind=c_char)  :: byte</span>
<a name="ln-3711"></a><span class="c">!!          call color(D_RED)</span>
<a name="ln-3712"></a><span class="c">!!          call move2(x-1.0,y); call draw2(x+1.0,y); call move2(x,y-1.0); call draw2(x,y+1.0)</span>
<a name="ln-3713"></a><span class="c">!!          call circle(x,y,5.0)</span>
<a name="ln-3714"></a><span class="c">!!          call color(D_BLUE)</span>
<a name="ln-3715"></a><span class="c">!!          call move2(x,y)</span>
<a name="ln-3716"></a><span class="c">!!          byte=char(justify)</span>
<a name="ln-3717"></a><span class="c">!!          call textjustify(byte)</span>
<a name="ln-3718"></a><span class="c">!!          call drawstr(string)</span>
<a name="ln-3719"></a><span class="c">!!          call color(D_WHITE)</span>
<a name="ln-3720"></a><span class="c">!!          call rmove2(-strlength(string),0.0)</span>
<a name="ln-3721"></a><span class="c">!!          call rdraw2(+strlength(string),0.0)</span>
<a name="ln-3722"></a><span class="c">!!          call getfontsize(width, height)</span>
<a name="ln-3723"></a><span class="c">!!          call rmove2(0.0,height)</span>
<a name="ln-3724"></a><span class="c">!!          call rmove2(-strlength(string),0.0)</span>
<a name="ln-3725"></a><span class="c">!!          call rdraw2(+strlength(string),0.0)</span>
<a name="ln-3726"></a><span class="c">!!       end subroutine seejustify</span>
<a name="ln-3727"></a><span class="c">!!    end program demo_textjustify</span>
<a name="ln-3728"></a><span class="c">!&gt;</span>
<a name="ln-3729"></a><span class="c">!!##NAME</span>
<a name="ln-3730"></a><span class="c">!!    leftjustify(3f) - [M_draw:TEXT] left justify text</span>
<a name="ln-3731"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3732"></a><span class="c">!!</span>
<a name="ln-3733"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3734"></a><span class="c">!!</span>
<a name="ln-3735"></a><span class="c">!!         subroutine leftjustify()</span>
<a name="ln-3736"></a><span class="c">!!</span>
<a name="ln-3737"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3738"></a><span class="c">!!    Left justifies text. The text string will begin at the current position</span>
<a name="ln-3739"></a><span class="c">!!    and extend to the notional right. Right justification and X centering</span>
<a name="ln-3740"></a><span class="c">!!    are turned off.</span>
<a name="ln-3741"></a><span class="c">!!</span>
<a name="ln-3742"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3743"></a><span class="c">!!</span>
<a name="ln-3744"></a><span class="c">!!   Sample program:</span>
<a name="ln-3745"></a><span class="c">!!</span>
<a name="ln-3746"></a><span class="c">!!    program demo_leftjustify</span>
<a name="ln-3747"></a><span class="c">!!    use M_draw</span>
<a name="ln-3748"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-3749"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3750"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3751"></a><span class="c">!!    implicit none</span>
<a name="ln-3752"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3753"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3754"></a><span class="c">!!    integer :: key</span>
<a name="ln-3755"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3756"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3757"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3758"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3759"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3760"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3761"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3762"></a><span class="c">!!       AX=(x1+x2)/2+1; BX=y1+1.3</span>
<a name="ln-3763"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3764"></a><span class="c">!!       call leftjustify()</span>
<a name="ln-3765"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-3766"></a><span class="c">!!       call drawstr(&quot;leftjustify()&quot;)</span>
<a name="ln-3767"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3768"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-3769"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-3770"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-3771"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-3772"></a><span class="c">!!       call vflush()</span>
<a name="ln-3773"></a><span class="c">!!       key=getkey()</span>
<a name="ln-3774"></a><span class="c">!!       call vexit()</span>
<a name="ln-3775"></a><span class="c">!!    end program demo_leftjustify</span>
<a name="ln-3776"></a><span class="c">!&gt;</span>
<a name="ln-3777"></a><span class="c">!!##NAME</span>
<a name="ln-3778"></a><span class="c">!!    rightjustify(3f) - [M_draw:TEXT] right justify text</span>
<a name="ln-3779"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3780"></a><span class="c">!!</span>
<a name="ln-3781"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3782"></a><span class="c">!!</span>
<a name="ln-3783"></a><span class="c">!!        subroutine rightjustify()</span>
<a name="ln-3784"></a><span class="c">!!</span>
<a name="ln-3785"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3786"></a><span class="c">!!</span>
<a name="ln-3787"></a><span class="c">!!    Right justifies text. The text string will begin at a point to the</span>
<a name="ln-3788"></a><span class="c">!!    notional left of the current position and finish at the current</span>
<a name="ln-3789"></a><span class="c">!!    position. Left justification and X centering are turned off.</span>
<a name="ln-3790"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3791"></a><span class="c">!!</span>
<a name="ln-3792"></a><span class="c">!!   Sample program:</span>
<a name="ln-3793"></a><span class="c">!!</span>
<a name="ln-3794"></a><span class="c">!!    program demo_rightjustify</span>
<a name="ln-3795"></a><span class="c">!!    use M_draw</span>
<a name="ln-3796"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-3797"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-3798"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-3799"></a><span class="c">!!    implicit none</span>
<a name="ln-3800"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3801"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3802"></a><span class="c">!!    integer :: key</span>
<a name="ln-3803"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3804"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3805"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3806"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3807"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3808"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3809"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3810"></a><span class="c">!!       AX=(x1+x2)/2+6; BX=y1+1.3</span>
<a name="ln-3811"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3812"></a><span class="c">!!       call rightjustify()</span>
<a name="ln-3813"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-3814"></a><span class="c">!!       call drawstr(&quot;rightjustify()&quot;)</span>
<a name="ln-3815"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3816"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-3817"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-3818"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-3819"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-3820"></a><span class="c">!!       call vflush()</span>
<a name="ln-3821"></a><span class="c">!!       key=getkey()</span>
<a name="ln-3822"></a><span class="c">!!       call vexit()</span>
<a name="ln-3823"></a><span class="c">!!    end program demo_rightjustify</span>
<a name="ln-3824"></a><span class="c">!&gt;</span>
<a name="ln-3825"></a><span class="c">!!##NAME</span>
<a name="ln-3826"></a><span class="c">!!    xcentertext(3f) - [M_draw:TEXT] set text centering mode on in X direction</span>
<a name="ln-3827"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3828"></a><span class="c">!!</span>
<a name="ln-3829"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3830"></a><span class="c">!!</span>
<a name="ln-3831"></a><span class="c">!!        subroutine xcentertext()</span>
<a name="ln-3832"></a><span class="c">!!</span>
<a name="ln-3833"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3834"></a><span class="c">!!    Set text centering mode on in X direction. Y justification is</span>
<a name="ln-3835"></a><span class="c">!!    turned off.</span>
<a name="ln-3836"></a><span class="c">!!</span>
<a name="ln-3837"></a><span class="c">!!    Centers text in the X direction. The text string will begin at a</span>
<a name="ln-3838"></a><span class="c">!!    point to the notional left of the current position and finish at a</span>
<a name="ln-3839"></a><span class="c">!!    point to the right of the current position. Left justification and</span>
<a name="ln-3840"></a><span class="c">!!    Right justification are turned off.</span>
<a name="ln-3841"></a><span class="c">!!</span>
<a name="ln-3842"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3843"></a><span class="c">!!</span>
<a name="ln-3844"></a><span class="c">!!   Sample program:</span>
<a name="ln-3845"></a><span class="c">!!</span>
<a name="ln-3846"></a><span class="c">!!    program demo_xcentertext</span>
<a name="ln-3847"></a><span class="c">!!    use M_draw</span>
<a name="ln-3848"></a><span class="c">!!    implicit none</span>
<a name="ln-3849"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3850"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3851"></a><span class="c">!!    integer :: key</span>
<a name="ln-3852"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3853"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3854"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3855"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3856"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3857"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3858"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3859"></a><span class="c">!!       AX=(x1+x2)/2+4; BX=y1+1.3</span>
<a name="ln-3860"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3861"></a><span class="c">!!       call xcentertext()</span>
<a name="ln-3862"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-3863"></a><span class="c">!!       call drawstr(&quot;xcentertext()&quot;)</span>
<a name="ln-3864"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3865"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-3866"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-3867"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-3868"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-3869"></a><span class="c">!!       call vflush()</span>
<a name="ln-3870"></a><span class="c">!!       key=getkey()</span>
<a name="ln-3871"></a><span class="c">!!       call vexit()</span>
<a name="ln-3872"></a><span class="c">!!    end program demo_xcentertext</span>
<a name="ln-3873"></a><span class="c">!&gt;</span>
<a name="ln-3874"></a><span class="c">!!##NAME</span>
<a name="ln-3875"></a><span class="c">!!    topjustify(3f) - [M_draw:TEXT] top justify text</span>
<a name="ln-3876"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3877"></a><span class="c">!!</span>
<a name="ln-3878"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3879"></a><span class="c">!!</span>
<a name="ln-3880"></a><span class="c">!!         subroutine topjustify()</span>
<a name="ln-3881"></a><span class="c">!!</span>
<a name="ln-3882"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3883"></a><span class="c">!!    Top justifies text. The text string will be drawn with its upper edge</span>
<a name="ln-3884"></a><span class="c">!!    aligned with the current Y position. Bottom justification and Y centering</span>
<a name="ln-3885"></a><span class="c">!!    are turned off.</span>
<a name="ln-3886"></a><span class="c">!!</span>
<a name="ln-3887"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3888"></a><span class="c">!!</span>
<a name="ln-3889"></a><span class="c">!!   Sample program:</span>
<a name="ln-3890"></a><span class="c">!!</span>
<a name="ln-3891"></a><span class="c">!!    program demo_topjustify</span>
<a name="ln-3892"></a><span class="c">!!    use M_draw</span>
<a name="ln-3893"></a><span class="c">!!    implicit none</span>
<a name="ln-3894"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3895"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3896"></a><span class="c">!!    integer :: key</span>
<a name="ln-3897"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3898"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3899"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3900"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3901"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3902"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3903"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3904"></a><span class="c">!!       AX=(x1+x2)/2+0.3; BX=y1+3.3</span>
<a name="ln-3905"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3906"></a><span class="c">!!       call topjustify()</span>
<a name="ln-3907"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-3908"></a><span class="c">!!       call drawstr(&quot;topjustify()&quot;)</span>
<a name="ln-3909"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3910"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-3911"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-3912"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-3913"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-3914"></a><span class="c">!!       call vflush()</span>
<a name="ln-3915"></a><span class="c">!!       key=getkey()</span>
<a name="ln-3916"></a><span class="c">!!       call vexit()</span>
<a name="ln-3917"></a><span class="c">!!    end program demo_topjustify</span>
<a name="ln-3918"></a><span class="c">!&gt;</span>
<a name="ln-3919"></a><span class="c">!!##NAME</span>
<a name="ln-3920"></a><span class="c">!!    bottomjustify(3f) - [M_draw:TEXT] bottom justify text</span>
<a name="ln-3921"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3922"></a><span class="c">!!</span>
<a name="ln-3923"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3924"></a><span class="c">!!</span>
<a name="ln-3925"></a><span class="c">!!        subroutine bottomjustify()</span>
<a name="ln-3926"></a><span class="c">!!</span>
<a name="ln-3927"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3928"></a><span class="c">!!</span>
<a name="ln-3929"></a><span class="c">!!    Bottom justifies text. The text string will be drawn with the lower</span>
<a name="ln-3930"></a><span class="c">!!    edge aligned with the current Y position. Top justification and Y</span>
<a name="ln-3931"></a><span class="c">!!    centering are turned off.</span>
<a name="ln-3932"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3933"></a><span class="c">!!</span>
<a name="ln-3934"></a><span class="c">!!   Sample program:</span>
<a name="ln-3935"></a><span class="c">!!</span>
<a name="ln-3936"></a><span class="c">!!    program demo_bottomjustify</span>
<a name="ln-3937"></a><span class="c">!!    use M_draw</span>
<a name="ln-3938"></a><span class="c">!!    implicit none</span>
<a name="ln-3939"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3940"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3941"></a><span class="c">!!    integer :: key</span>
<a name="ln-3942"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3943"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3944"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3945"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3946"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3947"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3948"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3949"></a><span class="c">!!       AX=(x1+x2)/2+1; BX=y1+1.3</span>
<a name="ln-3950"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3951"></a><span class="c">!!       call bottomjustify()</span>
<a name="ln-3952"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-3953"></a><span class="c">!!       call drawstr(&quot;bottomjustify()&quot;)</span>
<a name="ln-3954"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-3955"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-3956"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-3957"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-3958"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-3959"></a><span class="c">!!       call vflush()</span>
<a name="ln-3960"></a><span class="c">!!       key=getkey()</span>
<a name="ln-3961"></a><span class="c">!!       call vexit()</span>
<a name="ln-3962"></a><span class="c">!!    end program demo_bottomjustify</span>
<a name="ln-3963"></a><span class="c">!&gt;</span>
<a name="ln-3964"></a><span class="c">!!##NAME</span>
<a name="ln-3965"></a><span class="c">!!    ycentertext(3f) - [M_draw:TEXT] center text in the Y direction</span>
<a name="ln-3966"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-3967"></a><span class="c">!!</span>
<a name="ln-3968"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-3969"></a><span class="c">!!</span>
<a name="ln-3970"></a><span class="c">!!        subroutine ycentertext()</span>
<a name="ln-3971"></a><span class="c">!!</span>
<a name="ln-3972"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-3973"></a><span class="c">!!    Centers text in the Y direction. The text string will so that its</span>
<a name="ln-3974"></a><span class="c">!!    center line is aligned with the current y position. Top justification</span>
<a name="ln-3975"></a><span class="c">!!    and Bottom justification are turned off.</span>
<a name="ln-3976"></a><span class="c">!!</span>
<a name="ln-3977"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-3978"></a><span class="c">!!</span>
<a name="ln-3979"></a><span class="c">!!   Sample program:</span>
<a name="ln-3980"></a><span class="c">!!</span>
<a name="ln-3981"></a><span class="c">!!    program demo_ycentertext</span>
<a name="ln-3982"></a><span class="c">!!    use M_draw</span>
<a name="ln-3983"></a><span class="c">!!    implicit none</span>
<a name="ln-3984"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-3985"></a><span class="c">!!    real    :: scl, ax, bx</span>
<a name="ln-3986"></a><span class="c">!!    integer :: key</span>
<a name="ln-3987"></a><span class="c">!!       call prefsize(1200,120)</span>
<a name="ln-3988"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-3989"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-3990"></a><span class="c">!!       call clear()</span>
<a name="ln-3991"></a><span class="c">!!       x1=0; x2=40; y1=0; y2=4; scl=1.9</span>
<a name="ln-3992"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-3993"></a><span class="c">!!       call textsize(0.9*scl,1.4*scl)</span>
<a name="ln-3994"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-3995"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-3996"></a><span class="c">!!       AX=(x1+x2)/2.0; BX=(y1+y2)/2.0</span>
<a name="ln-3997"></a><span class="c">!!       call move2(AX,BX)</span>
<a name="ln-3998"></a><span class="c">!!       call ycentertext()</span>
<a name="ln-3999"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-4000"></a><span class="c">!!       call drawstr(&quot;ycentertext()&quot;)</span>
<a name="ln-4001"></a><span class="c">!!       call color(D_CYAN)</span>
<a name="ln-4002"></a><span class="c">!!       call move2(AX-1.0,BX)</span>
<a name="ln-4003"></a><span class="c">!!       call draw2(AX+1.0,BX)</span>
<a name="ln-4004"></a><span class="c">!!       call move2(AX,BX-1.0)</span>
<a name="ln-4005"></a><span class="c">!!       call draw2(AX,BX+1.0)</span>
<a name="ln-4006"></a><span class="c">!!       call vflush()</span>
<a name="ln-4007"></a><span class="c">!!       key=getkey()</span>
<a name="ln-4008"></a><span class="c">!!       call vexit()</span>
<a name="ln-4009"></a><span class="c">!!    end program demo_ycentertext</span>
<a name="ln-4010"></a><span class="c">!!</span>
<a name="ln-4011"></a><span class="c">!&gt;</span>
<a name="ln-4012"></a><span class="c">!!##NAME</span>
<a name="ln-4013"></a><span class="c">!!    textslant(3f) - [M_draw:TEXT] Defines the obliqueness of the fonts.</span>
<a name="ln-4014"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4015"></a><span class="c">!!</span>
<a name="ln-4016"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4017"></a><span class="c">!!</span>
<a name="ln-4018"></a><span class="c">!!        subroutine textslant(var)</span>
<a name="ln-4019"></a><span class="c">!!        real var</span>
<a name="ln-4020"></a><span class="c">!!</span>
<a name="ln-4021"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4022"></a><span class="c">!!</span>
<a name="ln-4023"></a><span class="c">!!    Defines the obliqueness of the fonts. This is a simplistic method that</span>
<a name="ln-4024"></a><span class="c">!!    allows you to generate italicized versions of the software fonts. The x-</span>
<a name="ln-4025"></a><span class="c">!!    values of the software font coordinates after the current textsize()</span>
<a name="ln-4026"></a><span class="c">!!    values are applied are multiplied by (1+val).</span>
<a name="ln-4027"></a><span class="c">!!</span>
<a name="ln-4028"></a><span class="c">!!    Note that this means the same value tilts the characters less the taller</span>
<a name="ln-4029"></a><span class="c">!!    the characters are relative to their width.</span>
<a name="ln-4030"></a><span class="c">!!</span>
<a name="ln-4031"></a><span class="c">!!    Generally, practical values are generally between -1 and 1 times the</span>
<a name="ln-4032"></a><span class="c">!!</span>
<a name="ln-4033"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4034"></a><span class="c">!!</span>
<a name="ln-4035"></a><span class="c">!!   Sample program:</span>
<a name="ln-4036"></a><span class="c">!!</span>
<a name="ln-4037"></a><span class="c">!!    program demo_textslant</span>
<a name="ln-4038"></a><span class="c">!!    use M_draw</span>
<a name="ln-4039"></a><span class="c">!!    implicit none</span>
<a name="ln-4040"></a><span class="c">!!    real    :: x1, x2, y1, y2</span>
<a name="ln-4041"></a><span class="c">!!    real    :: scl</span>
<a name="ln-4042"></a><span class="c">!!    integer :: key</span>
<a name="ln-4043"></a><span class="c">!!       call prefsize(1200,300)</span>
<a name="ln-4044"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-4045"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-4046"></a><span class="c">!!       call clear()</span>
<a name="ln-4047"></a><span class="c">!!       x1=0.0; x2=40.0; y1=0.0; y2=10.0; scl=3*0.7</span>
<a name="ln-4048"></a><span class="c">!!       call page(x1,x2,y1,y2)</span>
<a name="ln-4049"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-4050"></a><span class="c">!!       call linewidth(180)</span>
<a name="ln-4051"></a><span class="c">!!       call textsize(0.8*scl,1.2*scl)</span>
<a name="ln-4052"></a><span class="c">!!       call move2( x1+.3,y1+.4)</span>
<a name="ln-4053"></a><span class="c">!!       call color(D_RED); call textslant(0.0);  call drawstr(&quot;textslant(0.0); &quot;)</span>
<a name="ln-4054"></a><span class="c">!!       call color(D_GREEN); call textslant(-1.0); call drawstr(&quot; textslant(-1.0);&quot;)</span>
<a name="ln-4055"></a><span class="c">!!       call color(D_BLUE); call textslant(1.0);  call drawstr(&quot; textslant(1.0);&quot;)</span>
<a name="ln-4056"></a><span class="c">!!       call textsize(0.8*scl,1.2*3*scl)</span>
<a name="ln-4057"></a><span class="c">!!       call move2(x1+.3,y1+3+.4)</span>
<a name="ln-4058"></a><span class="c">!!       call color(D_MAGENTA); call textslant(1.0); call drawstr(&quot; textslant(1.0);&quot;)</span>
<a name="ln-4059"></a><span class="c">!!       call textsize(0.8*scl,1.2*scl)</span>
<a name="ln-4060"></a><span class="c">!!       call color(D_CYAN); call textslant(0.3); call drawstr(&quot; textslant(0.3);&quot;)</span>
<a name="ln-4061"></a><span class="c">!!       call color(D_WHITE); call textslant(0.5); call drawstr(&quot; textslant(0.5);&quot;)</span>
<a name="ln-4062"></a><span class="c">!!       call vflush()</span>
<a name="ln-4063"></a><span class="c">!!       key=getkey()</span>
<a name="ln-4064"></a><span class="c">!!       call vexit()</span>
<a name="ln-4065"></a><span class="c">!!    end program demo_textslant</span>
<a name="ln-4066"></a><span class="c">!&gt;</span>
<a name="ln-4067"></a><span class="c">!!##NAME</span>
<a name="ln-4068"></a><span class="c">!!    textweight(3f) - [M_draw:TEXT] Defines the weight of the fonts.</span>
<a name="ln-4069"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4070"></a><span class="c">!!</span>
<a name="ln-4071"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4072"></a><span class="c">!!</span>
<a name="ln-4073"></a><span class="c">!!        subroutine textweight(ival)</span>
<a name="ln-4074"></a><span class="c">!!        integer ival</span>
<a name="ln-4075"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4076"></a><span class="c">!!</span>
<a name="ln-4077"></a><span class="c">!!     Defines the weight of the fonts. Currently, the predefined constants</span>
<a name="ln-4078"></a><span class="c">!!     in C and Fortran are D_NORMAL and D_BOLD; which correspond to 0</span>
<a name="ln-4079"></a><span class="c">!!     and 1. This is not the same as using linethickess to change the</span>
<a name="ln-4080"></a><span class="c">!!     appearance of a software font. The font is redrawn multiple times</span>
<a name="ln-4081"></a><span class="c">!!     with a slight offset to create the bold appearance.</span>
<a name="ln-4082"></a><span class="c">!!</span>
<a name="ln-4083"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4084"></a><span class="c">!!</span>
<a name="ln-4085"></a><span class="c">!!   Sample program:</span>
<a name="ln-4086"></a><span class="c">!!</span>
<a name="ln-4087"></a><span class="c">!!    program demo_textweight</span>
<a name="ln-4088"></a><span class="c">!!    use M_draw</span>
<a name="ln-4089"></a><span class="c">!!    implicit none</span>
<a name="ln-4090"></a><span class="c">!!    real,parameter :: w=40.0</span>
<a name="ln-4091"></a><span class="c">!!    integer        :: key</span>
<a name="ln-4092"></a><span class="c">!!       call prefsize(600,600)</span>
<a name="ln-4093"></a><span class="c">!!       call vinit(&#39; &#39;)</span>
<a name="ln-4094"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-4095"></a><span class="c">!!       call clear()</span>
<a name="ln-4096"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-4097"></a><span class="c">!!       call page(-w,w,-w,w)</span>
<a name="ln-4098"></a><span class="c">!!       call font(&quot;times.rb&quot;)</span>
<a name="ln-4099"></a><span class="c">!!       call linewidth(180)</span>
<a name="ln-4100"></a><span class="c">!!       call textsize(15.0,15.0)</span>
<a name="ln-4101"></a><span class="c">!!       call centertext(.true.)</span>
<a name="ln-4102"></a><span class="c">!!       call linewidth(0);call color(D_BLUE)</span>
<a name="ln-4103"></a><span class="c">!!       call move2(0.0, W/2.0)</span>
<a name="ln-4104"></a><span class="c">!!</span>
<a name="ln-4105"></a><span class="c">!!       call textweight(0)</span>
<a name="ln-4106"></a><span class="c">!!       call drawstr(&#39;NORMAL&#39;)</span>
<a name="ln-4107"></a><span class="c">!!</span>
<a name="ln-4108"></a><span class="c">!!       call linewidth(0);call color(D_MAGENTA)</span>
<a name="ln-4109"></a><span class="c">!!       call move2(0.0, 0.0-W/2.0)</span>
<a name="ln-4110"></a><span class="c">!!</span>
<a name="ln-4111"></a><span class="c">!!       call textweight(1)</span>
<a name="ln-4112"></a><span class="c">!!       call drawstr(&#39;BOLD&#39;)</span>
<a name="ln-4113"></a><span class="c">!!</span>
<a name="ln-4114"></a><span class="c">!!       call vflush()</span>
<a name="ln-4115"></a><span class="c">!!       key=getkey()</span>
<a name="ln-4116"></a><span class="c">!!       call vexit()</span>
<a name="ln-4117"></a><span class="c">!!    end program demo_textweight</span>
<a name="ln-4118"></a><span class="c">!&gt;</span>
<a name="ln-4119"></a><span class="c">!!##NAME</span>
<a name="ln-4120"></a><span class="c">!!    linewidth(3f) - [M_draw:LINESTYLE] set line width in rasters</span>
<a name="ln-4121"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4122"></a><span class="c">!!</span>
<a name="ln-4123"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4124"></a><span class="c">!!</span>
<a name="ln-4125"></a><span class="c">!!         subroutine linewidth(iwidth)</span>
<a name="ln-4126"></a><span class="c">!!         integer iwidth</span>
<a name="ln-4127"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4128"></a><span class="c">!!</span>
<a name="ln-4129"></a><span class="c">!!    Set the current line width in units of 1/10,000 of the X size of the</span>
<a name="ln-4130"></a><span class="c">!!    display surface</span>
<a name="ln-4131"></a><span class="c">!!</span>
<a name="ln-4132"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4133"></a><span class="c">!!</span>
<a name="ln-4134"></a><span class="c">!!   Sample program:</span>
<a name="ln-4135"></a><span class="c">!!</span>
<a name="ln-4136"></a><span class="c">!!    program demo_linewidth</span>
<a name="ln-4137"></a><span class="c">!!    use M_draw,     only : prefsize, vinit, clear, getkey, drawstr, page</span>
<a name="ln-4138"></a><span class="c">!!    use M_draw,     only : textsize, ycentertext, rdraw2, rmove2</span>
<a name="ln-4139"></a><span class="c">!!    use M_draw,     only : move2, draw2, vexit, color, linewidth, font</span>
<a name="ln-4140"></a><span class="c">!!    use M_draw,     only : D_BLACK,   D_WHITE</span>
<a name="ln-4141"></a><span class="c">!!    use M_draw,     only : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-4142"></a><span class="c">!!    use M_draw,     only : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-4143"></a><span class="c">!!    implicit none</span>
<a name="ln-4144"></a><span class="c">!!    real    :: b=0.5</span>
<a name="ln-4145"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-4146"></a><span class="c">!!    call prefsize(1000,200)</span>
<a name="ln-4147"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4148"></a><span class="c">!!    call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-4149"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-4150"></a><span class="c">!!    call clear()</span>
<a name="ln-4151"></a><span class="c">!!    call textsize(2.4,3.0)</span>
<a name="ln-4152"></a><span class="c">!!    call font(&quot;futura.m&quot;)</span>
<a name="ln-4153"></a><span class="c">!!    call ycentertext()</span>
<a name="ln-4154"></a><span class="c">!!    ! draw circles with different precisions and label center of circles</span>
<a name="ln-4155"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4156"></a><span class="c">!!    call linewidth(0)</span>
<a name="ln-4157"></a><span class="c">!!    call move2(-20.0, -3.5)</span>
<a name="ln-4158"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4159"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4160"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4161"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4162"></a><span class="c">!!    call drawstr(&quot;0&quot;)</span>
<a name="ln-4163"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-4164"></a><span class="c">!!    call linewidth(100)</span>
<a name="ln-4165"></a><span class="c">!!    call move2(-20.0,0.0)</span>
<a name="ln-4166"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4167"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4168"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4169"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4170"></a><span class="c">!!    call drawstr(&quot;100&quot;)</span>
<a name="ln-4171"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-4172"></a><span class="c">!!    call linewidth(200)</span>
<a name="ln-4173"></a><span class="c">!!    call move2(-20.0,3.5)</span>
<a name="ln-4174"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4175"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4176"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4177"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4178"></a><span class="c">!!    call drawstr(&quot;200&quot;)</span>
<a name="ln-4179"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-4180"></a><span class="c">!!    call linewidth(300)</span>
<a name="ln-4181"></a><span class="c">!!    call move2(3.0,-3.5)</span>
<a name="ln-4182"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4183"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4184"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4185"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4186"></a><span class="c">!!    call drawstr(&quot;300&quot;)</span>
<a name="ln-4187"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-4188"></a><span class="c">!!    call linewidth(400)</span>
<a name="ln-4189"></a><span class="c">!!    call move2(3.0,0.0)</span>
<a name="ln-4190"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4191"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4192"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4193"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4194"></a><span class="c">!!    call drawstr(&quot;400&quot;)</span>
<a name="ln-4195"></a><span class="c">!!    call color(D_CYAN)</span>
<a name="ln-4196"></a><span class="c">!!    call linewidth(500)</span>
<a name="ln-4197"></a><span class="c">!!    call move2(3.0,3.5)</span>
<a name="ln-4198"></a><span class="c">!!    call rdraw2(10.0,0.0)</span>
<a name="ln-4199"></a><span class="c">!!    call rmove2(3.0,0.0)</span>
<a name="ln-4200"></a><span class="c">!!    call linewidth(180)</span>
<a name="ln-4201"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-4202"></a><span class="c">!!    call drawstr(&quot;500&quot;)</span>
<a name="ln-4203"></a><span class="c">!!    call linewidth(200)</span>
<a name="ln-4204"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-4205"></a><span class="c">!!    call move2(-25.0,-5.0)</span>
<a name="ln-4206"></a><span class="c">!!    call draw2(-25.0,5.0)</span>
<a name="ln-4207"></a><span class="c">!!    call draw2(25.0,5.0)</span>
<a name="ln-4208"></a><span class="c">!!    call draw2(25.0,-5.0)</span>
<a name="ln-4209"></a><span class="c">!!    call draw2(-25.0,-5.0)</span>
<a name="ln-4210"></a><span class="c">!!    ipaws=getkey()</span>
<a name="ln-4211"></a><span class="c">!!    ! exit graphics mode</span>
<a name="ln-4212"></a><span class="c">!!    call vexit()</span>
<a name="ln-4213"></a><span class="c">!!    end program demo_linewidth</span>
<a name="ln-4214"></a><span class="c">!&gt;</span>
<a name="ln-4215"></a><span class="c">!!##NAME</span>
<a name="ln-4216"></a><span class="c">!!    dashcode(3f) - [M_draw:LINESTYLE] set dash pattern length</span>
<a name="ln-4217"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4218"></a><span class="c">!!</span>
<a name="ln-4219"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4220"></a><span class="c">!!</span>
<a name="ln-4221"></a><span class="c">!!         subroutine dashcode(dashlen)</span>
<a name="ln-4222"></a><span class="c">!!         real dashlen</span>
<a name="ln-4223"></a><span class="c">!!</span>
<a name="ln-4224"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4225"></a><span class="c">!!</span>
<a name="ln-4226"></a><span class="c">!!    Set the current dash length (in world units) to be dashlen.</span>
<a name="ln-4227"></a><span class="c">!!</span>
<a name="ln-4228"></a><span class="c">!!##IMAGE</span>
<a name="ln-4229"></a><span class="c">!!</span>
<a name="ln-4230"></a><span class="c">!!    The sample graphic shows a line segment being drawn using the same</span>
<a name="ln-4231"></a><span class="c">!!    linestyle except the dashcode is being changed. Note that the dashcode</span>
<a name="ln-4232"></a><span class="c">!!    is in world units,</span>
<a name="ln-4233"></a><span class="c">!!</span>
<a name="ln-4234"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4235"></a><span class="c">!!</span>
<a name="ln-4236"></a><span class="c">!!  Sample program:</span>
<a name="ln-4237"></a><span class="c">!!</span>
<a name="ln-4238"></a><span class="c">!!   program demo_dashcode</span>
<a name="ln-4239"></a><span class="c">!!   use M_draw</span>
<a name="ln-4240"></a><span class="c">!!   implicit none</span>
<a name="ln-4241"></a><span class="c">!!   integer        :: icolor</span>
<a name="ln-4242"></a><span class="c">!!   integer        :: ikey</span>
<a name="ln-4243"></a><span class="c">!!   real,parameter :: b=0.5</span>
<a name="ln-4244"></a><span class="c">!!   real           :: x, y</span>
<a name="ln-4245"></a><span class="c">!!   real           :: dcode</span>
<a name="ln-4246"></a><span class="c">!!      call prefsize(1000,200)</span>
<a name="ln-4247"></a><span class="c">!!      call vinit(&#39; &#39;)</span>
<a name="ln-4248"></a><span class="c">!!      call color(D_BLACK)</span>
<a name="ln-4249"></a><span class="c">!!      call clear()</span>
<a name="ln-4250"></a><span class="c">!!      call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-4251"></a><span class="c">!!      call textsize(2.0, 2.4)</span>
<a name="ln-4252"></a><span class="c">!!      call font(&quot;futura.m&quot;)</span>
<a name="ln-4253"></a><span class="c">!!      call ycentertext()</span>
<a name="ln-4254"></a><span class="c">!!      icolor=7; dcode=0.010/5.0; X=-23.0; Y=3.5  ; call line()</span>
<a name="ln-4255"></a><span class="c">!!      icolor=1; dcode=0.025/5.0; X=-23.0; Y=-0.0 ; call line()</span>
<a name="ln-4256"></a><span class="c">!!      icolor=2; dcode=0.030/5.0; X=-23.0; Y=-3.5 ; call line()</span>
<a name="ln-4257"></a><span class="c">!!      icolor=4; dcode=0.050/5.0; X=0.0;   Y=3.5  ; call line()</span>
<a name="ln-4258"></a><span class="c">!!      icolor=5; dcode=0.075/5.0; X=0.0;   Y=-0.0 ; call line()</span>
<a name="ln-4259"></a><span class="c">!!      icolor=6; dcode=0.100/5.0; X=0.0;   Y=-3.5 ; call line()</span>
<a name="ln-4260"></a><span class="c">!!      call linewidth(200)</span>
<a name="ln-4261"></a><span class="c">!!      call color(D_BLUE)</span>
<a name="ln-4262"></a><span class="c">!!      call move2(-25.0, -5.0)</span>
<a name="ln-4263"></a><span class="c">!!      call draw2(-25.0,  5.0)</span>
<a name="ln-4264"></a><span class="c">!!      call draw2(25.0,   5.0)</span>
<a name="ln-4265"></a><span class="c">!!      call draw2(25.0,  -5.0)</span>
<a name="ln-4266"></a><span class="c">!!      call draw2(-25.0, -5.0)</span>
<a name="ln-4267"></a><span class="c">!!      ikey=getkey()</span>
<a name="ln-4268"></a><span class="c">!!      call vexit()</span>
<a name="ln-4269"></a><span class="c">!!   contains</span>
<a name="ln-4270"></a><span class="c">!!   subroutine line</span>
<a name="ln-4271"></a><span class="c">!!   character(len=6) :: string</span>
<a name="ln-4272"></a><span class="c">!!      call linestyle(&#39;11100100&#39;)</span>
<a name="ln-4273"></a><span class="c">!!      call dashcode(dcode)</span>
<a name="ln-4274"></a><span class="c">!!      call color(icolor)</span>
<a name="ln-4275"></a><span class="c">!!      call linewidth(70)</span>
<a name="ln-4276"></a><span class="c">!!      call move2(X,Y)</span>
<a name="ln-4277"></a><span class="c">!!      call rdraw2(10.0, 0.0)</span>
<a name="ln-4278"></a><span class="c">!!      call rmove2(3.0, 0.0)</span>
<a name="ln-4279"></a><span class="c">!!      call linestyle(&#39;&#39;)</span>
<a name="ln-4280"></a><span class="c">!!      call linewidth(180)</span>
<a name="ln-4281"></a><span class="c">!!      call color(D_WHITE)</span>
<a name="ln-4282"></a><span class="c">!!      write(string,&#39;(f6.3)&#39;)dcode</span>
<a name="ln-4283"></a><span class="c">!!      call drawstr (string)</span>
<a name="ln-4284"></a><span class="c">!!   end subroutine line</span>
<a name="ln-4285"></a><span class="c">!!   end program demo_dashcode</span>
<a name="ln-4286"></a><span class="c">!&gt;</span>
<a name="ln-4287"></a><span class="c">!!##NAME</span>
<a name="ln-4288"></a><span class="c">!!     linestyle(3f) - [M_draw:LINESTYLE] set the line dash pattern</span>
<a name="ln-4289"></a><span class="c">!!     (LICENSE:PD)</span>
<a name="ln-4290"></a><span class="c">!!</span>
<a name="ln-4291"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4292"></a><span class="c">!!</span>
<a name="ln-4293"></a><span class="c">!!    subroutine linestyle(style)</span>
<a name="ln-4294"></a><span class="c">!!    character *(*) style</span>
<a name="ln-4295"></a><span class="c">!!</span>
<a name="ln-4296"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4297"></a><span class="c">!!</span>
<a name="ln-4298"></a><span class="c">!!     Set the current linestyle to style. Linestyles are specified by giving</span>
<a name="ln-4299"></a><span class="c">!!     a nominal length of a single dash and a character string consisting</span>
<a name="ln-4300"></a><span class="c">!!     of 1&#39;s and 0&#39;s (zeros) that specify when to draw a dash and when not</span>
<a name="ln-4301"></a><span class="c">!!     to draw a dash. &quot;1&quot; is for a dash , &quot;0&quot; is for a gap. Linestyles will</span>
<a name="ln-4302"></a><span class="c">!!     follow curves and &quot;go around&quot; corners.</span>
<a name="ln-4303"></a><span class="c">!!</span>
<a name="ln-4304"></a><span class="c">!!     To reset to a solid line style, enter a linestyle of &quot; &quot;. If a</span>
<a name="ln-4305"></a><span class="c">!!     linestyle is set or reset, the accumulated information as to where</span>
<a name="ln-4306"></a><span class="c">!!     on a curve (or line) a dash is to be draw is also reset.</span>
<a name="ln-4307"></a><span class="c">!!</span>
<a name="ln-4308"></a><span class="c">!!     The sample program shows a line segment being drawn using the same</span>
<a name="ln-4309"></a><span class="c">!!     dashcode (to specify dash length) except the linestyle is being</span>
<a name="ln-4310"></a><span class="c">!!     changed. Note that the dashcode is in world units.</span>
<a name="ln-4311"></a><span class="c">!!</span>
<a name="ln-4312"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4313"></a><span class="c">!!</span>
<a name="ln-4314"></a><span class="c">!!  Sample program:</span>
<a name="ln-4315"></a><span class="c">!!</span>
<a name="ln-4316"></a><span class="c">!!     program demo_linestyle</span>
<a name="ln-4317"></a><span class="c">!!     ! A program showing basic line styles.</span>
<a name="ln-4318"></a><span class="c">!!     use M_draw</span>
<a name="ln-4319"></a><span class="c">!!     character(len=40) :: device</span>
<a name="ln-4320"></a><span class="c">!!     integer           :: ios</span>
<a name="ln-4321"></a><span class="c">!!</span>
<a name="ln-4322"></a><span class="c">!!        print*,&#39;Enter output device: &#39;</span>
<a name="ln-4323"></a><span class="c">!!        read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-4324"></a><span class="c">!!        if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-4325"></a><span class="c">!!</span>
<a name="ln-4326"></a><span class="c">!!        call prefsize(1000,1000)</span>
<a name="ln-4327"></a><span class="c">!!        call vinit(device)</span>
<a name="ln-4328"></a><span class="c">!!        call vsetflush(.true.)</span>
<a name="ln-4329"></a><span class="c">!!        call up(0.0, 1.0, 0.0)</span>
<a name="ln-4330"></a><span class="c">!!        call perspective(90.0, 1.0, 0.3, 3.0)</span>
<a name="ln-4331"></a><span class="c">!!        call translate(0.0, 0.0, -1.3)</span>
<a name="ln-4332"></a><span class="c">!!        call linewidth(30)</span>
<a name="ln-4333"></a><span class="c">!!</span>
<a name="ln-4334"></a><span class="c">!!        call drawscene()</span>
<a name="ln-4335"></a><span class="c">!!        call rotate(-30.0, &#39;y&#39;)</span>
<a name="ln-4336"></a><span class="c">!!        call rotate(-30.0, &#39;x&#39;)</span>
<a name="ln-4337"></a><span class="c">!!        call drawscene()</span>
<a name="ln-4338"></a><span class="c">!!</span>
<a name="ln-4339"></a><span class="c">!!        call vexit()</span>
<a name="ln-4340"></a><span class="c">!!        contains</span>
<a name="ln-4341"></a><span class="c">!!</span>
<a name="ln-4342"></a><span class="c">!!        subroutine drawscene()</span>
<a name="ln-4343"></a><span class="c">!!</span>
<a name="ln-4344"></a><span class="c">!!           call color(D_BLACK)</span>
<a name="ln-4345"></a><span class="c">!!           call clear()</span>
<a name="ln-4346"></a><span class="c">!!</span>
<a name="ln-4347"></a><span class="c">!!           call color(D_GREEN)</span>
<a name="ln-4348"></a><span class="c">!!           call dashcode(0.03)</span>
<a name="ln-4349"></a><span class="c">!!</span>
<a name="ln-4350"></a><span class="c">!!           call linestyle(&#39; &#39;)</span>
<a name="ln-4351"></a><span class="c">!!           call xcentertext()</span>
<a name="ln-4352"></a><span class="c">!!           call move2(-0.45, 0.9)</span>
<a name="ln-4353"></a><span class="c">!!           call drawstr(&#39;Linestyle: &quot;10&quot;&#39;)</span>
<a name="ln-4354"></a><span class="c">!!           call move2(-0.45, 0.7)</span>
<a name="ln-4355"></a><span class="c">!!           call drawstr(&#39;Linestyle: &quot;110&quot;&#39;)</span>
<a name="ln-4356"></a><span class="c">!!           call move2(-0.45, 0.5)</span>
<a name="ln-4357"></a><span class="c">!!           call drawstr(&#39;Linestyle: &quot;111010&quot;&#39;)</span>
<a name="ln-4358"></a><span class="c">!!           call move2(-0.45, 0.3)</span>
<a name="ln-4359"></a><span class="c">!!           call drawstr(&#39;Linestyle: &quot;0001&quot;&#39;)</span>
<a name="ln-4360"></a><span class="c">!!</span>
<a name="ln-4361"></a><span class="c">!!           call linestyle(&#39;10&#39;)</span>
<a name="ln-4362"></a><span class="c">!!           call move2(-0.9, 0.9)</span>
<a name="ln-4363"></a><span class="c">!!           call draw2( 0.0, 0.9)</span>
<a name="ln-4364"></a><span class="c">!!           call circle(0.6, 0.6, 0.4)</span>
<a name="ln-4365"></a><span class="c">!!</span>
<a name="ln-4366"></a><span class="c">!!           call drawbox(0.9)</span>
<a name="ln-4367"></a><span class="c">!!           call drawsine(0.9)</span>
<a name="ln-4368"></a><span class="c">!!</span>
<a name="ln-4369"></a><span class="c">!!           call color(D_RED)</span>
<a name="ln-4370"></a><span class="c">!!           call linestyle(&#39;110&#39;)</span>
<a name="ln-4371"></a><span class="c">!!           call move2(-0.9, 0.7)</span>
<a name="ln-4372"></a><span class="c">!!           call draw2( 0.0, 0.7)</span>
<a name="ln-4373"></a><span class="c">!!           call circle(0.6, 0.6, 0.3)</span>
<a name="ln-4374"></a><span class="c">!!           call drawbox(0.7)</span>
<a name="ln-4375"></a><span class="c">!!           call drawsine(0.7)</span>
<a name="ln-4376"></a><span class="c">!!</span>
<a name="ln-4377"></a><span class="c">!!           call color(D_CYAN)</span>
<a name="ln-4378"></a><span class="c">!!           call linestyle(&#39;111010&#39;)</span>
<a name="ln-4379"></a><span class="c">!!           call move2(-0.9, 0.5)</span>
<a name="ln-4380"></a><span class="c">!!           call draw2( 0.0, 0.5)</span>
<a name="ln-4381"></a><span class="c">!!           call circle(0.6, 0.6, 0.2)</span>
<a name="ln-4382"></a><span class="c">!!           call drawbox(0.5)</span>
<a name="ln-4383"></a><span class="c">!!           call drawsine(0.5)</span>
<a name="ln-4384"></a><span class="c">!!</span>
<a name="ln-4385"></a><span class="c">!!           call color(D_YELLOW)</span>
<a name="ln-4386"></a><span class="c">!!           call linestyle(&#39;0001&#39;)</span>
<a name="ln-4387"></a><span class="c">!!           call move2(-0.9, 0.3)</span>
<a name="ln-4388"></a><span class="c">!!           call draw2( 0.0, 0.3)</span>
<a name="ln-4389"></a><span class="c">!!           call circle(0.6, 0.6, 0.1)</span>
<a name="ln-4390"></a><span class="c">!!           call drawbox(0.3)</span>
<a name="ln-4391"></a><span class="c">!!           call drawsine(0.3)</span>
<a name="ln-4392"></a><span class="c">!!</span>
<a name="ln-4393"></a><span class="c">!!           idum=getkey()</span>
<a name="ln-4394"></a><span class="c">!!</span>
<a name="ln-4395"></a><span class="c">!!           end subroutine drawscene</span>
<a name="ln-4396"></a><span class="c">!!</span>
<a name="ln-4397"></a><span class="c">!!           subroutine drawbox(scl)</span>
<a name="ln-4398"></a><span class="c">!!           real :: scl</span>
<a name="ln-4399"></a><span class="c">!!</span>
<a name="ln-4400"></a><span class="c">!!           call pushmatrix()</span>
<a name="ln-4401"></a><span class="c">!!</span>
<a name="ln-4402"></a><span class="c">!!           call rotate(30.0, &#39;x&#39;)</span>
<a name="ln-4403"></a><span class="c">!!           call rotate(60.0, &#39;y&#39;)</span>
<a name="ln-4404"></a><span class="c">!!           call translate(-0.7, -1.2, 0.0)</span>
<a name="ln-4405"></a><span class="c">!!           call scale(scl, scl, scl)</span>
<a name="ln-4406"></a><span class="c">!!</span>
<a name="ln-4407"></a><span class="c">!!           call move(0.0, 0.0, 0.0)</span>
<a name="ln-4408"></a><span class="c">!!</span>
<a name="ln-4409"></a><span class="c">!!           call draw(1.0, 0.0, 0.0)</span>
<a name="ln-4410"></a><span class="c">!!           call draw(1.0, 1.0, 0.0)</span>
<a name="ln-4411"></a><span class="c">!!           call draw(0.0, 1.0, 0.0)</span>
<a name="ln-4412"></a><span class="c">!!           call draw(0.0, 0.0, 0.0)</span>
<a name="ln-4413"></a><span class="c">!!</span>
<a name="ln-4414"></a><span class="c">!!           call draw(0.0, 0.0, -1.0)</span>
<a name="ln-4415"></a><span class="c">!!           call draw(1.0, 0.0, -1.0)</span>
<a name="ln-4416"></a><span class="c">!!           call draw(1.0, 1.0, -1.0)</span>
<a name="ln-4417"></a><span class="c">!!           call draw(0.0, 1.0, -1.0)</span>
<a name="ln-4418"></a><span class="c">!!           call draw(0.0, 0.0, -1.0)</span>
<a name="ln-4419"></a><span class="c">!!</span>
<a name="ln-4420"></a><span class="c">!!           call move(0.0, 1.0, -1.0)</span>
<a name="ln-4421"></a><span class="c">!!           call draw(0.0, 1.0, 0.0)</span>
<a name="ln-4422"></a><span class="c">!!</span>
<a name="ln-4423"></a><span class="c">!!           call move(1.0, 1.0, 0.0)</span>
<a name="ln-4424"></a><span class="c">!!           call draw(1.0, 1.0, -1.0)</span>
<a name="ln-4425"></a><span class="c">!!</span>
<a name="ln-4426"></a><span class="c">!!           call move(1.0, 0.0, 0.0)</span>
<a name="ln-4427"></a><span class="c">!!           call draw(1.0, 0.0, -1.0)</span>
<a name="ln-4428"></a><span class="c">!!</span>
<a name="ln-4429"></a><span class="c">!!           call popmatrix()</span>
<a name="ln-4430"></a><span class="c">!!</span>
<a name="ln-4431"></a><span class="c">!!           end subroutine drawbox</span>
<a name="ln-4432"></a><span class="c">!!</span>
<a name="ln-4433"></a><span class="c">!!           subroutine drawsine(s)</span>
<a name="ln-4434"></a><span class="c">!!           real    s, RAD, AMP</span>
<a name="ln-4435"></a><span class="c">!!           parameter(RAD = 0.5, AMP = 0.04)</span>
<a name="ln-4436"></a><span class="c">!!           real    a, x, y, z</span>
<a name="ln-4437"></a><span class="c">!!</span>
<a name="ln-4438"></a><span class="c">!!           call pushmatrix()</span>
<a name="ln-4439"></a><span class="c">!!</span>
<a name="ln-4440"></a><span class="c">!!           call translate(RAD + 0.2, -0.5, 0.0)</span>
<a name="ln-4441"></a><span class="c">!!           call scale(s, s, s)</span>
<a name="ln-4442"></a><span class="c">!!</span>
<a name="ln-4443"></a><span class="c">!!           call move(RAD, 0.0, 0.0)</span>
<a name="ln-4444"></a><span class="c">!!           a=0.0</span>
<a name="ln-4445"></a><span class="c">!!           do i10 = 0,2*314,2</span>
<a name="ln-4446"></a><span class="c">!!              x = RAD * cos(a)</span>
<a name="ln-4447"></a><span class="c">!!              z = RAD * sin(a)</span>
<a name="ln-4448"></a><span class="c">!!              y = AMP * sin(a * 6.0)</span>
<a name="ln-4449"></a><span class="c">!!</span>
<a name="ln-4450"></a><span class="c">!!              call draw(x, y, z)</span>
<a name="ln-4451"></a><span class="c">!!              a=a+0.02</span>
<a name="ln-4452"></a><span class="c">!!           enddo</span>
<a name="ln-4453"></a><span class="c">!!           call popmatrix()</span>
<a name="ln-4454"></a><span class="c">!!           end subroutine drawsine</span>
<a name="ln-4455"></a><span class="c">!!     end program demo_linestyle</span>
<a name="ln-4456"></a><span class="c">!&gt;</span>
<a name="ln-4457"></a><span class="c">!!##NAME</span>
<a name="ln-4458"></a><span class="c">!!    clear(3f) - [M_draw:COLOR] Clears screen to current color</span>
<a name="ln-4459"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4460"></a><span class="c">!!</span>
<a name="ln-4461"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4462"></a><span class="c">!!</span>
<a name="ln-4463"></a><span class="c">!!    subroutine clear()</span>
<a name="ln-4464"></a><span class="c">!!</span>
<a name="ln-4465"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4466"></a><span class="c">!!</span>
<a name="ln-4467"></a><span class="c">!!    Clears the screen to the current color. Causes a new page to begin</span>
<a name="ln-4468"></a><span class="c">!!    on file-based devices that support multiple pages (Currently, the</span>
<a name="ln-4469"></a><span class="c">!!    pixmap devices do not support multiple pages).</span>
<a name="ln-4470"></a><span class="c">!!</span>
<a name="ln-4471"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4472"></a><span class="c">!!</span>
<a name="ln-4473"></a><span class="c">!!  Sample program:</span>
<a name="ln-4474"></a><span class="c">!!</span>
<a name="ln-4475"></a><span class="c">!!      program demo_clear</span>
<a name="ln-4476"></a><span class="c">!!      use M_draw, only  : prefsize, vinit, ortho2, clear, getkey</span>
<a name="ln-4477"></a><span class="c">!!      use M_draw, only  : vexit, color, circle, polyfill</span>
<a name="ln-4478"></a><span class="c">!!      use M_draw, only  : D_BLACK,   D_WHITE</span>
<a name="ln-4479"></a><span class="c">!!      use M_draw, only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-4480"></a><span class="c">!!      use M_draw, only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-4481"></a><span class="c">!!      implicit none</span>
<a name="ln-4482"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-4483"></a><span class="c">!!</span>
<a name="ln-4484"></a><span class="c">!!      call prefsize(300,300)</span>
<a name="ln-4485"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4486"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-4487"></a><span class="c">!!      call ortho2(-100.0,100.0,-100.0,100.0)</span>
<a name="ln-4488"></a><span class="c">!!</span>
<a name="ln-4489"></a><span class="c">!!      call color(D_BLACK)               ! set current  color</span>
<a name="ln-4490"></a><span class="c">!!      call clear()                ! clear background to current color</span>
<a name="ln-4491"></a><span class="c">!!      call color(D_RED)               ! set color to draw with</span>
<a name="ln-4492"></a><span class="c">!!      call circle(0.0,0.0,50.0)</span>
<a name="ln-4493"></a><span class="c">!!      ipaws=getkey()              ! pause for a keypress on interactive devices</span>
<a name="ln-4494"></a><span class="c">!!</span>
<a name="ln-4495"></a><span class="c">!!      call color(D_GREEN)               ! make a second page</span>
<a name="ln-4496"></a><span class="c">!!      call clear()</span>
<a name="ln-4497"></a><span class="c">!!      call polyfill(.true.)</span>
<a name="ln-4498"></a><span class="c">!!      call color(D_YELLOW)</span>
<a name="ln-4499"></a><span class="c">!!      call circle(0.0,0.0,50.0)</span>
<a name="ln-4500"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-4501"></a><span class="c">!!</span>
<a name="ln-4502"></a><span class="c">!!      call vexit()</span>
<a name="ln-4503"></a><span class="c">!!</span>
<a name="ln-4504"></a><span class="c">!!      end program demo_clear</span>
<a name="ln-4505"></a><span class="c">!&gt;</span>
<a name="ln-4506"></a><span class="c">!!##NAME</span>
<a name="ln-4507"></a><span class="c">!!    color(3f) - [M_draw:COLOR] Set current color</span>
<a name="ln-4508"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4509"></a><span class="c">!!</span>
<a name="ln-4510"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4511"></a><span class="c">!!</span>
<a name="ln-4512"></a><span class="c">!!         subroutine color(col)</span>
<a name="ln-4513"></a><span class="c">!!         integer,intent(in) :: col</span>
<a name="ln-4514"></a><span class="c">!!</span>
<a name="ln-4515"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4516"></a><span class="c">!!</span>
<a name="ln-4517"></a><span class="c">!! Set the current color. The standard colors are as follows:</span>
<a name="ln-4518"></a><span class="c">!!</span>
<a name="ln-4519"></a><span class="c">!!       d_black  =  0  d_red      =  1  d_green  =  2  d_yellow  =  3</span>
<a name="ln-4520"></a><span class="c">!!       d_blue   =  4  d_magenta  =  5  d_cyan   =  6  d_white   =  7</span>
<a name="ln-4521"></a><span class="c">!!</span>
<a name="ln-4522"></a><span class="c">!!##OPTION</span>
<a name="ln-4523"></a><span class="c">!!     COL  A color number from 0 to 255. To define additional</span>
<a name="ln-4524"></a><span class="c">!!          colors see mapcolor(3f).</span>
<a name="ln-4525"></a><span class="c">!!</span>
<a name="ln-4526"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4527"></a><span class="c">!!</span>
<a name="ln-4528"></a><span class="c">!!   Sample program:</span>
<a name="ln-4529"></a><span class="c">!!</span>
<a name="ln-4530"></a><span class="c">!!     program demo_color</span>
<a name="ln-4531"></a><span class="c">!!     use M_draw</span>
<a name="ln-4532"></a><span class="c">!!     real    :: b=0.5</span>
<a name="ln-4533"></a><span class="c">!!     real    :: y1,y2,ym,x1,x2</span>
<a name="ln-4534"></a><span class="c">!!     real    :: width=50.0/8.0,width2</span>
<a name="ln-4535"></a><span class="c">!!     integer :: i</span>
<a name="ln-4536"></a><span class="c">!!     integer :: ipaws</span>
<a name="ln-4537"></a><span class="c">!!        !! set up long bar as plotting area</span>
<a name="ln-4538"></a><span class="c">!!        call prefsize(1000,200)</span>
<a name="ln-4539"></a><span class="c">!!        call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4540"></a><span class="c">!!        call page(-25.0-b, 25.0+b, -5.0-b, 5.0+b)</span>
<a name="ln-4541"></a><span class="c">!!        call textsize( 3.5, 4.0)</span>
<a name="ln-4542"></a><span class="c">!!        call font(&#39;futura.m&#39;)</span>
<a name="ln-4543"></a><span class="c">!!        call centertext(.true.)</span>
<a name="ln-4544"></a><span class="c">!!        call linewidth(90)</span>
<a name="ln-4545"></a><span class="c">!!        y1=-5</span>
<a name="ln-4546"></a><span class="c">!!        y2=5</span>
<a name="ln-4547"></a><span class="c">!!        ym=0</span>
<a name="ln-4548"></a><span class="c">!!        x1=-25+.05*width</span>
<a name="ln-4549"></a><span class="c">!!        ! draw colored rectangle and a circle and label center of circle</span>
<a name="ln-4550"></a><span class="c">!!        ! and repeat from colors 0 to 7.</span>
<a name="ln-4551"></a><span class="c">!!        width2=width*0.95</span>
<a name="ln-4552"></a><span class="c">!!        call linewidth(40)</span>
<a name="ln-4553"></a><span class="c">!!        do i=0,7</span>
<a name="ln-4554"></a><span class="c">!!           call color(i)</span>
<a name="ln-4555"></a><span class="c">!!           x2=x1+width2</span>
<a name="ln-4556"></a><span class="c">!!           call polyfill(.true.)</span>
<a name="ln-4557"></a><span class="c">!!           call makepoly()</span>
<a name="ln-4558"></a><span class="c">!!           call rect(x1,y1,x2,y2)</span>
<a name="ln-4559"></a><span class="c">!!           call closepoly()</span>
<a name="ln-4560"></a><span class="c">!!           call color(mod(i+1,7)+1)</span>
<a name="ln-4561"></a><span class="c">!!           call move2((x1+x2)/2.0,ym)</span>
<a name="ln-4562"></a><span class="c">!!           call print(i)     ! convert number to string and draw it</span>
<a name="ln-4563"></a><span class="c">!!           call polyfill(.false.)</span>
<a name="ln-4564"></a><span class="c">!!           call circle((x1+x2)/2.0, ym, (x2-x1)/2.10)</span>
<a name="ln-4565"></a><span class="c">!!           x1=x1+width</span>
<a name="ln-4566"></a><span class="c">!!        enddo</span>
<a name="ln-4567"></a><span class="c">!!        ipaws=getkey()</span>
<a name="ln-4568"></a><span class="c">!!        call vexit()</span>
<a name="ln-4569"></a><span class="c">!!     end program demo_color</span>
<a name="ln-4570"></a><span class="c">!&gt;</span>
<a name="ln-4571"></a><span class="c">!!##NAME</span>
<a name="ln-4572"></a><span class="c">!!    mapcolor(3f) - [M_draw:COLOR] set a color index using RGB values</span>
<a name="ln-4573"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4574"></a><span class="c">!!</span>
<a name="ln-4575"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4576"></a><span class="c">!!</span>
<a name="ln-4577"></a><span class="c">!!         subroutine mapcolor(indx, red, green, blue)</span>
<a name="ln-4578"></a><span class="c">!!         integer,intent(in) :: indx, red, green, blue</span>
<a name="ln-4579"></a><span class="c">!!</span>
<a name="ln-4580"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4581"></a><span class="c">!!</span>
<a name="ln-4582"></a><span class="c">!!    Set the color map index indx to the color represented by (red, green,</span>
<a name="ln-4583"></a><span class="c">!!    blue). If the device has no color map this call does nothing.</span>
<a name="ln-4584"></a><span class="c">!!</span>
<a name="ln-4585"></a><span class="c">!!    rgb values are in the range of 0 to 255.</span>
<a name="ln-4586"></a><span class="c">!!</span>
<a name="ln-4587"></a><span class="c">!!##OPTIONS</span>
<a name="ln-4588"></a><span class="c">!!    INDX    color index number, in range 0 to 255</span>
<a name="ln-4589"></a><span class="c">!!    RED     red component of color being defined, in range 0 to 255</span>
<a name="ln-4590"></a><span class="c">!!    GREEN   green component of color being defined, in range 0 to 255</span>
<a name="ln-4591"></a><span class="c">!!    BLUE    blue component of color being defined, in range 0 to 255</span>
<a name="ln-4592"></a><span class="c">!!</span>
<a name="ln-4593"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4594"></a><span class="c">!!</span>
<a name="ln-4595"></a><span class="c">!!  Color wheel EXAMPLE:</span>
<a name="ln-4596"></a><span class="c">!!</span>
<a name="ln-4597"></a><span class="c">!!    program demo_mapcolor</span>
<a name="ln-4598"></a><span class="c">!!    !   good program to exercise color tables, and look at differences</span>
<a name="ln-4599"></a><span class="c">!!    !   when actual output device has a color table that is dynamic,</span>
<a name="ln-4600"></a><span class="c">!!    !   or only has a small color table (a frame in this program takes</span>
<a name="ln-4601"></a><span class="c">!!    !   at least SLICES*RINGS colors to produce accurately).</span>
<a name="ln-4602"></a><span class="c">!!    use M_draw</span>
<a name="ln-4603"></a><span class="c">!!    use m_color, only : hue</span>
<a name="ln-4604"></a><span class="c">!!    use M_units, only : cosd, sind</span>
<a name="ln-4605"></a><span class="c">!!    implicit none</span>
<a name="ln-4606"></a><span class="c">!!       real                 :: lightstep</span>
<a name="ln-4607"></a><span class="c">!!       integer              :: ii,iframe</span>
<a name="ln-4608"></a><span class="c">!!       integer,parameter    :: SLICES=30</span>
<a name="ln-4609"></a><span class="c">!!       integer,parameter    :: RINGS=  8</span>
<a name="ln-4610"></a><span class="c">!!       real                 :: LIGHTNESS</span>
<a name="ln-4611"></a><span class="c">!!       integer,parameter    :: BOX=1200</span>
<a name="ln-4612"></a><span class="c">!!       integer              :: ipaws</span>
<a name="ln-4613"></a><span class="c">!!       integer              :: istart, iend</span>
<a name="ln-4614"></a><span class="c">!!       character(len=20)    :: device</span>
<a name="ln-4615"></a><span class="c">!!       call prefsize(BOX,BOX)</span>
<a name="ln-4616"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4617"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-4618"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-4619"></a><span class="c">!!       call clear()</span>
<a name="ln-4620"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-4621"></a><span class="c">!!       call page(-110./2.,85./2.,-110./2.,110./2.)</span>
<a name="ln-4622"></a><span class="c">!!       LIGHTNESS=100.0</span>
<a name="ln-4623"></a><span class="c">!!       lightstep=-5</span>
<a name="ln-4624"></a><span class="c">!!</span>
<a name="ln-4625"></a><span class="c">!!       call vgetdev(device)</span>
<a name="ln-4626"></a><span class="c">!!       select case(device)</span>
<a name="ln-4627"></a><span class="c">!!       case (&#39;p6&#39;,&#39;p3&#39;,&#39;ppm&#39;) ! just do one wheel</span>
<a name="ln-4628"></a><span class="c">!!          istart=10</span>
<a name="ln-4629"></a><span class="c">!!          iend=10</span>
<a name="ln-4630"></a><span class="c">!!          LIGHTNESS=50.0</span>
<a name="ln-4631"></a><span class="c">!!       case default           ! do many lightnesses</span>
<a name="ln-4632"></a><span class="c">!!          istart=1</span>
<a name="ln-4633"></a><span class="c">!!          iend=19</span>
<a name="ln-4634"></a><span class="c">!!       end select</span>
<a name="ln-4635"></a><span class="c">!!</span>
<a name="ln-4636"></a><span class="c">!!       do ii=istart,iend</span>
<a name="ln-4637"></a><span class="c">!!          iframe=ii</span>
<a name="ln-4638"></a><span class="c">!!          call color(D_BLACK)</span>
<a name="ln-4639"></a><span class="c">!!          call clear()</span>
<a name="ln-4640"></a><span class="c">!!          call color(D_WHITE)</span>
<a name="ln-4641"></a><span class="c">!!          call wheel()</span>
<a name="ln-4642"></a><span class="c">!!          LIGHTNESS=LIGHTNESS+LIGHTSTEP</span>
<a name="ln-4643"></a><span class="c">!!          ipaws=getkey()</span>
<a name="ln-4644"></a><span class="c">!!       enddo</span>
<a name="ln-4645"></a><span class="c">!!       call vexit()</span>
<a name="ln-4646"></a><span class="c">!!    contains</span>
<a name="ln-4647"></a><span class="c">!!    !=======================================================================--------</span>
<a name="ln-4648"></a><span class="c">!!    subroutine wheel() ! draw an entire wheel</span>
<a name="ln-4649"></a><span class="c">!!       character(len=40) :: inline</span>
<a name="ln-4650"></a><span class="c">!!       real              :: hue_val</span>
<a name="ln-4651"></a><span class="c">!!       integer           :: ii</span>
<a name="ln-4652"></a><span class="c">!!       call textang(0.0)</span>
<a name="ln-4653"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-4654"></a><span class="c">!!       call textsize(5.0,6.0)</span>
<a name="ln-4655"></a><span class="c">!!       call font(&#39;times.r&#39;)</span>
<a name="ln-4656"></a><span class="c">!!       call move2(0.0,103.0/2.0)</span>
<a name="ln-4657"></a><span class="c">!!       call centertext(.true.)</span>
<a name="ln-4658"></a><span class="c">!!       call linewidth(30)</span>
<a name="ln-4659"></a><span class="c">!!       call drawstr(&#39;COLOR WHEEL&#39;)</span>
<a name="ln-4660"></a><span class="c">!!       call linewidth(0)</span>
<a name="ln-4661"></a><span class="c">!!       call textsize( 2.5,2.5)</span>
<a name="ln-4662"></a><span class="c">!!       call font(&#39;futura.l&#39;)</span>
<a name="ln-4663"></a><span class="c">!!       call move2(0.0,90.0/2.0)</span>
<a name="ln-4664"></a><span class="c">!!       write(inline,&#39;(&quot;lightness=&quot;,f6.2)&#39;)LIGHTNESS</span>
<a name="ln-4665"></a><span class="c">!!       call linewidth(30)</span>
<a name="ln-4666"></a><span class="c">!!       call drawstr(inline)</span>
<a name="ln-4667"></a><span class="c">!!       call linewidth(0)</span>
<a name="ln-4668"></a><span class="c">!!       call textsize(1.5,1.5)</span>
<a name="ln-4669"></a><span class="c">!!       hue_val=0</span>
<a name="ln-4670"></a><span class="c">!!       do ii=SLICES, 1,-1</span>
<a name="ln-4671"></a><span class="c">!!          call slice(hue_val)</span>
<a name="ln-4672"></a><span class="c">!!       enddo</span>
<a name="ln-4673"></a><span class="c">!!       call centertext(.false.)</span>
<a name="ln-4674"></a><span class="c">!!    end subroutine wheel</span>
<a name="ln-4675"></a><span class="c">!!    !=======================================================================--------</span>
<a name="ln-4676"></a><span class="c">!!    subroutine slice(hue_val) ! draw a slice</span>
<a name="ln-4677"></a><span class="c">!!       integer           :: buffer</span>
<a name="ln-4678"></a><span class="c">!!       real              :: hue_val, ang_inc</span>
<a name="ln-4679"></a><span class="c">!!       character(len=40) :: inline</span>
<a name="ln-4680"></a><span class="c">!!       real              :: step</span>
<a name="ln-4681"></a><span class="c">!!       real              :: X1, X2, X3, X4</span>
<a name="ln-4682"></a><span class="c">!!       real              :: Y1, Y2, Y3, Y4</span>
<a name="ln-4683"></a><span class="c">!!       !</span>
<a name="ln-4684"></a><span class="c">!!       integer           :: maxcolors, current_color</span>
<a name="ln-4685"></a><span class="c">!!       integer           :: ir, ig, ib</span>
<a name="ln-4686"></a><span class="c">!!       real              :: r,g,b</span>
<a name="ln-4687"></a><span class="c">!!       real              :: saturation</span>
<a name="ln-4688"></a><span class="c">!!       !</span>
<a name="ln-4689"></a><span class="c">!!       integer           :: status</span>
<a name="ln-4690"></a><span class="c">!!       integer           :: icount</span>
<a name="ln-4691"></a><span class="c">!!       real              :: angle1, angle2</span>
<a name="ln-4692"></a><span class="c">!!       real              :: radius1, radius2, radius3, radius4</span>
<a name="ln-4693"></a><span class="c">!!       !</span>
<a name="ln-4694"></a><span class="c">!!       integer,save      :: color_count=0</span>
<a name="ln-4695"></a><span class="c">!!       !</span>
<a name="ln-4696"></a><span class="c">!!       buffer=8</span>
<a name="ln-4697"></a><span class="c">!!       ANG_INC=360.0/SLICES</span>
<a name="ln-4698"></a><span class="c">!!       angle1=hue_val-ANG_INC/2</span>
<a name="ln-4699"></a><span class="c">!!       angle2=angle1+ANG_INC</span>
<a name="ln-4700"></a><span class="c">!!       saturation=100</span>
<a name="ln-4701"></a><span class="c">!!       radius1=32</span>
<a name="ln-4702"></a><span class="c">!!       radius3=radius1+4</span>
<a name="ln-4703"></a><span class="c">!!       radius4=radius1+7</span>
<a name="ln-4704"></a><span class="c">!!       ! draw tic from wheel to start of angle label</span>
<a name="ln-4705"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-4706"></a><span class="c">!!       call linewidth(40)</span>
<a name="ln-4707"></a><span class="c">!!       call move2( radius1*cosd(hue_val), radius1*sind(hue_val) )</span>
<a name="ln-4708"></a><span class="c">!!       call draw2( radius3*cosd(hue_val), radius3*sind(hue_val) )</span>
<a name="ln-4709"></a><span class="c">!!       ! draw degree label at tic</span>
<a name="ln-4710"></a><span class="c">!!       call textang(hue_val)</span>
<a name="ln-4711"></a><span class="c">!!       call move2( radius4*cosd(hue_val), radius4*sind(hue_val) )</span>
<a name="ln-4712"></a><span class="c">!!       write(inline,&#39;(i0)&#39;)nint(hue_val)</span>
<a name="ln-4713"></a><span class="c">!!       call linewidth(20)</span>
<a name="ln-4714"></a><span class="c">!!       call drawstr(inline)</span>
<a name="ln-4715"></a><span class="c">!!       call linewidth(0)</span>
<a name="ln-4716"></a><span class="c">!!       step=radius1/real(RINGS)</span>
<a name="ln-4717"></a><span class="c">!!       radius2=radius1-step</span>
<a name="ln-4718"></a><span class="c">!!       ! draw a chunk in a slice</span>
<a name="ln-4719"></a><span class="c">!!       MAXCOLORS=(256)-buffer</span>
<a name="ln-4720"></a><span class="c">!!       do icount=RINGS+1,2,-1</span>
<a name="ln-4721"></a><span class="c">!!          CURRENT_COLOR=MOD(color_count,MAXCOLORS)+buffer  ! add buffer to leave base colors alone</span>
<a name="ln-4722"></a><span class="c">!!          color_count=color_count+1</span>
<a name="ln-4723"></a><span class="c">!!          ! fancy mapcolor</span>
<a name="ln-4724"></a><span class="c">!!          call hue(&quot;hls&quot;,hue_val,LIGHTNESS,saturation,&quot;rgb&quot;,r,g,b,status)</span>
<a name="ln-4725"></a><span class="c">!!          ir=int(r*255.0/100.0+0.50)</span>
<a name="ln-4726"></a><span class="c">!!          ig=int(g*255.0/100.0+0.50)</span>
<a name="ln-4727"></a><span class="c">!!          ib=int(b*255.0/100.0+0.50)</span>
<a name="ln-4728"></a><span class="c">!!          call mapcolor(CURRENT_COLOR,ir,ig,ib)</span>
<a name="ln-4729"></a><span class="c">!!          call color(CURRENT_COLOR)</span>
<a name="ln-4730"></a><span class="c">!!          !</span>
<a name="ln-4731"></a><span class="c">!!          X1=cosd(angle1)*radius2</span>
<a name="ln-4732"></a><span class="c">!!          Y1=sind(angle1)*radius2</span>
<a name="ln-4733"></a><span class="c">!!          X2=cosd(angle1)*radius1</span>
<a name="ln-4734"></a><span class="c">!!          Y2=sind(angle1)*radius1</span>
<a name="ln-4735"></a><span class="c">!!          !</span>
<a name="ln-4736"></a><span class="c">!!          X3=cosd(angle2)*radius2</span>
<a name="ln-4737"></a><span class="c">!!          Y3=sind(angle2)*radius2</span>
<a name="ln-4738"></a><span class="c">!!          X4=cosd(angle2)*radius1</span>
<a name="ln-4739"></a><span class="c">!!          Y4=sind(angle2)*radius1</span>
<a name="ln-4740"></a><span class="c">!!          !</span>
<a name="ln-4741"></a><span class="c">!!          call makepoly()</span>
<a name="ln-4742"></a><span class="c">!!          call move2(X1,Y1)</span>
<a name="ln-4743"></a><span class="c">!!          call draw2(X2,Y2)</span>
<a name="ln-4744"></a><span class="c">!!          call draw2(X4,Y4)</span>
<a name="ln-4745"></a><span class="c">!!          call draw2(X3,Y3)</span>
<a name="ln-4746"></a><span class="c">!!          call closepoly()</span>
<a name="ln-4747"></a><span class="c">!!          !</span>
<a name="ln-4748"></a><span class="c">!!          saturation=saturation-100.0/RINGS</span>
<a name="ln-4749"></a><span class="c">!!          radius1=radius2</span>
<a name="ln-4750"></a><span class="c">!!          radius2=radius1-step</span>
<a name="ln-4751"></a><span class="c">!!       enddo</span>
<a name="ln-4752"></a><span class="c">!!       hue_val=hue_val+ANG_INC</span>
<a name="ln-4753"></a><span class="c">!!    end subroutine slice</span>
<a name="ln-4754"></a><span class="c">!!    end program demo_mapcolor</span>
<a name="ln-4755"></a><span class="c">!&gt;</span>
<a name="ln-4756"></a><span class="c">!!##NAME</span>
<a name="ln-4757"></a><span class="c">!!    clipping(3f) - [M_draw:CLIPPING] Turn clipping on or off</span>
<a name="ln-4758"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4759"></a><span class="c">!!</span>
<a name="ln-4760"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4761"></a><span class="c">!!</span>
<a name="ln-4762"></a><span class="c">!!          subroutine clipping(onoff)</span>
<a name="ln-4763"></a><span class="c">!!</span>
<a name="ln-4764"></a><span class="c">!!          logical onoff</span>
<a name="ln-4765"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4766"></a><span class="c">!!</span>
<a name="ln-4767"></a><span class="c">!! Turn clipping on or off. Note: on some devices</span>
<a name="ln-4768"></a><span class="c">!! turning clipping off may not be a good idea.</span>
<a name="ln-4769"></a><span class="c">!&gt;</span>
<a name="ln-4770"></a><span class="c">!!##NAME</span>
<a name="ln-4771"></a><span class="c">!!    getkey(3f) - [M_draw:INTERACTIVE] Return ASCII ordinal of next key typed</span>
<a name="ln-4772"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4773"></a><span class="c">!!</span>
<a name="ln-4774"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4775"></a><span class="c">!!</span>
<a name="ln-4776"></a><span class="c">!!          integer function getkey()</span>
<a name="ln-4777"></a><span class="c">!!</span>
<a name="ln-4778"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4779"></a><span class="c">!!</span>
<a name="ln-4780"></a><span class="c">!!    Return the ASCII ordinal of the next key typed at the keyboard. If the</span>
<a name="ln-4781"></a><span class="c">!!    device has no keyboard getkey(3) returns -1.</span>
<a name="ln-4782"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4783"></a><span class="c">!!</span>
<a name="ln-4784"></a><span class="c">!!   Sample program:</span>
<a name="ln-4785"></a><span class="c">!!</span>
<a name="ln-4786"></a><span class="c">!!      program demo_getkey</span>
<a name="ln-4787"></a><span class="c">!!      use :: M_draw</span>
<a name="ln-4788"></a><span class="c">!!      !! set up drawing environment</span>
<a name="ln-4789"></a><span class="c">!!      call prefsize(600,600)</span>
<a name="ln-4790"></a><span class="c">!!      call voutput(&#39;+&#39;)</span>
<a name="ln-4791"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4792"></a><span class="c">!!      call ortho2(-300.0,300.0,-300.0,300.0)</span>
<a name="ln-4793"></a><span class="c">!!      call textsize(500.0,500.0)</span>
<a name="ln-4794"></a><span class="c">!!      call linewidth(130)</span>
<a name="ln-4795"></a><span class="c">!!      call centertext(.true.)</span>
<a name="ln-4796"></a><span class="c">!!      call color(D_BLACK)</span>
<a name="ln-4797"></a><span class="c">!!      call clear()</span>
<a name="ln-4798"></a><span class="c">!!      write(*,*)&#39;press any character to see it displayed in the default font&#39;</span>
<a name="ln-4799"></a><span class="c">!!      write(*,*)&#39;Enter &quot;q&quot; to quit&#39;</span>
<a name="ln-4800"></a><span class="c">!!      do</span>
<a name="ln-4801"></a><span class="c">!!        ichar=getkey()</span>
<a name="ln-4802"></a><span class="c">!!        if(ichar.lt.0)then</span>
<a name="ln-4803"></a><span class="c">!!           write(*,*)&#39;this device does not support getkey&#39;</span>
<a name="ln-4804"></a><span class="c">!!           exit</span>
<a name="ln-4805"></a><span class="c">!!        elseif(ichar.ne.0)then</span>
<a name="ln-4806"></a><span class="c">!!           call color(D_BLACK)</span>
<a name="ln-4807"></a><span class="c">!!           call clear()</span>
<a name="ln-4808"></a><span class="c">!!           call color(D_BLUE)</span>
<a name="ln-4809"></a><span class="c">!!           call move2(0.0,0.0)</span>
<a name="ln-4810"></a><span class="c">!!           call drawstr(char(ichar))</span>
<a name="ln-4811"></a><span class="c">!!        endif</span>
<a name="ln-4812"></a><span class="c">!!        if(char(ichar).eq.&#39;q&#39;)then</span>
<a name="ln-4813"></a><span class="c">!!           write(*,*)&#39;press any key to exit&#39;</span>
<a name="ln-4814"></a><span class="c">!!           ichar=getkey()</span>
<a name="ln-4815"></a><span class="c">!!           exit</span>
<a name="ln-4816"></a><span class="c">!!        endif</span>
<a name="ln-4817"></a><span class="c">!!      enddo</span>
<a name="ln-4818"></a><span class="c">!!      call vexit()</span>
<a name="ln-4819"></a><span class="c">!!      end program demo_getkey</span>
<a name="ln-4820"></a><span class="c">!&gt;</span>
<a name="ln-4821"></a><span class="c">!!##NAME</span>
<a name="ln-4822"></a><span class="c">!!    checkkey(3f) - [M_draw:INTERACTIVE] Returns zero if no key is pressed or ASCII ordinal</span>
<a name="ln-4823"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4824"></a><span class="c">!!</span>
<a name="ln-4825"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4826"></a><span class="c">!!</span>
<a name="ln-4827"></a><span class="c">!!          integer function checkkey()</span>
<a name="ln-4828"></a><span class="c">!!</span>
<a name="ln-4829"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4830"></a><span class="c">!!</span>
<a name="ln-4831"></a><span class="c">!!    Returns zero if no key is pressed or the ASCII ordinal of the key</span>
<a name="ln-4832"></a><span class="c">!!    that was pressed.</span>
<a name="ln-4833"></a><span class="c">!!</span>
<a name="ln-4834"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4835"></a><span class="c">!!</span>
<a name="ln-4836"></a><span class="c">!!   Sample program:</span>
<a name="ln-4837"></a><span class="c">!!</span>
<a name="ln-4838"></a><span class="c">!!    program demo_checkkey</span>
<a name="ln-4839"></a><span class="c">!!    use :: M_draw</span>
<a name="ln-4840"></a><span class="c">!!    use :: M_time, only : system_sleep</span>
<a name="ln-4841"></a><span class="c">!!    !! set up drawing environment</span>
<a name="ln-4842"></a><span class="c">!!    call prefsize(600,600)</span>
<a name="ln-4843"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-4844"></a><span class="c">!!    call ortho2(-300.0,300.0,-300.0,300.0)</span>
<a name="ln-4845"></a><span class="c">!!    call textsize(500.0,500.0)</span>
<a name="ln-4846"></a><span class="c">!!    call linewidth(130)</span>
<a name="ln-4847"></a><span class="c">!!    call centertext(.true.)</span>
<a name="ln-4848"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-4849"></a><span class="c">!!    call clear()</span>
<a name="ln-4850"></a><span class="c">!!    write(*,*)&#39;press any character to see it displayed in the default font&#39;</span>
<a name="ln-4851"></a><span class="c">!!    write(*,*)&#39;Enter &quot;q&quot; to quit&#39;</span>
<a name="ln-4852"></a><span class="c">!!    do</span>
<a name="ln-4853"></a><span class="c">!!      ichar=checkkey()</span>
<a name="ln-4854"></a><span class="c">!!      if(ichar.lt.0)then</span>
<a name="ln-4855"></a><span class="c">!!         write(*,*)&#39;this device does not support checkkey&#39;</span>
<a name="ln-4856"></a><span class="c">!!         exit</span>
<a name="ln-4857"></a><span class="c">!!      elseif(ichar.ne.0)then</span>
<a name="ln-4858"></a><span class="c">!!         call color(D_BLACK)</span>
<a name="ln-4859"></a><span class="c">!!         call clear()</span>
<a name="ln-4860"></a><span class="c">!!         call color(D_BLUE)</span>
<a name="ln-4861"></a><span class="c">!!         call move2(0.0,0.0)</span>
<a name="ln-4862"></a><span class="c">!!         call drawstr(char(ichar))</span>
<a name="ln-4863"></a><span class="c">!!      endif</span>
<a name="ln-4864"></a><span class="c">!!      call system_sleep(0.5)</span>
<a name="ln-4865"></a><span class="c">!!      if(char(ichar).eq.&#39;q&#39;)then</span>
<a name="ln-4866"></a><span class="c">!!         write(*,*)&#39;press any key to exit&#39;</span>
<a name="ln-4867"></a><span class="c">!!         ichar=getkey()</span>
<a name="ln-4868"></a><span class="c">!!         exit</span>
<a name="ln-4869"></a><span class="c">!!      endif</span>
<a name="ln-4870"></a><span class="c">!!    enddo</span>
<a name="ln-4871"></a><span class="c">!!    call vexit()</span>
<a name="ln-4872"></a><span class="c">!!    end program demo_checkkey</span>
<a name="ln-4873"></a><span class="c">!&gt;</span>
<a name="ln-4874"></a><span class="c">!!##NAME</span>
<a name="ln-4875"></a><span class="c">!!    getstring(3f) - [M_draw:INTERACTIVE] Read in a string, echoing it in current font</span>
<a name="ln-4876"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4877"></a><span class="c">!!</span>
<a name="ln-4878"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4879"></a><span class="c">!!</span>
<a name="ln-4880"></a><span class="c">!!          integer function getstring(bcol, string)</span>
<a name="ln-4881"></a><span class="c">!!          integer bcol</span>
<a name="ln-4882"></a><span class="c">!!          character *(*) string</span>
<a name="ln-4883"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4884"></a><span class="c">!!</span>
<a name="ln-4885"></a><span class="c">!!    Read in a string, echoing it in the current font, using the current</span>
<a name="ln-4886"></a><span class="c">!!    color and the current transformation.</span>
<a name="ln-4887"></a><span class="c">!!</span>
<a name="ln-4888"></a><span class="c">!!    getstring(3f) interprets the Backspace key (ASCII 8) and the Del</span>
<a name="ln-4889"></a><span class="c">!!    key (ASCII 127) as erasing characters. An EOT (ASCII 4) or a Carriage</span>
<a name="ln-4890"></a><span class="c">!!    return (ASCII 13) will terminate input.</span>
<a name="ln-4891"></a><span class="c">!!</span>
<a name="ln-4892"></a><span class="c">!!##OPTIONS</span>
<a name="ln-4893"></a><span class="c">!!    BCOL  is the background color which is used for erasing characters</span>
<a name="ln-4894"></a><span class="c">!!          after a backspace or a delete key is received.</span>
<a name="ln-4895"></a><span class="c">!!##RETURNS</span>
<a name="ln-4896"></a><span class="c">!!          getstring(3f) returns the number of characters read. Getstring</span>
<a name="ln-4897"></a><span class="c">!!          does not check for overflow in the input buffer string.</span>
<a name="ln-4898"></a><span class="c">!!</span>
<a name="ln-4899"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4900"></a><span class="c">!!</span>
<a name="ln-4901"></a><span class="c">!!   Sample program:</span>
<a name="ln-4902"></a><span class="c">!!</span>
<a name="ln-4903"></a><span class="c">!!    program demo_getstring</span>
<a name="ln-4904"></a><span class="c">!!    use M_draw</span>
<a name="ln-4905"></a><span class="c">!!    ! reading a string from graphic input with getstring(3f)</span>
<a name="ln-4906"></a><span class="c">!!    character(len=128) :: buf(10)</span>
<a name="ln-4907"></a><span class="c">!!    character(len=20)  :: dev</span>
<a name="ln-4908"></a><span class="c">!!    character(len=20)  :: fname</span>
<a name="ln-4909"></a><span class="c">!!    integer            :: ios</span>
<a name="ln-4910"></a><span class="c">!!</span>
<a name="ln-4911"></a><span class="c">!!    print*, &#39;Enter device:&#39;</span>
<a name="ln-4912"></a><span class="c">!!    read (*, &#39;(a)&#39;,iostat=ios) dev</span>
<a name="ln-4913"></a><span class="c">!!    if(ios.ne.0)dev=&#39; &#39;</span>
<a name="ln-4914"></a><span class="c">!!</span>
<a name="ln-4915"></a><span class="c">!!    print*, &#39;Enter a font name:&#39;</span>
<a name="ln-4916"></a><span class="c">!!    read (*, &#39;(a)&#39;,iostat=ios) fname</span>
<a name="ln-4917"></a><span class="c">!!    if(ios.ne.0)fname=&#39;futura.l&#39;</span>
<a name="ln-4918"></a><span class="c">!!    if(fname.eq.&#39;&#39;)fname=&#39;futura.l&#39;</span>
<a name="ln-4919"></a><span class="c">!!</span>
<a name="ln-4920"></a><span class="c">!!    call vinit(dev)</span>
<a name="ln-4921"></a><span class="c">!!</span>
<a name="ln-4922"></a><span class="c">!!    call font(fname)</span>
<a name="ln-4923"></a><span class="c">!!</span>
<a name="ln-4924"></a><span class="c">!!    call clipping(.false.)</span>
<a name="ln-4925"></a><span class="c">!!</span>
<a name="ln-4926"></a><span class="c">!!    shft=0.14</span>
<a name="ln-4927"></a><span class="c">!!    call window(-1.0-shft, 1.0-shft, -1.0, 1.0, 1.0, -1.0)</span>
<a name="ln-4928"></a><span class="c">!!    call lookat(0.0-shft, 0.0-shft, 1.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-4929"></a><span class="c">!!</span>
<a name="ln-4930"></a><span class="c">!!    call rotate(30.0, &#39;x&#39;)</span>
<a name="ln-4931"></a><span class="c">!!    call rotate(30.0, &#39;z&#39;)</span>
<a name="ln-4932"></a><span class="c">!!    call rotate(60.0, &#39;y&#39;)</span>
<a name="ln-4933"></a><span class="c">!!</span>
<a name="ln-4934"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-4935"></a><span class="c">!!    call clear()</span>
<a name="ln-4936"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-4937"></a><span class="c">!!</span>
<a name="ln-4938"></a><span class="c">!!    tsize=0.25</span>
<a name="ln-4939"></a><span class="c">!!    call textsize(tsize/2.5, tsize)</span>
<a name="ln-4940"></a><span class="c">!!    call linewidth(100)</span>
<a name="ln-4941"></a><span class="c">!!    call rect(-0.5, -0.5, 0.5, 0.5)</span>
<a name="ln-4942"></a><span class="c">!!</span>
<a name="ln-4943"></a><span class="c">!!    y=0.5</span>
<a name="ln-4944"></a><span class="c">!!</span>
<a name="ln-4945"></a><span class="c">!!    call linewidth(40)</span>
<a name="ln-4946"></a><span class="c">!!    call move2(-0.5, y)</span>
<a name="ln-4947"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-4948"></a><span class="c">!!    call drawstr(&#39;getstring(3f) demo&#39;)</span>
<a name="ln-4949"></a><span class="c">!!</span>
<a name="ln-4950"></a><span class="c">!!    write(*,*)&#39;Enter 10 lines up to 128 characters long.&#39;</span>
<a name="ln-4951"></a><span class="c">!!    write(*,*)&#39;Program ends on blank line.&#39;</span>
<a name="ln-4952"></a><span class="c">!!</span>
<a name="ln-4953"></a><span class="c">!!    do n=1,10</span>
<a name="ln-4954"></a><span class="c">!!       y=y-tsize</span>
<a name="ln-4955"></a><span class="c">!!       call move2(-0.5, y)</span>
<a name="ln-4956"></a><span class="c">!!       i = getstring(D_BLACK, buf(n))</span>
<a name="ln-4957"></a><span class="c">!!       write(*,&#39;(/,a,i0,a,i0)&#39;,advance=&#39;no&#39;)&#39;N=&#39;,n,&#39; I=&#39;,i</span>
<a name="ln-4958"></a><span class="c">!!       if(n.ge.1 .and. n.le.size(buf))write(*,*)&#39; BUF=&#39;,trim(buf(n)(:i))</span>
<a name="ln-4959"></a><span class="c">!!       buf(n)(min(128,i+1):)=&#39; &#39;</span>
<a name="ln-4960"></a><span class="c">!!       if(i.le.0)exit ! exit on empty line</span>
<a name="ln-4961"></a><span class="c">!!    enddo</span>
<a name="ln-4962"></a><span class="c">!!</span>
<a name="ln-4963"></a><span class="c">!!    call vexit()</span>
<a name="ln-4964"></a><span class="c">!!</span>
<a name="ln-4965"></a><span class="c">!!    do i = 1, n-1</span>
<a name="ln-4966"></a><span class="c">!!       write(*, &#39;(1x, &#39;&#39;Line&#39;&#39;,i3,&#39;&#39; was: &#39;&#39;, a)&#39;) i, buf(i)</span>
<a name="ln-4967"></a><span class="c">!!    enddo</span>
<a name="ln-4968"></a><span class="c">!!</span>
<a name="ln-4969"></a><span class="c">!!    end program demo_getstring</span>
<a name="ln-4970"></a><span class="c">!&gt;</span>
<a name="ln-4971"></a><span class="c">!!##NAME</span>
<a name="ln-4972"></a><span class="c">!!    locator(3f) - [M_draw:INTERACTIVE] Find out where cursor is</span>
<a name="ln-4973"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-4974"></a><span class="c">!!</span>
<a name="ln-4975"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-4976"></a><span class="c">!!</span>
<a name="ln-4977"></a><span class="c">!!          integer function locator(xaddr, yaddr)</span>
<a name="ln-4978"></a><span class="c">!!          real xaddr, yaddr</span>
<a name="ln-4979"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-4980"></a><span class="c">!!</span>
<a name="ln-4981"></a><span class="c">!!    Find out where the cursor is. XADDR and YADDR are set to the current</span>
<a name="ln-4982"></a><span class="c">!!    location in world coordinates. The function returns a bit pattern</span>
<a name="ln-4983"></a><span class="c">!!    which indicates which buttons are being held down -- eg. if mouse</span>
<a name="ln-4984"></a><span class="c">!!    buttons 1 and 3 are down locator returns binary 101 (decimal 7). The</span>
<a name="ln-4985"></a><span class="c">!!    function returns -1 if the device has no locator capability. Note:</span>
<a name="ln-4986"></a><span class="c">!!    if doing 3-D transformations XADDR and YADDR may not make a lot of</span>
<a name="ln-4987"></a><span class="c">!!    sense. In that case use slocator.</span>
<a name="ln-4988"></a><span class="c">!!</span>
<a name="ln-4989"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-4990"></a><span class="c">!!</span>
<a name="ln-4991"></a><span class="c">!!   Sample program:</span>
<a name="ln-4992"></a><span class="c">!!</span>
<a name="ln-4993"></a><span class="c">!!       program demo_locator !     track a cube with the locator</span>
<a name="ln-4994"></a><span class="c">!!       use M_draw</span>
<a name="ln-4995"></a><span class="c">!!       parameter(TRANS=20.0, SC=0.1)</span>
<a name="ln-4996"></a><span class="c">!!       integer, parameter :: FACE=1, FILLED=2, OUTLINE=3</span>
<a name="ln-4997"></a><span class="c">!!       character(len=10)  :: device</span>
<a name="ln-4998"></a><span class="c">!!       character(len=1)   :: but</span>
<a name="ln-4999"></a><span class="c">!!       logical            :: back, fill, hatch</span>
<a name="ln-5000"></a><span class="c">!!       integer            :: ios</span>
<a name="ln-5001"></a><span class="c">!!          write(*,*)&#39;x,y,z = translate&#39;</span>
<a name="ln-5002"></a><span class="c">!!          write(*,*)&#39;s     = apply scale&#39;</span>
<a name="ln-5003"></a><span class="c">!!          write(*,*)&#39;+,-   = change scale/translate direction&#39;</span>
<a name="ln-5004"></a><span class="c">!!          write(*,*)&#39;f,h   = fill, hatch&#39;</span>
<a name="ln-5005"></a><span class="c">!!          write(*,*)&#39;b     = toggle backface&#39;</span>
<a name="ln-5006"></a><span class="c">!!          write(*,*)&#39;q     = quit&#39;</span>
<a name="ln-5007"></a><span class="c">!!</span>
<a name="ln-5008"></a><span class="c">!!          print*, &#39;Enter output device:&#39;</span>
<a name="ln-5009"></a><span class="c">!!          read(*, &#39;(a)&#39;,iostat=ios) device</span>
<a name="ln-5010"></a><span class="c">!!          if(ios.ne.0) device=&#39; &#39;</span>
<a name="ln-5011"></a><span class="c">!!</span>
<a name="ln-5012"></a><span class="c">!!          call prefposition(50, 50)</span>
<a name="ln-5013"></a><span class="c">!!          call prefsize(500, 500)</span>
<a name="ln-5014"></a><span class="c">!!</span>
<a name="ln-5015"></a><span class="c">!!          call vinit(device)</span>
<a name="ln-5016"></a><span class="c">!!</span>
<a name="ln-5017"></a><span class="c">!!          call window(-800.0, 800.0, -800.0, 800.0, -800.0, 800.0)</span>
<a name="ln-5018"></a><span class="c">!!          call lookat(0.0, 0.0, 1500.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-5019"></a><span class="c">!!</span>
<a name="ln-5020"></a><span class="c">!!          tdir = TRANS</span>
<a name="ln-5021"></a><span class="c">!!          scal = SC</span>
<a name="ln-5022"></a><span class="c">!!</span>
<a name="ln-5023"></a><span class="c">!!          !</span>
<a name="ln-5024"></a><span class="c">!!          ! Start with a very ordinary filled cube like in the original demo...</span>
<a name="ln-5025"></a><span class="c">!!          !</span>
<a name="ln-5026"></a><span class="c">!!          call polyhatch(.false.)</span>
<a name="ln-5027"></a><span class="c">!!          call hatchang(45.0)</span>
<a name="ln-5028"></a><span class="c">!!          call hatchpitch(40.0)</span>
<a name="ln-5029"></a><span class="c">!!          call polyfill(.true.)</span>
<a name="ln-5030"></a><span class="c">!!</span>
<a name="ln-5031"></a><span class="c">!!          fill = .true.</span>
<a name="ln-5032"></a><span class="c">!!          hatch = .false.</span>
<a name="ln-5033"></a><span class="c">!!          back = .true.</span>
<a name="ln-5034"></a><span class="c">!!</span>
<a name="ln-5035"></a><span class="c">!!          call makeobj(FACE)</span>
<a name="ln-5036"></a><span class="c">!!          call makepoly()</span>
<a name="ln-5037"></a><span class="c">!!          call rect(-200.0, -200.0, 200.0, 200.0)</span>
<a name="ln-5038"></a><span class="c">!!          call closepoly()</span>
<a name="ln-5039"></a><span class="c">!!          call closeobj()</span>
<a name="ln-5040"></a><span class="c">!!</span>
<a name="ln-5041"></a><span class="c">!!          call makecube(FILLED)</span>
<a name="ln-5042"></a><span class="c">!!</span>
<a name="ln-5043"></a><span class="c">!!          nplanes = getdepth()</span>
<a name="ln-5044"></a><span class="c">!!          if (nplanes .eq. 1) call makecube(OUTLINE)</span>
<a name="ln-5045"></a><span class="c">!!</span>
<a name="ln-5046"></a><span class="c">!!          call backface(back)</span>
<a name="ln-5047"></a><span class="c">!!          !</span>
<a name="ln-5048"></a><span class="c">!!          ! Setup drawing into the backbuffer....</span>
<a name="ln-5049"></a><span class="c">!!          !</span>
<a name="ln-5050"></a><span class="c">!!          if (backbuffer().lt.0) then</span>
<a name="ln-5051"></a><span class="c">!!             call vexit()</span>
<a name="ln-5052"></a><span class="c">!!             write(*,*)&#39;Device can&#39;&#39;t support doublebuffering&#39;</span>
<a name="ln-5053"></a><span class="c">!!             stop</span>
<a name="ln-5054"></a><span class="c">!!          endif</span>
<a name="ln-5055"></a><span class="c">!!</span>
<a name="ln-5056"></a><span class="c">!!          INFINITE: do</span>
<a name="ln-5057"></a><span class="c">!!             idum = slocator(x, y)</span>
<a name="ln-5058"></a><span class="c">!!             call pushmatrix()</span>
<a name="ln-5059"></a><span class="c">!!             call rotate(100.0 * x, &#39;y&#39;)</span>
<a name="ln-5060"></a><span class="c">!!             call rotate(100.0 * y, &#39;x&#39;)</span>
<a name="ln-5061"></a><span class="c">!!             call color(D_BLACK)</span>
<a name="ln-5062"></a><span class="c">!!             call clear()</span>
<a name="ln-5063"></a><span class="c">!!             call callobj(FILLED)</span>
<a name="ln-5064"></a><span class="c">!!             if (nplanes .eq. 1 .and. (fill .or. hatch)) call callobj(OUTLINE)</span>
<a name="ln-5065"></a><span class="c">!!             call popmatrix()</span>
<a name="ln-5066"></a><span class="c">!!             call swapbuffers()</span>
<a name="ln-5067"></a><span class="c">!!</span>
<a name="ln-5068"></a><span class="c">!!             but = char(checkkey())</span>
<a name="ln-5069"></a><span class="c">!!             select case(but)</span>
<a name="ln-5070"></a><span class="c">!!              case(&#39;x&#39;)</span>
<a name="ln-5071"></a><span class="c">!!                call translate(tdir, 0.0, 0.0)</span>
<a name="ln-5072"></a><span class="c">!!              case(&#39;y&#39;)</span>
<a name="ln-5073"></a><span class="c">!!                call translate(0.0, tdir, 0.0)</span>
<a name="ln-5074"></a><span class="c">!!              case(&#39;z&#39;)</span>
<a name="ln-5075"></a><span class="c">!!                call translate(0.0, 0.0, tdir)</span>
<a name="ln-5076"></a><span class="c">!!              case(&#39;s&#39;)</span>
<a name="ln-5077"></a><span class="c">!!                call scale(scal, scal, scal)</span>
<a name="ln-5078"></a><span class="c">!!              case(&#39;f&#39;)</span>
<a name="ln-5079"></a><span class="c">!!                fill = .not. fill</span>
<a name="ln-5080"></a><span class="c">!!                hatch = .false.</span>
<a name="ln-5081"></a><span class="c">!!                call polyfill(fill)</span>
<a name="ln-5082"></a><span class="c">!!              case(&#39;h&#39;)</span>
<a name="ln-5083"></a><span class="c">!!                hatch = .not. hatch</span>
<a name="ln-5084"></a><span class="c">!!                fill = .false.</span>
<a name="ln-5085"></a><span class="c">!!                call polyhatch(hatch)</span>
<a name="ln-5086"></a><span class="c">!!              case(&#39;b&#39;)</span>
<a name="ln-5087"></a><span class="c">!!                back = .not. back</span>
<a name="ln-5088"></a><span class="c">!!                call backface(back)</span>
<a name="ln-5089"></a><span class="c">!!              case(&#39;-&#39;)</span>
<a name="ln-5090"></a><span class="c">!!                tdir = -tdir</span>
<a name="ln-5091"></a><span class="c">!!                if (scal .lt. 1.0) then</span>
<a name="ln-5092"></a><span class="c">!!                   scal = 1.0 + SC</span>
<a name="ln-5093"></a><span class="c">!!                else</span>
<a name="ln-5094"></a><span class="c">!!                   scal = 1.0 - SC</span>
<a name="ln-5095"></a><span class="c">!!                endif</span>
<a name="ln-5096"></a><span class="c">!!              case(&#39;+&#39;)</span>
<a name="ln-5097"></a><span class="c">!!                tdir = TRANS</span>
<a name="ln-5098"></a><span class="c">!!              case(&#39;q&#39;,char(27))</span>
<a name="ln-5099"></a><span class="c">!!                call vexit()</span>
<a name="ln-5100"></a><span class="c">!!                stop</span>
<a name="ln-5101"></a><span class="c">!!             end select</span>
<a name="ln-5102"></a><span class="c">!!          enddo INFINITE</span>
<a name="ln-5103"></a><span class="c">!!       contains</span>
<a name="ln-5104"></a><span class="c">!!</span>
<a name="ln-5105"></a><span class="c">!!       subroutine makecube(obj)</span>
<a name="ln-5106"></a><span class="c">!!       integer obj</span>
<a name="ln-5107"></a><span class="c">!!</span>
<a name="ln-5108"></a><span class="c">!!          call makeobj(obj)</span>
<a name="ln-5109"></a><span class="c">!!          if (obj .eq. OUTLINE) then</span>
<a name="ln-5110"></a><span class="c">!!             call pushattributes()</span>
<a name="ln-5111"></a><span class="c">!!             call color(D_BLACK)</span>
<a name="ln-5112"></a><span class="c">!!             call polyfill(.false.)</span>
<a name="ln-5113"></a><span class="c">!!             call polyhatch(.false.)</span>
<a name="ln-5114"></a><span class="c">!!          endif</span>
<a name="ln-5115"></a><span class="c">!!</span>
<a name="ln-5116"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5117"></a><span class="c">!!          call translate(0.0, 0.0, 200.0)</span>
<a name="ln-5118"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_RED)</span>
<a name="ln-5119"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5120"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5121"></a><span class="c">!!</span>
<a name="ln-5122"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5123"></a><span class="c">!!          call translate(200.0, 0.0, 0.0)</span>
<a name="ln-5124"></a><span class="c">!!          call rotate(90.0, &#39;y&#39;)</span>
<a name="ln-5125"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_GREEN)</span>
<a name="ln-5126"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5127"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5128"></a><span class="c">!!</span>
<a name="ln-5129"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5130"></a><span class="c">!!          call translate(0.0, 0.0, -200.0)</span>
<a name="ln-5131"></a><span class="c">!!          call rotate(180.0, &#39;y&#39;)</span>
<a name="ln-5132"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_BLUE)</span>
<a name="ln-5133"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5134"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5135"></a><span class="c">!!</span>
<a name="ln-5136"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5137"></a><span class="c">!!          call translate(-200.0, 0.0, 0.0)</span>
<a name="ln-5138"></a><span class="c">!!          call rotate(-90.0, &#39;y&#39;)</span>
<a name="ln-5139"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_CYAN)</span>
<a name="ln-5140"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5141"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5142"></a><span class="c">!!</span>
<a name="ln-5143"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5144"></a><span class="c">!!          call translate(0.0, 200.0, 0.0)</span>
<a name="ln-5145"></a><span class="c">!!          call rotate(-90.0, &#39;x&#39;)</span>
<a name="ln-5146"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_MAGENTA)</span>
<a name="ln-5147"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5148"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5149"></a><span class="c">!!</span>
<a name="ln-5150"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-5151"></a><span class="c">!!          call translate(0.0, -200.0, 0.0)</span>
<a name="ln-5152"></a><span class="c">!!          call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-5153"></a><span class="c">!!          if (obj .eq. FILLED) call color(D_YELLOW)</span>
<a name="ln-5154"></a><span class="c">!!          call callobj(FACE)</span>
<a name="ln-5155"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-5156"></a><span class="c">!!</span>
<a name="ln-5157"></a><span class="c">!!          if (obj .eq. OUTLINE) call popattributes()</span>
<a name="ln-5158"></a><span class="c">!!</span>
<a name="ln-5159"></a><span class="c">!!          call closeobj()</span>
<a name="ln-5160"></a><span class="c">!!</span>
<a name="ln-5161"></a><span class="c">!!       end subroutine makecube</span>
<a name="ln-5162"></a><span class="c">!!</span>
<a name="ln-5163"></a><span class="c">!!       end program demo_locator</span>
<a name="ln-5164"></a><span class="c">!&gt;</span>
<a name="ln-5165"></a><span class="c">!!##NAME</span>
<a name="ln-5166"></a><span class="c">!!    slocator(3f) - [M_draw:INTERACTIVE] Find out where cursor is in screen coordinates</span>
<a name="ln-5167"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5168"></a><span class="c">!!</span>
<a name="ln-5169"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5170"></a><span class="c">!!</span>
<a name="ln-5171"></a><span class="c">!!          integer function slocator(xaddr, yaddr)</span>
<a name="ln-5172"></a><span class="c">!!          real xaddr, yaddr</span>
<a name="ln-5173"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5174"></a><span class="c">!!</span>
<a name="ln-5175"></a><span class="c">!!    Find out where the cursor is. xaddr and yaddr are set to the current</span>
<a name="ln-5176"></a><span class="c">!!    location in screen coordinates. The return value of the function is</span>
<a name="ln-5177"></a><span class="c">!!    set up in the same way as with locator. If the device has no locator</span>
<a name="ln-5178"></a><span class="c">!!    device slocator returns -1.</span>
<a name="ln-5179"></a><span class="c">!!</span>
<a name="ln-5180"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5181"></a><span class="c">!!</span>
<a name="ln-5182"></a><span class="c">!!   Sample program:</span>
<a name="ln-5183"></a><span class="c">!!</span>
<a name="ln-5184"></a><span class="c">!!     !</span>
<a name="ln-5185"></a><span class="c">!!     !      a routine to demonstrate using locator.</span>
<a name="ln-5186"></a><span class="c">!!     !</span>
<a name="ln-5187"></a><span class="c">!!     program demo_slocator</span>
<a name="ln-5188"></a><span class="c">!!</span>
<a name="ln-5189"></a><span class="c">!!     use M_draw</span>
<a name="ln-5190"></a><span class="c">!!</span>
<a name="ln-5191"></a><span class="c">!!     character(len=20) :: dev</span>
<a name="ln-5192"></a><span class="c">!!     integer bt</span>
<a name="ln-5193"></a><span class="c">!!     real x, y, sx, sy</span>
<a name="ln-5194"></a><span class="c">!!     logical act, curpnt</span>
<a name="ln-5195"></a><span class="c">!!     integer :: ios</span>
<a name="ln-5196"></a><span class="c">!!</span>
<a name="ln-5197"></a><span class="c">!!     print*,&#39;Enter device name:&#39;</span>
<a name="ln-5198"></a><span class="c">!!     read(*,&#39;(a)&#39;,iostat=ios) dev</span>
<a name="ln-5199"></a><span class="c">!!     if(ios.ne.0)dev=&#39; &#39;</span>
<a name="ln-5200"></a><span class="c">!!     call vinit(dev)</span>
<a name="ln-5201"></a><span class="c">!!</span>
<a name="ln-5202"></a><span class="c">!!     call color(D_BLACK)</span>
<a name="ln-5203"></a><span class="c">!!     call clear()</span>
<a name="ln-5204"></a><span class="c">!!</span>
<a name="ln-5205"></a><span class="c">!!     call color(D_BLUE)</span>
<a name="ln-5206"></a><span class="c">!!     !</span>
<a name="ln-5207"></a><span class="c">!!     !       draw some axes</span>
<a name="ln-5208"></a><span class="c">!!     !</span>
<a name="ln-5209"></a><span class="c">!!     call move2(0.0, 1.0)</span>
<a name="ln-5210"></a><span class="c">!!     call draw2(0.0, -1.0)</span>
<a name="ln-5211"></a><span class="c">!!</span>
<a name="ln-5212"></a><span class="c">!!     call move2(1.0, 0.0)</span>
<a name="ln-5213"></a><span class="c">!!     call draw2(-1.0, 0.0)</span>
<a name="ln-5214"></a><span class="c">!!</span>
<a name="ln-5215"></a><span class="c">!!     call color(D_GREEN)</span>
<a name="ln-5216"></a><span class="c">!!</span>
<a name="ln-5217"></a><span class="c">!!     act = .false.</span>
<a name="ln-5218"></a><span class="c">!!     curpnt = .false.</span>
<a name="ln-5219"></a><span class="c">!!     !</span>
<a name="ln-5220"></a><span class="c">!!     !       locator returns whether a mouse button has been</span>
<a name="ln-5221"></a><span class="c">!!     !       pressed or not. In a device such as the tektronix</span>
<a name="ln-5222"></a><span class="c">!!     !       where you have to wait for a keypress to get the</span>
<a name="ln-5223"></a><span class="c">!!     !       position of the crosshairs locator returns 0</span>
<a name="ln-5224"></a><span class="c">!!     !       automatically on every second call. A return value</span>
<a name="ln-5225"></a><span class="c">!!     !       of 2 indicates the second mouse button has been pressed.</span>
<a name="ln-5226"></a><span class="c">!!     !       A return value of 1 indicates the first mouse button has</span>
<a name="ln-5227"></a><span class="c">!!     !       been pressed. We wait for the locator to return zero so</span>
<a name="ln-5228"></a><span class="c">!!     !       that we know the mouse button has been released.</span>
<a name="ln-5229"></a><span class="c">!!     !</span>
<a name="ln-5230"></a><span class="c">!!     write(*,*)&#39; click two points to create a line segment&#39;</span>
<a name="ln-5231"></a><span class="c">!!     write(*,*)&#39; button 2 exits&#39;</span>
<a name="ln-5232"></a><span class="c">!!</span>
<a name="ln-5233"></a><span class="c">!!     INFINITE: do</span>
<a name="ln-5234"></a><span class="c">!!        bt = slocator(x, y)</span>
<a name="ln-5235"></a><span class="c">!!        !! write(*,*)&#39;slocator returned &#39;,bt,&#39; and coordinates &#39;,x,y</span>
<a name="ln-5236"></a><span class="c">!!        if (bt .eq. -1) then</span>
<a name="ln-5237"></a><span class="c">!!           call vexit()</span>
<a name="ln-5238"></a><span class="c">!!           print*,&#39;No locator device found&#39;</span>
<a name="ln-5239"></a><span class="c">!!           stop</span>
<a name="ln-5240"></a><span class="c">!!        elseif (bt .eq. 2) then</span>
<a name="ln-5241"></a><span class="c">!!           call vexit()</span>
<a name="ln-5242"></a><span class="c">!!           stop</span>
<a name="ln-5243"></a><span class="c">!!        elseif (bt .eq. 0) then</span>
<a name="ln-5244"></a><span class="c">!!           act = .true.</span>
<a name="ln-5245"></a><span class="c">!!        elseif (act) then</span>
<a name="ln-5246"></a><span class="c">!!           act = .false.</span>
<a name="ln-5247"></a><span class="c">!!           if (bt .eq. 1) then</span>
<a name="ln-5248"></a><span class="c">!!              if (curpnt) then</span>
<a name="ln-5249"></a><span class="c">!!                 call move2(sx, sy)</span>
<a name="ln-5250"></a><span class="c">!!                 call draw2(x, y)</span>
<a name="ln-5251"></a><span class="c">!!                 curpnt = .false.</span>
<a name="ln-5252"></a><span class="c">!!              else</span>
<a name="ln-5253"></a><span class="c">!!                 curpnt = .true.</span>
<a name="ln-5254"></a><span class="c">!!              endif</span>
<a name="ln-5255"></a><span class="c">!!</span>
<a name="ln-5256"></a><span class="c">!!              sx = x</span>
<a name="ln-5257"></a><span class="c">!!              sy = y</span>
<a name="ln-5258"></a><span class="c">!!           endif</span>
<a name="ln-5259"></a><span class="c">!!        endif</span>
<a name="ln-5260"></a><span class="c">!!     enddo INFINITE</span>
<a name="ln-5261"></a><span class="c">!!</span>
<a name="ln-5262"></a><span class="c">!!     end program demo_slocator</span>
<a name="ln-5263"></a><span class="c">!&gt;</span>
<a name="ln-5264"></a><span class="c">!!##NAME</span>
<a name="ln-5265"></a><span class="c">!!    vsetflush(3f) - [M_draw:FLUSHING] Set global flushing status</span>
<a name="ln-5266"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5267"></a><span class="c">!!</span>
<a name="ln-5268"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5269"></a><span class="c">!!</span>
<a name="ln-5270"></a><span class="c">!!          subroutine vsetflush(yesno)</span>
<a name="ln-5271"></a><span class="c">!!          logical yesno</span>
<a name="ln-5272"></a><span class="c">!!</span>
<a name="ln-5273"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5274"></a><span class="c">!!    Set global flushing status. If yesno = 0 (.false.) then don&#39;t do any</span>
<a name="ln-5275"></a><span class="c">!!    flushing (except in swapbuffers(), or vflush()). If yesno = 1</span>
<a name="ln-5276"></a><span class="c">!!    (.true.) then do the flushing as described above.</span>
<a name="ln-5277"></a><span class="c">!&gt;</span>
<a name="ln-5278"></a><span class="c">!!##NAME</span>
<a name="ln-5279"></a><span class="c">!!    vflush(3f) - [M_draw:FLUSHING] Call device flush or syncronisation routine</span>
<a name="ln-5280"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5281"></a><span class="c">!!</span>
<a name="ln-5282"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5283"></a><span class="c">!!</span>
<a name="ln-5284"></a><span class="c">!!          subroutine vflush()</span>
<a name="ln-5285"></a><span class="c">!!</span>
<a name="ln-5286"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5287"></a><span class="c">!!</span>
<a name="ln-5288"></a><span class="c">!!    Call the device flush or syncronisation routine. This forces a flush.</span>
<a name="ln-5289"></a><span class="c">!&gt;</span>
<a name="ln-5290"></a><span class="c">!!##NAME</span>
<a name="ln-5291"></a><span class="c">!!    viewport(3f) - [M_draw:VIEWPORT] Specify which part of screen to draw in</span>
<a name="ln-5292"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5293"></a><span class="c">!!</span>
<a name="ln-5294"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5295"></a><span class="c">!!</span>
<a name="ln-5296"></a><span class="c">!!          subroutine viewport(left, right, bottom, top)</span>
<a name="ln-5297"></a><span class="c">!!          real,intent(in) :: left, right, bottom, top</span>
<a name="ln-5298"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5299"></a><span class="c">!!    Specify which part of the screen to draw in. Left, right, bottom,</span>
<a name="ln-5300"></a><span class="c">!!    and top are real values in screen coordinates (0:n,0:m).</span>
<a name="ln-5301"></a><span class="c">!!</span>
<a name="ln-5302"></a><span class="c">!!    If a device has been declared to be 600 x 400</span>
<a name="ln-5303"></a><span class="c">!!</span>
<a name="ln-5304"></a><span class="c">!!         o-----&gt; X                         (right=600,top=0)</span>
<a name="ln-5305"></a><span class="c">!!         | #------------------------------------#</span>
<a name="ln-5306"></a><span class="c">!!         | |                                    |</span>
<a name="ln-5307"></a><span class="c">!!         | |                                    |</span>
<a name="ln-5308"></a><span class="c">!!         V |                                    |</span>
<a name="ln-5309"></a><span class="c">!!         Y |                                    |</span>
<a name="ln-5310"></a><span class="c">!!           #------------------------------------#</span>
<a name="ln-5311"></a><span class="c">!!      (left=0,bottom=400)</span>
<a name="ln-5312"></a><span class="c">!!</span>
<a name="ln-5313"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5314"></a><span class="c">!!</span>
<a name="ln-5315"></a><span class="c">!!   Sample program:</span>
<a name="ln-5316"></a><span class="c">!!</span>
<a name="ln-5317"></a><span class="c">!!    program demo_viewport</span>
<a name="ln-5318"></a><span class="c">!!    !</span>
<a name="ln-5319"></a><span class="c">!!    ! using non-square viewports, the associated distortion -- and how to fix it</span>
<a name="ln-5320"></a><span class="c">!!    !</span>
<a name="ln-5321"></a><span class="c">!!    use M_draw</span>
<a name="ln-5322"></a><span class="c">!!</span>
<a name="ln-5323"></a><span class="c">!!    character(len=50)  :: device</span>
<a name="ln-5324"></a><span class="c">!!    character(len=120) :: buf</span>
<a name="ln-5325"></a><span class="c">!!    real    xfact, yfact</span>
<a name="ln-5326"></a><span class="c">!!    integer :: ios</span>
<a name="ln-5327"></a><span class="c">!!</span>
<a name="ln-5328"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-5329"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-5330"></a><span class="c">!!    if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-5331"></a><span class="c">!!</span>
<a name="ln-5332"></a><span class="c">!!    call vinit(device)</span>
<a name="ln-5333"></a><span class="c">!!</span>
<a name="ln-5334"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-5335"></a><span class="c">!!    call clear()</span>
<a name="ln-5336"></a><span class="c">!!    !</span>
<a name="ln-5337"></a><span class="c">!!    ! Make the viewport the same size as the screen/window.</span>
<a name="ln-5338"></a><span class="c">!!    !</span>
<a name="ln-5339"></a><span class="c">!!    call getfactors(xfact, yfact)</span>
<a name="ln-5340"></a><span class="c">!!    call viewport(-1.0, xfact, -1.0, yfact)</span>
<a name="ln-5341"></a><span class="c">!!    !</span>
<a name="ln-5342"></a><span class="c">!!    ! Draw a square. (Looks like a rectangle, if the viewport</span>
<a name="ln-5343"></a><span class="c">!!    ! wasn&#39;t &quot;accidentally&quot; square)</span>
<a name="ln-5344"></a><span class="c">!!    !</span>
<a name="ln-5345"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-5346"></a><span class="c">!!    call rect(-0.5, -0.5, 0.5, 0.5)</span>
<a name="ln-5347"></a><span class="c">!!    !</span>
<a name="ln-5348"></a><span class="c">!!    ! Tell them what it is.</span>
<a name="ln-5349"></a><span class="c">!!    !</span>
<a name="ln-5350"></a><span class="c">!!    call move2(-1.0, 0.9)</span>
<a name="ln-5351"></a><span class="c">!!    write(buf,&#39;(&#39;&#39;Distorted square (viewport(-1, &#39;&#39;, F7.3, &#39;&#39;, -1, &#39;&#39;, F7.3, &#39;&#39;))&#39;&#39;)&#39;) xfact, yfact</span>
<a name="ln-5352"></a><span class="c">!!    call drawstr(buf)</span>
<a name="ln-5353"></a><span class="c">!!</span>
<a name="ln-5354"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5355"></a><span class="c">!!    !</span>
<a name="ln-5356"></a><span class="c">!!    ! Fix up the distortion (The actual formula to fix</span>
<a name="ln-5357"></a><span class="c">!!    ! the distortion is (viewport.xmax * (1 + xfact) / 2.0),</span>
<a name="ln-5358"></a><span class="c">!!    ! and similar for the y axis.</span>
<a name="ln-5359"></a><span class="c">!!    !</span>
<a name="ln-5360"></a><span class="c">!!    call ortho2(-1.0, xfact, -1.0, yfact)</span>
<a name="ln-5361"></a><span class="c">!!    !</span>
<a name="ln-5362"></a><span class="c">!!    ! Draw another square (Really is square this time)</span>
<a name="ln-5363"></a><span class="c">!!    !</span>
<a name="ln-5364"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-5365"></a><span class="c">!!    call rect(-0.5, -0.5, 0.5, 0.5)</span>
<a name="ln-5366"></a><span class="c">!!    !</span>
<a name="ln-5367"></a><span class="c">!!    ! Tell them what it is.</span>
<a name="ln-5368"></a><span class="c">!!    !</span>
<a name="ln-5369"></a><span class="c">!!    call move2(-1.0, -0.9)</span>
<a name="ln-5370"></a><span class="c">!!    write(buf,&#39;(&#39;&#39;Fixed up square with ortho2(-1, &#39;&#39;, F7.3, &#39;&#39;, -1, &#39;&#39;, F7.3, &#39;&#39;)&#39;&#39;)&#39;) xfact, yfact</span>
<a name="ln-5371"></a><span class="c">!!    call drawstr(buf)</span>
<a name="ln-5372"></a><span class="c">!!</span>
<a name="ln-5373"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5374"></a><span class="c">!!    !</span>
<a name="ln-5375"></a><span class="c">!!    ! Do it with world coords going from 0 - 5, 0 - 5.</span>
<a name="ln-5376"></a><span class="c">!!    ! Reset square viewport.</span>
<a name="ln-5377"></a><span class="c">!!    !</span>
<a name="ln-5378"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-5379"></a><span class="c">!!    call clear()</span>
<a name="ln-5380"></a><span class="c">!!</span>
<a name="ln-5381"></a><span class="c">!!    call viewport(-1.0, 1.0, -1.0, 1.0)</span>
<a name="ln-5382"></a><span class="c">!!    call ortho2(0.0, 5.0, 0.0, 5.0)</span>
<a name="ln-5383"></a><span class="c">!!    call textsize(0.1, 0.1)</span>
<a name="ln-5384"></a><span class="c">!!    !</span>
<a name="ln-5385"></a><span class="c">!!    ! Square from 1 to 3. (Really is square)</span>
<a name="ln-5386"></a><span class="c">!!    !</span>
<a name="ln-5387"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-5388"></a><span class="c">!!    call rect(1.0, 1.0, 3.0, 3.0)</span>
<a name="ln-5389"></a><span class="c">!!</span>
<a name="ln-5390"></a><span class="c">!!    call move2(0.0, 4.5)</span>
<a name="ln-5391"></a><span class="c">!!    call drawstr(&#39;Square from 0 - 3, 0 - 3&#39;)</span>
<a name="ln-5392"></a><span class="c">!!</span>
<a name="ln-5393"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5394"></a><span class="c">!!    !</span>
<a name="ln-5395"></a><span class="c">!!    ! Distort it with a non-square viewport.</span>
<a name="ln-5396"></a><span class="c">!!    !</span>
<a name="ln-5397"></a><span class="c">!!    call viewport(-1.0, xfact, -1.0, yfact)</span>
<a name="ln-5398"></a><span class="c">!!</span>
<a name="ln-5399"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-5400"></a><span class="c">!!    call rect(1.0, 1.0, 3.0, 3.0)</span>
<a name="ln-5401"></a><span class="c">!!</span>
<a name="ln-5402"></a><span class="c">!!    call move2(0.0, 0.5)</span>
<a name="ln-5403"></a><span class="c">!!    call drawstr(&#39;Distorted square from 0 - 3, 0 - 3&#39;)</span>
<a name="ln-5404"></a><span class="c">!!</span>
<a name="ln-5405"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5406"></a><span class="c">!!    !</span>
<a name="ln-5407"></a><span class="c">!!    ! Fix the distortion.</span>
<a name="ln-5408"></a><span class="c">!!    !</span>
<a name="ln-5409"></a><span class="c">!!    call ortho2(0.0, 5.0 * (1.0 + xfact) / 2.0, 0.0, 5.0 * (1.0 + yfact) / 2.0)</span>
<a name="ln-5410"></a><span class="c">!!</span>
<a name="ln-5411"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-5412"></a><span class="c">!!    call rect(1.0, 1.0, 3.0, 3.0)</span>
<a name="ln-5413"></a><span class="c">!!</span>
<a name="ln-5414"></a><span class="c">!!    call move2(0.0, 2.5)</span>
<a name="ln-5415"></a><span class="c">!!    call drawstr(&#39;Fixed up  square from 0 - 3, 0 - 3&#39;)</span>
<a name="ln-5416"></a><span class="c">!!</span>
<a name="ln-5417"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5418"></a><span class="c">!!</span>
<a name="ln-5419"></a><span class="c">!!    call vexit()</span>
<a name="ln-5420"></a><span class="c">!!</span>
<a name="ln-5421"></a><span class="c">!!    end program demo_viewport</span>
<a name="ln-5422"></a><span class="c">!&gt;</span>
<a name="ln-5423"></a><span class="c">!!##NAME</span>
<a name="ln-5424"></a><span class="c">!!    pushviewport(3f) - [M_draw:VIEWPORT] Save current viewport</span>
<a name="ln-5425"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5426"></a><span class="c">!!</span>
<a name="ln-5427"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5428"></a><span class="c">!!</span>
<a name="ln-5429"></a><span class="c">!!          subroutine pushviewport()</span>
<a name="ln-5430"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5431"></a><span class="c">!!</span>
<a name="ln-5432"></a><span class="c">!!    Save current viewport.</span>
<a name="ln-5433"></a><span class="c">!&gt;</span>
<a name="ln-5434"></a><span class="c">!!##NAME</span>
<a name="ln-5435"></a><span class="c">!!    popviewport(3f) - [M_draw:VIEWPORT] Retrieve last viewport</span>
<a name="ln-5436"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5437"></a><span class="c">!!</span>
<a name="ln-5438"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5439"></a><span class="c">!!</span>
<a name="ln-5440"></a><span class="c">!!          subroutine popviewport()</span>
<a name="ln-5441"></a><span class="c">!!</span>
<a name="ln-5442"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5443"></a><span class="c">!!</span>
<a name="ln-5444"></a><span class="c">!!    Retrieve last viewport.</span>
<a name="ln-5445"></a><span class="c">!&gt;</span>
<a name="ln-5446"></a><span class="c">!!##NAME</span>
<a name="ln-5447"></a><span class="c">!!    getviewport(3f) - [M_draw:VIEWPORT] Returns limits of current viewport in screen coordinates</span>
<a name="ln-5448"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5449"></a><span class="c">!!</span>
<a name="ln-5450"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5451"></a><span class="c">!!</span>
<a name="ln-5452"></a><span class="c">!!          subroutine getviewport(left, right, bottom, top)</span>
<a name="ln-5453"></a><span class="c">!!          real,intent(out) :: left</span>
<a name="ln-5454"></a><span class="c">!!          real,intent(out) :: right</span>
<a name="ln-5455"></a><span class="c">!!          real,intent(out) :: bottom</span>
<a name="ln-5456"></a><span class="c">!!          real,intent(out) :: top</span>
<a name="ln-5457"></a><span class="c">!!</span>
<a name="ln-5458"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5459"></a><span class="c">!!</span>
<a name="ln-5460"></a><span class="c">!! Returns the left, right, bottom and top limits of the current viewport</span>
<a name="ln-5461"></a><span class="c">!! in screen coordinates (-1.0 to 1.0).</span>
<a name="ln-5462"></a><span class="c">!!</span>
<a name="ln-5463"></a><span class="c">!!    If a device has been declared to be real :: array(600,400)</span>
<a name="ln-5464"></a><span class="c">!!</span>
<a name="ln-5465"></a><span class="c">!!         o-----&gt; X                         (right=600,top=0)</span>
<a name="ln-5466"></a><span class="c">!!         | #------------------------------------#</span>
<a name="ln-5467"></a><span class="c">!!         | |                                    |</span>
<a name="ln-5468"></a><span class="c">!!         | |                                    |</span>
<a name="ln-5469"></a><span class="c">!!         V |                                    |</span>
<a name="ln-5470"></a><span class="c">!!         Y |                                    |</span>
<a name="ln-5471"></a><span class="c">!!           #------------------------------------#</span>
<a name="ln-5472"></a><span class="c">!!      (left=0,bottom=400)</span>
<a name="ln-5473"></a><span class="c">!!</span>
<a name="ln-5474"></a><span class="c">!!##OPTIONS</span>
<a name="ln-5475"></a><span class="c">!!    LEFT     value for left side</span>
<a name="ln-5476"></a><span class="c">!!    RIGHT    value for right side</span>
<a name="ln-5477"></a><span class="c">!!    BOTTOM   value for bottom side</span>
<a name="ln-5478"></a><span class="c">!!    TOP      value for top side</span>
<a name="ln-5479"></a><span class="c">!&gt;</span>
<a name="ln-5480"></a><span class="c">!!##NAME</span>
<a name="ln-5481"></a><span class="c">!!    expandviewport(3f) - [M_draw:VIEWPORT] use the entire device viewport</span>
<a name="ln-5482"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5483"></a><span class="c">!!</span>
<a name="ln-5484"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5485"></a><span class="c">!!</span>
<a name="ln-5486"></a><span class="c">!!         subroutine expandviewport()</span>
<a name="ln-5487"></a><span class="c">!!</span>
<a name="ln-5488"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5489"></a><span class="c">!!</span>
<a name="ln-5490"></a><span class="c">!!    When M_draw does viewport calculations, it will normally begin by using</span>
<a name="ln-5491"></a><span class="c">!!    the largest square it can fit onto the actual display device. This</span>
<a name="ln-5492"></a><span class="c">!!    call says to use the whole device... however you must then take</span>
<a name="ln-5493"></a><span class="c">!!    into account any distortion that will occur due to the non-square</span>
<a name="ln-5494"></a><span class="c">!!    mapping. Thus, a viewport of (-1.0, 1.0, -1.0, 1.0) will map into</span>
<a name="ln-5495"></a><span class="c">!!    the whole display device.</span>
<a name="ln-5496"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5497"></a><span class="c">!!</span>
<a name="ln-5498"></a><span class="c">!!   Sample program:</span>
<a name="ln-5499"></a><span class="c">!!</span>
<a name="ln-5500"></a><span class="c">!!    program demo_expandviewport</span>
<a name="ln-5501"></a><span class="c">!!    use M_draw</span>
<a name="ln-5502"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-5503"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-5504"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-5505"></a><span class="c">!!    implicit none</span>
<a name="ln-5506"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-5507"></a><span class="c">!!</span>
<a name="ln-5508"></a><span class="c">!!    !! set up graphics area</span>
<a name="ln-5509"></a><span class="c">!!    call prefsize(1000,200)</span>
<a name="ln-5510"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-5511"></a><span class="c">!!</span>
<a name="ln-5512"></a><span class="c">!!    !! draw box that fills default world coordinate window</span>
<a name="ln-5513"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-5514"></a><span class="c">!!    call polyfill(.true.)</span>
<a name="ln-5515"></a><span class="c">!!    call rect(-1.0, -1.0, 1.0, 1.0)</span>
<a name="ln-5516"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-5517"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-5518"></a><span class="c">!!</span>
<a name="ln-5519"></a><span class="c">!!    call expandviewport()</span>
<a name="ln-5520"></a><span class="c">!!    !! the meaning of viewport numbers has now changed, but the</span>
<a name="ln-5521"></a><span class="c">!!    !! viewport itself has not. Now &lt;-1,-1&gt; &lt;1,1&gt; defines the</span>
<a name="ln-5522"></a><span class="c">!!    !! entire display area, where before it defined the largest square</span>
<a name="ln-5523"></a><span class="c">!!    !! that would fit on the display</span>
<a name="ln-5524"></a><span class="c">!!    call viewport(-1.0,1.0,-1.0,1.0)</span>
<a name="ln-5525"></a><span class="c">!!    !! draw box that fills default world coordinate window again</span>
<a name="ln-5526"></a><span class="c">!!</span>
<a name="ln-5527"></a><span class="c">!!    !! instead of a square and circle, the mapping now</span>
<a name="ln-5528"></a><span class="c">!!    !! produces an ellipse and rectangle unless this</span>
<a name="ln-5529"></a><span class="c">!!    !! device has a square display</span>
<a name="ln-5530"></a><span class="c">!!    call polyhatch(.true.)</span>
<a name="ln-5531"></a><span class="c">!!    call hatchpitch(0.1)</span>
<a name="ln-5532"></a><span class="c">!!    call hatchang(30.0)</span>
<a name="ln-5533"></a><span class="c">!!    call linewidth(20)</span>
<a name="ln-5534"></a><span class="c">!!    call color(D_CYAN)</span>
<a name="ln-5535"></a><span class="c">!!    call rect(-1.0, -1.0, 1.0, 1.0)</span>
<a name="ln-5536"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-5537"></a><span class="c">!!    call hatchang(120.0)</span>
<a name="ln-5538"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-5539"></a><span class="c">!!</span>
<a name="ln-5540"></a><span class="c">!!    !! border</span>
<a name="ln-5541"></a><span class="c">!!    call linewidth(100)</span>
<a name="ln-5542"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-5543"></a><span class="c">!!    call move2(-1.0, -1.0)</span>
<a name="ln-5544"></a><span class="c">!!    call draw2(-1.0, 1.0)</span>
<a name="ln-5545"></a><span class="c">!!    call draw2(1.0, 1.0)</span>
<a name="ln-5546"></a><span class="c">!!    call draw2(1.0, -1.0)</span>
<a name="ln-5547"></a><span class="c">!!    call draw2(-1.0, -1.0)</span>
<a name="ln-5548"></a><span class="c">!!</span>
<a name="ln-5549"></a><span class="c">!!    call vflush(); ipaws=getkey() !! pause</span>
<a name="ln-5550"></a><span class="c">!!    call vexit()                  !! wrap up graphics</span>
<a name="ln-5551"></a><span class="c">!!</span>
<a name="ln-5552"></a><span class="c">!!    end program demo_expandviewport</span>
<a name="ln-5553"></a><span class="c">!&gt;</span>
<a name="ln-5554"></a><span class="c">!!##NAME</span>
<a name="ln-5555"></a><span class="c">!!    unexpandviewport(3f) - [M_draw:VIEWPORT] undo expandviewport(3f)</span>
<a name="ln-5556"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5557"></a><span class="c">!!</span>
<a name="ln-5558"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5559"></a><span class="c">!!</span>
<a name="ln-5560"></a><span class="c">!!         subroutine unexpandviewport()</span>
<a name="ln-5561"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5562"></a><span class="c">!!</span>
<a name="ln-5563"></a><span class="c">!!    Does the reverse of expandviewport. Basically, it returns M_draw to</span>
<a name="ln-5564"></a><span class="c">!!    using the largest square of the device for its viewport calculations.</span>
<a name="ln-5565"></a><span class="c">!!</span>
<a name="ln-5566"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5567"></a><span class="c">!!</span>
<a name="ln-5568"></a><span class="c">!!   Sample program:</span>
<a name="ln-5569"></a><span class="c">!!</span>
<a name="ln-5570"></a><span class="c">!!    program demo_unexpandviewport</span>
<a name="ln-5571"></a><span class="c">!!    use M_draw</span>
<a name="ln-5572"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-5573"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-5574"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-5575"></a><span class="c">!!    implicit none</span>
<a name="ln-5576"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-5577"></a><span class="c">!!</span>
<a name="ln-5578"></a><span class="c">!!    !! set up graphics area</span>
<a name="ln-5579"></a><span class="c">!!    call prefsize(1000,200)</span>
<a name="ln-5580"></a><span class="c">!!    call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-5581"></a><span class="c">!!</span>
<a name="ln-5582"></a><span class="c">!!    !! draw circle that fills default world coordinate window</span>
<a name="ln-5583"></a><span class="c">!!    call polyfill(.true.)</span>
<a name="ln-5584"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-5585"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-5586"></a><span class="c">!!    ipaws=getkey() !! pause</span>
<a name="ln-5587"></a><span class="c">!!</span>
<a name="ln-5588"></a><span class="c">!!    !! set new scales for viewport so &lt;-1,-1&gt; and &lt;1,1&gt; are at</span>
<a name="ln-5589"></a><span class="c">!!    !! corners of display instead of corners of largest square</span>
<a name="ln-5590"></a><span class="c">!!    !! that can fit on display</span>
<a name="ln-5591"></a><span class="c">!!    call expandviewport()</span>
<a name="ln-5592"></a><span class="c">!!    call viewport(-1.0,1.0,-1.0,1.0)</span>
<a name="ln-5593"></a><span class="c">!!</span>
<a name="ln-5594"></a><span class="c">!!    !! draw circle that fills default world coordinate window again</span>
<a name="ln-5595"></a><span class="c">!!    !! instead of a circle, the mapping now produces an ellipse unless</span>
<a name="ln-5596"></a><span class="c">!!    !! this device has a square display</span>
<a name="ln-5597"></a><span class="c">!!    call polyhatch(.true.)</span>
<a name="ln-5598"></a><span class="c">!!    call hatchpitch(0.1)</span>
<a name="ln-5599"></a><span class="c">!!    call hatchang(30.0)</span>
<a name="ln-5600"></a><span class="c">!!    call linewidth(40)</span>
<a name="ln-5601"></a><span class="c">!!    call color(D_CYAN)</span>
<a name="ln-5602"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-5603"></a><span class="c">!!    ipaws=getkey() !! pause</span>
<a name="ln-5604"></a><span class="c">!!</span>
<a name="ln-5605"></a><span class="c">!!    !! set new scales for viewport so &lt;-1,-1&gt; and &lt;1,1&gt; are at</span>
<a name="ln-5606"></a><span class="c">!!    !! corners of largest square that fits on display</span>
<a name="ln-5607"></a><span class="c">!!    call unexpandviewport()</span>
<a name="ln-5608"></a><span class="c">!!    !! actually change to the new viewport</span>
<a name="ln-5609"></a><span class="c">!!    call viewport(-1.0,1.0,-1.0,1.0)</span>
<a name="ln-5610"></a><span class="c">!!</span>
<a name="ln-5611"></a><span class="c">!!    !! now the same circle should draw where the original one did</span>
<a name="ln-5612"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-5613"></a><span class="c">!!    call hatchang(120.0)</span>
<a name="ln-5614"></a><span class="c">!!    call linewidth(40)</span>
<a name="ln-5615"></a><span class="c">!!    call circle(0.0,0.0,1.0)</span>
<a name="ln-5616"></a><span class="c">!!    ipaws=getkey() !! pause</span>
<a name="ln-5617"></a><span class="c">!!</span>
<a name="ln-5618"></a><span class="c">!!    call vexit()                  !! wrap up graphics</span>
<a name="ln-5619"></a><span class="c">!!</span>
<a name="ln-5620"></a><span class="c">!!    end program demo_unexpandviewport</span>
<a name="ln-5621"></a><span class="c">!&gt;</span>
<a name="ln-5622"></a><span class="c">!!##NAME</span>
<a name="ln-5623"></a><span class="c">!!    getaspect(3f) - [M_draw:ASPECT] Returns the ratio height over width of the display device.</span>
<a name="ln-5624"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5625"></a><span class="c">!!</span>
<a name="ln-5626"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5627"></a><span class="c">!!</span>
<a name="ln-5628"></a><span class="c">!!          real function getaspect()</span>
<a name="ln-5629"></a><span class="c">!!</span>
<a name="ln-5630"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5631"></a><span class="c">!!    Returns the ratio height over width of the display device.</span>
<a name="ln-5632"></a><span class="c">!&gt;</span>
<a name="ln-5633"></a><span class="c">!!##NAME</span>
<a name="ln-5634"></a><span class="c">!!    getfactors(3f) - [M_draw:ASPECT] Returns width over min(width of device, height of device) and height over min(width of device, height of device).</span>
<a name="ln-5635"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5636"></a><span class="c">!!</span>
<a name="ln-5637"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5638"></a><span class="c">!!</span>
<a name="ln-5639"></a><span class="c">!!          subroutine getfactors(w, h)</span>
<a name="ln-5640"></a><span class="c">!!          real w, h</span>
<a name="ln-5641"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5642"></a><span class="c">!!    Returns wfact as the width over min(width of device, height of device)</span>
<a name="ln-5643"></a><span class="c">!!    and hfact as the height over min(width of device, height of</span>
<a name="ln-5644"></a><span class="c">!!    device).</span>
<a name="ln-5645"></a><span class="c">!&gt;</span>
<a name="ln-5646"></a><span class="c">!!##NAME</span>
<a name="ln-5647"></a><span class="c">!!    getdisplaysize(3f) - [M_draw:ASPECT] Returns width and height of device in device units</span>
<a name="ln-5648"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5649"></a><span class="c">!!</span>
<a name="ln-5650"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5651"></a><span class="c">!!</span>
<a name="ln-5652"></a><span class="c">!!          subroutine getdisplaysize(w, h)</span>
<a name="ln-5653"></a><span class="c">!!          real,intent(in) :: w, h</span>
<a name="ln-5654"></a><span class="c">!!</span>
<a name="ln-5655"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5656"></a><span class="c">!!    Returns the width and height of the device in device units in w and h</span>
<a name="ln-5657"></a><span class="c">!!    respectively.</span>
<a name="ln-5658"></a><span class="c">!&gt;</span>
<a name="ln-5659"></a><span class="c">!!##NAME</span>
<a name="ln-5660"></a><span class="c">!!    pushattributes(3f) - [M_draw:ATTRIBUTE_STACK] Save the current attributes on the attribute stack.</span>
<a name="ln-5661"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5662"></a><span class="c">!!</span>
<a name="ln-5663"></a><span class="c">!!</span>
<a name="ln-5664"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5665"></a><span class="c">!!</span>
<a name="ln-5666"></a><span class="c">!!          subroutine pushattributes()</span>
<a name="ln-5667"></a><span class="c">!!</span>
<a name="ln-5668"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5669"></a><span class="c">!!</span>
<a name="ln-5670"></a><span class="c">!!    Save the current attributes on the attribute stack.</span>
<a name="ln-5671"></a><span class="c">!&gt;</span>
<a name="ln-5672"></a><span class="c">!!##NAME</span>
<a name="ln-5673"></a><span class="c">!!    popattributes(3f) - [M_draw:ATTRIBUTE_STACK] Restore attributes to what they were at last pushattributes().</span>
<a name="ln-5674"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5675"></a><span class="c">!!</span>
<a name="ln-5676"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5677"></a><span class="c">!!</span>
<a name="ln-5678"></a><span class="c">!!          subroutine popattributes()</span>
<a name="ln-5679"></a><span class="c">!!</span>
<a name="ln-5680"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5681"></a><span class="c">!!</span>
<a name="ln-5682"></a><span class="c">!!    Restore the attributes to what they were at the last pushattributes().</span>
<a name="ln-5683"></a><span class="c">!&gt;</span>
<a name="ln-5684"></a><span class="c">!!##NAME</span>
<a name="ln-5685"></a><span class="c">!!    ortho(3f) - [M_draw:PROJECTION] Define x,y,z clipping planes.</span>
<a name="ln-5686"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5687"></a><span class="c">!!</span>
<a name="ln-5688"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5689"></a><span class="c">!!</span>
<a name="ln-5690"></a><span class="c">!!          subroutine ortho(left, right, bottom, top, near_d, far_d)</span>
<a name="ln-5691"></a><span class="c">!!          real left, right, bottom, top, near_d, far_d</span>
<a name="ln-5692"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5693"></a><span class="c">!!</span>
<a name="ln-5694"></a><span class="c">!!    Define x (left, right), y (bottom, top), and z (near, far) clipping</span>
<a name="ln-5695"></a><span class="c">!!    planes. The near and far clipping planes are actually specified</span>
<a name="ln-5696"></a><span class="c">!!    as distances along the line of sight. These distances can also be</span>
<a name="ln-5697"></a><span class="c">!!    negative. The actual location of the clipping planes is z = -near_d</span>
<a name="ln-5698"></a><span class="c">!!    and z = -far_d.</span>
<a name="ln-5699"></a><span class="c">!&gt;</span>
<a name="ln-5700"></a><span class="c">!!##NAME</span>
<a name="ln-5701"></a><span class="c">!!    ortho2(3f) - [M_draw:PROJECTION] define the area of the virtual world coordinates to map to the viewport</span>
<a name="ln-5702"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5703"></a><span class="c">!!</span>
<a name="ln-5704"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5705"></a><span class="c">!!</span>
<a name="ln-5706"></a><span class="c">!!          subroutine ortho2(left, right, bottom, top)</span>
<a name="ln-5707"></a><span class="c">!!          real,intent(in) :: left, right, bottom, top</span>
<a name="ln-5708"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5709"></a><span class="c">!!</span>
<a name="ln-5710"></a><span class="c">!!    Defines the section of the virtual world coordinates to map to</span>
<a name="ln-5711"></a><span class="c">!!    the viewport. That is, Define x (left, right), and y (bottom, top)</span>
<a name="ln-5712"></a><span class="c">!!    clipping planes.</span>
<a name="ln-5713"></a><span class="c">!!</span>
<a name="ln-5714"></a><span class="c">!!    All the projection routines define a new transformation</span>
<a name="ln-5715"></a><span class="c">!!    matrix, and consequently the world units. Parallel projections are</span>
<a name="ln-5716"></a><span class="c">!!    defined by ortho2.</span>
<a name="ln-5717"></a><span class="c">!&gt;</span>
<a name="ln-5718"></a><span class="c">!!##NAME</span>
<a name="ln-5719"></a><span class="c">!!    perspective(3f) - [M_draw:PROJECTION] Specify perspective viewing pyramid</span>
<a name="ln-5720"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5721"></a><span class="c">!!</span>
<a name="ln-5722"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5723"></a><span class="c">!!</span>
<a name="ln-5724"></a><span class="c">!!          subroutine perspective(fov, aspect, near, far)</span>
<a name="ln-5725"></a><span class="c">!!          real fov, aspect, near, far</span>
<a name="ln-5726"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5727"></a><span class="c">!!    Specify a perspective viewing pyramid in world coordinates by giving</span>
<a name="ln-5728"></a><span class="c">!!    a field of view, aspect ratio and the distance from the eye of the</span>
<a name="ln-5729"></a><span class="c">!!    near and far clipping plane.</span>
<a name="ln-5730"></a><span class="c">!!</span>
<a name="ln-5731"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5732"></a><span class="c">!!</span>
<a name="ln-5733"></a><span class="c">!!   Sample program:</span>
<a name="ln-5734"></a><span class="c">!!</span>
<a name="ln-5735"></a><span class="c">!!    program demo_perspective</span>
<a name="ln-5736"></a><span class="c">!!    !</span>
<a name="ln-5737"></a><span class="c">!!    !     Shows various combinations of viewing and projection transformations</span>
<a name="ln-5738"></a><span class="c">!!    use M_draw</span>
<a name="ln-5739"></a><span class="c">!!    !</span>
<a name="ln-5740"></a><span class="c">!!    character(len=50) :: device</span>
<a name="ln-5741"></a><span class="c">!!    integer :: ios</span>
<a name="ln-5742"></a><span class="c">!!    !</span>
<a name="ln-5743"></a><span class="c">!!       print*,&#39;Enter output device:&#39;</span>
<a name="ln-5744"></a><span class="c">!!       read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-5745"></a><span class="c">!!       if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-5746"></a><span class="c">!!    !</span>
<a name="ln-5747"></a><span class="c">!!       call vinit(device)</span>
<a name="ln-5748"></a><span class="c">!!    !</span>
<a name="ln-5749"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-5750"></a><span class="c">!!       call clear()</span>
<a name="ln-5751"></a><span class="c">!!    !</span>
<a name="ln-5752"></a><span class="c">!!    ! we want to draw just within the boundaries of the screen</span>
<a name="ln-5753"></a><span class="c">!!    !</span>
<a name="ln-5754"></a><span class="c">!!       call viewport(-0.9, 0.9, -0.9, 0.9)</span>
<a name="ln-5755"></a><span class="c">!!    !</span>
<a name="ln-5756"></a><span class="c">!!    ! set the world size</span>
<a name="ln-5757"></a><span class="c">!!    !</span>
<a name="ln-5758"></a><span class="c">!!       call ortho2(-5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5759"></a><span class="c">!!    !</span>
<a name="ln-5760"></a><span class="c">!!    ! draw a boundary frame</span>
<a name="ln-5761"></a><span class="c">!!    !</span>
<a name="ln-5762"></a><span class="c">!!       call color(D_RED)</span>
<a name="ln-5763"></a><span class="c">!!       call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5764"></a><span class="c">!!    !</span>
<a name="ln-5765"></a><span class="c">!!    ! set up a perspective projection with a field of view of</span>
<a name="ln-5766"></a><span class="c">!!    ! 40.0 degrees, aspect ratio of 1.0, near clipping plane 0.1,</span>
<a name="ln-5767"></a><span class="c">!!    ! and the far clipping plane at 1000.0.</span>
<a name="ln-5768"></a><span class="c">!!    !</span>
<a name="ln-5769"></a><span class="c">!!       call perspective(40.0, 1.0, 0.1, 1000.0)</span>
<a name="ln-5770"></a><span class="c">!!    !</span>
<a name="ln-5771"></a><span class="c">!!    ! we want the drawing to be done with our eye point at (5.0, 8.0, 5.0)</span>
<a name="ln-5772"></a><span class="c">!!    ! looking towards (0.0, 0.0, 0.0). The last parameter gives a twist</span>
<a name="ln-5773"></a><span class="c">!!    ! in degrees around the line of sight, in this case zero.</span>
<a name="ln-5774"></a><span class="c">!!    !</span>
<a name="ln-5775"></a><span class="c">!!       call lookat(5.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-5776"></a><span class="c">!!    !</span>
<a name="ln-5777"></a><span class="c">!!       call drawtetra()</span>
<a name="ln-5778"></a><span class="c">!!    !</span>
<a name="ln-5779"></a><span class="c">!!    ! set the text size</span>
<a name="ln-5780"></a><span class="c">!!    !</span>
<a name="ln-5781"></a><span class="c">!!       call textsize(0.6, 0.9)</span>
<a name="ln-5782"></a><span class="c">!!    !</span>
<a name="ln-5783"></a><span class="c">!!       call move2(-4.5, -4.5)</span>
<a name="ln-5784"></a><span class="c">!!       call drawstr(&#39;perspective/lookat&#39;)</span>
<a name="ln-5785"></a><span class="c">!!    !</span>
<a name="ln-5786"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-5787"></a><span class="c">!!    !</span>
<a name="ln-5788"></a><span class="c">!!    ! window can also be used to give a perspective projection. Its</span>
<a name="ln-5789"></a><span class="c">!!    ! arguments are 6 clipping planes, left, right, bottom, top, near,</span>
<a name="ln-5790"></a><span class="c">!!    ! and far.</span>
<a name="ln-5791"></a><span class="c">!!    !</span>
<a name="ln-5792"></a><span class="c">!!       call window(-5.0, 5.0, -5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5793"></a><span class="c">!!    !</span>
<a name="ln-5794"></a><span class="c">!!    ! as window replaces the current transformation matrix we must</span>
<a name="ln-5795"></a><span class="c">!!    ! specify our viewpoint again.</span>
<a name="ln-5796"></a><span class="c">!!    !</span>
<a name="ln-5797"></a><span class="c">!!       call lookat(5.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-5798"></a><span class="c">!!    !</span>
<a name="ln-5799"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-5800"></a><span class="c">!!       call clear()</span>
<a name="ln-5801"></a><span class="c">!!    !</span>
<a name="ln-5802"></a><span class="c">!!       call color(D_GREEN)</span>
<a name="ln-5803"></a><span class="c">!!       call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5804"></a><span class="c">!!    !</span>
<a name="ln-5805"></a><span class="c">!!       call drawtetra()</span>
<a name="ln-5806"></a><span class="c">!!    !</span>
<a name="ln-5807"></a><span class="c">!!       call textsize(0.6, 0.9)</span>
<a name="ln-5808"></a><span class="c">!!       call move2(-4.5,-4.5)</span>
<a name="ln-5809"></a><span class="c">!!       call drawstr(&#39;window/lookat&#39;)</span>
<a name="ln-5810"></a><span class="c">!!    !</span>
<a name="ln-5811"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-5812"></a><span class="c">!!    !</span>
<a name="ln-5813"></a><span class="c">!!    ! set up our original perspective projection again.</span>
<a name="ln-5814"></a><span class="c">!!    !</span>
<a name="ln-5815"></a><span class="c">!!       call perspective(40.0, 1.0, 0.1, 1000.0)</span>
<a name="ln-5816"></a><span class="c">!!    !</span>
<a name="ln-5817"></a><span class="c">!!    ! polarview also specifies our viewpoint, but, unlike lookat, in polar</span>
<a name="ln-5818"></a><span class="c">!!    ! coordinates. Its arguments are the distance from the world origin, an</span>
<a name="ln-5819"></a><span class="c">!!    ! azimuthal angle in the x-y plane measured from the y axis, an</span>
<a name="ln-5820"></a><span class="c">!!    ! incidence angle in the y-z plane measured from the z axis, and a</span>
<a name="ln-5821"></a><span class="c">!!    ! twist around the line of sight.</span>
<a name="ln-5822"></a><span class="c">!!    !</span>
<a name="ln-5823"></a><span class="c">!!       call polarview(15.0, 30.0, 30.0, 30.0)</span>
<a name="ln-5824"></a><span class="c">!!    !</span>
<a name="ln-5825"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-5826"></a><span class="c">!!       call clear()</span>
<a name="ln-5827"></a><span class="c">!!    !</span>
<a name="ln-5828"></a><span class="c">!!       call color(D_MAGENTA)</span>
<a name="ln-5829"></a><span class="c">!!       call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5830"></a><span class="c">!!    !</span>
<a name="ln-5831"></a><span class="c">!!       call drawtetra()</span>
<a name="ln-5832"></a><span class="c">!!    !</span>
<a name="ln-5833"></a><span class="c">!!       call move2(-4.5,-4.5)</span>
<a name="ln-5834"></a><span class="c">!!       call textsize(0.6, 0.9)</span>
<a name="ln-5835"></a><span class="c">!!       call drawstr(&#39;perspective/polarview&#39;)</span>
<a name="ln-5836"></a><span class="c">!!    !</span>
<a name="ln-5837"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-5838"></a><span class="c">!!    !</span>
<a name="ln-5839"></a><span class="c">!!    ! once more with window for comparison</span>
<a name="ln-5840"></a><span class="c">!!    !</span>
<a name="ln-5841"></a><span class="c">!!       call window(-4.0, 4.0, -4.0, 4.0, -4.0, 4.0)</span>
<a name="ln-5842"></a><span class="c">!!       call polarview(6.0, 20.0, -30.0, 70.0)</span>
<a name="ln-5843"></a><span class="c">!!    !</span>
<a name="ln-5844"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-5845"></a><span class="c">!!       call clear()</span>
<a name="ln-5846"></a><span class="c">!!    !</span>
<a name="ln-5847"></a><span class="c">!!       call color(D_YELLOW)</span>
<a name="ln-5848"></a><span class="c">!!       call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5849"></a><span class="c">!!    !</span>
<a name="ln-5850"></a><span class="c">!!       call drawtetra()</span>
<a name="ln-5851"></a><span class="c">!!    !</span>
<a name="ln-5852"></a><span class="c">!!       call move2(-4.5,-4.5)</span>
<a name="ln-5853"></a><span class="c">!!       call textsize(0.6, 0.9)</span>
<a name="ln-5854"></a><span class="c">!!       call drawstr(&#39;window/polarview&#39;)</span>
<a name="ln-5855"></a><span class="c">!!    !</span>
<a name="ln-5856"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-5857"></a><span class="c">!!    !</span>
<a name="ln-5858"></a><span class="c">!!       call vexit()</span>
<a name="ln-5859"></a><span class="c">!!    !</span>
<a name="ln-5860"></a><span class="c">!!    contains</span>
<a name="ln-5861"></a><span class="c">!!    !</span>
<a name="ln-5862"></a><span class="c">!!    subroutine drawtetra()</span>
<a name="ln-5863"></a><span class="c">!!    !</span>
<a name="ln-5864"></a><span class="c">!!    ! generate a tetrahedron as a series of move draws</span>
<a name="ln-5865"></a><span class="c">!!    !</span>
<a name="ln-5866"></a><span class="c">!!       call move(-0.5,  0.866, -0.5)</span>
<a name="ln-5867"></a><span class="c">!!       call draw(-0.5, -0.866, -0.5)</span>
<a name="ln-5868"></a><span class="c">!!       call draw( 1.0,  0.0,   -0.5)</span>
<a name="ln-5869"></a><span class="c">!!       call draw(-0.5,  0.866, -0.5)</span>
<a name="ln-5870"></a><span class="c">!!       call draw( 0.0,  0.0,    1.5)</span>
<a name="ln-5871"></a><span class="c">!!       call draw(-0.5, -0.866, -0.5)</span>
<a name="ln-5872"></a><span class="c">!!       call move( 1.0,  0.0,   -0.5)</span>
<a name="ln-5873"></a><span class="c">!!       call draw( 0.0,  0.0,    1.5)</span>
<a name="ln-5874"></a><span class="c">!!    !</span>
<a name="ln-5875"></a><span class="c">!!    !    Label the vertices.</span>
<a name="ln-5876"></a><span class="c">!!    !</span>
<a name="ln-5877"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-5878"></a><span class="c">!!       call textsize(0.3, 0.5)</span>
<a name="ln-5879"></a><span class="c">!!       call move(-0.5,  0.866, -0.5)</span>
<a name="ln-5880"></a><span class="c">!!       call drawchar(&#39;a&#39;)</span>
<a name="ln-5881"></a><span class="c">!!       call move(-0.5, -0.866, -0.5)</span>
<a name="ln-5882"></a><span class="c">!!       call drawchar(&#39;b&#39;)</span>
<a name="ln-5883"></a><span class="c">!!       call move( 1.0,  0.0,   -0.5)</span>
<a name="ln-5884"></a><span class="c">!!       call drawchar(&#39;c&#39;)</span>
<a name="ln-5885"></a><span class="c">!!       call move( 0.0,  0.0,    1.5)</span>
<a name="ln-5886"></a><span class="c">!!       call drawchar(&#39;d&#39;)</span>
<a name="ln-5887"></a><span class="c">!!    !</span>
<a name="ln-5888"></a><span class="c">!!    end subroutine drawtetra</span>
<a name="ln-5889"></a><span class="c">!!    !</span>
<a name="ln-5890"></a><span class="c">!!    end program demo_perspective</span>
<a name="ln-5891"></a><span class="c">!&gt;</span>
<a name="ln-5892"></a><span class="c">!!##NAME</span>
<a name="ln-5893"></a><span class="c">!!    window(3f) - [M_draw:PROJECTION] Specify a perspective viewing pyramid</span>
<a name="ln-5894"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-5895"></a><span class="c">!!</span>
<a name="ln-5896"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-5897"></a><span class="c">!!</span>
<a name="ln-5898"></a><span class="c">!!          subroutine window(left, right, bot, top, near, far)</span>
<a name="ln-5899"></a><span class="c">!!          real left, right, bot, top, near, far</span>
<a name="ln-5900"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-5901"></a><span class="c">!!</span>
<a name="ln-5902"></a><span class="c">!!    Specify a perspective viewing pyramid in world coordinates by giving</span>
<a name="ln-5903"></a><span class="c">!!    the rectangle closest to the eye (ie. at the near clipping plane)</span>
<a name="ln-5904"></a><span class="c">!!    and the distances to the near and far clipping planes.</span>
<a name="ln-5905"></a><span class="c">!!</span>
<a name="ln-5906"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-5907"></a><span class="c">!!</span>
<a name="ln-5908"></a><span class="c">!!   Sample program:</span>
<a name="ln-5909"></a><span class="c">!!</span>
<a name="ln-5910"></a><span class="c">!!    program demo_windows</span>
<a name="ln-5911"></a><span class="c">!!    use M_draw</span>
<a name="ln-5912"></a><span class="c">!!    integer CUBE, TOPLEFT, TOPRIGHT, BOTTOMLEFT, BOTTOMRIGHT</span>
<a name="ln-5913"></a><span class="c">!!    parameter(CUBE = 1, TOPLEFT = 2, TOPRIGHT = 3, BOTTOMLEFT = 4, BOTTOMRIGHT = 5)</span>
<a name="ln-5914"></a><span class="c">!!    character(len=20) :: device</span>
<a name="ln-5915"></a><span class="c">!!    print*,&#39;Enter device name:&#39;</span>
<a name="ln-5916"></a><span class="c">!!    read(*,&#39;(A)&#39;,iostat=ios)device</span>
<a name="ln-5917"></a><span class="c">!!    if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-5918"></a><span class="c">!!    call vinit(device)</span>
<a name="ln-5919"></a><span class="c">!!    call pushviewport</span>
<a name="ln-5920"></a><span class="c">!!    call textsize(0.5, 0.9)</span>
<a name="ln-5921"></a><span class="c">!!    call font(&#39;futura.m&#39;)</span>
<a name="ln-5922"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-5923"></a><span class="c">!!    call clear</span>
<a name="ln-5924"></a><span class="c">!!    ! make an object that represents the cube</span>
<a name="ln-5925"></a><span class="c">!!    call makecube</span>
<a name="ln-5926"></a><span class="c">!!    ! set up an object which draws in the top left of the screen.</span>
<a name="ln-5927"></a><span class="c">!!    call makeobj(TOPLEFT)</span>
<a name="ln-5928"></a><span class="c">!!    call viewport(-1.0, 0.0, 0.0, 1.0)</span>
<a name="ln-5929"></a><span class="c">!!    call ortho2(-5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5930"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-5931"></a><span class="c">!!    call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5932"></a><span class="c">!!    call perspective(40.0, 1.0, 0.1, 1000.0)</span>
<a name="ln-5933"></a><span class="c">!!    call lookat(5.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-5934"></a><span class="c">!!    ! Call an object within another object</span>
<a name="ln-5935"></a><span class="c">!!    call callobj(CUBE)</span>
<a name="ln-5936"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-5937"></a><span class="c">!!    call move2(-4.5, -4.5)</span>
<a name="ln-5938"></a><span class="c">!!    call drawstr(&#39;perspective/lookat&#39;)</span>
<a name="ln-5939"></a><span class="c">!!    call closeobj</span>
<a name="ln-5940"></a><span class="c">!!    ! now set up one which draws in the top right of the screen</span>
<a name="ln-5941"></a><span class="c">!!    call makeobj(TOPRIGHT)</span>
<a name="ln-5942"></a><span class="c">!!    call viewport(0.0, 1.0, 0.0, 1.0)</span>
<a name="ln-5943"></a><span class="c">!!    call ortho2(-5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5944"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-5945"></a><span class="c">!!    call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5946"></a><span class="c">!!    call window(-5.0, 5.0, -5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5947"></a><span class="c">!!    call lookat(5.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-5948"></a><span class="c">!!    call callobj(CUBE)</span>
<a name="ln-5949"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-5950"></a><span class="c">!!    call move2(-4.5, -4.5)</span>
<a name="ln-5951"></a><span class="c">!!    call drawstr(&#39;window/lookat&#39;)</span>
<a name="ln-5952"></a><span class="c">!!    call closeobj</span>
<a name="ln-5953"></a><span class="c">!!    ! try the bottom left</span>
<a name="ln-5954"></a><span class="c">!!    call makeobj(BOTTOMLEFT)</span>
<a name="ln-5955"></a><span class="c">!!    call viewport(-1.0, 0.0, -1.0, 0.0)</span>
<a name="ln-5956"></a><span class="c">!!    call ortho2(-5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5957"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-5958"></a><span class="c">!!    call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5959"></a><span class="c">!!    call perspective(40.0, 1.0, 0.1, 1000.0)</span>
<a name="ln-5960"></a><span class="c">!!    call polarview(15.0, 30.0, 30.0, 30.0)</span>
<a name="ln-5961"></a><span class="c">!!    call callobj(CUBE)</span>
<a name="ln-5962"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-5963"></a><span class="c">!!    call move2(-4.5, -4.5)</span>
<a name="ln-5964"></a><span class="c">!!    call drawstr(&#39;perspective/polarview&#39;)</span>
<a name="ln-5965"></a><span class="c">!!    call closeobj</span>
<a name="ln-5966"></a><span class="c">!!    ! and the bottom right</span>
<a name="ln-5967"></a><span class="c">!!    call makeobj(BOTTOMRIGHT)</span>
<a name="ln-5968"></a><span class="c">!!    call viewport(0.0, 1.0, -1.0, 0.0)</span>
<a name="ln-5969"></a><span class="c">!!    call ortho2(-5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5970"></a><span class="c">!!    call color(D_CYAN)</span>
<a name="ln-5971"></a><span class="c">!!    call rect(-5.0, -5.0, 5.0, 5.0)</span>
<a name="ln-5972"></a><span class="c">!!    call window(-5.0, 5.0, -5.0, 5.0, -5.0, 5.0)</span>
<a name="ln-5973"></a><span class="c">!!    call polarview(8.0, -18.0, -3.0, 18.0)</span>
<a name="ln-5974"></a><span class="c">!!    call callobj(CUBE)</span>
<a name="ln-5975"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-5976"></a><span class="c">!!    call move2(-4.5, -4.5)</span>
<a name="ln-5977"></a><span class="c">!!    call drawstr(&#39;window/polarview&#39;)</span>
<a name="ln-5978"></a><span class="c">!!    call closeobj</span>
<a name="ln-5979"></a><span class="c">!!    ! now draw them</span>
<a name="ln-5980"></a><span class="c">!!    call callobj(TOPLEFT)</span>
<a name="ln-5981"></a><span class="c">!!    call callobj(TOPRIGHT)</span>
<a name="ln-5982"></a><span class="c">!!    call callobj(BOTTOMLEFT)</span>
<a name="ln-5983"></a><span class="c">!!    call callobj(BOTTOMRIGHT)</span>
<a name="ln-5984"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-5985"></a><span class="c">!!    call vexit</span>
<a name="ln-5986"></a><span class="c">!!    !=====================================================================</span>
<a name="ln-5987"></a><span class="c">!!    contains</span>
<a name="ln-5988"></a><span class="c">!!    !=====================================================================</span>
<a name="ln-5989"></a><span class="c">!!    subroutine makecube</span>
<a name="ln-5990"></a><span class="c">!!    ! set up a cube</span>
<a name="ln-5991"></a><span class="c">!!    integer CUBE</span>
<a name="ln-5992"></a><span class="c">!!    parameter (CUBE = 1)</span>
<a name="ln-5993"></a><span class="c">!!    call makeobj(CUBE)</span>
<a name="ln-5994"></a><span class="c">!!    ! The border around the cube</span>
<a name="ln-5995"></a><span class="c">!!    call rect(-5.0, -5.0, 10.0, 10.0)</span>
<a name="ln-5996"></a><span class="c">!!    ! Make the cube from 4 squares</span>
<a name="ln-5997"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-5998"></a><span class="c">!!    call side()</span>
<a name="ln-5999"></a><span class="c">!!    call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-6000"></a><span class="c">!!    call side()</span>
<a name="ln-6001"></a><span class="c">!!    call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-6002"></a><span class="c">!!    call side()</span>
<a name="ln-6003"></a><span class="c">!!    call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-6004"></a><span class="c">!!    call side()</span>
<a name="ln-6005"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6006"></a><span class="c">!!    call closeobj()</span>
<a name="ln-6007"></a><span class="c">!!    end subroutine makecube</span>
<a name="ln-6008"></a><span class="c">!!    !=====================================================================</span>
<a name="ln-6009"></a><span class="c">!!    subroutine side</span>
<a name="ln-6010"></a><span class="c">!!    ! define a face for the cube</span>
<a name="ln-6011"></a><span class="c">!!    call pushmatrix</span>
<a name="ln-6012"></a><span class="c">!!    call translate(0.0, 0.0, 1.0)</span>
<a name="ln-6013"></a><span class="c">!!    call rect(-1.0, -1.0, 1.0, 1.0)</span>
<a name="ln-6014"></a><span class="c">!!    call popmatrix</span>
<a name="ln-6015"></a><span class="c">!!    end subroutine side</span>
<a name="ln-6016"></a><span class="c">!!    !=====================================================================</span>
<a name="ln-6017"></a><span class="c">!!    end program demo_windows</span>
<a name="ln-6018"></a><span class="c">!&gt;</span>
<a name="ln-6019"></a><span class="c">!!##NAME</span>
<a name="ln-6020"></a><span class="c">!!    pushmatrix(3f) - [M_draw:MATRIX_STACK] Save the current transformation matrix on the matrix stack.</span>
<a name="ln-6021"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6022"></a><span class="c">!!</span>
<a name="ln-6023"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6024"></a><span class="c">!!</span>
<a name="ln-6025"></a><span class="c">!!          subroutine pushmatrix()</span>
<a name="ln-6026"></a><span class="c">!!</span>
<a name="ln-6027"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6028"></a><span class="c">!!</span>
<a name="ln-6029"></a><span class="c">!!    Save the current transformation matrix on the matrix stack.</span>
<a name="ln-6030"></a><span class="c">!&gt;</span>
<a name="ln-6031"></a><span class="c">!!##NAME</span>
<a name="ln-6032"></a><span class="c">!!    popmatrix(3f) - [M_draw:MATRIX_STACK] Reinstall the last matrix pushed</span>
<a name="ln-6033"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6034"></a><span class="c">!!</span>
<a name="ln-6035"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6036"></a><span class="c">!!</span>
<a name="ln-6037"></a><span class="c">!!          subroutine popmatrix()</span>
<a name="ln-6038"></a><span class="c">!!</span>
<a name="ln-6039"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6040"></a><span class="c">!!</span>
<a name="ln-6041"></a><span class="c">!!    Retrieve the last matrix pushed and make it the current transformation matrix.</span>
<a name="ln-6042"></a><span class="c">!&gt;</span>
<a name="ln-6043"></a><span class="c">!!##NAME</span>
<a name="ln-6044"></a><span class="c">!!    polarview(3f) - [M_draw:VIEWPORT] Specify the viewer&#39;s position in polar coordinates</span>
<a name="ln-6045"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6046"></a><span class="c">!!</span>
<a name="ln-6047"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6048"></a><span class="c">!!</span>
<a name="ln-6049"></a><span class="c">!!          subroutine polarview(dist, azim, inc, twist)</span>
<a name="ln-6050"></a><span class="c">!!          real dist, azim, inc, twist</span>
<a name="ln-6051"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6052"></a><span class="c">!!</span>
<a name="ln-6053"></a><span class="c">!! Specify the viewer&#39;s position in polar coordinates by giving the distance</span>
<a name="ln-6054"></a><span class="c">!! from the viewpoint to the world origin, the azimuthal angle in the x-y</span>
<a name="ln-6055"></a><span class="c">!! plane, measured from the y-axis, the incidence angle in the y-z plane,</span>
<a name="ln-6056"></a><span class="c">!! measured from the z-axis, and the twist angle about the line of sight.</span>
<a name="ln-6057"></a><span class="c">!&gt;</span>
<a name="ln-6058"></a><span class="c">!!##NAME</span>
<a name="ln-6059"></a><span class="c">!!    up(3f) - [M_draw:VIEWPORT] Specify the world up.</span>
<a name="ln-6060"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6061"></a><span class="c">!!</span>
<a name="ln-6062"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6063"></a><span class="c">!!</span>
<a name="ln-6064"></a><span class="c">!!          subroutine up(x, y, z)</span>
<a name="ln-6065"></a><span class="c">!!          real x, y, z</span>
<a name="ln-6066"></a><span class="c">!!</span>
<a name="ln-6067"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6068"></a><span class="c">!! Specify the world up. This can be used to prevent lookat&#39;s sometimes</span>
<a name="ln-6069"></a><span class="c">!! annoying habit of turning everything upside down due to the line of</span>
<a name="ln-6070"></a><span class="c">!! sight crossing the appropriate axis.</span>
<a name="ln-6071"></a><span class="c">!&gt;</span>
<a name="ln-6072"></a><span class="c">!!##NAME</span>
<a name="ln-6073"></a><span class="c">!!    lookat(3f) - [M_draw:VIEWPORT] Specify the viewer&#39;s position</span>
<a name="ln-6074"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6075"></a><span class="c">!!</span>
<a name="ln-6076"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6077"></a><span class="c">!!</span>
<a name="ln-6078"></a><span class="c">!!          subroutine lookat(vx, vy, vz, px, py, pz, twist)</span>
<a name="ln-6079"></a><span class="c">!!          real vx, vy, vz, px, py, pz, twist</span>
<a name="ln-6080"></a><span class="c">!!</span>
<a name="ln-6081"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6082"></a><span class="c">!!    Specify the viewer&#39;s position by giving a viewpoint and a reference</span>
<a name="ln-6083"></a><span class="c">!!    point in world coordinates. A twist about the line of sight may also</span>
<a name="ln-6084"></a><span class="c">!!    be given.</span>
<a name="ln-6085"></a><span class="c">!!</span>
<a name="ln-6086"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6087"></a><span class="c">!!</span>
<a name="ln-6088"></a><span class="c">!!  Sample program:</span>
<a name="ln-6089"></a><span class="c">!!</span>
<a name="ln-6090"></a><span class="c">!!    program demo_lookat</span>
<a name="ln-6091"></a><span class="c">!!    ! Demonstrate a rotating translating tetrahedron, and doublebuffering</span>
<a name="ln-6092"></a><span class="c">!!    use M_draw</span>
<a name="ln-6093"></a><span class="c">!!    use M_time, only : system_sleep</span>
<a name="ln-6094"></a><span class="c">!!    !</span>
<a name="ln-6095"></a><span class="c">!!    integer TETRAHEDRON</span>
<a name="ln-6096"></a><span class="c">!!    parameter (TETRAHEDRON = 1)</span>
<a name="ln-6097"></a><span class="c">!!    !</span>
<a name="ln-6098"></a><span class="c">!!    real R, tx, tz, rotval, drotval, zeye</span>
<a name="ln-6099"></a><span class="c">!!    integer i</span>
<a name="ln-6100"></a><span class="c">!!    logical back, backdir, fill</span>
<a name="ln-6101"></a><span class="c">!!    character(len=50) :: device</span>
<a name="ln-6102"></a><span class="c">!!    integer :: ios</span>
<a name="ln-6103"></a><span class="c">!!    !</span>
<a name="ln-6104"></a><span class="c">!!    call prefsize(300, 300)</span>
<a name="ln-6105"></a><span class="c">!!    !</span>
<a name="ln-6106"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-6107"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios)device</span>
<a name="ln-6108"></a><span class="c">!!    if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-6109"></a><span class="c">!!    !</span>
<a name="ln-6110"></a><span class="c">!!    back = .true.</span>
<a name="ln-6111"></a><span class="c">!!    backdir = .true.</span>
<a name="ln-6112"></a><span class="c">!!    fill = .true.</span>
<a name="ln-6113"></a><span class="c">!!    !</span>
<a name="ln-6114"></a><span class="c">!!    call vinit(device)</span>
<a name="ln-6115"></a><span class="c">!!    !</span>
<a name="ln-6116"></a><span class="c">!!    ! Make the tetrahedral object</span>
<a name="ln-6117"></a><span class="c">!!    !</span>
<a name="ln-6118"></a><span class="c">!!    call maketheobject()</span>
<a name="ln-6119"></a><span class="c">!!    !</span>
<a name="ln-6120"></a><span class="c">!!    rotval = 0.0</span>
<a name="ln-6121"></a><span class="c">!!    drotval = 5.0</span>
<a name="ln-6122"></a><span class="c">!!    zeye = 5.0</span>
<a name="ln-6123"></a><span class="c">!!    !</span>
<a name="ln-6124"></a><span class="c">!!    R = 1.6</span>
<a name="ln-6125"></a><span class="c">!!    !</span>
<a name="ln-6126"></a><span class="c">!!    tx = 0.0</span>
<a name="ln-6127"></a><span class="c">!!    tz = R</span>
<a name="ln-6128"></a><span class="c">!!    !</span>
<a name="ln-6129"></a><span class="c">!!    !all polyfill(fill)</span>
<a name="ln-6130"></a><span class="c">!!    call backface(back)</span>
<a name="ln-6131"></a><span class="c">!!    call backfacedir(backdir)</span>
<a name="ln-6132"></a><span class="c">!!    call clipping(.false.)</span>
<a name="ln-6133"></a><span class="c">!!    !</span>
<a name="ln-6134"></a><span class="c">!!    ! set up a perspective projection with a field of view of</span>
<a name="ln-6135"></a><span class="c">!!    ! 40.0 degrees, aspect ratio of 1.0, near clipping plane 0.1,</span>
<a name="ln-6136"></a><span class="c">!!    ! and the far clipping plane at 1000.0.</span>
<a name="ln-6137"></a><span class="c">!!    !</span>
<a name="ln-6138"></a><span class="c">!!    call perspective(40.0, 1.0, 0.001, 15.0)</span>
<a name="ln-6139"></a><span class="c">!!    call lookat(0.0, 0.0, zeye, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-6140"></a><span class="c">!!    !</span>
<a name="ln-6141"></a><span class="c">!!    ! Setup drawing into the backbuffer....</span>
<a name="ln-6142"></a><span class="c">!!    !</span>
<a name="ln-6143"></a><span class="c">!!    if (backbuffer().lt.0) then</span>
<a name="ln-6144"></a><span class="c">!!       call vexit()</span>
<a name="ln-6145"></a><span class="c">!!       write(*,*)&#39;Device can&#39;&#39;t support doublebuffering&#39;</span>
<a name="ln-6146"></a><span class="c">!!       stop</span>
<a name="ln-6147"></a><span class="c">!!    endif</span>
<a name="ln-6148"></a><span class="c">!!    !</span>
<a name="ln-6149"></a><span class="c">!!    ! we loop back here ad-nauseam until someone hits a non-interpreted key</span>
<a name="ln-6150"></a><span class="c">!!    !</span>
<a name="ln-6151"></a><span class="c">!!    INFINITE: do</span>
<a name="ln-6152"></a><span class="c">!!    !</span>
<a name="ln-6153"></a><span class="c">!!       rotval = 0.0</span>
<a name="ln-6154"></a><span class="c">!!    !</span>
<a name="ln-6155"></a><span class="c">!!       do i = 0, int(359.0 / drotval)</span>
<a name="ln-6156"></a><span class="c">!!    !</span>
<a name="ln-6157"></a><span class="c">!!          call color(D_BLACK)</span>
<a name="ln-6158"></a><span class="c">!!          call clear()</span>
<a name="ln-6159"></a><span class="c">!!    !</span>
<a name="ln-6160"></a><span class="c">!!    !  Rotate the whole scene...(this accumulates - hence</span>
<a name="ln-6161"></a><span class="c">!!    !  drotval)</span>
<a name="ln-6162"></a><span class="c">!!    !</span>
<a name="ln-6163"></a><span class="c">!!          call rotate(drotval * 0.1, &#39;x&#39;)</span>
<a name="ln-6164"></a><span class="c">!!          call rotate(drotval * 0.1, &#39;z&#39;)</span>
<a name="ln-6165"></a><span class="c">!!    !</span>
<a name="ln-6166"></a><span class="c">!!          call color(D_RED)</span>
<a name="ln-6167"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-6168"></a><span class="c">!!          call polyfill(.false.)</span>
<a name="ln-6169"></a><span class="c">!!          call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-6170"></a><span class="c">!!          call circle(0.0, 0.0, R)</span>
<a name="ln-6171"></a><span class="c">!!          call polyfill(fill)</span>
<a name="ln-6172"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-6173"></a><span class="c">!!    !</span>
<a name="ln-6174"></a><span class="c">!!          call color(D_BLUE)</span>
<a name="ln-6175"></a><span class="c">!!          call move(0.0, 0.0, 0.0)</span>
<a name="ln-6176"></a><span class="c">!!          call draw(tx, 0.0, tz)</span>
<a name="ln-6177"></a><span class="c">!!    !</span>
<a name="ln-6178"></a><span class="c">!!    ! Remember! The order of the transformations is</span>
<a name="ln-6179"></a><span class="c">!!    ! the reverse of what is specified here in between</span>
<a name="ln-6180"></a><span class="c">!!    ! the pushmatrix and the popmatrix. These ones don&#39;t</span>
<a name="ln-6181"></a><span class="c">!!    ! accumulate because of the push and pop.</span>
<a name="ln-6182"></a><span class="c">!!    !</span>
<a name="ln-6183"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-6184"></a><span class="c">!!             call translate(tx, 0.0, tz)</span>
<a name="ln-6185"></a><span class="c">!!             call rotate(rotval, &#39;x&#39;)</span>
<a name="ln-6186"></a><span class="c">!!             call rotate(rotval, &#39;y&#39;)</span>
<a name="ln-6187"></a><span class="c">!!             call rotate(rotval, &#39;z&#39;)</span>
<a name="ln-6188"></a><span class="c">!!             call scale(0.4, 0.4, 0.4)</span>
<a name="ln-6189"></a><span class="c">!!             call callobj(TETRAHEDRON)</span>
<a name="ln-6190"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-6191"></a><span class="c">!!    !</span>
<a name="ln-6192"></a><span class="c">!!          tz = R * cos(rotval * 3.1415926535 / 180)</span>
<a name="ln-6193"></a><span class="c">!!          tx = R * sin(rotval * 3.1415926535 / 180)</span>
<a name="ln-6194"></a><span class="c">!!    !</span>
<a name="ln-6195"></a><span class="c">!!          call swapbuffers()</span>
<a name="ln-6196"></a><span class="c">!!    !</span>
<a name="ln-6197"></a><span class="c">!!          select case(char(checkkey()))</span>
<a name="ln-6198"></a><span class="c">!!          case(&#39;f&#39;)</span>
<a name="ln-6199"></a><span class="c">!!                    fill = .not. fill</span>
<a name="ln-6200"></a><span class="c">!!                    call polyfill(fill)</span>
<a name="ln-6201"></a><span class="c">!!          case(&#39;b&#39;)</span>
<a name="ln-6202"></a><span class="c">!!                    back = .not. back</span>
<a name="ln-6203"></a><span class="c">!!                    call backface(back)</span>
<a name="ln-6204"></a><span class="c">!!          case(&#39;d&#39;)</span>
<a name="ln-6205"></a><span class="c">!!                    backdir = .not. backdir</span>
<a name="ln-6206"></a><span class="c">!!                    call backfacedir(backdir)</span>
<a name="ln-6207"></a><span class="c">!!          case(char(0))</span>
<a name="ln-6208"></a><span class="c">!!          case default</span>
<a name="ln-6209"></a><span class="c">!!                    call vexit()</span>
<a name="ln-6210"></a><span class="c">!!                    stop</span>
<a name="ln-6211"></a><span class="c">!!           end select</span>
<a name="ln-6212"></a><span class="c">!!    !</span>
<a name="ln-6213"></a><span class="c">!!          rotval = rotval + drotval</span>
<a name="ln-6214"></a><span class="c">!!    !</span>
<a name="ln-6215"></a><span class="c">!!          call system_sleep(0.05)</span>
<a name="ln-6216"></a><span class="c">!!    !</span>
<a name="ln-6217"></a><span class="c">!!    enddo</span>
<a name="ln-6218"></a><span class="c">!!    !</span>
<a name="ln-6219"></a><span class="c">!!    enddo INFINITE</span>
<a name="ln-6220"></a><span class="c">!!    !</span>
<a name="ln-6221"></a><span class="c">!!    contains</span>
<a name="ln-6222"></a><span class="c">!!    !</span>
<a name="ln-6223"></a><span class="c">!!    ! maketheobject</span>
<a name="ln-6224"></a><span class="c">!!    !</span>
<a name="ln-6225"></a><span class="c">!!    !       generate a tetrahedron object as a series of move draws</span>
<a name="ln-6226"></a><span class="c">!!    !</span>
<a name="ln-6227"></a><span class="c">!!    subroutine maketheobject()</span>
<a name="ln-6228"></a><span class="c">!!</span>
<a name="ln-6229"></a><span class="c">!!    integer TETRAHEDRON, NSIDES, NFACES, NPNTS</span>
<a name="ln-6230"></a><span class="c">!!    parameter (TETRAHEDRON = 1, NSIDES = 3, NFACES = 4, NPNTS = 4)</span>
<a name="ln-6231"></a><span class="c">!!    integer colface(NFACES)</span>
<a name="ln-6232"></a><span class="c">!!    real pnts(3, NPNTS)</span>
<a name="ln-6233"></a><span class="c">!!    integer faces(NSIDES, NFACES)</span>
<a name="ln-6234"></a><span class="c">!!    integer i, j</span>
<a name="ln-6235"></a><span class="c">!!    real x, y, z</span>
<a name="ln-6236"></a><span class="c">!!</span>
<a name="ln-6237"></a><span class="c">!!    data pnts/               &amp;</span>
<a name="ln-6238"></a><span class="c">!!         &amp;  -0.5, 0.866, -0.667,     &amp;</span>
<a name="ln-6239"></a><span class="c">!!         &amp;  -0.5, -0.866, -0.667,    &amp;</span>
<a name="ln-6240"></a><span class="c">!!         &amp;   1.0, 0.0, -0.667,       &amp;</span>
<a name="ln-6241"></a><span class="c">!!         &amp;   0.0, 0.0, 1.334/</span>
<a name="ln-6242"></a><span class="c">!!</span>
<a name="ln-6243"></a><span class="c">!!    data colface/D_GREEN, D_YELLOW, D_CYAN, D_MAGENTA/</span>
<a name="ln-6244"></a><span class="c">!!</span>
<a name="ln-6245"></a><span class="c">!!    data faces/   &amp;</span>
<a name="ln-6246"></a><span class="c">!!         &amp;  3, 2, 1,      &amp;</span>
<a name="ln-6247"></a><span class="c">!!         &amp;  1, 2, 4,      &amp;</span>
<a name="ln-6248"></a><span class="c">!!         &amp;  2, 3, 4,      &amp;</span>
<a name="ln-6249"></a><span class="c">!!         &amp;  3, 1, 4/</span>
<a name="ln-6250"></a><span class="c">!!</span>
<a name="ln-6251"></a><span class="c">!!    call makeobj(TETRAHEDRON)</span>
<a name="ln-6252"></a><span class="c">!!</span>
<a name="ln-6253"></a><span class="c">!!    do i = 1, NFACES</span>
<a name="ln-6254"></a><span class="c">!!       call makepoly()</span>
<a name="ln-6255"></a><span class="c">!!       call color(colface(i))</span>
<a name="ln-6256"></a><span class="c">!!       x = pnts(1, faces(1, i))</span>
<a name="ln-6257"></a><span class="c">!!       y = pnts(2, faces(1, i))</span>
<a name="ln-6258"></a><span class="c">!!       z = pnts(3, faces(1, i))</span>
<a name="ln-6259"></a><span class="c">!!       call move(x, y, z)</span>
<a name="ln-6260"></a><span class="c">!!       do j = 2, NSIDES</span>
<a name="ln-6261"></a><span class="c">!!          x = pnts(1, faces(j,i))</span>
<a name="ln-6262"></a><span class="c">!!          y = pnts(2, faces(j,i))</span>
<a name="ln-6263"></a><span class="c">!!          z = pnts(3, faces(j,i))</span>
<a name="ln-6264"></a><span class="c">!!          call draw(x, y, z)</span>
<a name="ln-6265"></a><span class="c">!!       enddo</span>
<a name="ln-6266"></a><span class="c">!!       call closepoly()</span>
<a name="ln-6267"></a><span class="c">!!     enddo</span>
<a name="ln-6268"></a><span class="c">!!</span>
<a name="ln-6269"></a><span class="c">!!     call closeobj()</span>
<a name="ln-6270"></a><span class="c">!!</span>
<a name="ln-6271"></a><span class="c">!!     end subroutine maketheobject</span>
<a name="ln-6272"></a><span class="c">!!</span>
<a name="ln-6273"></a><span class="c">!!    end program demo_lookat</span>
<a name="ln-6274"></a><span class="c">!&gt;</span>
<a name="ln-6275"></a><span class="c">!!##NAME</span>
<a name="ln-6276"></a><span class="c">!!    translate(3f) - [M_draw:TRANSFORMATION] Set up a translation.</span>
<a name="ln-6277"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6278"></a><span class="c">!!</span>
<a name="ln-6279"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6280"></a><span class="c">!!</span>
<a name="ln-6281"></a><span class="c">!!       subroutine translate(x, y, z)</span>
<a name="ln-6282"></a><span class="c">!!       real x, y, z</span>
<a name="ln-6283"></a><span class="c">!!</span>
<a name="ln-6284"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6285"></a><span class="c">!!</span>
<a name="ln-6286"></a><span class="c">!!    Set up a translation.</span>
<a name="ln-6287"></a><span class="c">!!</span>
<a name="ln-6288"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6289"></a><span class="c">!!</span>
<a name="ln-6290"></a><span class="c">!!   Sample program:</span>
<a name="ln-6291"></a><span class="c">!!</span>
<a name="ln-6292"></a><span class="c">!!    program demo_translate</span>
<a name="ln-6293"></a><span class="c">!!    !</span>
<a name="ln-6294"></a><span class="c">!!    !      a demonstration of objects</span>
<a name="ln-6295"></a><span class="c">!!    !</span>
<a name="ln-6296"></a><span class="c">!!    use M_draw</span>
<a name="ln-6297"></a><span class="c">!!</span>
<a name="ln-6298"></a><span class="c">!!    integer SPHERE</span>
<a name="ln-6299"></a><span class="c">!!    real RADIUS</span>
<a name="ln-6300"></a><span class="c">!!    parameter (RADIUS = 10.0)</span>
<a name="ln-6301"></a><span class="c">!!    parameter(SPHERE = 1)</span>
<a name="ln-6302"></a><span class="c">!!    character(len=50) :: device</span>
<a name="ln-6303"></a><span class="c">!!    integer           :: ios</span>
<a name="ln-6304"></a><span class="c">!!</span>
<a name="ln-6305"></a><span class="c">!!    print*,&#39;Enter output device:&#39;</span>
<a name="ln-6306"></a><span class="c">!!    read(*,&#39;(a)&#39;,iostat=ios) device</span>
<a name="ln-6307"></a><span class="c">!!    if(ios.ne.0)device=&#39; &#39;</span>
<a name="ln-6308"></a><span class="c">!!</span>
<a name="ln-6309"></a><span class="c">!!    call vinit(device)</span>
<a name="ln-6310"></a><span class="c">!!</span>
<a name="ln-6311"></a><span class="c">!!    call vsetflush(.false.)</span>
<a name="ln-6312"></a><span class="c">!!    !</span>
<a name="ln-6313"></a><span class="c">!!    ! set up our viewing transformation</span>
<a name="ln-6314"></a><span class="c">!!    !</span>
<a name="ln-6315"></a><span class="c">!!    call perspective(90.0, 1.0, 0.001, 500.0)</span>
<a name="ln-6316"></a><span class="c">!!    call lookat(13.0, 13.0, 8.0, 0.0, 0.0, 0.0, 0.0)</span>
<a name="ln-6317"></a><span class="c">!!</span>
<a name="ln-6318"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-6319"></a><span class="c">!!    call clear()</span>
<a name="ln-6320"></a><span class="c">!!    !</span>
<a name="ln-6321"></a><span class="c">!!    ! Call a routine to make the sphere object</span>
<a name="ln-6322"></a><span class="c">!!    !</span>
<a name="ln-6323"></a><span class="c">!!    call makesphere()</span>
<a name="ln-6324"></a><span class="c">!!</span>
<a name="ln-6325"></a><span class="c">!!    !</span>
<a name="ln-6326"></a><span class="c">!!    ! Now draw the sphere object scaled down. We use the pushmatrix</span>
<a name="ln-6327"></a><span class="c">!!    ! and the popmatrix to preserve the transformation matrix so</span>
<a name="ln-6328"></a><span class="c">!!    ! that only this sphere is drawn scaled. The callobj then enables</span>
<a name="ln-6329"></a><span class="c">!!    ! us to draw the sphere we generated with makeobj in makesphere.</span>
<a name="ln-6330"></a><span class="c">!!    !</span>
<a name="ln-6331"></a><span class="c">!!    call color(D_CYAN)</span>
<a name="ln-6332"></a><span class="c">!!</span>
<a name="ln-6333"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6334"></a><span class="c">!!    call scale(0.5, 0.5, 0.5)</span>
<a name="ln-6335"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6336"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6337"></a><span class="c">!!    !</span>
<a name="ln-6338"></a><span class="c">!!    ! now we draw the same sphere translated, with a different</span>
<a name="ln-6339"></a><span class="c">!!    ! scale and color.</span>
<a name="ln-6340"></a><span class="c">!!    !</span>
<a name="ln-6341"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-6342"></a><span class="c">!!</span>
<a name="ln-6343"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6344"></a><span class="c">!!    call translate(0.0, (-1.4) * RADIUS, 1.4 * RADIUS)</span>
<a name="ln-6345"></a><span class="c">!!    call scale(0.3, 0.3, 0.3)</span>
<a name="ln-6346"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6347"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6348"></a><span class="c">!!    !</span>
<a name="ln-6349"></a><span class="c">!!    ! and maybe a few more times....</span>
<a name="ln-6350"></a><span class="c">!!    !</span>
<a name="ln-6351"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-6352"></a><span class="c">!!</span>
<a name="ln-6353"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6354"></a><span class="c">!!    call translate(0.0, RADIUS, 0.7 * RADIUS)</span>
<a name="ln-6355"></a><span class="c">!!    call scale(0.2, 0.2, 0.2)</span>
<a name="ln-6356"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6357"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6358"></a><span class="c">!!</span>
<a name="ln-6359"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-6360"></a><span class="c">!!</span>
<a name="ln-6361"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6362"></a><span class="c">!!    call translate(0.0, 1.5 * RADIUS, -RADIUS)</span>
<a name="ln-6363"></a><span class="c">!!    call scale(0.15, 0.15, 0.15)</span>
<a name="ln-6364"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6365"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6366"></a><span class="c">!!</span>
<a name="ln-6367"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-6368"></a><span class="c">!!</span>
<a name="ln-6369"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6370"></a><span class="c">!!    call translate(0.0, -RADIUS, -RADIUS)</span>
<a name="ln-6371"></a><span class="c">!!    call scale(0.12, 0.12, 0.12)</span>
<a name="ln-6372"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6373"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6374"></a><span class="c">!!</span>
<a name="ln-6375"></a><span class="c">!!    call color(D_BLUE)</span>
<a name="ln-6376"></a><span class="c">!!</span>
<a name="ln-6377"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6378"></a><span class="c">!!    call translate(0.0, (-2.0)*RADIUS, -RADIUS)</span>
<a name="ln-6379"></a><span class="c">!!    call scale(0.3, 0.3, 0.3)</span>
<a name="ln-6380"></a><span class="c">!!    call callobj(SPHERE)</span>
<a name="ln-6381"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6382"></a><span class="c">!!</span>
<a name="ln-6383"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-6384"></a><span class="c">!!</span>
<a name="ln-6385"></a><span class="c">!!    call vexit()</span>
<a name="ln-6386"></a><span class="c">!!    contains</span>
<a name="ln-6387"></a><span class="c">!!    subroutine makesphere</span>
<a name="ln-6388"></a><span class="c">!!    !</span>
<a name="ln-6389"></a><span class="c">!!    !        make a sphere object</span>
<a name="ln-6390"></a><span class="c">!!    !</span>
<a name="ln-6391"></a><span class="c">!!    integer SPHERE</span>
<a name="ln-6392"></a><span class="c">!!    integer ii</span>
<a name="ln-6393"></a><span class="c">!!    real i, r, z, a, RADIUS, PI</span>
<a name="ln-6394"></a><span class="c">!!    parameter (PI = 3.1415926535, RADIUS = 10.0, SPHERE = 1)</span>
<a name="ln-6395"></a><span class="c">!!</span>
<a name="ln-6396"></a><span class="c">!!    call makeobj(SPHERE)</span>
<a name="ln-6397"></a><span class="c">!!    !</span>
<a name="ln-6398"></a><span class="c">!!    ! create the latitudinal rings</span>
<a name="ln-6399"></a><span class="c">!!    !</span>
<a name="ln-6400"></a><span class="c">!!    do ii = 0, 180, 20</span>
<a name="ln-6401"></a><span class="c">!!       call pushmatrix()</span>
<a name="ln-6402"></a><span class="c">!!       i=real(ii)</span>
<a name="ln-6403"></a><span class="c">!!       call rotate(i, &#39;y&#39;)</span>
<a name="ln-6404"></a><span class="c">!!       call circle(0.0, 0.0, RADIUS)</span>
<a name="ln-6405"></a><span class="c">!!       call popmatrix()</span>
<a name="ln-6406"></a><span class="c">!!    enddo</span>
<a name="ln-6407"></a><span class="c">!!    !</span>
<a name="ln-6408"></a><span class="c">!!    ! create the longitudinal rings</span>
<a name="ln-6409"></a><span class="c">!!    !</span>
<a name="ln-6410"></a><span class="c">!!    call pushmatrix()</span>
<a name="ln-6411"></a><span class="c">!!    call rotate(90.0, &#39;x&#39;)</span>
<a name="ln-6412"></a><span class="c">!!    do ia = -90, 90, 20</span>
<a name="ln-6413"></a><span class="c">!!       a=ia</span>
<a name="ln-6414"></a><span class="c">!!       r = RADIUS * cos(a * PI / 180.0)</span>
<a name="ln-6415"></a><span class="c">!!       z = RADIUS * sin(a * PI / 180.0)</span>
<a name="ln-6416"></a><span class="c">!!       call pushmatrix()</span>
<a name="ln-6417"></a><span class="c">!!       call translate(0.0, 0.0, -z)</span>
<a name="ln-6418"></a><span class="c">!!       call circle(0.0, 0.0, r)</span>
<a name="ln-6419"></a><span class="c">!!       call popmatrix()</span>
<a name="ln-6420"></a><span class="c">!!    enddo</span>
<a name="ln-6421"></a><span class="c">!!    call popmatrix()</span>
<a name="ln-6422"></a><span class="c">!!</span>
<a name="ln-6423"></a><span class="c">!!    call closeobj()</span>
<a name="ln-6424"></a><span class="c">!!</span>
<a name="ln-6425"></a><span class="c">!!    end subroutine makesphere</span>
<a name="ln-6426"></a><span class="c">!!</span>
<a name="ln-6427"></a><span class="c">!!    end program demo_translate</span>
<a name="ln-6428"></a><span class="c">!&gt;</span>
<a name="ln-6429"></a><span class="c">!!##NAME</span>
<a name="ln-6430"></a><span class="c">!!    scale(3f) - [M_draw:TRANSFORMATION] Set up scaling factors in x, y, and z axis.</span>
<a name="ln-6431"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6432"></a><span class="c">!!</span>
<a name="ln-6433"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6434"></a><span class="c">!!</span>
<a name="ln-6435"></a><span class="c">!!    subroutine scale(x, y, z)</span>
<a name="ln-6436"></a><span class="c">!!</span>
<a name="ln-6437"></a><span class="c">!!     real,intent(in) ::  x, y, z</span>
<a name="ln-6438"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6439"></a><span class="c">!!    Set up scaling factors in x, y, and z axis. The scaling is applied relative</span>
<a name="ln-6440"></a><span class="c">!!    to the current transformation matrix; ie. the scaling is accumulative.</span>
<a name="ln-6441"></a><span class="c">!!</span>
<a name="ln-6442"></a><span class="c">!!##OPTIONS</span>
<a name="ln-6443"></a><span class="c">!!    x  scaling factor to apply in X direction to current transformation matrix</span>
<a name="ln-6444"></a><span class="c">!!    y  scaling factor to apply in Y direction to current transformation matrix</span>
<a name="ln-6445"></a><span class="c">!!    x  scaling factor to apply in Z direction to current transformation matrix</span>
<a name="ln-6446"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6447"></a><span class="c">!!</span>
<a name="ln-6448"></a><span class="c">!!  Sample program</span>
<a name="ln-6449"></a><span class="c">!!</span>
<a name="ln-6450"></a><span class="c">!!    program demo_scale</span>
<a name="ln-6451"></a><span class="c">!!    use M_drawplus, only : draw_interpret</span>
<a name="ln-6452"></a><span class="c">!!    character(len=:),allocatable :: draw_cmds(:)</span>
<a name="ln-6453"></a><span class="c">!!    draw_cmds=[ character(len=128) ::                                      &amp;</span>
<a name="ln-6454"></a><span class="c">!!    &#39;# set up display                                                    &#39;,&amp;</span>
<a name="ln-6455"></a><span class="c">!!    &#39;prefsize 300 300;prefposition 200 10;vinit X11;                     &#39;,&amp;</span>
<a name="ln-6456"></a><span class="c">!!    &#39;set SIZE=1.2                                                        &#39;,&amp;</span>
<a name="ln-6457"></a><span class="c">!!    &#39;color 3;clear;color 2; ortho2 -SIZE SIZE -SIZE SIZE                 &#39;,&amp;</span>
<a name="ln-6458"></a><span class="c">!!    &#39;set X=-0.75 Y=0.75                                                  &#39;,&amp;</span>
<a name="ln-6459"></a><span class="c">!!    &#39;# create an object to repeatedly draw                               &#39;,&amp;</span>
<a name="ln-6460"></a><span class="c">!!    &#39;makeobj 1                                                           &#39;,&amp;</span>
<a name="ln-6461"></a><span class="c">!!    &#39;polyfill .true.;color 1; rect 0 0 X Y                               &#39;,&amp;</span>
<a name="ln-6462"></a><span class="c">!!    &#39;polyfill .false.;linewidth 200;color 2 ;rect 0 0 X Y                &#39;,&amp;</span>
<a name="ln-6463"></a><span class="c">!!    &#39;closeobj                                                            &#39;,&amp;</span>
<a name="ln-6464"></a><span class="c">!!    &#39;# draw object, rotating coordinate system between instantiations   &#39; ,&amp;</span>
<a name="ln-6465"></a><span class="c">!!    &#39;pushmatrix                                                          &#39;,&amp;</span>
<a name="ln-6466"></a><span class="c">!!    &#39;scale 1.1 2.0                                                       &#39;,&amp;</span>
<a name="ln-6467"></a><span class="c">!!    &#39;callobj 1                                                           &#39;,&amp;</span>
<a name="ln-6468"></a><span class="c">!!    &#39;scale 0.5 0.5                                                       &#39;,&amp;</span>
<a name="ln-6469"></a><span class="c">!!    &#39;callobj 1                                                           &#39;,&amp;</span>
<a name="ln-6470"></a><span class="c">!!    &#39;circle 0 0 X/3                                                      &#39;,&amp;</span>
<a name="ln-6471"></a><span class="c">!!    &#39;popmatrix                                                           &#39;,&amp;</span>
<a name="ln-6472"></a><span class="c">!!    &#39;color 5;circle 0 0 X/3                                              &#39;,&amp;</span>
<a name="ln-6473"></a><span class="c">!!    &#39;getkey;vexit                                                        &#39;]</span>
<a name="ln-6474"></a><span class="c">!!    write(*,&#39;(a)&#39;)draw_cmds</span>
<a name="ln-6475"></a><span class="c">!!    call draw_interpret(draw_cmds,delimiters=&#39;;&#39;)</span>
<a name="ln-6476"></a><span class="c">!!    end program demo_scale</span>
<a name="ln-6477"></a><span class="c">!!</span>
<a name="ln-6478"></a><span class="c">!!##SEE ALSO</span>
<a name="ln-6479"></a><span class="c">!!     rotate, translate, pushmatrix, popmatrix</span>
<a name="ln-6480"></a><span class="c">!&gt;</span>
<a name="ln-6481"></a><span class="c">!!##NAME</span>
<a name="ln-6482"></a><span class="c">!!    rotate(3f) - [M_draw:TRANSFORMATION] Set up a rotation in axis axis where axis is one of &#39;x&#39;,&#39;y&#39;, or &#39;z&#39;.</span>
<a name="ln-6483"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6484"></a><span class="c">!!</span>
<a name="ln-6485"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6486"></a><span class="c">!!</span>
<a name="ln-6487"></a><span class="c">!!          subroutine rotate(angle, axis)</span>
<a name="ln-6488"></a><span class="c">!!          real angle</span>
<a name="ln-6489"></a><span class="c">!!          character axis</span>
<a name="ln-6490"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6491"></a><span class="c">!!</span>
<a name="ln-6492"></a><span class="c">!!    Set up a rotation of coordinate system along specified axis, relative</span>
<a name="ln-6493"></a><span class="c">!!    to current coordinate system.</span>
<a name="ln-6494"></a><span class="c">!!</span>
<a name="ln-6495"></a><span class="c">!!##OPTIONS</span>
<a name="ln-6496"></a><span class="c">!!    angle  Angle in degrees to rotate coordinate system, with clockwise</span>
<a name="ln-6497"></a><span class="c">!!           angles being positive.</span>
<a name="ln-6498"></a><span class="c">!!</span>
<a name="ln-6499"></a><span class="c">!!    axis   Which axis to perform rotation about. Allowed values are &#39;x&#39;,</span>
<a name="ln-6500"></a><span class="c">!!           &#39;y&#39;, and &#39;z&#39;.</span>
<a name="ln-6501"></a><span class="c">!!</span>
<a name="ln-6502"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6503"></a><span class="c">!!</span>
<a name="ln-6504"></a><span class="c">!!   Sample usage</span>
<a name="ln-6505"></a><span class="c">!!</span>
<a name="ln-6506"></a><span class="c">!!    program demo_rotate</span>
<a name="ln-6507"></a><span class="c">!!    use M_drawplus, only : draw_interpret</span>
<a name="ln-6508"></a><span class="c">!!    character(len=:),allocatable :: draw_cmds(:)</span>
<a name="ln-6509"></a><span class="c">!!    draw_cmds=[ character(len=128) ::                                      &amp;</span>
<a name="ln-6510"></a><span class="c">!!    &#39;# set up display                                                    &#39;,&amp;</span>
<a name="ln-6511"></a><span class="c">!!    &#39;prefsize 300 300;prefposition 200 10;vinit X11;                     &#39;,&amp;</span>
<a name="ln-6512"></a><span class="c">!!    &#39;set SIZE=1.2                                                        &#39;,&amp;</span>
<a name="ln-6513"></a><span class="c">!!    &#39;color 3;clear;color 2; ortho2 -SIZE SIZE -SIZE SIZE                 &#39;,&amp;</span>
<a name="ln-6514"></a><span class="c">!!    &#39;set X=-0.75 Y=0.75                                                  &#39;,&amp;</span>
<a name="ln-6515"></a><span class="c">!!    &#39;# create an object to repeatedly draw                               &#39;,&amp;</span>
<a name="ln-6516"></a><span class="c">!!    &#39;makeobj 1                                                           &#39;,&amp;</span>
<a name="ln-6517"></a><span class="c">!!    &#39;polyfill .true.;color 1; rect 0 0 X Y                               &#39;,&amp;</span>
<a name="ln-6518"></a><span class="c">!!    &#39;polyfill .false.;linewidth 200;color 2 ;rect 0 0 X Y                &#39;,&amp;</span>
<a name="ln-6519"></a><span class="c">!!    &#39;closeobj                                                            &#39;,&amp;</span>
<a name="ln-6520"></a><span class="c">!!    &#39;# draw object, rotating coordinate system between instantiations   &#39; ,&amp;</span>
<a name="ln-6521"></a><span class="c">!!    &#39;callobj 1                                                           &#39;,&amp;</span>
<a name="ln-6522"></a><span class="c">!!    &#39;rotate 45 z                                                         &#39;,&amp;</span>
<a name="ln-6523"></a><span class="c">!!    &#39;callobj 1                                                           &#39;,&amp;</span>
<a name="ln-6524"></a><span class="c">!!    &#39;rotate 45 z                                                         &#39;,&amp;</span>
<a name="ln-6525"></a><span class="c">!!    &#39;callobj 1                                                           &#39;,&amp;</span>
<a name="ln-6526"></a><span class="c">!!    &#39;circle 0 0 X/3                                                      &#39;,&amp;</span>
<a name="ln-6527"></a><span class="c">!!    &#39;getkey;vexit                                                        &#39;]</span>
<a name="ln-6528"></a><span class="c">!!    write(*,&#39;(a)&#39;)draw_cmds</span>
<a name="ln-6529"></a><span class="c">!!    call draw_interpret(draw_cmds,delimiters=&#39;;&#39;)</span>
<a name="ln-6530"></a><span class="c">!!    end program demo_rotate</span>
<a name="ln-6531"></a><span class="c">!!</span>
<a name="ln-6532"></a><span class="c">!!##SEE ALSO</span>
<a name="ln-6533"></a><span class="c">!!     translate, pushmatrix, popmatrix, scale</span>
<a name="ln-6534"></a><span class="c">!&gt;</span>
<a name="ln-6535"></a><span class="c">!!##NAME</span>
<a name="ln-6536"></a><span class="c">!!    patchbasis(3f) - [M_draw:PATCH] Define the t and u basis matrices of a patch.</span>
<a name="ln-6537"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6538"></a><span class="c">!!</span>
<a name="ln-6539"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6540"></a><span class="c">!!</span>
<a name="ln-6541"></a><span class="c">!!          subroutine patchbasis(tbasis, ubasis)</span>
<a name="ln-6542"></a><span class="c">!!          real :: tbasis(4,4), ubasis(4,4)</span>
<a name="ln-6543"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6544"></a><span class="c">!!</span>
<a name="ln-6545"></a><span class="c">!!    Define the t and u basis matrices of a patch.</span>
<a name="ln-6546"></a><span class="c">!&gt;</span>
<a name="ln-6547"></a><span class="c">!!##NAME</span>
<a name="ln-6548"></a><span class="c">!!    patchprecision(3f) - [M_draw:PATCH] Set minimum number of line segments making up curves in a patch.</span>
<a name="ln-6549"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6550"></a><span class="c">!!</span>
<a name="ln-6551"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6552"></a><span class="c">!!</span>
<a name="ln-6553"></a><span class="c">!!          subroutine patchprecision(tseg, useg)</span>
<a name="ln-6554"></a><span class="c">!!          integer,intent(in) :: tseg, useg</span>
<a name="ln-6555"></a><span class="c">!!</span>
<a name="ln-6556"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6557"></a><span class="c">!!    Set the minimum number of line segments making up curves in a patch.</span>
<a name="ln-6558"></a><span class="c">!&gt;</span>
<a name="ln-6559"></a><span class="c">!!##NAME</span>
<a name="ln-6560"></a><span class="c">!!    patchcurves(3f) - [M_draw:PATCH] Set the number of curves making up a patch.</span>
<a name="ln-6561"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6562"></a><span class="c">!!</span>
<a name="ln-6563"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6564"></a><span class="c">!!</span>
<a name="ln-6565"></a><span class="c">!!          subroutine patchcurves(nt, nu)</span>
<a name="ln-6566"></a><span class="c">!!          integer,intent(in) :: nt, nu</span>
<a name="ln-6567"></a><span class="c">!!</span>
<a name="ln-6568"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6569"></a><span class="c">!!</span>
<a name="ln-6570"></a><span class="c">!!    Set the number of curves making up a patch.</span>
<a name="ln-6571"></a><span class="c">!&gt;</span>
<a name="ln-6572"></a><span class="c">!!##NAME</span>
<a name="ln-6573"></a><span class="c">!!    rpatch(3f) - [M_draw:PATCH] Draws a rational patch in the current basis, according to the geometry matrices gx, gy, gz, and gw.</span>
<a name="ln-6574"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6575"></a><span class="c">!!</span>
<a name="ln-6576"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6577"></a><span class="c">!!</span>
<a name="ln-6578"></a><span class="c">!!          subroutine rpatch(gx, gy, gz, gw)</span>
<a name="ln-6579"></a><span class="c">!!          real,intent(in) :: gx(4,4), gy(4,4), gz(4,4), gw(4,4)</span>
<a name="ln-6580"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6581"></a><span class="c">!!</span>
<a name="ln-6582"></a><span class="c">!!    Draws a rational patch in the current basis, according to the geometry</span>
<a name="ln-6583"></a><span class="c">!!    matrices gx, gy, gz, and gw.</span>
<a name="ln-6584"></a><span class="c">!&gt;</span>
<a name="ln-6585"></a><span class="c">!!##NAME</span>
<a name="ln-6586"></a><span class="c">!!    patch(3f) - [M_draw:PATCH] Draws a patch in the current basis, according to the geometry matrices gx, gy, and gz.</span>
<a name="ln-6587"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6588"></a><span class="c">!!</span>
<a name="ln-6589"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6590"></a><span class="c">!!</span>
<a name="ln-6591"></a><span class="c">!!          subroutine patch(gx, gy, gz)</span>
<a name="ln-6592"></a><span class="c">!!          real,intent(in) :: gx(4,4), gy(4,4), gz(4,4)</span>
<a name="ln-6593"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6594"></a><span class="c">!!</span>
<a name="ln-6595"></a><span class="c">!!    Draws a patch in the current basis, according to the geometry matrices</span>
<a name="ln-6596"></a><span class="c">!!    gx, gy, and gz.</span>
<a name="ln-6597"></a><span class="c">!!</span>
<a name="ln-6598"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6599"></a><span class="c">!!</span>
<a name="ln-6600"></a><span class="c">!!   Sample program:</span>
<a name="ln-6601"></a><span class="c">!!</span>
<a name="ln-6602"></a><span class="c">!!    program demo_patch</span>
<a name="ln-6603"></a><span class="c">!!    !     Draws patches of various bases</span>
<a name="ln-6604"></a><span class="c">!!    !</span>
<a name="ln-6605"></a><span class="c">!!       use M_draw</span>
<a name="ln-6606"></a><span class="c">!!       implicit none</span>
<a name="ln-6607"></a><span class="c">!!    !</span>
<a name="ln-6608"></a><span class="c">!!       character(len=20) :: dev</span>
<a name="ln-6609"></a><span class="c">!!       integer           :: ios</span>
<a name="ln-6610"></a><span class="c">!!       integer           :: i</span>
<a name="ln-6611"></a><span class="c">!!       integer           :: idum</span>
<a name="ln-6612"></a><span class="c">!!    !</span>
<a name="ln-6613"></a><span class="c">!!    !  patch basis types</span>
<a name="ln-6614"></a><span class="c">!!    !</span>
<a name="ln-6615"></a><span class="c">!!       real bezier(4,4), cardinal(4, 4), bspline(4, 4)</span>
<a name="ln-6616"></a><span class="c">!!       real power(4, 4)</span>
<a name="ln-6617"></a><span class="c">!!       real x1(4, 4), y1(4, 4), z1(4, 4)</span>
<a name="ln-6618"></a><span class="c">!!       real x2(4, 4), y2(4, 4), z2(4, 4)</span>
<a name="ln-6619"></a><span class="c">!!      !</span>
<a name="ln-6620"></a><span class="c">!!       character(len=50) :: labels(4)</span>
<a name="ln-6621"></a><span class="c">!!      !</span>
<a name="ln-6622"></a><span class="c">!!       real    basis(64)</span>
<a name="ln-6623"></a><span class="c">!!       equivalence (basis(1), bezier(1, 1))</span>
<a name="ln-6624"></a><span class="c">!!       equivalence (basis(17), cardinal(1, 1))</span>
<a name="ln-6625"></a><span class="c">!!       equivalence (basis(33), bspline(1, 1))</span>
<a name="ln-6626"></a><span class="c">!!       equivalence (basis(49), power(1, 1))</span>
<a name="ln-6627"></a><span class="c">!!      !</span>
<a name="ln-6628"></a><span class="c">!!       data bezier/                                            &amp;</span>
<a name="ln-6629"></a><span class="c">!!       &amp;          -1.0,   3.0,    -3.0,   1.0,                 &amp;</span>
<a name="ln-6630"></a><span class="c">!!       &amp;          3.0,    -6.0,   3.0,    0.0,                 &amp;</span>
<a name="ln-6631"></a><span class="c">!!       &amp;          -3.0,   3.0,    0.0,    0.0,                 &amp;</span>
<a name="ln-6632"></a><span class="c">!!       &amp;          1.0,    0.0,    0.0,    0.0/</span>
<a name="ln-6633"></a><span class="c">!!      !</span>
<a name="ln-6634"></a><span class="c">!!       data cardinal/                                          &amp;</span>
<a name="ln-6635"></a><span class="c">!!       &amp;          -0.5,   1.5,    -1.5,   0.5,                 &amp;</span>
<a name="ln-6636"></a><span class="c">!!       &amp;          1.0,    -2.5,   2.0,    -0.5,                &amp;</span>
<a name="ln-6637"></a><span class="c">!!       &amp;          -0.5,   0.0,    0.5,    0.0,                 &amp;</span>
<a name="ln-6638"></a><span class="c">!!       &amp;          0.0,    1.0,    0.0,    0.0/</span>
<a name="ln-6639"></a><span class="c">!!      !</span>
<a name="ln-6640"></a><span class="c">!!       data bspline/                                           &amp;</span>
<a name="ln-6641"></a><span class="c">!!       &amp;          -0.166666,     0.5,     -0.5,     0.166666,  &amp;</span>
<a name="ln-6642"></a><span class="c">!!       &amp;           0.5,         -1.0,      0.5,     0.0,       &amp;</span>
<a name="ln-6643"></a><span class="c">!!       &amp;          -0.5,          0.0,      0.5,     0.0,       &amp;</span>
<a name="ln-6644"></a><span class="c">!!       &amp;           0.166666,     0.666666, 0.166666, 0.0 /</span>
<a name="ln-6645"></a><span class="c">!!      !</span>
<a name="ln-6646"></a><span class="c">!!       data power/                                             &amp;</span>
<a name="ln-6647"></a><span class="c">!!       &amp;          1.0, 0.0, 0.0, 0.0,                          &amp;</span>
<a name="ln-6648"></a><span class="c">!!       &amp;          0.0, 1.0, 0.0, 0.0,                          &amp;</span>
<a name="ln-6649"></a><span class="c">!!       &amp;          0.0, 0.0, 1.0, 0.0,                          &amp;</span>
<a name="ln-6650"></a><span class="c">!!       &amp;          0.0, 0.0, 0.0, 1.0/</span>
<a name="ln-6651"></a><span class="c">!!      !</span>
<a name="ln-6652"></a><span class="c">!!       data    x1 /                                            &amp;</span>
<a name="ln-6653"></a><span class="c">!!       &amp;          0.0,   0.2588,   0.5,   0.7071,              &amp;</span>
<a name="ln-6654"></a><span class="c">!!       &amp;          0.0,   0.51764,  1.0,   1.4142,              &amp;</span>
<a name="ln-6655"></a><span class="c">!!       &amp;          0.0,   0.51764,  1.0,   1.4142,              &amp;</span>
<a name="ln-6656"></a><span class="c">!!       &amp;          0.0,   0.2588,   0.5,   0.7071/</span>
<a name="ln-6657"></a><span class="c">!!      !</span>
<a name="ln-6658"></a><span class="c">!!       data    y1 /                                            &amp;</span>
<a name="ln-6659"></a><span class="c">!!       &amp;          1.0,   0.966,   0.866,  0.7071,              &amp;</span>
<a name="ln-6660"></a><span class="c">!!       &amp;          2.0,   1.9318,  1.732,  1.4142,              &amp;</span>
<a name="ln-6661"></a><span class="c">!!       &amp;          2.0,   1.9318,  1.732,  1.4142,              &amp;</span>
<a name="ln-6662"></a><span class="c">!!       &amp;          1.0,   0.966,   0.866,  0.7071/</span>
<a name="ln-6663"></a><span class="c">!!      !</span>
<a name="ln-6664"></a><span class="c">!!       data    z1 /                                            &amp;</span>
<a name="ln-6665"></a><span class="c">!!       &amp;          1.0,   1.0,     1.0,    1.0,                 &amp;</span>
<a name="ln-6666"></a><span class="c">!!       &amp;          1.0,   1.0,     1.0,    1.0,                 &amp;</span>
<a name="ln-6667"></a><span class="c">!!       &amp;          0.0,   0.0,     0.0,    0.0,                 &amp;</span>
<a name="ln-6668"></a><span class="c">!!       &amp;          0.0,   0.0,     0.0,    0.0/</span>
<a name="ln-6669"></a><span class="c">!!      !</span>
<a name="ln-6670"></a><span class="c">!!       data    x2 /                                            &amp;</span>
<a name="ln-6671"></a><span class="c">!!       &amp;          0.7071, 0.8660, 0.9660, 1.0,                 &amp;</span>
<a name="ln-6672"></a><span class="c">!!       &amp;          1.4142, 1.7320, 1.932,  2.0,                 &amp;</span>
<a name="ln-6673"></a><span class="c">!!       &amp;          1.4142, 1.7320, 1.932,  2.0,                 &amp;</span>
<a name="ln-6674"></a><span class="c">!!       &amp;          0.7071, 0.8660, 0.9660, 1.0/</span>
<a name="ln-6675"></a><span class="c">!!      !</span>
<a name="ln-6676"></a><span class="c">!!       data    y2 /                                            &amp;</span>
<a name="ln-6677"></a><span class="c">!!       &amp;          0.7071, 0.5,    0.2588, 0.0,                 &amp;</span>
<a name="ln-6678"></a><span class="c">!!       &amp;          1.4142, 1.0,    0.5176, 0.0,                 &amp;</span>
<a name="ln-6679"></a><span class="c">!!       &amp;          1.4142, 1.0,    0.5176, 0.0,                 &amp;</span>
<a name="ln-6680"></a><span class="c">!!       &amp;          0.7071, 0.5,    0.2588, 0.0/</span>
<a name="ln-6681"></a><span class="c">!!      !</span>
<a name="ln-6682"></a><span class="c">!!       data    z2 /                                            &amp;</span>
<a name="ln-6683"></a><span class="c">!!       &amp;          1.0,   1.0,     1.0,    1.0,                 &amp;</span>
<a name="ln-6684"></a><span class="c">!!       &amp;          1.0,   1.0,     1.0,    1.0,                 &amp;</span>
<a name="ln-6685"></a><span class="c">!!       &amp;          0.0,   0.0,     0.0,    0.0,                 &amp;</span>
<a name="ln-6686"></a><span class="c">!!       &amp;          0.0,   0.0,     0.0,    0.0/</span>
<a name="ln-6687"></a><span class="c">!!      !</span>
<a name="ln-6688"></a><span class="c">!!       data labels /                                           &amp;</span>
<a name="ln-6689"></a><span class="c">!!       &amp;          &#39;Bezier Patch(es)&#39;,                          &amp;</span>
<a name="ln-6690"></a><span class="c">!!       &amp;          &#39;Cardinal Patch(es)&#39;,                        &amp;</span>
<a name="ln-6691"></a><span class="c">!!       &amp;          &#39;B-Spline Patch(es)&#39;,                        &amp;</span>
<a name="ln-6692"></a><span class="c">!!       &amp;          &#39;&#39;&#39;Power&#39;&#39; Patch(es)&#39; /</span>
<a name="ln-6693"></a><span class="c">!!    !</span>
<a name="ln-6694"></a><span class="c">!!    !  demonstrate patches</span>
<a name="ln-6695"></a><span class="c">!!    !</span>
<a name="ln-6696"></a><span class="c">!!       write (*,*)&#39;Enter device:&#39;</span>
<a name="ln-6697"></a><span class="c">!!       read(*,&#39;(a)&#39;,iostat=ios) dev</span>
<a name="ln-6698"></a><span class="c">!!       if(ios.ne.0)dev=&#39; &#39;</span>
<a name="ln-6699"></a><span class="c">!!    !</span>
<a name="ln-6700"></a><span class="c">!!       call prefsize(1000,1000)</span>
<a name="ln-6701"></a><span class="c">!!       call vinit(dev)</span>
<a name="ln-6702"></a><span class="c">!!    !</span>
<a name="ln-6703"></a><span class="c">!!       call vsetflush(.true.)</span>
<a name="ln-6704"></a><span class="c">!!    !</span>
<a name="ln-6705"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-6706"></a><span class="c">!!       call clear()</span>
<a name="ln-6707"></a><span class="c">!!    !</span>
<a name="ln-6708"></a><span class="c">!!    ! Set up two viewports (They actually overlap)</span>
<a name="ln-6709"></a><span class="c">!!    !</span>
<a name="ln-6710"></a><span class="c">!!       call viewport(-1.0, 0.3, -1.0, 0.3)</span>
<a name="ln-6711"></a><span class="c">!!       call ortho(-2.0, 5.0, -2.0, 5.0, -2.0, 5.0)</span>
<a name="ln-6712"></a><span class="c">!!       call lookat(0.0, 0.0, 0.0, -3.0, 2.0, -4.0, 0.0)</span>
<a name="ln-6713"></a><span class="c">!!    !</span>
<a name="ln-6714"></a><span class="c">!!    !       Save it</span>
<a name="ln-6715"></a><span class="c">!!    !</span>
<a name="ln-6716"></a><span class="c">!!       call pushviewport()</span>
<a name="ln-6717"></a><span class="c">!!       call pushmatrix()</span>
<a name="ln-6718"></a><span class="c">!!    !</span>
<a name="ln-6719"></a><span class="c">!!       call viewport(-0.3, 1.0, -0.3, 1.0)</span>
<a name="ln-6720"></a><span class="c">!!       call ortho(-2.0, 5.0, -2.0, 5.0, -2.0, 5.0)</span>
<a name="ln-6721"></a><span class="c">!!       call lookat(0.0, 0.0, 0.0, 3.0, 2.0, -4.0, 0.0)</span>
<a name="ln-6722"></a><span class="c">!!    !</span>
<a name="ln-6723"></a><span class="c">!!       call textsize(0.4, 0.4)</span>
<a name="ln-6724"></a><span class="c">!!    !</span>
<a name="ln-6725"></a><span class="c">!!    !  patchcurves provides a number of curves in the t and u</span>
<a name="ln-6726"></a><span class="c">!!    !  directions. patchprecision gives the minimum number of line</span>
<a name="ln-6727"></a><span class="c">!!    !  segments making up the curves in the t and u directions. The</span>
<a name="ln-6728"></a><span class="c">!!    !  actual number of linesegments in t or u is equal to the closest</span>
<a name="ln-6729"></a><span class="c">!!    !  integer multiple of the number of curves, &gt; nsegs, in t or u,</span>
<a name="ln-6730"></a><span class="c">!!    !  greater than or equal to the number set by patchprecision in u or</span>
<a name="ln-6731"></a><span class="c">!!    !  t. eg. curves in t will be made up of 21 line segments so that we</span>
<a name="ln-6732"></a><span class="c">!!    !  can match up the 7 curves in u; curves in u will have 24 as 4 by 5</span>
<a name="ln-6733"></a><span class="c">!!    !  gives 20.</span>
<a name="ln-6734"></a><span class="c">!!    !</span>
<a name="ln-6735"></a><span class="c">!!       call patchcurves(4, 7)</span>
<a name="ln-6736"></a><span class="c">!!       call patchprecision(20, 20)</span>
<a name="ln-6737"></a><span class="c">!!    !</span>
<a name="ln-6738"></a><span class="c">!!       do 10 i = 0, 3</span>
<a name="ln-6739"></a><span class="c">!!    !</span>
<a name="ln-6740"></a><span class="c">!!          call axes()</span>
<a name="ln-6741"></a><span class="c">!!    !</span>
<a name="ln-6742"></a><span class="c">!!    !     patchbasis sets the basis matrices for the t and u</span>
<a name="ln-6743"></a><span class="c">!!    !     functions</span>
<a name="ln-6744"></a><span class="c">!!    !</span>
<a name="ln-6745"></a><span class="c">!!    !</span>
<a name="ln-6746"></a><span class="c">!!          call patchbasis(basis(i*16 + 1), basis(i*16 + 1))</span>
<a name="ln-6747"></a><span class="c">!!    !</span>
<a name="ln-6748"></a><span class="c">!!    !               Draw with viewport 2</span>
<a name="ln-6749"></a><span class="c">!!    !</span>
<a name="ln-6750"></a><span class="c">!!          call move(0.0, 4.0, 0.0)</span>
<a name="ln-6751"></a><span class="c">!!          call drawstr(labels(i+1))</span>
<a name="ln-6752"></a><span class="c">!!    !</span>
<a name="ln-6753"></a><span class="c">!!    !     Now draw the patches according to the geometry matrices in</span>
<a name="ln-6754"></a><span class="c">!!    !     x1, y1, and z1, x2, y2, z2.</span>
<a name="ln-6755"></a><span class="c">!!    !</span>
<a name="ln-6756"></a><span class="c">!!          call drawhull(x1, y1, z1)</span>
<a name="ln-6757"></a><span class="c">!!          call patch(x1, y1, z1)</span>
<a name="ln-6758"></a><span class="c">!!    !</span>
<a name="ln-6759"></a><span class="c">!!          call drawhull(x2, y2, z2)</span>
<a name="ln-6760"></a><span class="c">!!          call patch(x2, y2, z2)</span>
<a name="ln-6761"></a><span class="c">!!    !</span>
<a name="ln-6762"></a><span class="c">!!    !               Now with viewport 1</span>
<a name="ln-6763"></a><span class="c">!!    !</span>
<a name="ln-6764"></a><span class="c">!!          call popviewport()</span>
<a name="ln-6765"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-6766"></a><span class="c">!!    !</span>
<a name="ln-6767"></a><span class="c">!!          call axes()</span>
<a name="ln-6768"></a><span class="c">!!    !</span>
<a name="ln-6769"></a><span class="c">!!          call move(0.0, 4.0, 0.0)</span>
<a name="ln-6770"></a><span class="c">!!          call drawstr(labels(i + 1))</span>
<a name="ln-6771"></a><span class="c">!!    !</span>
<a name="ln-6772"></a><span class="c">!!    !     now draw the patches according to the geometry matrices in</span>
<a name="ln-6773"></a><span class="c">!!    !     x1, y1, and z1, x2, y2, z2.</span>
<a name="ln-6774"></a><span class="c">!!    !</span>
<a name="ln-6775"></a><span class="c">!!          call drawhull(x1, y1, z1)</span>
<a name="ln-6776"></a><span class="c">!!          call patch(x1, y1, z1)</span>
<a name="ln-6777"></a><span class="c">!!    !</span>
<a name="ln-6778"></a><span class="c">!!          call drawhull(x2, y2, z2)</span>
<a name="ln-6779"></a><span class="c">!!          call patch(x2, y2, z2)</span>
<a name="ln-6780"></a><span class="c">!!    !</span>
<a name="ln-6781"></a><span class="c">!!          idum=getkey()</span>
<a name="ln-6782"></a><span class="c">!!    !</span>
<a name="ln-6783"></a><span class="c">!!    !     Save viewport 1 again and reset to viewport 2</span>
<a name="ln-6784"></a><span class="c">!!    !</span>
<a name="ln-6785"></a><span class="c">!!          call pushviewport()</span>
<a name="ln-6786"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-6787"></a><span class="c">!!    !</span>
<a name="ln-6788"></a><span class="c">!!          call viewport(-0.3, 1.0, -0.3, 1.0)</span>
<a name="ln-6789"></a><span class="c">!!          call ortho(-1.5, 5.0, -1.5, 5.0, -1.5, 5.0)</span>
<a name="ln-6790"></a><span class="c">!!          call lookat(0.0, 0.0, 0.0, 3.0, 2.0, -4.0, 0.0)</span>
<a name="ln-6791"></a><span class="c">!!    !</span>
<a name="ln-6792"></a><span class="c">!!          call color(D_BLACK)</span>
<a name="ln-6793"></a><span class="c">!!          call clear()</span>
<a name="ln-6794"></a><span class="c">!!    10 continue</span>
<a name="ln-6795"></a><span class="c">!!    !</span>
<a name="ln-6796"></a><span class="c">!!       call vexit()</span>
<a name="ln-6797"></a><span class="c">!!    !</span>
<a name="ln-6798"></a><span class="c">!!    contains</span>
<a name="ln-6799"></a><span class="c">!!    !</span>
<a name="ln-6800"></a><span class="c">!!       subroutine drawhull(x, y, z)</span>
<a name="ln-6801"></a><span class="c">!!       implicit none</span>
<a name="ln-6802"></a><span class="c">!!    !</span>
<a name="ln-6803"></a><span class="c">!!       real    x(4,4), y(4,4), z(4,4)</span>
<a name="ln-6804"></a><span class="c">!!       integer :: i</span>
<a name="ln-6805"></a><span class="c">!!       integer :: j</span>
<a name="ln-6806"></a><span class="c">!!    !</span>
<a name="ln-6807"></a><span class="c">!!          call color(D_MAGENTA)</span>
<a name="ln-6808"></a><span class="c">!!          do i = 1,4</span>
<a name="ln-6809"></a><span class="c">!!             call move(x(i,1), y(i,1), z(i,1))</span>
<a name="ln-6810"></a><span class="c">!!             do j = 1,4</span>
<a name="ln-6811"></a><span class="c">!!                call draw(x(i,j), y(i,j), z(i,j))</span>
<a name="ln-6812"></a><span class="c">!!             enddo</span>
<a name="ln-6813"></a><span class="c">!!          enddo</span>
<a name="ln-6814"></a><span class="c">!!    !</span>
<a name="ln-6815"></a><span class="c">!!          do i = 1,4</span>
<a name="ln-6816"></a><span class="c">!!             call move(x(1,i), y(1,i), z(1,i))</span>
<a name="ln-6817"></a><span class="c">!!             do j = 1,4</span>
<a name="ln-6818"></a><span class="c">!!                call draw(x(j,i), y(j,i), z(j,i))</span>
<a name="ln-6819"></a><span class="c">!!             enddo</span>
<a name="ln-6820"></a><span class="c">!!          enddo</span>
<a name="ln-6821"></a><span class="c">!!    !</span>
<a name="ln-6822"></a><span class="c">!!          call color(D_GREEN)</span>
<a name="ln-6823"></a><span class="c">!!       end subroutine drawhull</span>
<a name="ln-6824"></a><span class="c">!!    !</span>
<a name="ln-6825"></a><span class="c">!!       subroutine axes()</span>
<a name="ln-6826"></a><span class="c">!!    !</span>
<a name="ln-6827"></a><span class="c">!!    !       draw the axes</span>
<a name="ln-6828"></a><span class="c">!!    !</span>
<a name="ln-6829"></a><span class="c">!!          call color(D_BLUE)</span>
<a name="ln-6830"></a><span class="c">!!          call move(0.0, 0.0, 0.0)</span>
<a name="ln-6831"></a><span class="c">!!          call draw(4.0, 0.0, 0.0)</span>
<a name="ln-6832"></a><span class="c">!!</span>
<a name="ln-6833"></a><span class="c">!!          call move(0.0, 0.0, 0.0)</span>
<a name="ln-6834"></a><span class="c">!!          call draw(0.0, 4.0, 0.0)</span>
<a name="ln-6835"></a><span class="c">!!</span>
<a name="ln-6836"></a><span class="c">!!          call move(0.0, 0.0, 0.0)</span>
<a name="ln-6837"></a><span class="c">!!          call draw(0.0, 0.0, 4.0)</span>
<a name="ln-6838"></a><span class="c">!!    !</span>
<a name="ln-6839"></a><span class="c">!!       end subroutine axes</span>
<a name="ln-6840"></a><span class="c">!!    !</span>
<a name="ln-6841"></a><span class="c">!!    end program demo_patch</span>
<a name="ln-6842"></a><span class="c">!&gt;</span>
<a name="ln-6843"></a><span class="c">!!##NAME</span>
<a name="ln-6844"></a><span class="c">!!    makeobj(3f) - [M_draw:OBJECT] Commence the object number n.</span>
<a name="ln-6845"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6846"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6847"></a><span class="c">!!</span>
<a name="ln-6848"></a><span class="c">!!         subroutine makeobj(n)</span>
<a name="ln-6849"></a><span class="c">!!         integer n</span>
<a name="ln-6850"></a><span class="c">!!</span>
<a name="ln-6851"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6852"></a><span class="c">!!    Commence the object number n.</span>
<a name="ln-6853"></a><span class="c">!&gt;</span>
<a name="ln-6854"></a><span class="c">!!##NAME</span>
<a name="ln-6855"></a><span class="c">!!    closeobj(3f) - [M_draw:OBJECT] Close the current object.</span>
<a name="ln-6856"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6857"></a><span class="c">!!</span>
<a name="ln-6858"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6859"></a><span class="c">!!</span>
<a name="ln-6860"></a><span class="c">!!         subroutine closeobj()</span>
<a name="ln-6861"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6862"></a><span class="c">!!</span>
<a name="ln-6863"></a><span class="c">!!    Close the current object.</span>
<a name="ln-6864"></a><span class="c">!&gt;</span>
<a name="ln-6865"></a><span class="c">!!##NAME</span>
<a name="ln-6866"></a><span class="c">!!    genobj(3f) - [M_draw:OBJECT] Returns a unique object identifier.</span>
<a name="ln-6867"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6868"></a><span class="c">!!</span>
<a name="ln-6869"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6870"></a><span class="c">!!</span>
<a name="ln-6871"></a><span class="c">!!         integer function genobj()</span>
<a name="ln-6872"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6873"></a><span class="c">!!    Returns a unique object identifier.</span>
<a name="ln-6874"></a><span class="c">!&gt;</span>
<a name="ln-6875"></a><span class="c">!!##NAME</span>
<a name="ln-6876"></a><span class="c">!!    getopenobj(3f) - [M_draw:OBJECT] Return the number of the current object.</span>
<a name="ln-6877"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6878"></a><span class="c">!!</span>
<a name="ln-6879"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6880"></a><span class="c">!!</span>
<a name="ln-6881"></a><span class="c">!!         integer function getopenobj()</span>
<a name="ln-6882"></a><span class="c">!!</span>
<a name="ln-6883"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6884"></a><span class="c">!!    Return the number of the current object.</span>
<a name="ln-6885"></a><span class="c">!&gt;</span>
<a name="ln-6886"></a><span class="c">!!##NAME</span>
<a name="ln-6887"></a><span class="c">!!    callobj(3f) - [M_draw:OBJECT] Draw object number n.</span>
<a name="ln-6888"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-6889"></a><span class="c">!!</span>
<a name="ln-6890"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-6891"></a><span class="c">!!</span>
<a name="ln-6892"></a><span class="c">!!         subroutine callobj(n)</span>
<a name="ln-6893"></a><span class="c">!!         integer n</span>
<a name="ln-6894"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-6895"></a><span class="c">!!    Draw object number n.</span>
<a name="ln-6896"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-6897"></a><span class="c">!!</span>
<a name="ln-6898"></a><span class="c">!!   Sample program:</span>
<a name="ln-6899"></a><span class="c">!!</span>
<a name="ln-6900"></a><span class="c">!!    program demo_callobj</span>
<a name="ln-6901"></a><span class="c">!!       use M_draw</span>
<a name="ln-6902"></a><span class="c">!!       implicit none</span>
<a name="ln-6903"></a><span class="c">!!       integer :: ipaws</span>
<a name="ln-6904"></a><span class="c">!!       integer :: ix, iy</span>
<a name="ln-6905"></a><span class="c">!!       real    :: x, y</span>
<a name="ln-6906"></a><span class="c">!!       integer :: icolor</span>
<a name="ln-6907"></a><span class="c">!!</span>
<a name="ln-6908"></a><span class="c">!!       ! set up graphics area</span>
<a name="ln-6909"></a><span class="c">!!       call prefsize(680,680)</span>
<a name="ln-6910"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-6911"></a><span class="c">!!       !! Background color</span>
<a name="ln-6912"></a><span class="c">!!       !call color(D_WHITE)</span>
<a name="ln-6913"></a><span class="c">!!       !! Page setup</span>
<a name="ln-6914"></a><span class="c">!!       !call page(0.0,2124.0,0.0,2124.0)</span>
<a name="ln-6915"></a><span class="c">!!       !call color(D_BLACK)</span>
<a name="ln-6916"></a><span class="c">!!</span>
<a name="ln-6917"></a><span class="c">!!       call makeobj(1111)</span>
<a name="ln-6918"></a><span class="c">!!       call circleprecision(300)</span>
<a name="ln-6919"></a><span class="c">!!       call curveprecision(300)</span>
<a name="ln-6920"></a><span class="c">!!</span>
<a name="ln-6921"></a><span class="c">!!       icolor=0</span>
<a name="ln-6922"></a><span class="c">!!       call mapcolor(icolor, 0, 0, 0); icolor=icolor+1</span>
<a name="ln-6923"></a><span class="c">!!       call mapcolor(icolor, 0, 0, 255); icolor=icolor+1</span>
<a name="ln-6924"></a><span class="c">!!       call mapcolor(icolor, 0, 255, 0); icolor=icolor+1</span>
<a name="ln-6925"></a><span class="c">!!       call mapcolor(icolor, 0, 255, 255); icolor=icolor+1</span>
<a name="ln-6926"></a><span class="c">!!       call mapcolor(icolor, 255, 0, 0); icolor=icolor+1</span>
<a name="ln-6927"></a><span class="c">!!       call mapcolor(icolor, 255, 0, 255); icolor=icolor+1</span>
<a name="ln-6928"></a><span class="c">!!       call mapcolor(icolor, 255, 255, 0); icolor=icolor+1</span>
<a name="ln-6929"></a><span class="c">!!       call mapcolor(icolor, 255, 255, 255); icolor=icolor+1</span>
<a name="ln-6930"></a><span class="c">!!       call mapcolor(icolor, 0, 0, 142); icolor=icolor+1</span>
<a name="ln-6931"></a><span class="c">!!       call mapcolor(icolor, 0, 0, 175); icolor=icolor+1</span>
<a name="ln-6932"></a><span class="c">!!       call mapcolor(icolor, 0, 0, 209); icolor=icolor+1</span>
<a name="ln-6933"></a><span class="c">!!       call mapcolor(icolor, 135, 206, 255); icolor=icolor+1</span>
<a name="ln-6934"></a><span class="c">!!       call mapcolor(icolor, 0, 142, 0); icolor=icolor+1</span>
<a name="ln-6935"></a><span class="c">!!       call mapcolor(icolor, 0, 175, 0); icolor=icolor+1</span>
<a name="ln-6936"></a><span class="c">!!       call mapcolor(icolor, 0, 209, 0); icolor=icolor+1</span>
<a name="ln-6937"></a><span class="c">!!       call mapcolor(icolor, 0, 142, 142); icolor=icolor+1</span>
<a name="ln-6938"></a><span class="c">!!       call mapcolor(icolor, 0, 175, 175); icolor=icolor+1</span>
<a name="ln-6939"></a><span class="c">!!       call mapcolor(icolor, 0, 209, 209); icolor=icolor+1</span>
<a name="ln-6940"></a><span class="c">!!       call mapcolor(icolor, 142, 0, 0); icolor=icolor+1</span>
<a name="ln-6941"></a><span class="c">!!       call mapcolor(icolor, 175, 0, 0); icolor=icolor+1</span>
<a name="ln-6942"></a><span class="c">!!       call mapcolor(icolor, 209, 0, 0); icolor=icolor+1</span>
<a name="ln-6943"></a><span class="c">!!       call mapcolor(icolor, 142, 0, 142); icolor=icolor+1</span>
<a name="ln-6944"></a><span class="c">!!       call mapcolor(icolor, 175, 0, 175); icolor=icolor+1</span>
<a name="ln-6945"></a><span class="c">!!       call mapcolor(icolor, 209, 0, 209); icolor=icolor+1</span>
<a name="ln-6946"></a><span class="c">!!       call mapcolor(icolor, 127, 48, 0); icolor=icolor+1</span>
<a name="ln-6947"></a><span class="c">!!       call mapcolor(icolor, 160, 63, 0); icolor=icolor+1</span>
<a name="ln-6948"></a><span class="c">!!       call mapcolor(icolor, 191, 96, 0); icolor=icolor+1</span>
<a name="ln-6949"></a><span class="c">!!       call mapcolor(icolor, 255, 127, 127); icolor=icolor+1</span>
<a name="ln-6950"></a><span class="c">!!       call mapcolor(icolor, 255, 160, 160); icolor=icolor+1</span>
<a name="ln-6951"></a><span class="c">!!       call mapcolor(icolor, 255, 191, 191); icolor=icolor+1</span>
<a name="ln-6952"></a><span class="c">!!       call mapcolor(icolor, 255, 224, 224); icolor=icolor+1</span>
<a name="ln-6953"></a><span class="c">!!       call mapcolor(icolor, 255, 214, 0); icolor=icolor+1</span>
<a name="ln-6954"></a><span class="c">!!       call mapcolor(icolor, 64, 64, 64); icolor=icolor+1</span>
<a name="ln-6955"></a><span class="c">!!       call mapcolor(icolor, 128, 128, 128); icolor=icolor+1</span>
<a name="ln-6956"></a><span class="c">!!       call mapcolor(icolor, 192, 192, 192); icolor=icolor+1</span>
<a name="ln-6957"></a><span class="c">!!       call mapcolor(icolor, 224, 224, 224); icolor=icolor+1</span>
<a name="ln-6958"></a><span class="c">!!       call mapcolor(icolor, 255, 255, 255); icolor=icolor+1</span>
<a name="ln-6959"></a><span class="c">!!</span>
<a name="ln-6960"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-6961"></a><span class="c">!!</span>
<a name="ln-6962"></a><span class="c">!!       ! Lower Pedestal Box</span>
<a name="ln-6963"></a><span class="c">!!       call color(34-1)</span>
<a name="ln-6964"></a><span class="c">!!       call rect(612.0, 537.0, 1512.0, 462.0)</span>
<a name="ln-6965"></a><span class="c">!!       call polyfill(.false.)</span>
<a name="ln-6966"></a><span class="c">!!       call rasters(5)</span>
<a name="ln-6967"></a><span class="c">!!       call color(37-1)</span>
<a name="ln-6968"></a><span class="c">!!       call rect(612.0, 537.0, 1512.0, 462.0)</span>
<a name="ln-6969"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-6970"></a><span class="c">!!       call rasters(1)</span>
<a name="ln-6971"></a><span class="c">!!       ! Keyboard Surface</span>
<a name="ln-6972"></a><span class="c">!!       call color(36-1)</span>
<a name="ln-6973"></a><span class="c">!!       call makepoly()</span>
<a name="ln-6974"></a><span class="c">!!       IX=237</span>
<a name="ln-6975"></a><span class="c">!!       IY=462</span>
<a name="ln-6976"></a><span class="c">!!       X=real(IX)</span>
<a name="ln-6977"></a><span class="c">!!       Y=real(IY)</span>
<a name="ln-6978"></a><span class="c">!!       call move2(X,Y)</span>
<a name="ln-6979"></a><span class="c">!!       call pline([IX,IY,1887,462,2112,87,2112,12,12,12,12,87,IX,IY])</span>
<a name="ln-6980"></a><span class="c">!!</span>
<a name="ln-6981"></a><span class="c">!!       call closepoly()</span>
<a name="ln-6982"></a><span class="c">!!       ! Upper Pedestal Box</span>
<a name="ln-6983"></a><span class="c">!!       call color(34-1)</span>
<a name="ln-6984"></a><span class="c">!!       call rect(687.0, 612.0, 1437.0, 537.0)</span>
<a name="ln-6985"></a><span class="c">!!       call polyfill(.false.)</span>
<a name="ln-6986"></a><span class="c">!!       call rasters(5)</span>
<a name="ln-6987"></a><span class="c">!!       call color(37-1)</span>
<a name="ln-6988"></a><span class="c">!!       call rect(687.0, 612.0, 1437.0, 537.0)</span>
<a name="ln-6989"></a><span class="c">!!       call polyfill(.true.)</span>
<a name="ln-6990"></a><span class="c">!!       call rasters(1)</span>
<a name="ln-6991"></a><span class="c">!!</span>
<a name="ln-6992"></a><span class="c">!!       ! Monitor Box</span>
<a name="ln-6993"></a><span class="c">!!       call color(36-1)</span>
<a name="ln-6994"></a><span class="c">!!       call rect(162.0, 2112.0, 1962.0, 612.0)</span>
<a name="ln-6995"></a><span class="c">!!</span>
<a name="ln-6996"></a><span class="c">!!       ! Main QWERTY area</span>
<a name="ln-6997"></a><span class="c">!!       !edgewidth(0)</span>
<a name="ln-6998"></a><span class="c">!!</span>
<a name="ln-6999"></a><span class="c">!!       call color(37-1)</span>
<a name="ln-7000"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7001"></a><span class="c">!!       call pline([312,387,162,162,1512,162,1437,387,312,387])</span>
<a name="ln-7002"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7003"></a><span class="c">!!</span>
<a name="ln-7004"></a><span class="c">!!       ! Numeric Keypad Area</span>
<a name="ln-7005"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7006"></a><span class="c">!!       call pline([1812,387,1512,387,1587,162,1962,162,1812,387])</span>
<a name="ln-7007"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7008"></a><span class="c">!!</span>
<a name="ln-7009"></a><span class="c">!!       ! Shade Keyboard Front</span>
<a name="ln-7010"></a><span class="c">!!       call color(35-1)</span>
<a name="ln-7011"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7012"></a><span class="c">!!       call pline([12,87,12,12,2112,12,2112,87])</span>
<a name="ln-7013"></a><span class="c">!!</span>
<a name="ln-7014"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7015"></a><span class="c">!!       ! U-Shaped Edge of Keyboard Front for definition</span>
<a name="ln-7016"></a><span class="c">!!       call rasters(5)</span>
<a name="ln-7017"></a><span class="c">!!       call color(1-1)</span>
<a name="ln-7018"></a><span class="c">!!       call pline([12,87,12,12,2112,12,2112,87])</span>
<a name="ln-7019"></a><span class="c">!!</span>
<a name="ln-7020"></a><span class="c">!!       ! Glass Tube/Viewing Panel</span>
<a name="ln-7021"></a><span class="c">!!       call color(33-1)</span>
<a name="ln-7022"></a><span class="c">!!       call rect(387.0, 1962.0, 1737.0, 762.0)</span>
<a name="ln-7023"></a><span class="c">!!       ! Upper Edge of Recess</span>
<a name="ln-7024"></a><span class="c">!!       call color(34-1)</span>
<a name="ln-7025"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7026"></a><span class="c">!!       call pline([ &amp;</span>
<a name="ln-7027"></a><span class="c">!!       &amp; 387,1887,388,1887,391,1887,396,1888,403,1888,413,1889,427,1890,443,1892,463,1893,484,1895, &amp;</span>
<a name="ln-7028"></a><span class="c">!!       &amp; 508,1896,535,1898,562,1900,592,1902,622,1904,654,1906,687,1907,722,1909,759,1911,797,1912, &amp;</span>
<a name="ln-7029"></a><span class="c">!!       &amp; 838,1913,881,1915,927,1916,975,1916,1025,1917,1077,1917,1133,1917,1187,1916,1238,1915,1285,1914, &amp;</span>
<a name="ln-7030"></a><span class="c">!!       &amp; 1330,1913,1371,1911,1410,1910,1446,1908,1481,1906,1514,1904,1545,1902,1575,1900,1603,1898,1629,1896, &amp;</span>
<a name="ln-7031"></a><span class="c">!!       &amp; 1653,1894,1674,1892,1692,1891,1707,1890,1719,1889,1727,1888,1733,1887,1736,1887,1737,1887,1738,1888, &amp;</span>
<a name="ln-7032"></a><span class="c">!!       &amp; 1741,1891,1748,1898,1760,1910,1775,1925,1789,1939,1801,1951,1808,1958,1811,1961,1812,1962,1810,1962, &amp;</span>
<a name="ln-7033"></a><span class="c">!!       &amp; 1807,1962,1800,1962,1789,1962,1773,1962,1752,1962,1725,1962,1692,1962,1653,1962,1607,1962,1555,1962, &amp;</span>
<a name="ln-7034"></a><span class="c">!!       &amp; 1498,1962,1434,1962,1366,1962,1294,1962,1218,1962,1141,1962,1062,1962,983,1962,906,1962,830,1962, &amp;</span>
<a name="ln-7035"></a><span class="c">!!       &amp; 758,1962,690,1962,626,1962,569,1962,517,1962,471,1962,432,1962,399,1962,372,1962,351,1962, &amp;</span>
<a name="ln-7036"></a><span class="c">!!       &amp; 335,1962,324,1962,317,1962,314,1962,312,1962,313,1961,316,1958,323,1951,335,1939,350,1924, &amp;</span>
<a name="ln-7037"></a><span class="c">!!       &amp; 364,1910,376,1898,383,1891,386,1888,387,1887])</span>
<a name="ln-7038"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7039"></a><span class="c">!!</span>
<a name="ln-7040"></a><span class="c">!!       ! Raised front of QWERTY area</span>
<a name="ln-7041"></a><span class="c">!!       call rect(162.0, 162.0, 1512.0, 135.0)</span>
<a name="ln-7042"></a><span class="c">!!</span>
<a name="ln-7043"></a><span class="c">!!       ! Left Control Keys in QWERTY</span>
<a name="ln-7044"></a><span class="c">!!       call color(35-1)</span>
<a name="ln-7045"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7046"></a><span class="c">!!       call pline([284,387,162,162,387,162,418,237,366,237,396,312,348,312,387,387,284,387])</span>
<a name="ln-7047"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7048"></a><span class="c">!!</span>
<a name="ln-7049"></a><span class="c">!!       ! Right Control Keys in QWERTY</span>
<a name="ln-7050"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7051"></a><span class="c">!!       call pline([1512,162,1287,162,1287,238,1336,237,1328,312,1362,312,1373,312,1358,387,1451,387,1512,162])</span>
<a name="ln-7052"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7053"></a><span class="c">!!</span>
<a name="ln-7054"></a><span class="c">!!       ! Numeric Keypad Special Keys -- Just Top?</span>
<a name="ln-7055"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7056"></a><span class="c">!!       call pline([1962,162,1893,162,1812,342,1526,342,1511,387,1843,387,1962,162])</span>
<a name="ln-7057"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7058"></a><span class="c">!!</span>
<a name="ln-7059"></a><span class="c">!!       ! Raised Front of Numeric Keypad</span>
<a name="ln-7060"></a><span class="c">!!       call color(34-1)</span>
<a name="ln-7061"></a><span class="c">!!       call rect(1587.0,162.0,1962.0,136.0)</span>
<a name="ln-7062"></a><span class="c">!!</span>
<a name="ln-7063"></a><span class="c">!!       ! Left Raised Edge of Numeric Keypad</span>
<a name="ln-7064"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7065"></a><span class="c">!!       call pline([1587,161,1586,134,1510,365,1511,386,1587,161])</span>
<a name="ln-7066"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7067"></a><span class="c">!!</span>
<a name="ln-7068"></a><span class="c">!!       ! Right Edge of Tube Recess</span>
<a name="ln-7069"></a><span class="c">!!       call color(35-1)</span>
<a name="ln-7070"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7071"></a><span class="c">!!       call pline([ &amp;</span>
<a name="ln-7072"></a><span class="c">!!       &amp; 1812,762,1811,763,1808,766,1801,773,1789,785, &amp;</span>
<a name="ln-7073"></a><span class="c">!!       &amp; 1774,800,1760,814,1748,826,1741,833,1738,836, &amp;</span>
<a name="ln-7074"></a><span class="c">!!       &amp; 1737,837,1737,839,1737,843,1737,851,1737,863, &amp;</span>
<a name="ln-7075"></a><span class="c">!!       &amp; 1737,881,1737,905,1737,934,1737,970,1737,1012, &amp;</span>
<a name="ln-7076"></a><span class="c">!!       &amp; 1737,1060,1737,1113,1737,1171,1737,1232,1737,1297, &amp;</span>
<a name="ln-7077"></a><span class="c">!!       &amp; 1737,1362,1737,1427,1737,1492,1737,1553,1737,1611, &amp;</span>
<a name="ln-7078"></a><span class="c">!!       &amp; 1737,1664,1737,1712,1737,1754,1737,1790,1737,1819, &amp;</span>
<a name="ln-7079"></a><span class="c">!!       &amp; 1737,1843,1737,1861,1737,1873,1737,1881,1737,1885, &amp;</span>
<a name="ln-7080"></a><span class="c">!!       &amp; 1737,1887,1738,1888,1741,1891,1748,1898,1760,1910, &amp;</span>
<a name="ln-7081"></a><span class="c">!!       &amp; 1775,1925,1789,1939,1801,1951,1808,1958,1811,1961, &amp;</span>
<a name="ln-7082"></a><span class="c">!!       &amp; 1812,1962,1812,1960,1812,1956,1812,1948,1812,1937, &amp;</span>
<a name="ln-7083"></a><span class="c">!!       &amp; 1812,1919,1812,1897,1812,1868,1812,1833,1812,1791, &amp;</span>
<a name="ln-7084"></a><span class="c">!!       &amp; 1812,1744,1812,1690,1812,1631,1812,1568,1812,1502, &amp;</span>
<a name="ln-7085"></a><span class="c">!!       &amp; 1812,1432,1812,1362,1812,1292,1812,1222,1812,1156, &amp;</span>
<a name="ln-7086"></a><span class="c">!!       &amp; 1812,1093,1812,1034,1812,980,1812,933,1812,891, &amp;</span>
<a name="ln-7087"></a><span class="c">!!       &amp; 1812,856,1812,827,1812,805,1812,787,1812,776, &amp;</span>
<a name="ln-7088"></a><span class="c">!!       &amp; 1812,768,1812,764,1812,762])</span>
<a name="ln-7089"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7090"></a><span class="c">!!</span>
<a name="ln-7091"></a><span class="c">!!       ! Left Edge of Tube Recess</span>
<a name="ln-7092"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7093"></a><span class="c">!!       call pline([ &amp;</span>
<a name="ln-7094"></a><span class="c">!!       &amp; 312,762,313,763,316,766,323,773,335,785, &amp;</span>
<a name="ln-7095"></a><span class="c">!!       &amp; 350,800,364,814,376,826,383,833,386,836, &amp;</span>
<a name="ln-7096"></a><span class="c">!!       &amp; 387,837,387,839,387,843,387,851,387,863, &amp;</span>
<a name="ln-7097"></a><span class="c">!!       &amp; 387,881,387,905,387,934,387,970,387,1012, &amp;</span>
<a name="ln-7098"></a><span class="c">!!       &amp; 387,1060,387,1113,387,1171,387,1232,387,1297, &amp;</span>
<a name="ln-7099"></a><span class="c">!!       &amp; 387,1362,387,1427,387,1492,387,1553,387,1611, &amp;</span>
<a name="ln-7100"></a><span class="c">!!       &amp; 387,1664,387,1712,387,1754,387,1790,387,1819, &amp;</span>
<a name="ln-7101"></a><span class="c">!!       &amp; 387,1843,387,1861,387,1873,387,1881,387,1885, &amp;</span>
<a name="ln-7102"></a><span class="c">!!       &amp; 387,1887,386,1888,383,1891,376,1898,364,1910, &amp;</span>
<a name="ln-7103"></a><span class="c">!!       &amp; 349,1925,335,1939,323,1951,316,1958,313,1961, &amp;</span>
<a name="ln-7104"></a><span class="c">!!       &amp; 312,1962,312,1960,312,1956,312,1948,312,1937, &amp;</span>
<a name="ln-7105"></a><span class="c">!!       &amp; 312,1919,312,1897,312,1868,312,1833,312,1791, &amp;</span>
<a name="ln-7106"></a><span class="c">!!       &amp; 312,1744,312,1690,312,1631,312,1568,312,1502, &amp;</span>
<a name="ln-7107"></a><span class="c">!!       &amp; 312,1432,312,1362,312,1292,312,1222,312,1156, &amp;</span>
<a name="ln-7108"></a><span class="c">!!       &amp; 312,1093,312,1034,312,980,312,933,312,891, &amp;</span>
<a name="ln-7109"></a><span class="c">!!       &amp; 312,856,312,827,312,805,312,787,312,776, &amp;</span>
<a name="ln-7110"></a><span class="c">!!       &amp; 312,768,312,764,312,762])</span>
<a name="ln-7111"></a><span class="c">!!</span>
<a name="ln-7112"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7113"></a><span class="c">!!</span>
<a name="ln-7114"></a><span class="c">!!       ! Bottom Edge of Tube Recess</span>
<a name="ln-7115"></a><span class="c">!!       call color(37-1)</span>
<a name="ln-7116"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7117"></a><span class="c">!!       call pline([ &amp;</span>
<a name="ln-7118"></a><span class="c">!!       &amp; 387,837,388,837,391,837,396,836,403,836,413,835,427,834,443,832,463,831,484,829, &amp;</span>
<a name="ln-7119"></a><span class="c">!!       &amp; 508,828,535,826,562,824,592,822,622,820,654,818,687,817,722,815,759,813,797,812, &amp;</span>
<a name="ln-7120"></a><span class="c">!!       &amp; 838,811,881,809,927,808,975,808,1025,807,1077,807,1133,807,1187,808,1238,809,1285,810, &amp;</span>
<a name="ln-7121"></a><span class="c">!!       &amp; 1330,811,1371,813,1410,814,1446,816,1481,818,1514,820,1545,822,1575,824,1603,826,1629,828, &amp;</span>
<a name="ln-7122"></a><span class="c">!!       &amp; 1653,830,1674,832,1692,833,1707,834,1719,835,1727,836,1733,837,1736,837,1737,837,1738,836, &amp;</span>
<a name="ln-7123"></a><span class="c">!!       &amp; 1741,833,1748,826,1760,814,1775,799,1789,785,1801,773,1808,766,1811,763,1812,762,1810,762, &amp;</span>
<a name="ln-7124"></a><span class="c">!!       &amp; 1807,762,1800,762,1789,762,1773,762,1752,762,1725,762,1692,762,1653,762,1607,762,1555,762, &amp;</span>
<a name="ln-7125"></a><span class="c">!!       &amp; 1498,762,1434,762,1366,762,1294,762,1218,762,1141,762,1062,762,983,762,906,762,830,762, &amp;</span>
<a name="ln-7126"></a><span class="c">!!       &amp; 758,762,690,762,626,762,569,762,517,762,471,762,432,762,399,762,372,762,351,762, &amp;</span>
<a name="ln-7127"></a><span class="c">!!       &amp; 335,762,324,762,317,762,314,762,312,762,313,763,316,766,323,773,335,785,350,800, &amp;</span>
<a name="ln-7128"></a><span class="c">!!       &amp; 364,814,376,826,383,833,386,836,387,837])</span>
<a name="ln-7129"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7130"></a><span class="c">!!</span>
<a name="ln-7131"></a><span class="c">!!       ! &lt; of X11</span>
<a name="ln-7132"></a><span class="c">!!       call color(8-1)</span>
<a name="ln-7133"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7134"></a><span class="c">!!       call pline([1034,1233,927,1233,743,1463,987,1769,1034,1769,819,1493,1034,1233])</span>
<a name="ln-7135"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7136"></a><span class="c">!!</span>
<a name="ln-7137"></a><span class="c">!!       call rasters(5)</span>
<a name="ln-7138"></a><span class="c">!!       call pline([1034,1233,927,1233,743,1463,987,1769,1034,1769,819,1493,1034,1233])</span>
<a name="ln-7139"></a><span class="c">!!       call rasters(1)</span>
<a name="ln-7140"></a><span class="c">!!</span>
<a name="ln-7141"></a><span class="c">!!       ! &gt; of X11</span>
<a name="ln-7142"></a><span class="c">!!       call color(8-1)</span>
<a name="ln-7143"></a><span class="c">!!       call makepoly()</span>
<a name="ln-7144"></a><span class="c">!!       call pline( [483,1769,591,1769,774,1540,530,1233,483,1233, 698,1509,483,1769])</span>
<a name="ln-7145"></a><span class="c">!!       call closepoly()</span>
<a name="ln-7146"></a><span class="c">!!</span>
<a name="ln-7147"></a><span class="c">!!       call rasters(5)</span>
<a name="ln-7148"></a><span class="c">!!       call pline( [483,1769,591,1769,774,1540,530,1233,483,1233,698,1509,483,1769])</span>
<a name="ln-7149"></a><span class="c">!!       call rasters(1)</span>
<a name="ln-7150"></a><span class="c">!!</span>
<a name="ln-7151"></a><span class="c">!!       ! End of Picture %</span>
<a name="ln-7152"></a><span class="c">!!</span>
<a name="ln-7153"></a><span class="c">!!       call closeobj()</span>
<a name="ln-7154"></a><span class="c">!!</span>
<a name="ln-7155"></a><span class="c">!!       call makeobj(2222)</span>
<a name="ln-7156"></a><span class="c">!!       call call_obj(1111,xt=-1012.0, yt=-1012.0)</span>
<a name="ln-7157"></a><span class="c">!!       call closeobj()</span>
<a name="ln-7158"></a><span class="c">!!</span>
<a name="ln-7159"></a><span class="c">!!       !!call call_obj(2222)</span>
<a name="ln-7160"></a><span class="c">!!</span>
<a name="ln-7161"></a><span class="c">!!       ! make a big page and call object with various transformations</span>
<a name="ln-7162"></a><span class="c">!!       call color(D_WHITE)</span>
<a name="ln-7163"></a><span class="c">!!       call page( 0.0, 20000.0, 0.0, 20000.0)</span>
<a name="ln-7164"></a><span class="c">!!       call clear()</span>
<a name="ln-7165"></a><span class="c">!!       call color(D_BLACK)</span>
<a name="ln-7166"></a><span class="c">!!</span>
<a name="ln-7167"></a><span class="c">!!       call call_obj(1111, xs=4.0, ys=4.0)</span>
<a name="ln-7168"></a><span class="c">!!       call call_obj(2222, xs=2.0, ys=2.0)</span>
<a name="ln-7169"></a><span class="c">!!       call call_obj(2222, xs=2.0, ys=2.0, xt=10000.0, yt=10000.0)</span>
<a name="ln-7170"></a><span class="c">!!       call call_obj(2222, xs=2.0, ys=2.0, xt=4000.0, yt=10000.0, zr=45.0)</span>
<a name="ln-7171"></a><span class="c">!!       call call_obj(2222, xs=2.0, ys=2.0, yt=3000.0, xt=12000.0)</span>
<a name="ln-7172"></a><span class="c">!!       call call_obj(2222, xs=1.4, ys=2.0, xt=13000.0, yt=16000.0, zr=180.0)</span>
<a name="ln-7173"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=16000.0, yt=16000.0, zr=0.0)</span>
<a name="ln-7174"></a><span class="c">!!       call call_obj(2222, xs=4.0, ys=2.0, xt=6000.0, yt=17000.0)</span>
<a name="ln-7175"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=16000.0, yt=4000.0, zr=0.0)</span>
<a name="ln-7176"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=18000.0, yt=5500.0, zr=-30.0)</span>
<a name="ln-7177"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=16000.0, yt=7000.0, zr=30.0)</span>
<a name="ln-7178"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=18000.0, yt=9500.0, zr=-50.0)</span>
<a name="ln-7179"></a><span class="c">!!       call call_obj(2222, xs=1.0, ys=1.0, xt=16000.0, yt=11000.0, zr=70.0)</span>
<a name="ln-7180"></a><span class="c">!!</span>
<a name="ln-7181"></a><span class="c">!!       ! this does not work as expected</span>
<a name="ln-7182"></a><span class="c">!!       !call call_obj(2222, xs=2.0,, ys=2.0,, xt=16000.0, yt=13000.0, xr=10.0, yr=10.0 )</span>
<a name="ln-7183"></a><span class="c">!!       !call call_obj(1111, xs=2.0,, ys=2.0,, xt=16000.0, yt=13000.0, xr=0.10, yr=0.10 )</span>
<a name="ln-7184"></a><span class="c">!!</span>
<a name="ln-7185"></a><span class="c">!!       ! pause</span>
<a name="ln-7186"></a><span class="c">!!       call vflush()</span>
<a name="ln-7187"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-7188"></a><span class="c">!!</span>
<a name="ln-7189"></a><span class="c">!!       ! wrap up graphics</span>
<a name="ln-7190"></a><span class="c">!!       call vexit()</span>
<a name="ln-7191"></a><span class="c">!!</span>
<a name="ln-7192"></a><span class="c">!!       contains</span>
<a name="ln-7193"></a><span class="c">!!       subroutine pline(iarr)</span>
<a name="ln-7194"></a><span class="c">!!          integer,intent(in) :: iarr(:)</span>
<a name="ln-7195"></a><span class="c">!!          integer            :: i</span>
<a name="ln-7196"></a><span class="c">!!          ! assuming nice data in x,y pairs</span>
<a name="ln-7197"></a><span class="c">!!          call move2(real(iarr(1)),real(iarr(2)))</span>
<a name="ln-7198"></a><span class="c">!!          do i=3,size(iarr),2</span>
<a name="ln-7199"></a><span class="c">!!             call draw2(real(iarr(i)),real(iarr(i+1)))</span>
<a name="ln-7200"></a><span class="c">!!          enddo</span>
<a name="ln-7201"></a><span class="c">!!       end subroutine pline</span>
<a name="ln-7202"></a><span class="c">!!</span>
<a name="ln-7203"></a><span class="c">!!       subroutine call_obj(iobj,xt,yt,zt,xs,ys,zs,xr,yr,zr)</span>
<a name="ln-7204"></a><span class="c">!!          ! DEFAULT call_obj(iobj,0.0,0.0,0.0, 1.0,1.0,1.0, 0.0,0.0.0.0)</span>
<a name="ln-7205"></a><span class="c">!!          integer,intent(in) :: iobj</span>
<a name="ln-7206"></a><span class="c">!!          real,optional :: xt,yt,zt</span>
<a name="ln-7207"></a><span class="c">!!          real,optional :: xs,ys,zs</span>
<a name="ln-7208"></a><span class="c">!!          real,optional :: xr,yr,zr</span>
<a name="ln-7209"></a><span class="c">!!          real          :: xt_l,yt_l,zt_l</span>
<a name="ln-7210"></a><span class="c">!!          real          :: xs_l,ys_l,zs_l</span>
<a name="ln-7211"></a><span class="c">!!          real          :: xr_l,yr_l,zr_l</span>
<a name="ln-7212"></a><span class="c">!!          if(present(xt))then; xt_l=xt; else; xt_l=0.0; endif</span>
<a name="ln-7213"></a><span class="c">!!          if(present(yt))then; yt_l=yt; else; yt_l=0.0; endif</span>
<a name="ln-7214"></a><span class="c">!!          if(present(zt))then; zt_l=zt; else; zt_l=0.0; endif</span>
<a name="ln-7215"></a><span class="c">!!</span>
<a name="ln-7216"></a><span class="c">!!          if(present(xs))then; xs_l=xs; else; xs_l=1.0; endif</span>
<a name="ln-7217"></a><span class="c">!!          if(present(ys))then; ys_l=ys; else; ys_l=1.0; endif</span>
<a name="ln-7218"></a><span class="c">!!          if(present(zs))then; zs_l=zs; else; zs_l=1.0; endif</span>
<a name="ln-7219"></a><span class="c">!!</span>
<a name="ln-7220"></a><span class="c">!!          if(present(xr))then; xr_l=xr; else; xr_l=0.0; endif</span>
<a name="ln-7221"></a><span class="c">!!          if(present(yr))then; yr_l=yr; else; yr_l=0.0; endif</span>
<a name="ln-7222"></a><span class="c">!!          if(present(zr))then; zr_l=zr; else; zr_l=0.0; endif</span>
<a name="ln-7223"></a><span class="c">!!</span>
<a name="ln-7224"></a><span class="c">!!          ! call an object using specified scaling, translation, and rotation</span>
<a name="ln-7225"></a><span class="c">!!          ! and then restore coordinate space</span>
<a name="ln-7226"></a><span class="c">!!          call pushmatrix()</span>
<a name="ln-7227"></a><span class="c">!!             call translate(xt_l,yt_l,zt_l)</span>
<a name="ln-7228"></a><span class="c">!!             call scale(xs_l,ys_l,zs_l)</span>
<a name="ln-7229"></a><span class="c">!!             call rotate(xr_l,&quot;x&quot;)</span>
<a name="ln-7230"></a><span class="c">!!             call rotate(yr_l,&quot;y&quot;)</span>
<a name="ln-7231"></a><span class="c">!!             call rotate(zr_l,&quot;z&quot;)</span>
<a name="ln-7232"></a><span class="c">!!             call callobj(iobj)</span>
<a name="ln-7233"></a><span class="c">!!          call popmatrix()</span>
<a name="ln-7234"></a><span class="c">!!       end subroutine call_obj</span>
<a name="ln-7235"></a><span class="c">!!</span>
<a name="ln-7236"></a><span class="c">!!       subroutine rasters(iwidth)</span>
<a name="ln-7237"></a><span class="c">!!          integer,intent(in) :: iwidth</span>
<a name="ln-7238"></a><span class="c">!!          call linewidth(iwidth*5)</span>
<a name="ln-7239"></a><span class="c">!!       end subroutine rasters</span>
<a name="ln-7240"></a><span class="c">!!    end program demo_callobj</span>
<a name="ln-7241"></a><span class="c">!&gt;</span>
<a name="ln-7242"></a><span class="c">!!##NAME</span>
<a name="ln-7243"></a><span class="c">!!    isobj(3f) - [M_draw:OBJECT] Returns .FALSE. if there is an object of number n.</span>
<a name="ln-7244"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7245"></a><span class="c">!!</span>
<a name="ln-7246"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7247"></a><span class="c">!!</span>
<a name="ln-7248"></a><span class="c">!!         logical function isobj(n)</span>
<a name="ln-7249"></a><span class="c">!!         integer :: n</span>
<a name="ln-7250"></a><span class="c">!!</span>
<a name="ln-7251"></a><span class="c">!!</span>
<a name="ln-7252"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7253"></a><span class="c">!!    Returns .FALSE. if there is an object of number n.</span>
<a name="ln-7254"></a><span class="c">!!</span>
<a name="ln-7255"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-7256"></a><span class="c">!!</span>
<a name="ln-7257"></a><span class="c">!!   Sample program:</span>
<a name="ln-7258"></a><span class="c">!!</span>
<a name="ln-7259"></a><span class="c">!!    program demo_isobj</span>
<a name="ln-7260"></a><span class="c">!!    use M_draw</span>
<a name="ln-7261"></a><span class="c">!!       call prefsize(300, 300)</span>
<a name="ln-7262"></a><span class="c">!!       call prefposition(100, 100)</span>
<a name="ln-7263"></a><span class="c">!!       call vinit(&#39; &#39;)   ! set up device</span>
<a name="ln-7264"></a><span class="c">!!       call ortho2(-5.0,5.0,-5.0,5.0)</span>
<a name="ln-7265"></a><span class="c">!!       call color(D_WHITE)  ! set current color</span>
<a name="ln-7266"></a><span class="c">!!       call clear()   ! clear screen to current color</span>
<a name="ln-7267"></a><span class="c">!!</span>
<a name="ln-7268"></a><span class="c">!!       call makeobj(3)  ! create a simple object</span>
<a name="ln-7269"></a><span class="c">!!          call polyfill(.true.)</span>
<a name="ln-7270"></a><span class="c">!!          call color(D_GREEN)</span>
<a name="ln-7271"></a><span class="c">!!          call circle(0.0,0.0,4.0)</span>
<a name="ln-7272"></a><span class="c">!!       call closeobj()</span>
<a name="ln-7273"></a><span class="c">!!</span>
<a name="ln-7274"></a><span class="c">!!       if(isobj(3))then</span>
<a name="ln-7275"></a><span class="c">!!          write(*,*)&#39; 3 is an object (CORRECT)&#39;</span>
<a name="ln-7276"></a><span class="c">!!          call callobj(3)</span>
<a name="ln-7277"></a><span class="c">!!       else</span>
<a name="ln-7278"></a><span class="c">!!          write(*,*)&#39; 3 is not an object (ERROR)&#39;</span>
<a name="ln-7279"></a><span class="c">!!       endif</span>
<a name="ln-7280"></a><span class="c">!!</span>
<a name="ln-7281"></a><span class="c">!!       if(isobj(4))then</span>
<a name="ln-7282"></a><span class="c">!!          write(*,*)&#39; 4 is an object (ERROR)&#39;</span>
<a name="ln-7283"></a><span class="c">!!       else</span>
<a name="ln-7284"></a><span class="c">!!          write(*,*)&#39; 4 is not an object (CORRECT)&#39;</span>
<a name="ln-7285"></a><span class="c">!!       endif</span>
<a name="ln-7286"></a><span class="c">!!</span>
<a name="ln-7287"></a><span class="c">!!       call callobj(4) ! note: calling a non-existent object is a no-op</span>
<a name="ln-7288"></a><span class="c">!!</span>
<a name="ln-7289"></a><span class="c">!!       idum=getkey()! wait for some input</span>
<a name="ln-7290"></a><span class="c">!!       call vexit()!  set the screen back to its original state</span>
<a name="ln-7291"></a><span class="c">!!</span>
<a name="ln-7292"></a><span class="c">!!    end program demo_isobj</span>
<a name="ln-7293"></a><span class="c">!!</span>
<a name="ln-7294"></a><span class="c">!!   Expected output:</span>
<a name="ln-7295"></a><span class="c">!!</span>
<a name="ln-7296"></a><span class="c">!!      3 is an object (CORRECT)</span>
<a name="ln-7297"></a><span class="c">!!      4 is not an object (CORRECT)</span>
<a name="ln-7298"></a><span class="c">!&gt;</span>
<a name="ln-7299"></a><span class="c">!!##NAME</span>
<a name="ln-7300"></a><span class="c">!!    delobj(3f) - [M_draw:OBJECT] Delete the object number n.</span>
<a name="ln-7301"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7302"></a><span class="c">!!</span>
<a name="ln-7303"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7304"></a><span class="c">!!</span>
<a name="ln-7305"></a><span class="c">!!         subroutine delobj(n)</span>
<a name="ln-7306"></a><span class="c">!!         integer n</span>
<a name="ln-7307"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7308"></a><span class="c">!!    Delete the object number n.</span>
<a name="ln-7309"></a><span class="c">!&gt;</span>
<a name="ln-7310"></a><span class="c">!!##NAME</span>
<a name="ln-7311"></a><span class="c">!!    loadobj(3f) - [M_draw:OBJECT] Load the object in the file filename as object number n.</span>
<a name="ln-7312"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7313"></a><span class="c">!!</span>
<a name="ln-7314"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7315"></a><span class="c">!!</span>
<a name="ln-7316"></a><span class="c">!!         subroutine loadobj(n, filename)</span>
<a name="ln-7317"></a><span class="c">!!         integer n</span>
<a name="ln-7318"></a><span class="c">!!         character*(*) filename</span>
<a name="ln-7319"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7320"></a><span class="c">!!    Load the object in the file &quot;filename&quot; as object number n.</span>
<a name="ln-7321"></a><span class="c">!!</span>
<a name="ln-7322"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-7323"></a><span class="c">!!</span>
<a name="ln-7324"></a><span class="c">!!   Sample program:</span>
<a name="ln-7325"></a><span class="c">!!</span>
<a name="ln-7326"></a><span class="c">!!    program demo_loadobj</span>
<a name="ln-7327"></a><span class="c">!!    ! test some object-related procedures</span>
<a name="ln-7328"></a><span class="c">!!    use M_draw</span>
<a name="ln-7329"></a><span class="c">!!    integer                      :: env_len</span>
<a name="ln-7330"></a><span class="c">!!    character(len=:),allocatable :: env</span>
<a name="ln-7331"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7332"></a><span class="c">!!       ! make an object file, which would normally be</span>
<a name="ln-7333"></a><span class="c">!!       ! made by a separate program</span>
<a name="ln-7334"></a><span class="c">!!       call voutput(&#39;+&#39;)</span>
<a name="ln-7335"></a><span class="c">!!       call vinit(&#39;nil&#39;)   ! set up device</span>
<a name="ln-7336"></a><span class="c">!!       call makeobj(3)</span>
<a name="ln-7337"></a><span class="c">!!          call polyfill(.true.)</span>
<a name="ln-7338"></a><span class="c">!!          call color(D_GREEN)</span>
<a name="ln-7339"></a><span class="c">!!          call circle(0.0,0.0,4.0)</span>
<a name="ln-7340"></a><span class="c">!!       call closeobj()</span>
<a name="ln-7341"></a><span class="c">!!       call saveobj(3,&quot;circle.obj&quot;)</span>
<a name="ln-7342"></a><span class="c">!!       call vexit()</span>
<a name="ln-7343"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7344"></a><span class="c">!!       ! CURRENTLY:</span>
<a name="ln-7345"></a><span class="c">!!       ! with multiple vinit(3f) calls the environment variable is</span>
<a name="ln-7346"></a><span class="c">!!       ! not used without explicitly using it</span>
<a name="ln-7347"></a><span class="c">!!       call get_environment_variable(&#39;M_DRAW_OUTPUT&#39;,LENGTH=env_len)</span>
<a name="ln-7348"></a><span class="c">!!       if(env_len.ne.0)then</span>
<a name="ln-7349"></a><span class="c">!!          allocate(character(len=env_len) :: env)</span>
<a name="ln-7350"></a><span class="c">!!          call get_environment_variable(&#39;M_DRAW_OUTPUT&#39;,env)</span>
<a name="ln-7351"></a><span class="c">!!          call voutput(env)</span>
<a name="ln-7352"></a><span class="c">!!       endif</span>
<a name="ln-7353"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7354"></a><span class="c">!!       call prefsize(300, 300)</span>
<a name="ln-7355"></a><span class="c">!!       call prefposition(100, 100)</span>
<a name="ln-7356"></a><span class="c">!!       call vinit(&#39; &#39;)   ! set up device</span>
<a name="ln-7357"></a><span class="c">!!       call ortho2(-5.1,5.3,-5.2,5.4)</span>
<a name="ln-7358"></a><span class="c">!!       call color(D_WHITE)  ! set current color</span>
<a name="ln-7359"></a><span class="c">!!       call clear()   ! clear screen to current color</span>
<a name="ln-7360"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-7361"></a><span class="c">!!       call move2(-5.0,-5.0)</span>
<a name="ln-7362"></a><span class="c">!!       call draw2(5.0,5.0)</span>
<a name="ln-7363"></a><span class="c">!!       call move2(-5.0,5.0)</span>
<a name="ln-7364"></a><span class="c">!!       call draw2(5.0,-5.0)</span>
<a name="ln-7365"></a><span class="c">!!       call loadobj(3,&quot;circle.obj&quot;)</span>
<a name="ln-7366"></a><span class="c">!!       call callobj(3)</span>
<a name="ln-7367"></a><span class="c">!!       call translate(1.0,0.0,0.0)</span>
<a name="ln-7368"></a><span class="c">!!       call translate(0.0,1.0,0.0)</span>
<a name="ln-7369"></a><span class="c">!!       idum=getkey() ! wait for some input</span>
<a name="ln-7370"></a><span class="c">!!       call vexit()  !  set the screen back to its original state</span>
<a name="ln-7371"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7372"></a><span class="c">!!    end program demo_loadobj</span>
<a name="ln-7373"></a><span class="c">!&gt;</span>
<a name="ln-7374"></a><span class="c">!!##NAME</span>
<a name="ln-7375"></a><span class="c">!!    saveobj(3f) - [M_draw:OBJECT] Save object number n into file filename. Does NOT save objects called inside object n.</span>
<a name="ln-7376"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7377"></a><span class="c">!!</span>
<a name="ln-7378"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7379"></a><span class="c">!!</span>
<a name="ln-7380"></a><span class="c">!!         subroutine saveobj(n, filename)</span>
<a name="ln-7381"></a><span class="c">!!         integer,intent(in) :: n</span>
<a name="ln-7382"></a><span class="c">!!         character(len=*),intent(in) :: filename</span>
<a name="ln-7383"></a><span class="c">!!</span>
<a name="ln-7384"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7385"></a><span class="c">!!    Save the object number n into the file filename. This call does not</span>
<a name="ln-7386"></a><span class="c">!!    save objects called inside object n.</span>
<a name="ln-7387"></a><span class="c">!!</span>
<a name="ln-7388"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-7389"></a><span class="c">!!</span>
<a name="ln-7390"></a><span class="c">!!   Sample program:</span>
<a name="ln-7391"></a><span class="c">!!</span>
<a name="ln-7392"></a><span class="c">!!    program demo_saveobj</span>
<a name="ln-7393"></a><span class="c">!!    ! create object in file &quot;circle.obj&quot; for use with loadobj(3f)</span>
<a name="ln-7394"></a><span class="c">!!    use M_draw</span>
<a name="ln-7395"></a><span class="c">!!    implicit none</span>
<a name="ln-7396"></a><span class="c">!!    character(len=:),allocatable :: env</span>
<a name="ln-7397"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-7398"></a><span class="c">!!    integer :: env_len</span>
<a name="ln-7399"></a><span class="c">!!       call voutput(&#39;+&#39;)            ! ignore $M_DRAW_OUTPUT</span>
<a name="ln-7400"></a><span class="c">!!       call vinit(&#39;nil&#39;)            ! start graphics</span>
<a name="ln-7401"></a><span class="c">!!       call push()</span>
<a name="ln-7402"></a><span class="c">!!       !</span>
<a name="ln-7403"></a><span class="c">!!       call makeobj(3)              ! create an object</span>
<a name="ln-7404"></a><span class="c">!!          call polyfill(.true.)</span>
<a name="ln-7405"></a><span class="c">!!          call color(D_GREEN)</span>
<a name="ln-7406"></a><span class="c">!!          call circle(0.0,0.0,10.0)</span>
<a name="ln-7407"></a><span class="c">!!          call polyfill(.false.)</span>
<a name="ln-7408"></a><span class="c">!!          call color(D_BLUE)</span>
<a name="ln-7409"></a><span class="c">!!          call linewidth(100)</span>
<a name="ln-7410"></a><span class="c">!!          call circle(0.0,0.0,4.0)</span>
<a name="ln-7411"></a><span class="c">!!       call closeobj()</span>
<a name="ln-7412"></a><span class="c">!!       !</span>
<a name="ln-7413"></a><span class="c">!!       call saveobj(3,&quot;circle.obj&quot;) ! save object to file</span>
<a name="ln-7414"></a><span class="c">!!       call pop()</span>
<a name="ln-7415"></a><span class="c">!!       call vexit()                 ! exit graphics</span>
<a name="ln-7416"></a><span class="c">!!       !</span>
<a name="ln-7417"></a><span class="c">!!       !-------  now this could be a separate program to use object</span>
<a name="ln-7418"></a><span class="c">!!       !</span>
<a name="ln-7419"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7420"></a><span class="c">!!       ! CURRENTLY:</span>
<a name="ln-7421"></a><span class="c">!!       ! with multiple vinit(3f) calls the environment variable is</span>
<a name="ln-7422"></a><span class="c">!!       ! not used without explicitly using it</span>
<a name="ln-7423"></a><span class="c">!!       call get_environment_variable(&#39;M_DRAW_OUTPUT&#39;,LENGTH=env_len)</span>
<a name="ln-7424"></a><span class="c">!!       if(env_len.ne.0)then</span>
<a name="ln-7425"></a><span class="c">!!          allocate(character(len=env_len) :: env)</span>
<a name="ln-7426"></a><span class="c">!!          call get_environment_variable(&#39;M_DRAW_OUTPUT&#39;,env)</span>
<a name="ln-7427"></a><span class="c">!!          call voutput(env)</span>
<a name="ln-7428"></a><span class="c">!!       endif</span>
<a name="ln-7429"></a><span class="c">!!       !------------------------------------------------------------</span>
<a name="ln-7430"></a><span class="c">!!       call vinit(&#39; &#39;)  ! set up device</span>
<a name="ln-7431"></a><span class="c">!!       call page(-100.0,100.0,-100.0,100.0)</span>
<a name="ln-7432"></a><span class="c">!!       call loadobj(100,&quot;circle.obj&quot;)</span>
<a name="ln-7433"></a><span class="c">!!       ! translate x,y,z scale x,y,z rotate x,y,z object</span>
<a name="ln-7434"></a><span class="c">!!       call invokeobj(   0.0,  0.0, 0.0,1.0,1.0,1.0,0.0,0.0,0.0, 100)</span>
<a name="ln-7435"></a><span class="c">!!       call invokeobj( -20.0,-20.0, 0.0,1.0,2.0,1.0,0.0,0.0,0.0, 100)</span>
<a name="ln-7436"></a><span class="c">!!       call invokeobj(  30.0, 40.0, 0.0,2.0,2.0,1.0,0.0,0.0,0.0, 100)</span>
<a name="ln-7437"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-7438"></a><span class="c">!!       call vexit() ! set the screen back to its original state</span>
<a name="ln-7439"></a><span class="c">!!       !</span>
<a name="ln-7440"></a><span class="c">!!    end program demo_saveobj</span>
<a name="ln-7441"></a><span class="c">!&gt;</span>
<a name="ln-7442"></a><span class="c">!!##NAME</span>
<a name="ln-7443"></a><span class="c">!!    backbuffer(3f) - [M_draw:DOUBLE_BUFFERING] Draw in the backbuffer. Returns -1 if the device is not up to it.</span>
<a name="ln-7444"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7445"></a><span class="c">!!</span>
<a name="ln-7446"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7447"></a><span class="c">!!</span>
<a name="ln-7448"></a><span class="c">!!          integer function backbuffer()</span>
<a name="ln-7449"></a><span class="c">!!</span>
<a name="ln-7450"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7451"></a><span class="c">!!    Make M_draw draw in the backbuffer. Returns -1 if the device is not up to it.</span>
<a name="ln-7452"></a><span class="c">!&gt;</span>
<a name="ln-7453"></a><span class="c">!!##NAME</span>
<a name="ln-7454"></a><span class="c">!!    frontbuffer(3f) - [M_draw:DOUBLE_BUFFERING] Draw in the front buffer. This will always work.</span>
<a name="ln-7455"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7456"></a><span class="c">!!</span>
<a name="ln-7457"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7458"></a><span class="c">!!</span>
<a name="ln-7459"></a><span class="c">!!          subroutine frontbuffer()</span>
<a name="ln-7460"></a><span class="c">!!</span>
<a name="ln-7461"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7462"></a><span class="c">!!</span>
<a name="ln-7463"></a><span class="c">!!    Make M_draw draw in the front buffer. This will always work.</span>
<a name="ln-7464"></a><span class="c">!&gt;</span>
<a name="ln-7465"></a><span class="c">!!##NAME</span>
<a name="ln-7466"></a><span class="c">!!    swapbuffers(3f) - [M_draw:DOUBLE_BUFFERING] Swap the front and back buffers.</span>
<a name="ln-7467"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7468"></a><span class="c">!!</span>
<a name="ln-7469"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7470"></a><span class="c">!!</span>
<a name="ln-7471"></a><span class="c">!!          subroutine swapbuffers()</span>
<a name="ln-7472"></a><span class="c">!!</span>
<a name="ln-7473"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7474"></a><span class="c">!!    Swap the front and back buffers.</span>
<a name="ln-7475"></a><span class="c">!&gt;</span>
<a name="ln-7476"></a><span class="c">!!##NAME</span>
<a name="ln-7477"></a><span class="c">!!    getgp(3f) - [M_draw:POSITION] Gets the current graphics position</span>
<a name="ln-7478"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7479"></a><span class="c">!!</span>
<a name="ln-7480"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7481"></a><span class="c">!!</span>
<a name="ln-7482"></a><span class="c">!!          subroutine getgp(x, y, z)</span>
<a name="ln-7483"></a><span class="c">!!          real x, y, z</span>
<a name="ln-7484"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7485"></a><span class="c">!!</span>
<a name="ln-7486"></a><span class="c">!!    Gets the current graphics position in world coords.</span>
<a name="ln-7487"></a><span class="c">!&gt;</span>
<a name="ln-7488"></a><span class="c">!!##NAME</span>
<a name="ln-7489"></a><span class="c">!!    getgpt(3f) - [M_draw:POSITION] Gets the current transformed graphics position in world coords.</span>
<a name="ln-7490"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7491"></a><span class="c">!!</span>
<a name="ln-7492"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7493"></a><span class="c">!!</span>
<a name="ln-7494"></a><span class="c">!!          subroutine getgpt(x, y, z, w)</span>
<a name="ln-7495"></a><span class="c">!!          real x, y, z, w</span>
<a name="ln-7496"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7497"></a><span class="c">!!</span>
<a name="ln-7498"></a><span class="c">!!    Gets the current transformed graphics position in world coords.</span>
<a name="ln-7499"></a><span class="c">!&gt;</span>
<a name="ln-7500"></a><span class="c">!!##NAME</span>
<a name="ln-7501"></a><span class="c">!!    getgp2(3f) - [M_draw:POSITION] Gets the current graphics position in world coordinates</span>
<a name="ln-7502"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7503"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7504"></a><span class="c">!!</span>
<a name="ln-7505"></a><span class="c">!!          subroutine getgp2(x, y)</span>
<a name="ln-7506"></a><span class="c">!!          real,intent(out) :: x,y</span>
<a name="ln-7507"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7508"></a><span class="c">!!</span>
<a name="ln-7509"></a><span class="c">!!    Gets the current graphics position in world coords.</span>
<a name="ln-7510"></a><span class="c">!!</span>
<a name="ln-7511"></a><span class="c">!!##RETURNS</span>
<a name="ln-7512"></a><span class="c">!!    X  X coordinate of current position</span>
<a name="ln-7513"></a><span class="c">!!    Y  Y coordinate of current position</span>
<a name="ln-7514"></a><span class="c">!!</span>
<a name="ln-7515"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-7516"></a><span class="c">!!</span>
<a name="ln-7517"></a><span class="c">!!   Sample program:</span>
<a name="ln-7518"></a><span class="c">!!</span>
<a name="ln-7519"></a><span class="c">!!      program demo_getgp2</span>
<a name="ln-7520"></a><span class="c">!!      use M_draw</span>
<a name="ln-7521"></a><span class="c">!!      implicit none</span>
<a name="ln-7522"></a><span class="c">!!      real :: X,Y</span>
<a name="ln-7523"></a><span class="c">!!      call prefsize(20,20)</span>
<a name="ln-7524"></a><span class="c">!!      call vinit(&#39; &#39;) ! start graphics using device $M_DRAW_DEVICE</span>
<a name="ln-7525"></a><span class="c">!!      call ortho2(-100.0,100.0,-100.0,100.0)</span>
<a name="ln-7526"></a><span class="c">!!      call move2(0.0,0.0)</span>
<a name="ln-7527"></a><span class="c">!!      call draw2(96.5,98.333)</span>
<a name="ln-7528"></a><span class="c">!!</span>
<a name="ln-7529"></a><span class="c">!!      call getgp2(X,Y)</span>
<a name="ln-7530"></a><span class="c">!!      write(*,*)&#39;CURRENT POSITION (X,Y)=&#39;,X,Y</span>
<a name="ln-7531"></a><span class="c">!!</span>
<a name="ln-7532"></a><span class="c">!!      call vexit()</span>
<a name="ln-7533"></a><span class="c">!!      end program demo_getgp2</span>
<a name="ln-7534"></a><span class="c">!!</span>
<a name="ln-7535"></a><span class="c">!!   Results</span>
<a name="ln-7536"></a><span class="c">!!</span>
<a name="ln-7537"></a><span class="c">!!    CURRENT POSITION (X,Y)=   96.5000000       98.3330002</span>
<a name="ln-7538"></a><span class="c">!&gt;</span>
<a name="ln-7539"></a><span class="c">!!##NAME</span>
<a name="ln-7540"></a><span class="c">!!    sgetgp2(3f) - [M_draw:POSITION] Gets the current screen graphics position in screen coords (-1 to 1)</span>
<a name="ln-7541"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7542"></a><span class="c">!!</span>
<a name="ln-7543"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-7544"></a><span class="c">!!</span>
<a name="ln-7545"></a><span class="c">!!          subroutine sgetgp2(x, y)</span>
<a name="ln-7546"></a><span class="c">!!          real x, y</span>
<a name="ln-7547"></a><span class="c">!!</span>
<a name="ln-7548"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7549"></a><span class="c">!!    Gets the current screen graphics position in screen coords (-1 to 1)</span>
<a name="ln-7550"></a><span class="c">!&gt;</span>
<a name="ln-7551"></a><span class="c">!!##NAME</span>
<a name="ln-7552"></a><span class="c">!!    example_text_justification(7) - [M_draw:EXAMPLE] example program showing text justification</span>
<a name="ln-7553"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-7554"></a><span class="c">!!</span>
<a name="ln-7555"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-7556"></a><span class="c">!!    Interactive example program to demonstrate text features such as</span>
<a name="ln-7557"></a><span class="c">!!    justification, size, angle, ...</span>
<a name="ln-7558"></a><span class="c">!!</span>
<a name="ln-7559"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-7560"></a><span class="c">!!</span>
<a name="ln-7561"></a><span class="c">!!   Sample program:</span>
<a name="ln-7562"></a><span class="c">!!</span>
<a name="ln-7563"></a><span class="c">!!    program demo_example_text_justification   !      demonstrate still more features of text</span>
<a name="ln-7564"></a><span class="c">!!    use M_draw</span>
<a name="ln-7565"></a><span class="c">!!    character(len=20) :: dev</span>
<a name="ln-7566"></a><span class="c">!!    integer           :: ios</span>
<a name="ln-7567"></a><span class="c">!!</span>
<a name="ln-7568"></a><span class="c">!!    write(*,&#39;(a)&#39;,advance=&#39;no&#39;)&#39;Enter device: &#39;</span>
<a name="ln-7569"></a><span class="c">!!    read(*, &#39;(a)&#39;,iostat=ios) dev</span>
<a name="ln-7570"></a><span class="c">!!    if(ios.ne.0)dev=&#39; &#39;</span>
<a name="ln-7571"></a><span class="c">!!    call vinit(dev)</span>
<a name="ln-7572"></a><span class="c">!!    call textsize(0.03, 0.04)</span>
<a name="ln-7573"></a><span class="c">!!    call ortho2(0.0, 1.0, 0.0, 1.0)</span>
<a name="ln-7574"></a><span class="c">!!    call color(D_RED)</span>
<a name="ln-7575"></a><span class="c">!!    call clear()</span>
<a name="ln-7576"></a><span class="c">!!</span>
<a name="ln-7577"></a><span class="c">!!    call drawstuff()</span>
<a name="ln-7578"></a><span class="c">!!    !       Now do it all with the text rotated ....</span>
<a name="ln-7579"></a><span class="c">!!    call textang(45.0); call drawstuff()</span>
<a name="ln-7580"></a><span class="c">!!    call textang(160.0); call drawstuff()</span>
<a name="ln-7581"></a><span class="c">!!    call textang(270.0); call drawstuff()</span>
<a name="ln-7582"></a><span class="c">!!    !       Now with a single character</span>
<a name="ln-7583"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7584"></a><span class="c">!!</span>
<a name="ln-7585"></a><span class="c">!!    call drawstuff2(0.0)</span>
<a name="ln-7586"></a><span class="c">!!    call drawstuff2(90.0)</span>
<a name="ln-7587"></a><span class="c">!!    call drawstuff2(160.0)</span>
<a name="ln-7588"></a><span class="c">!!    call drawstuff2(270.0)</span>
<a name="ln-7589"></a><span class="c">!!</span>
<a name="ln-7590"></a><span class="c">!!    do</span>
<a name="ln-7591"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-7592"></a><span class="c">!!       select case(idum)</span>
<a name="ln-7593"></a><span class="c">!!       case(:-1)                  ; exit</span>
<a name="ln-7594"></a><span class="c">!!       case(ichar(&#39;q&#39;),ichar(&#39;Q&#39;)); exit</span>
<a name="ln-7595"></a><span class="c">!!       end select</span>
<a name="ln-7596"></a><span class="c">!!    enddo</span>
<a name="ln-7597"></a><span class="c">!!    call vexit()</span>
<a name="ln-7598"></a><span class="c">!!    contains</span>
<a name="ln-7599"></a><span class="c">!!</span>
<a name="ln-7600"></a><span class="c">!!    subroutine drawstuff</span>
<a name="ln-7601"></a><span class="c">!!    use M_draw</span>
<a name="ln-7602"></a><span class="c">!!</span>
<a name="ln-7603"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7604"></a><span class="c">!!    !call polyfill(1)</span>
<a name="ln-7605"></a><span class="c">!!    call polyfill(.true.)</span>
<a name="ln-7606"></a><span class="c">!!    !               So rect clears a bit for us</span>
<a name="ln-7607"></a><span class="c">!!</span>
<a name="ln-7608"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7609"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7610"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7611"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7612"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7613"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7614"></a><span class="c">!!</span>
<a name="ln-7615"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-7616"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7617"></a><span class="c">!!    call leftjustify()</span>
<a name="ln-7618"></a><span class="c">!!    call drawstr(&#39;This is Left Justified text&#39;)</span>
<a name="ln-7619"></a><span class="c">!!</span>
<a name="ln-7620"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7621"></a><span class="c">!!</span>
<a name="ln-7622"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7623"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7624"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7625"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7626"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7627"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7628"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7629"></a><span class="c">!!</span>
<a name="ln-7630"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-7631"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7632"></a><span class="c">!!    call centertext(.true.)</span>
<a name="ln-7633"></a><span class="c">!!    call drawstr(&#39;This is Centered text&#39;)</span>
<a name="ln-7634"></a><span class="c">!!    call centertext(.false.)</span>
<a name="ln-7635"></a><span class="c">!!</span>
<a name="ln-7636"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7637"></a><span class="c">!!</span>
<a name="ln-7638"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7639"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7640"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7641"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7642"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7643"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7644"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7645"></a><span class="c">!!</span>
<a name="ln-7646"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-7647"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7648"></a><span class="c">!!    call rightjustify()</span>
<a name="ln-7649"></a><span class="c">!!    call drawstr(&#39;This is Right Justified text&#39;)</span>
<a name="ln-7650"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7651"></a><span class="c">!!</span>
<a name="ln-7652"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7653"></a><span class="c">!!    end subroutine drawstuff</span>
<a name="ln-7654"></a><span class="c">!!</span>
<a name="ln-7655"></a><span class="c">!!    subroutine drawstuff2(ang)</span>
<a name="ln-7656"></a><span class="c">!!    use M_draw</span>
<a name="ln-7657"></a><span class="c">!!</span>
<a name="ln-7658"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7659"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7660"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7661"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7662"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7663"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7664"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7665"></a><span class="c">!!</span>
<a name="ln-7666"></a><span class="c">!!</span>
<a name="ln-7667"></a><span class="c">!!    call textang(ang)</span>
<a name="ln-7668"></a><span class="c">!!    call color(D_GREEN)</span>
<a name="ln-7669"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7670"></a><span class="c">!!    call leftjustify()</span>
<a name="ln-7671"></a><span class="c">!!    call drawchar(&#39;B&#39;)</span>
<a name="ln-7672"></a><span class="c">!!</span>
<a name="ln-7673"></a><span class="c">!!    call textang(0.0)</span>
<a name="ln-7674"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7675"></a><span class="c">!!    call boxtext(0.1, 0.1, 0.4, 0.02, &#39;The &#39;&#39;B&#39;&#39; should be leftjustified&#39;)</span>
<a name="ln-7676"></a><span class="c">!!    call pushattributes()</span>
<a name="ln-7677"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7678"></a><span class="c">!!</span>
<a name="ln-7679"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7680"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7681"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7682"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7683"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7684"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7685"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7686"></a><span class="c">!!</span>
<a name="ln-7687"></a><span class="c">!!    call textang(ang)</span>
<a name="ln-7688"></a><span class="c">!!    call color(D_YELLOW)</span>
<a name="ln-7689"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7690"></a><span class="c">!!    call centertext(.true.)</span>
<a name="ln-7691"></a><span class="c">!!    call drawchar(&#39;B&#39;)</span>
<a name="ln-7692"></a><span class="c">!!    call centertext(.false.)</span>
<a name="ln-7693"></a><span class="c">!!    call textang(0.0)</span>
<a name="ln-7694"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7695"></a><span class="c">!!    call boxtext(0.1, 0.1, 0.4, 0.02, &#39;The &#39;&#39;B&#39;&#39; should be centered&#39;)</span>
<a name="ln-7696"></a><span class="c">!!    call pushattributes()</span>
<a name="ln-7697"></a><span class="c">!!</span>
<a name="ln-7698"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7699"></a><span class="c">!!</span>
<a name="ln-7700"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7701"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7702"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7703"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7704"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7705"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7706"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7707"></a><span class="c">!!</span>
<a name="ln-7708"></a><span class="c">!!    call textang(ang)</span>
<a name="ln-7709"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-7710"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7711"></a><span class="c">!!    call rightjustify()</span>
<a name="ln-7712"></a><span class="c">!!    call drawchar(&#39;B&#39;)</span>
<a name="ln-7713"></a><span class="c">!!    call textang(0.0)</span>
<a name="ln-7714"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7715"></a><span class="c">!!    call boxtext(0.1, 0.1, 0.4, 0.02, &#39;The &#39;&#39;B&#39;&#39; should be rightjustified&#39;)</span>
<a name="ln-7716"></a><span class="c">!!    call pushattributes()</span>
<a name="ln-7717"></a><span class="c">!!</span>
<a name="ln-7718"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7719"></a><span class="c">!!</span>
<a name="ln-7720"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7721"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7722"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7723"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7724"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7725"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7726"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7727"></a><span class="c">!!</span>
<a name="ln-7728"></a><span class="c">!!    call textang(ang)</span>
<a name="ln-7729"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-7730"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7731"></a><span class="c">!!    call topjustify()</span>
<a name="ln-7732"></a><span class="c">!!    call drawchar(&#39;B&#39;)</span>
<a name="ln-7733"></a><span class="c">!!    call textang(0.0)</span>
<a name="ln-7734"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7735"></a><span class="c">!!    call boxtext(0.1, 0.1, 0.4, 0.02, &#39;The &#39;&#39;B&#39;&#39; should be topjustified&#39;)</span>
<a name="ln-7736"></a><span class="c">!!    call pushattributes()</span>
<a name="ln-7737"></a><span class="c">!!</span>
<a name="ln-7738"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7739"></a><span class="c">!!</span>
<a name="ln-7740"></a><span class="c">!!    call color(D_BLACK)</span>
<a name="ln-7741"></a><span class="c">!!    call rect(0.1, 0.1, 0.9, 0.9)</span>
<a name="ln-7742"></a><span class="c">!!    call color(D_WHITE)</span>
<a name="ln-7743"></a><span class="c">!!    call move2(0.1, 0.5)</span>
<a name="ln-7744"></a><span class="c">!!    call draw2(0.9, 0.5)</span>
<a name="ln-7745"></a><span class="c">!!    call move2(0.5, 0.1)</span>
<a name="ln-7746"></a><span class="c">!!    call draw2(0.5, 0.9)</span>
<a name="ln-7747"></a><span class="c">!!</span>
<a name="ln-7748"></a><span class="c">!!    call textang(ang)</span>
<a name="ln-7749"></a><span class="c">!!    call color(D_MAGENTA)</span>
<a name="ln-7750"></a><span class="c">!!    call move2(0.5, 0.5)</span>
<a name="ln-7751"></a><span class="c">!!    call topjustify()</span>
<a name="ln-7752"></a><span class="c">!!    call rightjustify()</span>
<a name="ln-7753"></a><span class="c">!!    call drawchar(&#39;B&#39;)</span>
<a name="ln-7754"></a><span class="c">!!    call textang(0.0)</span>
<a name="ln-7755"></a><span class="c">!!    call textjustify(achar(0))</span>
<a name="ln-7756"></a><span class="c">!!    call boxtext(0.1, 0.1, 0.4, 0.02, &#39;The &#39;&#39;B&#39;&#39; should be right/topjustified&#39;)</span>
<a name="ln-7757"></a><span class="c">!!</span>
<a name="ln-7758"></a><span class="c">!!    idum=getkey()</span>
<a name="ln-7759"></a><span class="c">!!</span>
<a name="ln-7760"></a><span class="c">!!    end subroutine drawstuff2</span>
<a name="ln-7761"></a><span class="c">!!</span>
<a name="ln-7762"></a><span class="c">!!    end program demo_example_text_justification</span>
<a name="ln-7763"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-7764"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-7765"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-7766"></a><span class="k">module </span><span class="n">M_draw</span>
<a name="ln-7767"></a><span class="c">!</span>
<a name="ln-7768"></a><span class="c">! hide logicals from C</span>
<a name="ln-7769"></a><span class="c">! trim and append null to intent(in) character strings</span>
<a name="ln-7770"></a><span class="c">! logical to _Bool mapping not consistent across compilers, g95 does not even define KIND=C_BOOL; so make NAME_F routines</span>
<a name="ln-7771"></a><span class="c">!</span>
<a name="ln-7772"></a><span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-7773"></a><span class="k">implicit none</span>
<a name="ln-7774"></a>
<a name="ln-7775"></a><span class="c">! ident_1=&quot;@(#)M_draw::M_draw(3fm):: The M_draw graphics library module&quot;</span>
<a name="ln-7776"></a>
<a name="ln-7777"></a><span class="k">private</span>
<a name="ln-7778"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7779"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_XCENTERED</span><span class="o">=</span>     <span class="mi">1_C_SHORT</span>
<a name="ln-7780"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_YCENTERED</span><span class="o">=</span>     <span class="mi">2_C_SHORT</span>
<a name="ln-7781"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_LEFT</span><span class="o">=</span>          <span class="mi">4_C_SHORT</span>  <span class="c">! The default</span>
<a name="ln-7782"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_RIGHT</span><span class="o">=</span>         <span class="mi">8_C_SHORT</span>
<a name="ln-7783"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_TOP</span><span class="o">=</span>          <span class="mi">16_C_SHORT</span>
<a name="ln-7784"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_BOTTOM</span><span class="o">=</span>       <span class="mi">32_C_SHORT</span> <span class="c">! The default</span>
<a name="ln-7785"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7786"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_NORMAL</span><span class="o">=</span>        <span class="mi">0_C_SHORT</span> <span class="c">! The default</span>
<a name="ln-7787"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_BOLD</span><span class="o">=</span>          <span class="mi">1_C_SHORT</span>
<a name="ln-7788"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7789"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_THICK</span><span class="o">=</span>         <span class="mi">1_C_SHORT</span>
<a name="ln-7790"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_short</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">D_THIN</span><span class="o">=</span>          <span class="mi">0_C_SHORT</span> <span class="c">! The default</span>
<a name="ln-7791"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7792"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_BLACK</span>    <span class="o">=</span>  <span class="mi">0_C_INT</span>
<a name="ln-7793"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_RED</span>      <span class="o">=</span>  <span class="mi">1_C_INT</span>
<a name="ln-7794"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_GREEN</span>    <span class="o">=</span>  <span class="mi">2_C_INT</span>
<a name="ln-7795"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_YELLOW</span>   <span class="o">=</span>  <span class="mi">3_C_INT</span>
<a name="ln-7796"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_BLUE</span>     <span class="o">=</span>  <span class="mi">4_C_INT</span>
<a name="ln-7797"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_MAGENTA</span>  <span class="o">=</span>  <span class="mi">5_C_INT</span>
<a name="ln-7798"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_CYAN</span>     <span class="o">=</span>  <span class="mi">6_C_INT</span>
<a name="ln-7799"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">c_int</span><span class="p">),</span><span class="k">public</span><span class="p">,</span><span class="k">parameter</span>   <span class="kd">::</span> <span class="n">D_WHITE</span>    <span class="o">=</span>  <span class="mi">7_C_INT</span>
<a name="ln-7800"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7801"></a><span class="k">public </span><span class="n">MATRIX</span>
<a name="ln-7802"></a><span class="k">type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-7803"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-7804"></a><span class="k">end type </span><span class="n">MATRIX</span>
<a name="ln-7805"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7806"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">arc</span>
<a name="ln-7807"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">arcprecision</span>
<a name="ln-7808"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">backbuffer</span>
<a name="ln-7809"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">backface</span>
<a name="ln-7810"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">backfacedir</span>
<a name="ln-7811"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">bottomjustify</span>
<a name="ln-7812"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">boxfit</span>
<a name="ln-7813"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">boxtext</span>
<a name="ln-7814"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">CalcW2Vcoeffs</span>
<a name="ln-7815"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">callobj</span>
<a name="ln-7816"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">centertext</span>
<a name="ln-7817"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">checkkey</span>
<a name="ln-7818"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">circle</span>
<a name="ln-7819"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">circleprecision</span>
<a name="ln-7820"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">clear</span>
<a name="ln-7821"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">clipping</span>
<a name="ln-7822"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">closeobj</span>
<a name="ln-7823"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">closepoly</span>
<a name="ln-7824"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">color</span>
<a name="ln-7825"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">curve</span>
<a name="ln-7826"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">curvebasis</span>
<a name="ln-7827"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">curven</span>
<a name="ln-7828"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">curveprecision</span>
<a name="ln-7829"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">dashcode</span>
<a name="ln-7830"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">delobj</span>
<a name="ln-7831"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">draw</span>
<a name="ln-7832"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">draw2</span>
<a name="ln-7833"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">drawchar</span>
<a name="ln-7834"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">drawstr</span>
<a name="ln-7835"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">expandviewport</span>
<a name="ln-7836"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">fixedwidth</span>
<a name="ln-7837"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">font</span>
<a name="ln-7838"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">frontbuffer</span>
<a name="ln-7839"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">genobj</span>
<a name="ln-7840"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getaspect</span>
<a name="ln-7841"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getcharsize</span>
<a name="ln-7842"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getdepth</span>
<a name="ln-7843"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getdisplaysize</span>
<a name="ln-7844"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfactors</span>
<a name="ln-7845"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfontasc</span>
<a name="ln-7846"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfontdec</span>
<a name="ln-7847"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfontheight</span>
<a name="ln-7848"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfontsize</span>
<a name="ln-7849"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getfontwidth</span>
<a name="ln-7850"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getgp</span>
<a name="ln-7851"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getgp2</span>
<a name="ln-7852"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getgpt</span>
<a name="ln-7853"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getkey</span>
<a name="ln-7854"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getmatrix</span>
<a name="ln-7855"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getopenobj</span>
<a name="ln-7856"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getplanes</span>
<a name="ln-7857"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getprefposandsize</span>
<a name="ln-7858"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getstring</span>
<a name="ln-7859"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">getviewport</span>
<a name="ln-7860"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">hatchang</span>
<a name="ln-7861"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">hatchpitch</span>
<a name="ln-7862"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">isobj</span>
<a name="ln-7863"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">isobj_F</span>
<a name="ln-7864"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">leftjustify</span>
<a name="ln-7865"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">linestyle</span>
<a name="ln-7866"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">linewidth</span>
<a name="ln-7867"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">loadmatrix</span>
<a name="ln-7868"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">loadobj</span>
<a name="ln-7869"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">locator</span>
<a name="ln-7870"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">lookat</span>
<a name="ln-7871"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">makeobj</span>
<a name="ln-7872"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">makepoly</span>
<a name="ln-7873"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">mapcolor</span>
<a name="ln-7874"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">move</span>
<a name="ln-7875"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">move2</span>
<a name="ln-7876"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">multmatrix</span>
<a name="ln-7877"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">numchars</span>
<a name="ln-7878"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">ortho</span>
<a name="ln-7879"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">ortho2</span>
<a name="ln-7880"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">patch</span>
<a name="ln-7881"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">patchbasis</span>
<a name="ln-7882"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">patchcurves</span>
<a name="ln-7883"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">patchprecision</span>
<a name="ln-7884"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pdraw</span>
<a name="ln-7885"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">perspective</span>
<a name="ln-7886"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pmove</span>
<a name="ln-7887"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">point</span>
<a name="ln-7888"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">point2</span>
<a name="ln-7889"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">polarview</span>
<a name="ln-7890"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">poly</span>
<a name="ln-7891"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">poly2</span>
<a name="ln-7892"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">polyfill</span>
<a name="ln-7893"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">polyhatch</span>
<a name="ln-7894"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">popattributes</span>
<a name="ln-7895"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">popdev</span>
<a name="ln-7896"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">popmatrix</span>
<a name="ln-7897"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">popviewport</span>
<a name="ln-7898"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">prefposition</span>
<a name="ln-7899"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">prefsize</span>
<a name="ln-7900"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">printattribs</span>
<a name="ln-7901"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">printvdevice</span>
<a name="ln-7902"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pushattributes</span>
<a name="ln-7903"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pushdev</span>
<a name="ln-7904"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pushmatrix</span>
<a name="ln-7905"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">pushviewport</span>
<a name="ln-7906"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rcurve</span>
<a name="ln-7907"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rdraw</span>
<a name="ln-7908"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rdraw2</span>
<a name="ln-7909"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rect</span>
<a name="ln-7910"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rightjustify</span>
<a name="ln-7911"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rmove</span>
<a name="ln-7912"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rmove2</span>
<a name="ln-7913"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rotate</span>
<a name="ln-7914"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rsdraw2</span>
<a name="ln-7915"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">rsmove2</span>
<a name="ln-7916"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">saveobj</span>
<a name="ln-7917"></a> <span class="k">public</span> <span class="kd">::</span> <span class="nb">scale</span>
<a name="ln-7918"></a><span class="nb"> </span><span class="k">public</span> <span class="kd">::</span> <span class="n">sdraw2</span>
<a name="ln-7919"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">sector</span>
<a name="ln-7920"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">sgetgp2</span>
<a name="ln-7921"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">slocator</span>
<a name="ln-7922"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">smove2</span>
<a name="ln-7923"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">spoint2</span>
<a name="ln-7924"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">srect</span>
<a name="ln-7925"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">strlength</span>
<a name="ln-7926"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">strlength_F</span>
<a name="ln-7927"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">swapbuffers</span>
<a name="ln-7928"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">textang</span>
<a name="ln-7929"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">textjustify</span>
<a name="ln-7930"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">textsize</span>
<a name="ln-7931"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">textslant</span>
<a name="ln-7932"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">textweight</span>
<a name="ln-7933"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">topjustify</span>
<a name="ln-7934"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">translate</span>
<a name="ln-7935"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">unexpandviewport</span>
<a name="ln-7936"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">up</span>
<a name="ln-7937"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vexit</span>
<a name="ln-7938"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vflush</span>
<a name="ln-7939"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vgetdev</span>
<a name="ln-7940"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">viewport</span>
<a name="ln-7941"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vinit</span>
<a name="ln-7942"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vnewdev</span>
<a name="ln-7943"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">voutput</span>
<a name="ln-7944"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">vsetflush</span>
<a name="ln-7945"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">VtoWxy</span>
<a name="ln-7946"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">window</span>
<a name="ln-7947"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">xcentertext</span>
<a name="ln-7948"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">ycentertext</span>
<a name="ln-7949"></a> <span class="k">public</span> <span class="kd">::</span> <span class="n">yobbarays</span>
<a name="ln-7950"></a><span class="c">!public :: verror</span>
<a name="ln-7951"></a>
<a name="ln-7952"></a><span class="c">! integer,parameter :: C_BOOL = SELECTED_INT_KIND(1) ! _Bool ! integer*1</span>
<a name="ln-7953"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7954"></a><span class="c">! ==========  function definitions</span>
<a name="ln-7955"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7956"></a><span class="c">! ==========  arc routines</span>
<a name="ln-7957"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7958"></a><span class="c">! extern void arcprecision(int noseg);</span>
<a name="ln-7959"></a>   <span class="k">interface</span>
<a name="ln-7960"></a><span class="k">      subroutine </span><span class="n">arcprecision</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_arcprecision&#39;</span><span class="p">)</span>
<a name="ln-7961"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-7962"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-7963"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-7964"></a>      <span class="k">end subroutine </span><span class="n">arcprecision</span>
<a name="ln-7965"></a>   <span class="k">end interface</span>
<a name="ln-7966"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7967"></a><span class="c">! extern void arc(float x,float y, float radius, float startang, float endang);</span>
<a name="ln-7968"></a>   <span class="k">interface</span>
<a name="ln-7969"></a><span class="k">      subroutine </span><span class="n">arc</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">RADIUS</span><span class="p">,</span><span class="n">STARTANG</span><span class="p">,</span><span class="n">ENDANG</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_arc&#39;</span><span class="p">)</span>
<a name="ln-7970"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-7971"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-7972"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-7973"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-7974"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RADIUS</span>
<a name="ln-7975"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">STARTANG</span>
<a name="ln-7976"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ENDANG</span>
<a name="ln-7977"></a>      <span class="k">end subroutine </span><span class="n">arc</span>
<a name="ln-7978"></a>   <span class="k">end interface</span>
<a name="ln-7979"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7980"></a><span class="c">! extern void circle(float x,float y,float radius);</span>
<a name="ln-7981"></a>   <span class="k">interface</span>
<a name="ln-7982"></a><span class="k">      subroutine </span><span class="n">circle</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">RADIUS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_circle&#39;</span><span class="p">)</span>
<a name="ln-7983"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-7984"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-7985"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-7986"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-7987"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RADIUS</span>
<a name="ln-7988"></a>      <span class="k">end subroutine </span><span class="n">circle</span>
<a name="ln-7989"></a>   <span class="k">end interface</span>
<a name="ln-7990"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-7991"></a><span class="c">! extern void circleprecision(int noseg);</span>
<a name="ln-7992"></a>   <span class="k">interface</span>
<a name="ln-7993"></a><span class="k">      subroutine </span><span class="n">circleprecision</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_circleprecision&#39;</span><span class="p">)</span>
<a name="ln-7994"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-7995"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-7996"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-7997"></a>      <span class="k">end subroutine </span><span class="n">circleprecision</span>
<a name="ln-7998"></a>   <span class="k">end interface</span>
<a name="ln-7999"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8000"></a><span class="c">! extern void sector(float x,float y,float radius,float startang,float endang);</span>
<a name="ln-8001"></a>   <span class="k">interface</span>
<a name="ln-8002"></a><span class="k">      subroutine </span><span class="n">sector</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">RADIUS</span><span class="p">,</span><span class="n">STARTANG</span><span class="p">,</span><span class="n">ENDANG</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_sector&#39;</span><span class="p">)</span>
<a name="ln-8003"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8004"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8005"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8006"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8007"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RADIUS</span>
<a name="ln-8008"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">STARTANG</span>
<a name="ln-8009"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ENDANG</span>
<a name="ln-8010"></a>      <span class="k">end subroutine </span><span class="n">sector</span>
<a name="ln-8011"></a>   <span class="k">end interface</span>
<a name="ln-8012"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8013"></a><span class="c">! ==========  attr routines</span>
<a name="ln-8014"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8015"></a><span class="c">! extern void popattributes(void);</span>
<a name="ln-8016"></a>   <span class="k">interface</span>
<a name="ln-8017"></a><span class="k">      subroutine </span><span class="n">popattributes</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_popattributes&#39;</span><span class="p">)</span>
<a name="ln-8018"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8019"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8020"></a><span class="k">      end subroutine </span><span class="n">popattributes</span>
<a name="ln-8021"></a>   <span class="k">end interface</span>
<a name="ln-8022"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8023"></a><span class="c">! extern void pushattributes(void);</span>
<a name="ln-8024"></a>   <span class="k">interface</span>
<a name="ln-8025"></a><span class="k">      subroutine </span><span class="n">pushattributes</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pushattributes&#39;</span><span class="p">)</span>
<a name="ln-8026"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8027"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8028"></a><span class="k">      end subroutine </span><span class="n">pushattributes</span>
<a name="ln-8029"></a>   <span class="k">end interface</span>
<a name="ln-8030"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8031"></a><span class="c">! extern void printattribs(char *s);</span>
<a name="ln-8032"></a>   <span class="k">interface</span>
<a name="ln-8033"></a><span class="k">      subroutine </span><span class="n">printattribs_F</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_printattribs&#39;</span><span class="p">)</span>
<a name="ln-8034"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8035"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8036"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8037"></a>      <span class="k">end subroutine </span><span class="n">printattribs_F</span>
<a name="ln-8038"></a>   <span class="k">end interface</span>
<a name="ln-8039"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8040"></a><span class="c">! extern void printvdevice(char *s);</span>
<a name="ln-8041"></a>   <span class="k">interface</span>
<a name="ln-8042"></a><span class="k">      subroutine </span><span class="n">printvdevice_F</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_printvdevice&#39;</span><span class="p">)</span>
<a name="ln-8043"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8044"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8045"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8046"></a>      <span class="k">end subroutine </span><span class="n">printvdevice_F</span>
<a name="ln-8047"></a>   <span class="k">end interface</span>
<a name="ln-8048"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8049"></a><span class="c">! ==========  curve routines</span>
<a name="ln-8050"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8051"></a><span class="c">! extern void curve(float geom[4][3]);</span>
<a name="ln-8052"></a>   <span class="k">interface</span>
<a name="ln-8053"></a><span class="k">      subroutine </span><span class="n">curve</span><span class="p">(</span><span class="n">GEOM</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_curve&#39;</span><span class="p">)</span>
<a name="ln-8054"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8055"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8056"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOM</span>
<a name="ln-8057"></a>      <span class="k">end subroutine </span><span class="n">curve</span>
<a name="ln-8058"></a>   <span class="k">end interface</span>
<a name="ln-8059"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8060"></a><span class="c">! extern void rcurve_F(Matrix geom);</span>
<a name="ln-8061"></a>   <span class="k">interface</span>
<a name="ln-8062"></a><span class="k">      subroutine </span><span class="n">rcurve_F</span><span class="p">(</span><span class="n">GEOM</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rcurve&#39;</span><span class="p">)</span>
<a name="ln-8063"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8064"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8065"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-8066"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-8067"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-8068"></a>         <span class="c">!real(KIND=C_FLOAT),intent(in),dimension(4,4) :: GEOM</span>
<a name="ln-8069"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOM</span>
<a name="ln-8070"></a>      <span class="k">end subroutine </span><span class="n">rcurve_F</span>
<a name="ln-8071"></a>   <span class="k">end interface</span>
<a name="ln-8072"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8073"></a><span class="c">! extern void curven(int n, float geom[][3]);</span>
<a name="ln-8074"></a>   <span class="k">interface</span>
<a name="ln-8075"></a><span class="k">      subroutine </span><span class="n">curven</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">GEOM</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_curven&#39;</span><span class="p">)</span>
<a name="ln-8076"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8077"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8078"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8079"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOM</span>
<a name="ln-8080"></a>      <span class="k">end subroutine </span><span class="n">curven</span>
<a name="ln-8081"></a>   <span class="k">end interface</span>
<a name="ln-8082"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8083"></a><span class="c">! extern void drcurve(int n, Matrix r);</span>
<a name="ln-8084"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8085"></a><span class="c">! extern void curvebasis_F(Matrix basis);</span>
<a name="ln-8086"></a>   <span class="k">interface</span>
<a name="ln-8087"></a><span class="k">      subroutine </span><span class="n">curvebasis_F</span><span class="p">(</span><span class="n">BASIS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_curvebasis&#39;</span><span class="p">)</span>
<a name="ln-8088"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8089"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8090"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-8091"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-8092"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-8093"></a>         <span class="c">!real(KIND=C_FLOAT),intent(in),dimension(4,4) :: BASIS</span>
<a name="ln-8094"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BASIS</span>
<a name="ln-8095"></a>      <span class="k">end subroutine </span><span class="n">curvebasis_F</span>
<a name="ln-8096"></a>   <span class="k">end interface</span>
<a name="ln-8097"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8098"></a><span class="c">! extern void curveprecision(int nsegments);</span>
<a name="ln-8099"></a>   <span class="k">interface</span>
<a name="ln-8100"></a><span class="k">      subroutine </span><span class="n">curveprecision</span><span class="p">(</span><span class="n">NSEGMENTS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_curveprecision&#39;</span><span class="p">)</span>
<a name="ln-8101"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8102"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8103"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">NSEGMENTS</span>
<a name="ln-8104"></a>      <span class="k">end subroutine </span><span class="n">curveprecision</span>
<a name="ln-8105"></a>   <span class="k">end interface</span>
<a name="ln-8106"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8107"></a><span class="c">! ==========  draw routines</span>
<a name="ln-8108"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8109"></a><span class="c">! extern void draw(float x,float y, float z);</span>
<a name="ln-8110"></a>   <span class="k">interface</span>
<a name="ln-8111"></a><span class="k">      subroutine </span><span class="n">draw</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_draw&#39;</span><span class="p">)</span>
<a name="ln-8112"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8113"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8114"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8115"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8116"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8117"></a>      <span class="k">end subroutine </span><span class="n">draw</span>
<a name="ln-8118"></a>   <span class="k">end interface</span>
<a name="ln-8119"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8120"></a><span class="c">! extern void draw2(float x,float y);</span>
<a name="ln-8121"></a>   <span class="k">interface</span>
<a name="ln-8122"></a><span class="k">      subroutine </span><span class="n">draw2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_draw2&#39;</span><span class="p">)</span>
<a name="ln-8123"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8124"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8125"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8126"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8127"></a>      <span class="k">end subroutine </span><span class="n">draw2</span>
<a name="ln-8128"></a>   <span class="k">end interface</span>
<a name="ln-8129"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8130"></a><span class="c">! extern void rdraw(float dx,float dy,float dz);</span>
<a name="ln-8131"></a>   <span class="k">interface</span>
<a name="ln-8132"></a><span class="k">      subroutine </span><span class="n">rdraw</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rdraw&#39;</span><span class="p">)</span>
<a name="ln-8133"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8134"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8135"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8136"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8137"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8138"></a>      <span class="k">end subroutine </span><span class="n">rdraw</span>
<a name="ln-8139"></a>   <span class="k">end interface</span>
<a name="ln-8140"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8141"></a><span class="c">! extern void rdraw2(float dx, float dy);</span>
<a name="ln-8142"></a>   <span class="k">interface</span>
<a name="ln-8143"></a><span class="k">      subroutine </span><span class="n">rdraw2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rdraw2&#39;</span><span class="p">)</span>
<a name="ln-8144"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8145"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8146"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8147"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8148"></a>      <span class="k">end subroutine </span><span class="n">rdraw2</span>
<a name="ln-8149"></a>   <span class="k">end interface</span>
<a name="ln-8150"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8151"></a><span class="c">! extern void sdraw2(float xs, float ys);</span>
<a name="ln-8152"></a>   <span class="k">interface</span>
<a name="ln-8153"></a><span class="k">      subroutine </span><span class="n">sdraw2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_sdraw2&#39;</span><span class="p">)</span>
<a name="ln-8154"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8155"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8156"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8157"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8158"></a>      <span class="k">end subroutine </span><span class="n">sdraw2</span>
<a name="ln-8159"></a>   <span class="k">end interface</span>
<a name="ln-8160"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8161"></a><span class="c">! extern void rsdraw2(float dxs, float dys);</span>
<a name="ln-8162"></a>   <span class="k">interface</span>
<a name="ln-8163"></a><span class="k">      subroutine </span><span class="n">rsdraw2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rsdraw2&#39;</span><span class="p">)</span>
<a name="ln-8164"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8165"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8166"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8167"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8168"></a>      <span class="k">end subroutine </span><span class="n">rsdraw2</span>
<a name="ln-8169"></a>   <span class="k">end interface</span>
<a name="ln-8170"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8171"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8172"></a><span class="c">! extern void dashcode(float d);</span>
<a name="ln-8173"></a>   <span class="k">interface</span>
<a name="ln-8174"></a><span class="k">      subroutine </span><span class="n">dashcode</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_dashcode&#39;</span><span class="p">)</span>
<a name="ln-8175"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8176"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8177"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_float</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">D</span>
<a name="ln-8178"></a>      <span class="k">end subroutine </span><span class="n">dashcode</span>
<a name="ln-8179"></a>   <span class="k">end interface</span>
<a name="ln-8180"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8181"></a><span class="c">! extern void dashline(Vector p0, Vector p1);</span>
<a name="ln-8182"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8183"></a><span class="c">! extern void linestyle(char *l);</span>
<a name="ln-8184"></a>   <span class="k">interface</span>
<a name="ln-8185"></a><span class="k">      subroutine </span><span class="n">linestyle_F</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_linestyle&#39;</span><span class="p">)</span>
<a name="ln-8186"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8187"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8188"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">L</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8189"></a>      <span class="k">end subroutine </span><span class="n">linestyle_F</span>
<a name="ln-8190"></a>   <span class="k">end interface</span>
<a name="ln-8191"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8192"></a><span class="c">! extern void linewidth(int w);</span>
<a name="ln-8193"></a>   <span class="k">interface</span>
<a name="ln-8194"></a><span class="k">      subroutine </span><span class="n">linewidth</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_linewidth&#39;</span><span class="p">)</span>
<a name="ln-8195"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8196"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8197"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">W</span>
<a name="ln-8198"></a>      <span class="k">end subroutine </span><span class="n">linewidth</span>
<a name="ln-8199"></a>   <span class="k">end interface</span>
<a name="ln-8200"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8201"></a><span class="c">! ==========  device routines</span>
<a name="ln-8202"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8203"></a><span class="c">! extern void clear(void);</span>
<a name="ln-8204"></a>   <span class="k">interface</span>
<a name="ln-8205"></a><span class="k">      subroutine </span><span class="n">clear</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_clear&#39;</span><span class="p">)</span>
<a name="ln-8206"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8207"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8208"></a><span class="k">      end subroutine </span><span class="n">clear</span>
<a name="ln-8209"></a>   <span class="k">end interface</span>
<a name="ln-8210"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8211"></a><span class="c">! extern void color(int i);</span>
<a name="ln-8212"></a>   <span class="k">interface</span>
<a name="ln-8213"></a><span class="k">      subroutine </span><span class="n">color</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_color&#39;</span><span class="p">)</span>
<a name="ln-8214"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8215"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8216"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8217"></a>      <span class="k">end subroutine </span><span class="n">color</span>
<a name="ln-8218"></a>   <span class="k">end interface</span>
<a name="ln-8219"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8220"></a><span class="c">! extern int      getkey(void);</span>
<a name="ln-8221"></a>   <span class="k">interface</span>
<a name="ln-8222"></a><span class="k">      function </span><span class="n">getkey</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getkey&#39;</span><span class="p">)</span>
<a name="ln-8223"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8224"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8225"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getkey</span>
<a name="ln-8226"></a>      <span class="k">end function </span><span class="n">getkey</span>
<a name="ln-8227"></a>   <span class="k">end interface</span>
<a name="ln-8228"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8229"></a><span class="c">! extern int      getdepth(void);</span>
<a name="ln-8230"></a>   <span class="k">interface</span>
<a name="ln-8231"></a><span class="k">      function </span><span class="n">getdepth</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getdepth&#39;</span><span class="p">)</span>
<a name="ln-8232"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8233"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8234"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getdepth</span>
<a name="ln-8235"></a>      <span class="k">end function </span><span class="n">getdepth</span>
<a name="ln-8236"></a>   <span class="k">end interface</span>
<a name="ln-8237"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8238"></a><span class="c">! extern int      checkkey(void);</span>
<a name="ln-8239"></a>   <span class="k">interface</span>
<a name="ln-8240"></a><span class="k">      function </span><span class="n">checkkey</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_checkkey&#39;</span><span class="p">)</span>
<a name="ln-8241"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8242"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8243"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">checkkey</span>
<a name="ln-8244"></a>      <span class="k">end function </span><span class="n">checkkey</span>
<a name="ln-8245"></a>   <span class="k">end interface</span>
<a name="ln-8246"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8247"></a><span class="c">! extern int      getplanes(void);</span>
<a name="ln-8248"></a>   <span class="k">interface</span>
<a name="ln-8249"></a><span class="k">      function </span><span class="n">getplanes</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getplanes&#39;</span><span class="p">)</span>
<a name="ln-8250"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8251"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8252"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getplanes</span>
<a name="ln-8253"></a>      <span class="k">end function </span><span class="n">getplanes</span>
<a name="ln-8254"></a>   <span class="k">end interface</span>
<a name="ln-8255"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8256"></a><span class="c">! extern int      locator(float *wx,float *wy);</span>
<a name="ln-8257"></a>   <span class="k">interface</span>
<a name="ln-8258"></a><span class="k">      function </span><span class="n">locator</span><span class="p">(</span><span class="n">WX</span><span class="p">,</span><span class="n">WY</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_locator&#39;</span><span class="p">)</span>
<a name="ln-8259"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8260"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8261"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">locator</span>
<a name="ln-8262"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WX</span>
<a name="ln-8263"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WY</span>
<a name="ln-8264"></a>      <span class="k">end function </span><span class="n">locator</span>
<a name="ln-8265"></a>   <span class="k">end interface</span>
<a name="ln-8266"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8267"></a><span class="c">! extern int      slocator(float *wx,float *wy);</span>
<a name="ln-8268"></a>   <span class="k">interface</span>
<a name="ln-8269"></a><span class="k">      function </span><span class="n">slocator</span><span class="p">(</span><span class="n">WX</span><span class="p">,</span><span class="n">WY</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_slocator&#39;</span><span class="p">)</span>
<a name="ln-8270"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8271"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8272"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SLOCATOR</span>
<a name="ln-8273"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WX</span>
<a name="ln-8274"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WY</span>
<a name="ln-8275"></a>      <span class="k">end function </span><span class="n">slocator</span>
<a name="ln-8276"></a>   <span class="k">end interface</span>
<a name="ln-8277"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8278"></a><span class="c">! extern void mapcolor(int i, short r, short g, short b);</span>
<a name="ln-8279"></a>   <span class="k">interface</span>
<a name="ln-8280"></a><span class="k">      subroutine </span><span class="n">mapcolor</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_mapcolor&#39;</span><span class="p">)</span>
<a name="ln-8281"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8282"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8283"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">I</span>
<a name="ln-8284"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">R</span>
<a name="ln-8285"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">G</span>
<a name="ln-8286"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">B</span>
<a name="ln-8287"></a>      <span class="k">end subroutine </span><span class="n">mapcolor</span>
<a name="ln-8288"></a>   <span class="k">end interface</span>
<a name="ln-8289"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8290"></a><span class="c">! extern void vinit(char *device);</span>
<a name="ln-8291"></a>   <span class="k">interface</span>
<a name="ln-8292"></a><span class="k">      subroutine </span><span class="n">vinit_F</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vinit&#39;</span><span class="p">)</span>
<a name="ln-8293"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8294"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8295"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DEVICE</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8296"></a>      <span class="k">end subroutine </span><span class="n">vinit_F</span>
<a name="ln-8297"></a>   <span class="k">end interface</span>
<a name="ln-8298"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8299"></a><span class="c">! extern void vexit(void);</span>
<a name="ln-8300"></a>   <span class="k">interface</span>
<a name="ln-8301"></a><span class="k">      subroutine </span><span class="n">vexit</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vexit&#39;</span><span class="p">)</span>
<a name="ln-8302"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8303"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8304"></a><span class="k">      end subroutine </span><span class="n">vexit</span>
<a name="ln-8305"></a>   <span class="k">end interface</span>
<a name="ln-8306"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8307"></a><span class="c">! extern void voutput(char *path);</span>
<a name="ln-8308"></a>   <span class="k">interface</span>
<a name="ln-8309"></a><span class="k">      subroutine </span><span class="n">voutput_F</span><span class="p">(</span><span class="n">PATH</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_voutput&#39;</span><span class="p">)</span>
<a name="ln-8310"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8311"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8312"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PATH</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8313"></a>      <span class="k">end subroutine </span><span class="n">voutput_F</span>
<a name="ln-8314"></a>   <span class="k">end interface</span>
<a name="ln-8315"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8316"></a><span class="c">! extern void vnewdev(char *device);</span>
<a name="ln-8317"></a>   <span class="k">interface</span>
<a name="ln-8318"></a><span class="k">      subroutine </span><span class="n">vnewdev_F</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vnewdev&#39;</span><span class="p">)</span>
<a name="ln-8319"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8320"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8321"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DEVICE</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8322"></a>      <span class="k">end subroutine </span><span class="n">vnewdev_F</span>
<a name="ln-8323"></a>   <span class="k">end interface</span>
<a name="ln-8324"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8325"></a><span class="c">! extern char     *vgetdev(char *buf);</span>
<a name="ln-8326"></a>   <span class="k">interface</span>
<a name="ln-8327"></a><span class="k">      subroutine </span><span class="n">vgetdev_F</span><span class="p">(</span><span class="n">BUF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vgetdev&#39;</span><span class="p">)</span>
<a name="ln-8328"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8329"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8330"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BUF</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8331"></a>      <span class="k">end subroutine </span><span class="n">vgetdev_F</span>
<a name="ln-8332"></a>   <span class="k">end interface</span>
<a name="ln-8333"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8334"></a><span class="c">! extern void pushdev(char *device);</span>
<a name="ln-8335"></a>   <span class="k">interface</span>
<a name="ln-8336"></a><span class="k">      subroutine </span><span class="n">pushdev_F</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pushdev&#39;</span><span class="p">)</span>
<a name="ln-8337"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8338"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8339"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DEVICE</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8340"></a>      <span class="k">end subroutine </span><span class="n">pushdev_F</span>
<a name="ln-8341"></a>   <span class="k">end interface</span>
<a name="ln-8342"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8343"></a><span class="c">! extern void popdev(void);</span>
<a name="ln-8344"></a>   <span class="k">interface</span>
<a name="ln-8345"></a><span class="k">      subroutine </span><span class="n">popdev</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_popdev&#39;</span><span class="p">)</span>
<a name="ln-8346"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8347"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8348"></a><span class="k">      end subroutine </span><span class="n">popdev</span>
<a name="ln-8349"></a>   <span class="k">end interface</span>
<a name="ln-8350"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8351"></a><span class="c">! ==========  move routines</span>
<a name="ln-8352"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8353"></a><span class="c">! extern void move(float x, float y, float z);</span>
<a name="ln-8354"></a>   <span class="k">interface</span>
<a name="ln-8355"></a><span class="k">      subroutine </span><span class="n">move</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_move&#39;</span><span class="p">)</span>
<a name="ln-8356"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8357"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8358"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8359"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8360"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8361"></a>      <span class="k">end subroutine </span><span class="n">move</span>
<a name="ln-8362"></a>   <span class="k">end interface</span>
<a name="ln-8363"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8364"></a><span class="c">! extern void move2(float x, float y);</span>
<a name="ln-8365"></a>   <span class="k">interface</span>
<a name="ln-8366"></a><span class="k">      subroutine </span><span class="n">move2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_move2&#39;</span><span class="p">)</span>
<a name="ln-8367"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8368"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8369"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8370"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8371"></a>      <span class="k">end subroutine </span><span class="n">move2</span>
<a name="ln-8372"></a>   <span class="k">end interface</span>
<a name="ln-8373"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8374"></a><span class="c">! extern void rmove(float dx, float dy, float dz);</span>
<a name="ln-8375"></a>   <span class="k">interface</span>
<a name="ln-8376"></a><span class="k">      subroutine </span><span class="n">rmove</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rmove&#39;</span><span class="p">)</span>
<a name="ln-8377"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8378"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8379"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8380"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8381"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8382"></a>      <span class="k">end subroutine </span><span class="n">rmove</span>
<a name="ln-8383"></a>   <span class="k">end interface</span>
<a name="ln-8384"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8385"></a><span class="c">! extern void rmove2(float dx, float dy);</span>
<a name="ln-8386"></a>   <span class="k">interface</span>
<a name="ln-8387"></a><span class="k">      subroutine </span><span class="n">rmove2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rmove2&#39;</span><span class="p">)</span>
<a name="ln-8388"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8389"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8390"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8391"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8392"></a>      <span class="k">end subroutine </span><span class="n">rmove2</span>
<a name="ln-8393"></a>   <span class="k">end interface</span>
<a name="ln-8394"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8395"></a><span class="c">! extern void smove2(float xs, float ys);</span>
<a name="ln-8396"></a>   <span class="k">interface</span>
<a name="ln-8397"></a><span class="k">      subroutine </span><span class="n">smove2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_smove2&#39;</span><span class="p">)</span>
<a name="ln-8398"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8399"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8400"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8401"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8402"></a>      <span class="k">end subroutine </span><span class="n">smove2</span>
<a name="ln-8403"></a>   <span class="k">end interface</span>
<a name="ln-8404"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8405"></a><span class="c">! extern void rsmove2(float dxs, float dys);</span>
<a name="ln-8406"></a>   <span class="k">interface</span>
<a name="ln-8407"></a><span class="k">      subroutine </span><span class="n">rsmove2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rsmove2&#39;</span><span class="p">)</span>
<a name="ln-8408"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8409"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8410"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8411"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8412"></a>      <span class="k">end subroutine </span><span class="n">rsmove2</span>
<a name="ln-8413"></a>   <span class="k">end interface</span>
<a name="ln-8414"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8415"></a><span class="c">! ==========  object routines</span>
<a name="ln-8416"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8417"></a><span class="c">! extern int    isobj(int n);</span>
<a name="ln-8418"></a>   <span class="k">interface</span>
<a name="ln-8419"></a><span class="k">      function </span><span class="n">isobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_isobj&#39;</span><span class="p">)</span>
<a name="ln-8420"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8421"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8422"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ISOBJ_F</span>
<a name="ln-8423"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8424"></a>      <span class="k">end function </span><span class="n">isobj_F</span>
<a name="ln-8425"></a>   <span class="k">end interface</span>
<a name="ln-8426"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8427"></a><span class="c">! extern int    genobj(void);</span>
<a name="ln-8428"></a>   <span class="k">interface</span>
<a name="ln-8429"></a><span class="k">      function </span><span class="n">genobj</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_genobj&#39;</span><span class="p">)</span>
<a name="ln-8430"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8431"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8432"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">genobj</span>
<a name="ln-8433"></a>      <span class="k">end function </span><span class="n">genobj</span>
<a name="ln-8434"></a>   <span class="k">end interface</span>
<a name="ln-8435"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8436"></a><span class="c">! extern void delobj(int n);</span>
<a name="ln-8437"></a>   <span class="k">interface</span>
<a name="ln-8438"></a><span class="k">      subroutine </span><span class="n">delobj</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_delobj&#39;</span><span class="p">)</span>
<a name="ln-8439"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8440"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8441"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8442"></a>      <span class="k">end subroutine </span><span class="n">delobj</span>
<a name="ln-8443"></a>   <span class="k">end interface</span>
<a name="ln-8444"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8445"></a><span class="c">! extern void makeobj(int n);</span>
<a name="ln-8446"></a>   <span class="k">interface</span>
<a name="ln-8447"></a><span class="k">      subroutine </span><span class="n">makeobj</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_makeobj&#39;</span><span class="p">)</span>
<a name="ln-8448"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8449"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8450"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8451"></a>      <span class="k">end subroutine </span><span class="n">makeobj</span>
<a name="ln-8452"></a>   <span class="k">end interface</span>
<a name="ln-8453"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8454"></a><span class="c">! extern void loadobj(int n, char *file);</span>
<a name="ln-8455"></a>   <span class="k">interface</span>
<a name="ln-8456"></a><span class="k">      subroutine </span><span class="n">loadobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="k">FILE</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_loadobj&#39;</span><span class="p">)</span>
<a name="ln-8457"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8458"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8459"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8460"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">FILE</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8461"></a>      <span class="k">end subroutine </span><span class="n">loadobj_F</span>
<a name="ln-8462"></a>   <span class="k">end interface</span>
<a name="ln-8463"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8464"></a><span class="c">! extern void saveobj(int n, char *file);</span>
<a name="ln-8465"></a>   <span class="k">interface</span>
<a name="ln-8466"></a><span class="k">      subroutine </span><span class="n">saveobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="k">FILE</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_saveobj&#39;</span><span class="p">)</span>
<a name="ln-8467"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8468"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8469"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8470"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">FILE</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8471"></a>      <span class="k">end subroutine </span><span class="n">saveobj_F</span>
<a name="ln-8472"></a>   <span class="k">end interface</span>
<a name="ln-8473"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8474"></a><span class="c">! extern void callobj(int n);</span>
<a name="ln-8475"></a>   <span class="k">interface</span>
<a name="ln-8476"></a><span class="k">      subroutine </span><span class="n">callobj</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_callobj&#39;</span><span class="p">)</span>
<a name="ln-8477"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8478"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8479"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8480"></a>      <span class="k">end subroutine </span><span class="n">callobj</span>
<a name="ln-8481"></a>   <span class="k">end interface</span>
<a name="ln-8482"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8483"></a><span class="c">! extern void closeobj(void);</span>
<a name="ln-8484"></a>   <span class="k">interface</span>
<a name="ln-8485"></a><span class="k">      subroutine </span><span class="n">closeobj</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_closeobj&#39;</span><span class="p">)</span>
<a name="ln-8486"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8487"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8488"></a><span class="k">      end subroutine </span><span class="n">closeobj</span>
<a name="ln-8489"></a>   <span class="k">end interface</span>
<a name="ln-8490"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8491"></a><span class="c">! extern int    getopenobj(void);</span>
<a name="ln-8492"></a>   <span class="k">interface</span>
<a name="ln-8493"></a><span class="k">      function </span><span class="n">getopenobj</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getopenobj&#39;</span><span class="p">)</span>
<a name="ln-8494"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8495"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8496"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getopenobj</span>
<a name="ln-8497"></a>      <span class="k">end function </span><span class="n">getopenobj</span>
<a name="ln-8498"></a>   <span class="k">end interface</span>
<a name="ln-8499"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8500"></a><span class="c">! ==========  patch routines.</span>
<a name="ln-8501"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8502"></a><span class="c">! extern void patch(Matrix geomx, Matrix geomy, Matrix geomz);</span>
<a name="ln-8503"></a>   <span class="k">interface</span>
<a name="ln-8504"></a><span class="k">      subroutine </span><span class="n">patch_F</span><span class="p">(</span><span class="n">GEOMX</span><span class="p">,</span><span class="n">GEOMY</span><span class="p">,</span><span class="n">GEOMZ</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_patch&#39;</span><span class="p">)</span>
<a name="ln-8505"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8506"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8507"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-8508"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-8509"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-8510"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMX</span>
<a name="ln-8511"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMY</span>
<a name="ln-8512"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMZ</span>
<a name="ln-8513"></a>      <span class="k">end subroutine </span><span class="n">patch_F</span>
<a name="ln-8514"></a>   <span class="k">end interface</span>
<a name="ln-8515"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8516"></a><span class="c">! extern void rpatch(Matrix geomx, Matrix geomy, Matrix geomz, Matrix geomw);</span>
<a name="ln-8517"></a>   <span class="k">interface</span>
<a name="ln-8518"></a><span class="k">      subroutine </span><span class="n">rpatch_F</span><span class="p">(</span><span class="n">GEOMX</span><span class="p">,</span><span class="n">GEOMY</span><span class="p">,</span><span class="n">GEOMZ</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rpatch&#39;</span><span class="p">)</span>
<a name="ln-8519"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8520"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8521"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-8522"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-8523"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-8524"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMX</span>
<a name="ln-8525"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMY</span>
<a name="ln-8526"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMZ</span>
<a name="ln-8527"></a>      <span class="k">end subroutine </span><span class="n">rpatch_F</span>
<a name="ln-8528"></a>   <span class="k">end interface</span>
<a name="ln-8529"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8530"></a><span class="c">! extern void drpatch(Tensor R, int ntcurves, int nucurves, int ntsegs, int nusegs, int ntiter, int nuiter);</span>
<a name="ln-8531"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8532"></a><span class="c">! extern void patchbasis(Matrix tb, Matrix ub) ;</span>
<a name="ln-8533"></a>   <span class="k">interface</span>
<a name="ln-8534"></a><span class="k">      subroutine </span><span class="n">patchbasis_F</span><span class="p">(</span><span class="n">TB</span><span class="p">,</span><span class="n">UB</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_patchbasis&#39;</span><span class="p">)</span>
<a name="ln-8535"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8536"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8537"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-8538"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-8539"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-8540"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TB</span>
<a name="ln-8541"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UB</span>
<a name="ln-8542"></a>      <span class="k">end subroutine </span><span class="n">patchbasis_F</span>
<a name="ln-8543"></a>   <span class="k">end interface</span>
<a name="ln-8544"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8545"></a><span class="c">! extern void patchcurves(int nt, int nu);</span>
<a name="ln-8546"></a>   <span class="k">interface</span>
<a name="ln-8547"></a><span class="k">      subroutine </span><span class="n">patchcurves</span><span class="p">(</span><span class="n">NT</span><span class="p">,</span><span class="n">NU</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_patchcurves&#39;</span><span class="p">)</span>
<a name="ln-8548"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8549"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8550"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">NT</span>
<a name="ln-8551"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">NU</span>
<a name="ln-8552"></a>      <span class="k">end subroutine </span><span class="n">patchcurves</span>
<a name="ln-8553"></a>   <span class="k">end interface</span>
<a name="ln-8554"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8555"></a><span class="c">! extern void patchprecision(int tseg, int useg);</span>
<a name="ln-8556"></a>   <span class="k">interface</span>
<a name="ln-8557"></a><span class="k">      subroutine </span><span class="n">patchprecision</span><span class="p">(</span><span class="n">TSEG</span><span class="p">,</span><span class="n">USEG</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_patchprecision&#39;</span><span class="p">)</span>
<a name="ln-8558"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8559"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8560"></a><span class="k">         </span><span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TSEG</span>
<a name="ln-8561"></a>         <span class="kt">INTEGER</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">USEG</span>
<a name="ln-8562"></a>      <span class="k">end subroutine </span><span class="n">patchprecision</span>
<a name="ln-8563"></a>   <span class="k">end interface</span>
<a name="ln-8564"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8565"></a><span class="c">! extern void transformtensor(Tensor S, Matrix m);</span>
<a name="ln-8566"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8567"></a><span class="c">! ==========  point routines</span>
<a name="ln-8568"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8569"></a><span class="c">! extern void point(float x, float y, float z);</span>
<a name="ln-8570"></a>   <span class="k">interface</span>
<a name="ln-8571"></a><span class="k">      subroutine </span><span class="n">point</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_point&#39;</span><span class="p">)</span>
<a name="ln-8572"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8573"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8574"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8575"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8576"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8577"></a>      <span class="k">end subroutine </span><span class="n">point</span>
<a name="ln-8578"></a>   <span class="k">end interface</span>
<a name="ln-8579"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8580"></a><span class="c">! extern void point2(float x, float y);</span>
<a name="ln-8581"></a>   <span class="k">interface</span>
<a name="ln-8582"></a><span class="k">      subroutine </span><span class="n">point2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_point2&#39;</span><span class="p">)</span>
<a name="ln-8583"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8584"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8585"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8586"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8587"></a>      <span class="k">end subroutine </span><span class="n">point2</span>
<a name="ln-8588"></a>   <span class="k">end interface</span>
<a name="ln-8589"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8590"></a><span class="c">! extern void spoint2(float xs, float ys);</span>
<a name="ln-8591"></a>   <span class="k">interface</span>
<a name="ln-8592"></a><span class="k">      subroutine </span><span class="n">spoint2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_spoint2&#39;</span><span class="p">)</span>
<a name="ln-8593"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8594"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8595"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8596"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8597"></a>      <span class="k">end subroutine </span><span class="n">spoint2</span>
<a name="ln-8598"></a>   <span class="k">end interface</span>
<a name="ln-8599"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8600"></a><span class="c">! ==========  polygon routines.</span>
<a name="ln-8601"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8602"></a><span class="c">! extern void poly(int n, float dp[][3]);</span>
<a name="ln-8603"></a>   <span class="k">interface</span>
<a name="ln-8604"></a><span class="k">      subroutine </span><span class="n">poly</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">DP</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_poly&#39;</span><span class="p">)</span>
<a name="ln-8605"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8606"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8607"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8608"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DP</span>
<a name="ln-8609"></a>      <span class="k">end subroutine </span><span class="n">poly</span>
<a name="ln-8610"></a>   <span class="k">end interface</span>
<a name="ln-8611"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8612"></a><span class="c">! extern void poly2(int n, float dp[][2]);</span>
<a name="ln-8613"></a>   <span class="k">interface</span>
<a name="ln-8614"></a><span class="k">      subroutine </span><span class="n">poly2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">DP</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_poly2&#39;</span><span class="p">)</span>
<a name="ln-8615"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8616"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8617"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-8618"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DP</span>
<a name="ln-8619"></a>      <span class="k">end subroutine </span><span class="n">poly2</span>
<a name="ln-8620"></a>   <span class="k">end interface</span>
<a name="ln-8621"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8622"></a><span class="c">! extern void hatchang(float a);</span>
<a name="ln-8623"></a>   <span class="k">interface</span>
<a name="ln-8624"></a><span class="k">      subroutine </span><span class="n">hatchang</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_hatchang&#39;</span><span class="p">)</span>
<a name="ln-8625"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8626"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8627"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-8628"></a>      <span class="k">end subroutine </span><span class="n">hatchang</span>
<a name="ln-8629"></a>   <span class="k">end interface</span>
<a name="ln-8630"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8631"></a><span class="c">! extern void makepoly(void);</span>
<a name="ln-8632"></a>   <span class="k">interface</span>
<a name="ln-8633"></a><span class="k">      subroutine </span><span class="n">makepoly</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_makepoly&#39;</span><span class="p">)</span>
<a name="ln-8634"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8635"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8636"></a><span class="k">      end subroutine </span><span class="n">makepoly</span>
<a name="ln-8637"></a>   <span class="k">end interface</span>
<a name="ln-8638"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8639"></a><span class="c">! extern void polyfill(int onoff);</span>
<a name="ln-8640"></a>   <span class="k">interface</span>
<a name="ln-8641"></a><span class="k">      subroutine </span><span class="n">polyfill_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_polyfill&#39;</span><span class="p">)</span>
<a name="ln-8642"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8643"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8644"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-8645"></a>      <span class="k">end subroutine </span><span class="n">polyfill_F</span>
<a name="ln-8646"></a>   <span class="k">end interface</span>
<a name="ln-8647"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8648"></a><span class="c">! extern void closepoly(void);</span>
<a name="ln-8649"></a>   <span class="k">interface</span>
<a name="ln-8650"></a><span class="k">      subroutine </span><span class="n">closepoly</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_closepoly&#39;</span><span class="p">)</span>
<a name="ln-8651"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8652"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8653"></a><span class="k">      end subroutine </span><span class="n">closepoly</span>
<a name="ln-8654"></a>   <span class="k">end interface</span>
<a name="ln-8655"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8656"></a><span class="c">! extern void polyhatch(int onoff);</span>
<a name="ln-8657"></a>   <span class="k">interface</span>
<a name="ln-8658"></a><span class="k">      subroutine </span><span class="n">polyhatch_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_polyhatch&#39;</span><span class="p">)</span>
<a name="ln-8659"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8660"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8661"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-8662"></a>      <span class="k">end subroutine </span><span class="n">polyhatch_F</span>
<a name="ln-8663"></a>   <span class="k">end interface</span>
<a name="ln-8664"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8665"></a><span class="c">! extern void hatchpitch(float a);</span>
<a name="ln-8666"></a>   <span class="k">interface</span>
<a name="ln-8667"></a><span class="k">      subroutine </span><span class="n">hatchpitch</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_hatchpitch&#39;</span><span class="p">)</span>
<a name="ln-8668"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8669"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8670"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">A</span>
<a name="ln-8671"></a>      <span class="k">end subroutine </span><span class="n">hatchpitch</span>
<a name="ln-8672"></a>   <span class="k">end interface</span>
<a name="ln-8673"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8674"></a><span class="c">! extern void backfacedir(int cdir);</span>
<a name="ln-8675"></a>   <span class="k">interface</span>
<a name="ln-8676"></a><span class="k">      subroutine </span><span class="n">backfacedir_F</span><span class="p">(</span><span class="n">cdir</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_backfacedir&#39;</span><span class="p">)</span>
<a name="ln-8677"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8678"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8679"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">cdir</span>
<a name="ln-8680"></a>      <span class="k">end subroutine </span><span class="n">backfacedir_F</span>
<a name="ln-8681"></a>   <span class="k">end interface</span>
<a name="ln-8682"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8683"></a><span class="c">! extern void backface(int onoff);</span>
<a name="ln-8684"></a>   <span class="k">interface</span>
<a name="ln-8685"></a><span class="k">      subroutine </span><span class="n">backface_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_backface&#39;</span><span class="p">)</span>
<a name="ln-8686"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8687"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8688"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-8689"></a>      <span class="k">end subroutine </span><span class="n">backface_F</span>
<a name="ln-8690"></a>   <span class="k">end interface</span>
<a name="ln-8691"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8692"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8693"></a><span class="c">! extern void pmove(float x, float y, float z);</span>
<a name="ln-8694"></a>   <span class="k">interface</span>
<a name="ln-8695"></a><span class="k">      subroutine </span><span class="n">pmove</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pmove&#39;</span><span class="p">)</span>
<a name="ln-8696"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8697"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8698"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8699"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8700"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8701"></a>      <span class="k">end subroutine </span><span class="n">pmove</span>
<a name="ln-8702"></a>   <span class="k">end interface</span>
<a name="ln-8703"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8704"></a><span class="c">! extern void pdraw(float x, float y, float z);</span>
<a name="ln-8705"></a>   <span class="k">interface</span>
<a name="ln-8706"></a><span class="k">      subroutine </span><span class="n">pdraw</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pdraw&#39;</span><span class="p">)</span>
<a name="ln-8707"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8708"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8709"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8710"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8711"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8712"></a>      <span class="k">end subroutine </span><span class="n">pdraw</span>
<a name="ln-8713"></a>   <span class="k">end interface</span>
<a name="ln-8714"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8715"></a><span class="c">! ==========  rectangle routine</span>
<a name="ln-8716"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8717"></a><span class="c">! extern void rect(float x1, float y1, float x2, float y2);</span>
<a name="ln-8718"></a>   <span class="k">interface</span>
<a name="ln-8719"></a><span class="k">      subroutine </span><span class="n">rect</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rect&#39;</span><span class="p">)</span>
<a name="ln-8720"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8721"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8722"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8723"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8724"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X2</span>
<a name="ln-8725"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y2</span>
<a name="ln-8726"></a>      <span class="k">end subroutine </span><span class="n">rect</span>
<a name="ln-8727"></a>   <span class="k">end interface</span>
<a name="ln-8728"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8729"></a><span class="c">! extern void srect(float x1, float y1, float x2, float y2);</span>
<a name="ln-8730"></a>   <span class="k">interface</span>
<a name="ln-8731"></a><span class="k">      subroutine </span><span class="n">srect</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_srect&#39;</span><span class="p">)</span>
<a name="ln-8732"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8733"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8734"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8735"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8736"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X2</span>
<a name="ln-8737"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y2</span>
<a name="ln-8738"></a>      <span class="k">end subroutine </span><span class="n">srect</span>
<a name="ln-8739"></a>   <span class="k">end interface</span>
<a name="ln-8740"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8741"></a><span class="c">! ==========  text routines</span>
<a name="ln-8742"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8743"></a><span class="c">! extern float strlength(char *s);</span>
<a name="ln-8744"></a>   <span class="k">interface</span>
<a name="ln-8745"></a><span class="k">      function </span><span class="n">strlength_F</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_strlength&#39;</span><span class="p">)</span>
<a name="ln-8746"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8747"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8748"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">strlength_F</span>
<a name="ln-8749"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8750"></a>      <span class="k">end function </span><span class="n">strlength_F</span>
<a name="ln-8751"></a>   <span class="k">end interface</span>
<a name="ln-8752"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8753"></a><span class="c">! extern void boxtext(float x, float y, float l, float h, char *s);</span>
<a name="ln-8754"></a>   <span class="k">interface</span>
<a name="ln-8755"></a><span class="k">      subroutine </span><span class="n">boxtext_F</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_boxtext&#39;</span><span class="p">)</span>
<a name="ln-8756"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8757"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8758"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8759"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8760"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">L</span>
<a name="ln-8761"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-8762"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8763"></a>      <span class="k">end subroutine </span><span class="n">boxtext_F</span>
<a name="ln-8764"></a>   <span class="k">end interface</span>
<a name="ln-8765"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8766"></a><span class="c">! extern void boxfit(float l, float h, int nchars);</span>
<a name="ln-8767"></a>   <span class="k">interface</span>
<a name="ln-8768"></a><span class="k">      subroutine </span><span class="n">boxfit</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">NCHARS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_boxfit&#39;</span><span class="p">)</span>
<a name="ln-8769"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8770"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8771"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">L</span>
<a name="ln-8772"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-8773"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span>   <span class="kd">::</span> <span class="n">NCHARS</span>
<a name="ln-8774"></a>      <span class="k">end subroutine </span><span class="n">boxfit</span>
<a name="ln-8775"></a>   <span class="k">end interface</span>
<a name="ln-8776"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8777"></a><span class="c">! extern int numchars(void);</span>
<a name="ln-8778"></a>   <span class="k">interface</span>
<a name="ln-8779"></a><span class="k">      function </span><span class="n">numchars</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_numchars&#39;</span><span class="p">)</span>
<a name="ln-8780"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8781"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8782"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">numchars</span>
<a name="ln-8783"></a>      <span class="k">end function </span><span class="n">numchars</span>
<a name="ln-8784"></a>   <span class="k">end interface</span>
<a name="ln-8785"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8786"></a><span class="c">! extern void getcharsize(char c, float *width, float *height);</span>
<a name="ln-8787"></a>   <span class="k">interface</span>
<a name="ln-8788"></a><span class="k">      subroutine </span><span class="n">getcharsize</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">WIDTH</span><span class="p">,</span><span class="n">HEIGHT</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getcharsize&#39;</span><span class="p">)</span>
<a name="ln-8789"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8790"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8791"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WIDTH</span>
<a name="ln-8792"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HEIGHT</span>
<a name="ln-8793"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">C</span>
<a name="ln-8794"></a>      <span class="k">end subroutine </span><span class="n">getcharsize</span>
<a name="ln-8795"></a>   <span class="k">end interface</span>
<a name="ln-8796"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8797"></a><span class="c">! extern void drawchar(int c);</span>
<a name="ln-8798"></a><span class="c">!  there are currently issues in some ISO_C_BINDING implementations about a</span>
<a name="ln-8799"></a><span class="c">!  single character being equivalent to an integer in C and pass by value</span>
<a name="ln-8800"></a><span class="c">!  and such; might have to replace drawchar with a call to drawstr</span>
<a name="ln-8801"></a>   <span class="k">interface</span>
<a name="ln-8802"></a><span class="k">      subroutine </span><span class="n">drawchar_F</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_drawchar&#39;</span><span class="p">)</span>
<a name="ln-8803"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8804"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8805"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">C</span>
<a name="ln-8806"></a>      <span class="k">end subroutine </span><span class="n">drawchar_F</span>
<a name="ln-8807"></a>   <span class="k">end interface</span>
<a name="ln-8808"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8809"></a><span class="c">! extern void textsize(float width, float height);</span>
<a name="ln-8810"></a>   <span class="k">interface</span>
<a name="ln-8811"></a><span class="k">      subroutine </span><span class="n">textsize</span><span class="p">(</span><span class="n">WIDTH</span><span class="p">,</span><span class="n">HEIGHT</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_textsize&#39;</span><span class="p">)</span>
<a name="ln-8812"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8813"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8814"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">WIDTH</span>
<a name="ln-8815"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">HEIGHT</span>
<a name="ln-8816"></a>      <span class="k">end subroutine </span><span class="n">textsize</span>
<a name="ln-8817"></a>   <span class="k">end interface</span>
<a name="ln-8818"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8819"></a><span class="c">! extern float  getfontwidth(void);</span>
<a name="ln-8820"></a>   <span class="k">interface</span>
<a name="ln-8821"></a><span class="k">      function </span><span class="n">getfontwidth</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfontwidth&#39;</span><span class="p">)</span>
<a name="ln-8822"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8823"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8824"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getfontwidth</span>
<a name="ln-8825"></a>      <span class="k">end function </span><span class="n">getfontwidth</span>
<a name="ln-8826"></a>   <span class="k">end interface</span>
<a name="ln-8827"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8828"></a><span class="c">! extern float  getfontheight(void);</span>
<a name="ln-8829"></a>   <span class="k">interface</span>
<a name="ln-8830"></a><span class="k">      function </span><span class="n">getfontheight</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfontheight&#39;</span><span class="p">)</span>
<a name="ln-8831"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8832"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8833"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getfontheight</span>
<a name="ln-8834"></a>      <span class="k">end function </span><span class="n">getfontheight</span>
<a name="ln-8835"></a>   <span class="k">end interface</span>
<a name="ln-8836"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8837"></a><span class="c">! extern float  getfontdec(void);</span>
<a name="ln-8838"></a>   <span class="k">interface</span>
<a name="ln-8839"></a><span class="k">      function </span><span class="n">getfontdec</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfontdec&#39;</span><span class="p">)</span>
<a name="ln-8840"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8841"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8842"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getfontdec</span>
<a name="ln-8843"></a>      <span class="k">end function </span><span class="n">getfontdec</span>
<a name="ln-8844"></a>   <span class="k">end interface</span>
<a name="ln-8845"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8846"></a><span class="c">! extern float  getfontasc(void);</span>
<a name="ln-8847"></a>   <span class="k">interface</span>
<a name="ln-8848"></a><span class="k">      function </span><span class="n">getfontasc</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfontasc&#39;</span><span class="p">)</span>
<a name="ln-8849"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8850"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8851"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getfontasc</span>
<a name="ln-8852"></a>      <span class="k">end function </span><span class="n">getfontasc</span>
<a name="ln-8853"></a>   <span class="k">end interface</span>
<a name="ln-8854"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8855"></a><span class="c">! extern void getfontsize(float *cw, float *ch);</span>
<a name="ln-8856"></a>   <span class="k">interface</span>
<a name="ln-8857"></a><span class="k">      subroutine </span><span class="n">getfontsize</span><span class="p">(</span><span class="n">CW</span><span class="p">,</span><span class="n">CH</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfontsize&#39;</span><span class="p">)</span>
<a name="ln-8858"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8859"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8860"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CW</span>
<a name="ln-8861"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CH</span>
<a name="ln-8862"></a>      <span class="k">end subroutine </span><span class="n">getfontsize</span>
<a name="ln-8863"></a>   <span class="k">end interface</span>
<a name="ln-8864"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8865"></a><span class="c">! extern void drawstr(char *string);</span>
<a name="ln-8866"></a>   <span class="k">interface</span>
<a name="ln-8867"></a><span class="k">      subroutine </span><span class="n">drawstr_F</span><span class="p">(</span><span class="n">STRING</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_drawstr&#39;</span><span class="p">)</span>
<a name="ln-8868"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8869"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8870"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">STRING</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8871"></a>      <span class="k">end subroutine </span><span class="n">drawstr_F</span>
<a name="ln-8872"></a>   <span class="k">end interface</span>
<a name="ln-8873"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8874"></a><span class="c">! extern void centertext(int onoff);</span>
<a name="ln-8875"></a>   <span class="k">interface</span>
<a name="ln-8876"></a><span class="k">      subroutine </span><span class="n">centertext_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_centertext&#39;</span><span class="p">)</span>
<a name="ln-8877"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8878"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8879"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-8880"></a>      <span class="k">end subroutine </span><span class="n">centertext_F</span>
<a name="ln-8881"></a>   <span class="k">end interface</span>
<a name="ln-8882"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8883"></a><span class="c">! extern void fixedwidth(int onoff);</span>
<a name="ln-8884"></a>   <span class="k">interface</span>
<a name="ln-8885"></a><span class="k">      subroutine </span><span class="n">fixedwidth_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_fixedwidth&#39;</span><span class="p">)</span>
<a name="ln-8886"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8887"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8888"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-8889"></a>      <span class="k">end subroutine </span><span class="n">fixedwidth_F</span>
<a name="ln-8890"></a>   <span class="k">end interface</span>
<a name="ln-8891"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8892"></a><span class="c">! extern void textang(float ang);</span>
<a name="ln-8893"></a>   <span class="k">interface</span>
<a name="ln-8894"></a><span class="k">      subroutine </span><span class="n">textang</span><span class="p">(</span><span class="n">ANG</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_textang&#39;</span><span class="p">)</span>
<a name="ln-8895"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8896"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8897"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ANG</span>
<a name="ln-8898"></a>      <span class="k">end subroutine </span><span class="n">textang</span>
<a name="ln-8899"></a>   <span class="k">end interface</span>
<a name="ln-8900"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8901"></a><span class="c">! extern void font(char *name);</span>
<a name="ln-8902"></a>   <span class="k">interface</span>
<a name="ln-8903"></a><span class="k">      subroutine </span><span class="n">font_F</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_font&#39;</span><span class="p">)</span>
<a name="ln-8904"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8905"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8906"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8907"></a>      <span class="k">end subroutine </span><span class="n">font_F</span>
<a name="ln-8908"></a>   <span class="k">end interface</span>
<a name="ln-8909"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8910"></a><span class="c">! extern int    getstring(int bcol, char *s);</span>
<a name="ln-8911"></a>   <span class="k">interface</span>
<a name="ln-8912"></a><span class="k">      function </span><span class="n">getstring</span><span class="p">(</span><span class="n">BCOL</span><span class="p">,</span><span class="n">S</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getstring&#39;</span><span class="p">)</span>
<a name="ln-8913"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8914"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8915"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span><span class="kd">::</span> <span class="n">GETSTRING</span>
<a name="ln-8916"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">BCOL</span>
<a name="ln-8917"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-8918"></a>      <span class="k">end function </span><span class="n">getstring</span>
<a name="ln-8919"></a>   <span class="k">end interface</span>
<a name="ln-8920"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8921"></a><span class="c">! ==========  transformation routines</span>
<a name="ln-8922"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8923"></a><span class="c">! extern void scale(float x, float y, float z);</span>
<a name="ln-8924"></a>   <span class="k">interface</span>
<a name="ln-8925"></a><span class="k">      subroutine </span><span class="nb">scale</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_scale&#39;</span><span class="p">)</span>
<a name="ln-8926"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8927"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8928"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8929"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8930"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8931"></a>      <span class="k">end subroutine </span><span class="nb">scale</span>
<a name="ln-8932"></a><span class="nb">   </span><span class="k">end interface</span>
<a name="ln-8933"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8934"></a><span class="c">! extern void translate(float x, float y, float z);</span>
<a name="ln-8935"></a>   <span class="k">interface</span>
<a name="ln-8936"></a><span class="k">      subroutine </span><span class="n">translate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_translate&#39;</span><span class="p">)</span>
<a name="ln-8937"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8938"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8939"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-8940"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-8941"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-8942"></a>      <span class="k">end subroutine </span><span class="n">translate</span>
<a name="ln-8943"></a>   <span class="k">end interface</span>
<a name="ln-8944"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8945"></a><span class="c">! extern void rotate(float r,char axis);</span>
<a name="ln-8946"></a>   <span class="k">interface</span>
<a name="ln-8947"></a><span class="k">      subroutine </span><span class="n">rotate</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="n">AXIS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rotate&#39;</span><span class="p">)</span>
<a name="ln-8948"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8949"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8950"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">R</span>
<a name="ln-8951"></a>         <span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">AXIS</span>
<a name="ln-8952"></a>      <span class="k">end subroutine </span><span class="n">rotate</span>
<a name="ln-8953"></a>   <span class="k">end interface</span>
<a name="ln-8954"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8955"></a><span class="c">! ==========  window definition routines</span>
<a name="ln-8956"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8957"></a><span class="c">! extern void ortho(float left,float right,float bottom,float top,float hither,float yon);</span>
<a name="ln-8958"></a>   <span class="k">interface</span>
<a name="ln-8959"></a><span class="k">      subroutine </span><span class="n">ortho</span><span class="p">(</span><span class="n">LEFT</span><span class="p">,</span><span class="n">RIGHT</span><span class="p">,</span><span class="n">BOTTOM</span><span class="p">,</span><span class="n">TOP</span><span class="p">,</span><span class="n">HITHER</span><span class="p">,</span><span class="n">YON</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_ortho&#39;</span><span class="p">)</span>
<a name="ln-8960"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8961"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8962"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">LEFT</span>
<a name="ln-8963"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RIGHT</span>
<a name="ln-8964"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">BOTTOM</span>
<a name="ln-8965"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TOP</span>
<a name="ln-8966"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">HITHER</span>
<a name="ln-8967"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YON</span>
<a name="ln-8968"></a>      <span class="k">end subroutine </span><span class="n">ortho</span>
<a name="ln-8969"></a>   <span class="k">end interface</span>
<a name="ln-8970"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8971"></a><span class="c">! extern void ortho2(float left,float  right,float  bottom,float  top);</span>
<a name="ln-8972"></a>   <span class="k">interface</span>
<a name="ln-8973"></a><span class="k">      subroutine </span><span class="n">ortho2</span><span class="p">(</span><span class="n">LEFT</span><span class="p">,</span><span class="n">RIGHT</span><span class="p">,</span><span class="n">BOTTOM</span><span class="p">,</span><span class="n">TOP</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_ortho2&#39;</span><span class="p">)</span>
<a name="ln-8974"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8975"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8976"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">LEFT</span>
<a name="ln-8977"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RIGHT</span>
<a name="ln-8978"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">BOTTOM</span>
<a name="ln-8979"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TOP</span>
<a name="ln-8980"></a>      <span class="k">end subroutine </span><span class="n">ortho2</span>
<a name="ln-8981"></a>   <span class="k">end interface</span>
<a name="ln-8982"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8983"></a><span class="c">! extern void lookat(float vx,float vy,float vz,float px,float py,float pz,float twist);</span>
<a name="ln-8984"></a>   <span class="k">interface</span>
<a name="ln-8985"></a><span class="k">      subroutine </span><span class="n">lookat</span><span class="p">(</span><span class="n">VX</span><span class="p">,</span><span class="n">VY</span><span class="p">,</span><span class="n">VZ</span><span class="p">,</span><span class="n">PX</span><span class="p">,</span><span class="n">PY</span><span class="p">,</span><span class="n">PZ</span><span class="p">,</span><span class="n">TWIST</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_lookat&#39;</span><span class="p">)</span>
<a name="ln-8986"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-8987"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-8988"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VX</span>
<a name="ln-8989"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VY</span>
<a name="ln-8990"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VZ</span>
<a name="ln-8991"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">PX</span>
<a name="ln-8992"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">PY</span>
<a name="ln-8993"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">PZ</span>
<a name="ln-8994"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TWIST</span>
<a name="ln-8995"></a>      <span class="k">end subroutine </span><span class="n">lookat</span>
<a name="ln-8996"></a>   <span class="k">end interface</span>
<a name="ln-8997"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-8998"></a><span class="c">! extern void window(float left,float right,float bottom,float top,float hither,float yon);</span>
<a name="ln-8999"></a>   <span class="k">interface</span>
<a name="ln-9000"></a><span class="k">      subroutine </span><span class="n">window</span><span class="p">(</span><span class="n">LEFT</span><span class="p">,</span><span class="n">RIGHT</span><span class="p">,</span><span class="n">BOTTOM</span><span class="p">,</span><span class="n">TOP</span><span class="p">,</span><span class="n">HITHER</span><span class="p">,</span><span class="n">YON</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_window&#39;</span><span class="p">)</span>
<a name="ln-9001"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9002"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9003"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">LEFT</span>
<a name="ln-9004"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">RIGHT</span>
<a name="ln-9005"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">BOTTOM</span>
<a name="ln-9006"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TOP</span>
<a name="ln-9007"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">HITHER</span>
<a name="ln-9008"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YON</span>
<a name="ln-9009"></a>      <span class="k">end subroutine </span><span class="n">window</span>
<a name="ln-9010"></a>   <span class="k">end interface</span>
<a name="ln-9011"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9012"></a><span class="c">! extern void polarview(float dist, float azim, float inc, float twist) ;</span>
<a name="ln-9013"></a>   <span class="k">interface</span>
<a name="ln-9014"></a><span class="k">      subroutine </span><span class="n">polarview</span><span class="p">(</span><span class="n">DIST</span><span class="p">,</span><span class="n">AZIM</span><span class="p">,</span><span class="n">INC</span><span class="p">,</span><span class="n">TWIST</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_polarview&#39;</span><span class="p">)</span>
<a name="ln-9015"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9016"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9017"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">DIST</span>
<a name="ln-9018"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">AZIM</span>
<a name="ln-9019"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">INC</span>
<a name="ln-9020"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">TWIST</span>
<a name="ln-9021"></a>      <span class="k">end subroutine </span><span class="n">polarview</span>
<a name="ln-9022"></a>   <span class="k">end interface</span>
<a name="ln-9023"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9024"></a><span class="c">! extern void perspective(float fov, float aspect, float hither, float yon) ;</span>
<a name="ln-9025"></a>   <span class="k">interface</span>
<a name="ln-9026"></a><span class="k">      subroutine </span><span class="n">perspective</span><span class="p">(</span><span class="n">FOV</span><span class="p">,</span><span class="n">ASPECT</span><span class="p">,</span><span class="n">HITHER</span><span class="p">,</span><span class="n">YON</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_perspective&#39;</span><span class="p">)</span>
<a name="ln-9027"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9028"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9029"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">FOV</span>
<a name="ln-9030"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ASPECT</span>
<a name="ln-9031"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">HITHER</span>
<a name="ln-9032"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YON</span>
<a name="ln-9033"></a>      <span class="k">end subroutine </span><span class="n">perspective</span>
<a name="ln-9034"></a>   <span class="k">end interface</span>
<a name="ln-9035"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9036"></a><span class="c">! extern void up(float x, float y, float z) ;</span>
<a name="ln-9037"></a>   <span class="k">interface</span>
<a name="ln-9038"></a><span class="k">      subroutine </span><span class="n">up</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_up&#39;</span><span class="p">)</span>
<a name="ln-9039"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9040"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9041"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9042"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9043"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-9044"></a>      <span class="k">end subroutine </span><span class="n">up</span>
<a name="ln-9045"></a>   <span class="k">end interface</span>
<a name="ln-9046"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9047"></a><span class="c">! ==========  routines for manipulating the viewport</span>
<a name="ln-9048"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9049"></a><span class="c">! extern void getviewport(float *xlow, float *xhigh, float *ylow, float *yhigh);</span>
<a name="ln-9050"></a>   <span class="k">interface</span>
<a name="ln-9051"></a><span class="k">      subroutine </span><span class="n">getviewport</span><span class="p">(</span><span class="n">XLOW</span><span class="p">,</span><span class="n">XHIGH</span><span class="p">,</span><span class="n">YLOW</span><span class="p">,</span><span class="n">YHIGH</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getviewport&#39;</span><span class="p">)</span>
<a name="ln-9052"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9053"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9054"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XLOW</span>
<a name="ln-9055"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XHIGH</span>
<a name="ln-9056"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YLOW</span>
<a name="ln-9057"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YHIGH</span>
<a name="ln-9058"></a>      <span class="k">end subroutine </span><span class="n">getviewport</span>
<a name="ln-9059"></a>   <span class="k">end interface</span>
<a name="ln-9060"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9061"></a><span class="c">! extern void viewport(float xlow, float xhigh, float ylow, float yhigh);</span>
<a name="ln-9062"></a>   <span class="k">interface</span>
<a name="ln-9063"></a><span class="k">      subroutine </span><span class="n">viewport</span><span class="p">(</span><span class="n">XLOW</span><span class="p">,</span><span class="n">XHIGH</span><span class="p">,</span><span class="n">YLOW</span><span class="p">,</span><span class="n">YHIGH</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_viewport&#39;</span><span class="p">)</span>
<a name="ln-9064"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9065"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9066"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">XLOW</span>
<a name="ln-9067"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">XHIGH</span>
<a name="ln-9068"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YLOW</span>
<a name="ln-9069"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YHIGH</span>
<a name="ln-9070"></a>      <span class="k">end subroutine </span><span class="n">viewport</span>
<a name="ln-9071"></a>   <span class="k">end interface</span>
<a name="ln-9072"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9073"></a><span class="c">! extern void popviewport(void);</span>
<a name="ln-9074"></a>   <span class="k">interface</span>
<a name="ln-9075"></a><span class="k">      subroutine </span><span class="n">popviewport</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_popviewport&#39;</span><span class="p">)</span>
<a name="ln-9076"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9077"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9078"></a><span class="k">      end subroutine </span><span class="n">popviewport</span>
<a name="ln-9079"></a>   <span class="k">end interface</span>
<a name="ln-9080"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9081"></a><span class="c">! extern void pushviewport(void);</span>
<a name="ln-9082"></a>   <span class="k">interface</span>
<a name="ln-9083"></a><span class="k">      subroutine </span><span class="n">pushviewport</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pushviewport&#39;</span><span class="p">)</span>
<a name="ln-9084"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9085"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9086"></a><span class="k">      end subroutine </span><span class="n">pushviewport</span>
<a name="ln-9087"></a>   <span class="k">end interface</span>
<a name="ln-9088"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9089"></a><span class="c">! ==========  routines for retrieving the graphics position</span>
<a name="ln-9090"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9091"></a><span class="c">! extern void getgp(float *x,float *y,float *z);</span>
<a name="ln-9092"></a>   <span class="k">interface</span>
<a name="ln-9093"></a><span class="k">      subroutine </span><span class="n">getgp</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getgp&#39;</span><span class="p">)</span>
<a name="ln-9094"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9095"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9096"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="kd">::</span> <span class="n">X</span>
<a name="ln-9097"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9098"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-9099"></a>      <span class="k">end subroutine </span><span class="n">getgp</span>
<a name="ln-9100"></a>   <span class="k">end interface</span>
<a name="ln-9101"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9102"></a><span class="c">! extern void getgpt(float *x,float *y,float *z, float *w);</span>
<a name="ln-9103"></a>   <span class="k">interface</span>
<a name="ln-9104"></a><span class="k">      subroutine </span><span class="n">getgpt</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">W</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getgpt&#39;</span><span class="p">)</span>
<a name="ln-9105"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9106"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9107"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9108"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9109"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-9110"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">W</span>
<a name="ln-9111"></a>      <span class="k">end subroutine </span><span class="n">getgpt</span>
<a name="ln-9112"></a>   <span class="k">end interface</span>
<a name="ln-9113"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9114"></a><span class="c">! extern void getgp2(float *x,float *y);</span>
<a name="ln-9115"></a>   <span class="k">interface</span>
<a name="ln-9116"></a><span class="k">      subroutine </span><span class="n">getgp2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getgp2&#39;</span><span class="p">)</span>
<a name="ln-9117"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9118"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9119"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9120"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9121"></a>      <span class="k">end subroutine </span><span class="n">getgp2</span>
<a name="ln-9122"></a>   <span class="k">end interface</span>
<a name="ln-9123"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9124"></a><span class="c">! extern void sgetgp2(float *xs,float *ys);</span>
<a name="ln-9125"></a>   <span class="k">interface</span>
<a name="ln-9126"></a><span class="k">      subroutine </span><span class="n">sgetgp2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_sgetgp2&#39;</span><span class="p">)</span>
<a name="ln-9127"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9128"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9129"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9130"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9131"></a>      <span class="k">end subroutine </span><span class="n">sgetgp2</span>
<a name="ln-9132"></a>   <span class="k">end interface</span>
<a name="ln-9133"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9134"></a><span class="c">! ==========  routines for retrieving the aspect details of the device</span>
<a name="ln-9135"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9136"></a><span class="c">! extern float    getaspect(void);</span>
<a name="ln-9137"></a>   <span class="k">interface</span>
<a name="ln-9138"></a><span class="k">      function </span><span class="n">getaspect</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getaspect&#39;</span><span class="p">)</span>
<a name="ln-9139"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9140"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9141"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">getaspect</span>
<a name="ln-9142"></a>      <span class="k">end function </span><span class="n">getaspect</span>
<a name="ln-9143"></a>   <span class="k">end interface</span>
<a name="ln-9144"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9145"></a><span class="c">! extern void getfactors(float *x,float *y);</span>
<a name="ln-9146"></a>   <span class="k">interface</span>
<a name="ln-9147"></a><span class="k">      subroutine </span><span class="n">getfactors</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getfactors&#39;</span><span class="p">)</span>
<a name="ln-9148"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9149"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9150"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9151"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9152"></a>      <span class="k">end subroutine </span><span class="n">getfactors</span>
<a name="ln-9153"></a>   <span class="k">end interface</span>
<a name="ln-9154"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9155"></a><span class="c">! extern void getdisplaysize(float *x,float *y);</span>
<a name="ln-9156"></a>   <span class="k">interface</span>
<a name="ln-9157"></a><span class="k">      subroutine </span><span class="n">getdisplaysize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getdisplaysize&#39;</span><span class="p">)</span>
<a name="ln-9158"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9159"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9160"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9161"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9162"></a>      <span class="k">end subroutine </span><span class="n">getdisplaysize</span>
<a name="ln-9163"></a>   <span class="k">end interface</span>
<a name="ln-9164"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9165"></a><span class="c">! extern void expandviewport(void);</span>
<a name="ln-9166"></a>   <span class="k">interface</span>
<a name="ln-9167"></a><span class="k">      subroutine </span><span class="n">expandviewport</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_expandviewport&#39;</span><span class="p">)</span>
<a name="ln-9168"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9169"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9170"></a><span class="k">      end subroutine </span><span class="n">expandviewport</span>
<a name="ln-9171"></a>   <span class="k">end interface</span>
<a name="ln-9172"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9173"></a><span class="c">! extern void unexpandviewport(void);</span>
<a name="ln-9174"></a>   <span class="k">interface</span>
<a name="ln-9175"></a><span class="k">      subroutine </span><span class="n">unexpandviewport</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_unexpandviewport&#39;</span><span class="p">)</span>
<a name="ln-9176"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9177"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9178"></a><span class="k">      end subroutine </span><span class="n">unexpandviewport</span>
<a name="ln-9179"></a>   <span class="k">end interface</span>
<a name="ln-9180"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9181"></a><span class="c">! ==========  routines for handling the buffering</span>
<a name="ln-9182"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9183"></a><span class="c">! extern int      backbuffer(void);</span>
<a name="ln-9184"></a>   <span class="k">interface</span>
<a name="ln-9185"></a><span class="k">      function </span><span class="n">backbuffer</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_backbuffer&#39;</span><span class="p">)</span>
<a name="ln-9186"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9187"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9188"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">backbuffer</span>
<a name="ln-9189"></a>      <span class="k">end function </span><span class="n">backbuffer</span>
<a name="ln-9190"></a>   <span class="k">end interface</span>
<a name="ln-9191"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9192"></a><span class="c">! extern void frontbuffer(void);</span>
<a name="ln-9193"></a>   <span class="k">interface</span>
<a name="ln-9194"></a><span class="k">      subroutine </span><span class="n">frontbuffer</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_frontbuffer&#39;</span><span class="p">)</span>
<a name="ln-9195"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9196"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9197"></a><span class="k">      end subroutine </span><span class="n">frontbuffer</span>
<a name="ln-9198"></a>   <span class="k">end interface</span>
<a name="ln-9199"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9200"></a><span class="c">! extern int      swapbuffers(void);</span>
<a name="ln-9201"></a>   <span class="k">interface</span>
<a name="ln-9202"></a><span class="k">      subroutine </span><span class="n">swapbuffers</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_swapbuffers&#39;</span><span class="p">)</span>
<a name="ln-9203"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9204"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9205"></a><span class="k">      end subroutine </span><span class="n">swapbuffers</span>
<a name="ln-9206"></a>   <span class="k">end interface</span>
<a name="ln-9207"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9208"></a><span class="c">! ==========  routines for window sizing and positioning</span>
<a name="ln-9209"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9210"></a><span class="c">! void prefposition(int x, int y);</span>
<a name="ln-9211"></a>   <span class="k">interface</span>
<a name="ln-9212"></a><span class="k">      subroutine </span><span class="n">prefposition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_prefposition&#39;</span><span class="p">)</span>
<a name="ln-9213"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9214"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9215"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9216"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9217"></a>      <span class="k">end subroutine </span><span class="n">prefposition</span>
<a name="ln-9218"></a>   <span class="k">end interface</span>
<a name="ln-9219"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9220"></a><span class="c">! void prefsize(int x, int y);</span>
<a name="ln-9221"></a>   <span class="k">interface</span>
<a name="ln-9222"></a><span class="k">      subroutine </span><span class="n">prefsize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_prefsize&#39;</span><span class="p">)</span>
<a name="ln-9223"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9224"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9225"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9226"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9227"></a>      <span class="k">end subroutine </span><span class="n">prefsize</span>
<a name="ln-9228"></a>   <span class="k">end interface</span>
<a name="ln-9229"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9230"></a><span class="c">! void getprefposandsize(int *x, int *y, int *xs, int *ys);</span>
<a name="ln-9231"></a>   <span class="k">interface</span>
<a name="ln-9232"></a><span class="k">      subroutine </span><span class="n">getprefposandsize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">XS</span><span class="p">,</span><span class="n">YS</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getprefposandsize&#39;</span><span class="p">)</span>
<a name="ln-9233"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9234"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9235"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9236"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9237"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">XS</span>
<a name="ln-9238"></a>         <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">YS</span>
<a name="ln-9239"></a>      <span class="k">end subroutine </span><span class="n">getprefposandsize</span>
<a name="ln-9240"></a>   <span class="k">end interface</span>
<a name="ln-9241"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9242"></a><span class="c">! ==========  Misc control routines</span>
<a name="ln-9243"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9244"></a><span class="c">! extern void clipping(int onoff);</span>
<a name="ln-9245"></a>   <span class="k">interface</span>
<a name="ln-9246"></a><span class="k">      subroutine </span><span class="n">clipping_F</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_clipping&#39;</span><span class="p">)</span>
<a name="ln-9247"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9248"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9249"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9250"></a>      <span class="k">end subroutine </span><span class="n">clipping_F</span>
<a name="ln-9251"></a>   <span class="k">end interface</span>
<a name="ln-9252"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9253"></a><span class="c">! extern void vsetflush(int yn);</span>
<a name="ln-9254"></a>   <span class="k">interface</span>
<a name="ln-9255"></a><span class="k">      subroutine </span><span class="n">vsetflush_F</span><span class="p">(</span><span class="n">YN</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vsetflush&#39;</span><span class="p">)</span>
<a name="ln-9256"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9257"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9258"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YN</span>
<a name="ln-9259"></a>      <span class="k">end subroutine </span><span class="n">vsetflush_F</span>
<a name="ln-9260"></a>   <span class="k">end interface</span>
<a name="ln-9261"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9262"></a><span class="c">! extern void vflush(void);</span>
<a name="ln-9263"></a>   <span class="k">interface</span>
<a name="ln-9264"></a><span class="k">      subroutine </span><span class="n">vflush</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_vflush&#39;</span><span class="p">)</span>
<a name="ln-9265"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9266"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9267"></a><span class="k">      end subroutine </span><span class="n">vflush</span>
<a name="ln-9268"></a>   <span class="k">end interface</span>
<a name="ln-9269"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9270"></a><span class="c">! extern void clip(Vector p0, Vector p1);</span>
<a name="ln-9271"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9272"></a><span class="c">! extern void quickclip(Vector p0, Vector p1);</span>
<a name="ln-9273"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9274"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9275"></a><span class="c">! extern void yobbarays(int onoff);</span>
<a name="ln-9276"></a>   <span class="k">interface</span>
<a name="ln-9277"></a><span class="k">      subroutine </span><span class="n">yobbarays</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_yobbarays&#39;</span><span class="p">)</span>
<a name="ln-9278"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9279"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9280"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9281"></a>      <span class="k">end subroutine </span><span class="n">yobbarays</span>
<a name="ln-9282"></a>   <span class="k">end interface</span>
<a name="ln-9283"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9284"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9285"></a><span class="c">! extern void xcentertext(void);</span>
<a name="ln-9286"></a>   <span class="k">interface</span>
<a name="ln-9287"></a><span class="k">      subroutine </span><span class="n">xcentertext</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_xcentertext&#39;</span><span class="p">)</span>
<a name="ln-9288"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9289"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9290"></a><span class="k">      end subroutine </span><span class="n">xcentertext</span>
<a name="ln-9291"></a>   <span class="k">end interface</span>
<a name="ln-9292"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9293"></a><span class="c">! extern void ycentertext(void);</span>
<a name="ln-9294"></a>   <span class="k">interface</span>
<a name="ln-9295"></a><span class="k">      subroutine </span><span class="n">ycentertext</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_ycentertext&#39;</span><span class="p">)</span>
<a name="ln-9296"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9297"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9298"></a><span class="k">      end subroutine </span><span class="n">ycentertext</span>
<a name="ln-9299"></a>   <span class="k">end interface</span>
<a name="ln-9300"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9301"></a><span class="c">! extern void topjustify(void);</span>
<a name="ln-9302"></a>   <span class="k">interface</span>
<a name="ln-9303"></a><span class="k">      subroutine </span><span class="n">topjustify</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_topjustify&#39;</span><span class="p">)</span>
<a name="ln-9304"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9305"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9306"></a><span class="k">      end subroutine </span><span class="n">topjustify</span>
<a name="ln-9307"></a>   <span class="k">end interface</span>
<a name="ln-9308"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9309"></a><span class="c">! extern void bottomjustify(void);</span>
<a name="ln-9310"></a>   <span class="k">interface</span>
<a name="ln-9311"></a><span class="k">      subroutine </span><span class="n">bottomjustify</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_bottomjustify&#39;</span><span class="p">)</span>
<a name="ln-9312"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9313"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9314"></a><span class="k">      end subroutine </span><span class="n">bottomjustify</span>
<a name="ln-9315"></a>   <span class="k">end interface</span>
<a name="ln-9316"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9317"></a><span class="c">! extern void leftjustify(void);</span>
<a name="ln-9318"></a>   <span class="k">interface</span>
<a name="ln-9319"></a><span class="k">      subroutine </span><span class="n">leftjustify</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_leftjustify&#39;</span><span class="p">)</span>
<a name="ln-9320"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9321"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9322"></a><span class="k">      end subroutine </span><span class="n">leftjustify</span>
<a name="ln-9323"></a>   <span class="k">end interface</span>
<a name="ln-9324"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9325"></a><span class="c">! extern void rightjustify(void);</span>
<a name="ln-9326"></a>   <span class="k">interface</span>
<a name="ln-9327"></a><span class="k">      subroutine </span><span class="n">rightjustify</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_rightjustify&#39;</span><span class="p">)</span>
<a name="ln-9328"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9329"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9330"></a><span class="k">      end subroutine </span><span class="n">rightjustify</span>
<a name="ln-9331"></a>   <span class="k">end interface</span>
<a name="ln-9332"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9333"></a><span class="c">! extern void textjustify(unsigned val);</span>
<a name="ln-9334"></a><span class="c">! extern void textjustify(char val);</span>
<a name="ln-9335"></a>   <span class="k">interface</span>
<a name="ln-9336"></a><span class="k">      subroutine </span><span class="n">textjustify</span><span class="p">(</span><span class="n">VAL</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_textjustify&#39;</span><span class="p">)</span>
<a name="ln-9337"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9338"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9339"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VAL</span>
<a name="ln-9340"></a>      <span class="k">end subroutine </span><span class="n">textjustify</span>
<a name="ln-9341"></a>   <span class="k">end interface</span>
<a name="ln-9342"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9343"></a><span class="c">! extern void textslant(float val);</span>
<a name="ln-9344"></a>   <span class="k">interface</span>
<a name="ln-9345"></a><span class="k">      subroutine </span><span class="n">textslant</span><span class="p">(</span><span class="n">VAL</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_textslant&#39;</span><span class="p">)</span>
<a name="ln-9346"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9347"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9348"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VAL</span>
<a name="ln-9349"></a>      <span class="k">end subroutine </span><span class="n">textslant</span>
<a name="ln-9350"></a>   <span class="k">end interface</span>
<a name="ln-9351"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9352"></a><span class="c">! extern void textweight(int val);</span>
<a name="ln-9353"></a>   <span class="k">interface</span>
<a name="ln-9354"></a><span class="k">      subroutine </span><span class="n">textweight</span><span class="p">(</span><span class="n">VAL</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_textweight&#39;</span><span class="p">)</span>
<a name="ln-9355"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9356"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9357"></a><span class="k">         </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">VAL</span>
<a name="ln-9358"></a>      <span class="k">end subroutine </span><span class="n">textweight</span>
<a name="ln-9359"></a>   <span class="k">end interface</span>
<a name="ln-9360"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9361"></a><span class="c">! ==========  matrix stack routines</span>
<a name="ln-9362"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9363"></a><span class="c">! extern void popmatrix(void);</span>
<a name="ln-9364"></a>   <span class="k">interface</span>
<a name="ln-9365"></a><span class="k">      subroutine </span><span class="n">popmatrix</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_popmatrix&#39;</span><span class="p">)</span>
<a name="ln-9366"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9367"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9368"></a><span class="k">      end subroutine </span><span class="n">popmatrix</span>
<a name="ln-9369"></a>   <span class="k">end interface</span>
<a name="ln-9370"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9371"></a><span class="c">! extern void pushmatrix(void);</span>
<a name="ln-9372"></a>   <span class="k">interface</span>
<a name="ln-9373"></a><span class="k">      subroutine </span><span class="n">pushmatrix</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_pushmatrix&#39;</span><span class="p">)</span>
<a name="ln-9374"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9375"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9376"></a><span class="k">      end subroutine </span><span class="n">pushmatrix</span>
<a name="ln-9377"></a>   <span class="k">end interface</span>
<a name="ln-9378"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9379"></a><span class="c">! ==========  matrix stack routines</span>
<a name="ln-9380"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9381"></a><span class="c">! extern void getmatrix_F(Matrix m);</span>
<a name="ln-9382"></a>   <span class="k">interface</span>
<a name="ln-9383"></a><span class="k">      subroutine </span><span class="n">getmatrix_F</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_getmatrix&#39;</span><span class="p">)</span>
<a name="ln-9384"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9385"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9386"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9387"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9388"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-9389"></a>         <span class="c">!real(KIND=C_FLOAT),intent(out),dimension(4,4) :: M</span>
<a name="ln-9390"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9391"></a>      <span class="k">end subroutine </span><span class="n">getmatrix_F</span>
<a name="ln-9392"></a>   <span class="k">end interface</span>
<a name="ln-9393"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9394"></a><span class="c">! extern void loadmatrix_F(Matrix mat);</span>
<a name="ln-9395"></a>   <span class="k">interface</span>
<a name="ln-9396"></a><span class="k">      subroutine </span><span class="n">loadmatrix_F</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_loadmatrix&#39;</span><span class="p">)</span>
<a name="ln-9397"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9398"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9399"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9400"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9401"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-9402"></a>         <span class="c">!real(KIND=C_FLOAT),intent(in),dimension(4,4) :: M</span>
<a name="ln-9403"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9404"></a>      <span class="k">end subroutine </span><span class="n">loadmatrix_F</span>
<a name="ln-9405"></a>   <span class="k">end interface</span>
<a name="ln-9406"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9407"></a><span class="c">! extern void multmatrix_F(Matrix mat);</span>
<a name="ln-9408"></a>   <span class="k">interface</span>
<a name="ln-9409"></a><span class="k">      subroutine </span><span class="n">multmatrix_F</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_multmatrix&#39;</span><span class="p">)</span>
<a name="ln-9410"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9411"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9412"></a><span class="k">         type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9413"></a>            <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9414"></a><span class="k">         end type </span><span class="n">MATRIX</span>
<a name="ln-9415"></a>         <span class="c">!real(KIND=C_FLOAT),intent(inout),dimension(4,4) :: M</span>
<a name="ln-9416"></a>         <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9417"></a>      <span class="k">end subroutine </span><span class="n">multmatrix_F</span>
<a name="ln-9418"></a>   <span class="k">end interface</span>
<a name="ln-9419"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9420"></a><span class="c">! extern void printmat(char *s, Matrix m);</span>
<a name="ln-9421"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9422"></a><span class="c">! extern void printvect(char *s, Vector v);</span>
<a name="ln-9423"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9424"></a><span class="c">! ==========  object routines</span>
<a name="ln-9425"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9426"></a><span class="c">! extern Token  *newtokens(int num);</span>
<a name="ln-9427"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9428"></a><span class="c">! extern void polyobj(int n, Token dp[]);</span>
<a name="ln-9429"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9430"></a><span class="c">! ==========  tensor routines</span>
<a name="ln-9431"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9432"></a><span class="c">! extern void premulttensor(Tensor c, Matrix a,Tensor  b) ;</span>
<a name="ln-9433"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9434"></a><span class="c">! extern void multtensor(Tensor c, Matrix a,Tensor  b) ;</span>
<a name="ln-9435"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9436"></a><span class="c">! extern void copytensor(Tensor b, Tensor a) ;</span>
<a name="ln-9437"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9438"></a><span class="c">! extern void copytensortrans(Tensor b,Tensor  a) ;</span>
<a name="ln-9439"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9440"></a><span class="c">! ==========  mapping routines</span>
<a name="ln-9441"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9442"></a><span class="c">! extern int WtoVx( float p[]);</span>
<a name="ln-9443"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9444"></a><span class="c">! extern int WtoVy( float p[]);</span>
<a name="ln-9445"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9446"></a><span class="c">! extern void VtoWxy( float xs, float ys, float  *xw, float *yw);</span>
<a name="ln-9447"></a>   <span class="k">interface</span>
<a name="ln-9448"></a><span class="k">      subroutine </span><span class="n">VtoWxy</span><span class="p">(</span><span class="n">XS</span><span class="p">,</span><span class="n">YS</span><span class="p">,</span><span class="n">XW</span><span class="p">,</span><span class="n">YW</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_VtoWxy&#39;</span><span class="p">)</span>
<a name="ln-9449"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9450"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9451"></a><span class="k">         </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">XS</span>
<a name="ln-9452"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">value</span> <span class="kd">::</span> <span class="n">YS</span>
<a name="ln-9453"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">XW</span>
<a name="ln-9454"></a>         <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">YW</span>
<a name="ln-9455"></a>      <span class="k">end subroutine </span><span class="n">VtoWxy</span>
<a name="ln-9456"></a>   <span class="k">end interface</span>
<a name="ln-9457"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9458"></a><span class="c">! extern void CalcW2Vcoeffs(void);</span>
<a name="ln-9459"></a>   <span class="k">interface</span>
<a name="ln-9460"></a><span class="k">      subroutine </span><span class="n">CalcW2Vcoeffs</span><span class="p">()</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_CalcW2Vcoeffs&#39;</span><span class="p">)</span>
<a name="ln-9461"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9462"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9463"></a><span class="k">      end subroutine </span><span class="n">CalcW2Vcoeffs</span>
<a name="ln-9464"></a>   <span class="k">end interface</span>
<a name="ln-9465"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9466"></a><span class="c">! ==========  general matrix and vector routines</span>
<a name="ln-9467"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9468"></a><span class="c">! extern void mult4x4(register Matrix a, register Matrix b, register Matrix c);</span>
<a name="ln-9469"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9470"></a><span class="c">! extern void copymatrix(register Matrix a, register Matrix b);</span>
<a name="ln-9471"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9472"></a><span class="c">! extern void identmatrix(Matrix a);</span>
<a name="ln-9473"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9474"></a><span class="c">! extern void copyvector(register Vector a, register Vector b);</span>
<a name="ln-9475"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9476"></a><span class="c">! extern void premultvector(Vector v, Vector a, Matrix b);</span>
<a name="ln-9477"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9478"></a><span class="c">! extern void copytranspose(register Matrix a, register Matrix b);</span>
<a name="ln-9479"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9480"></a><span class="c">! extern void multvector(Vector v, Vector a, Matrix b);</span>
<a name="ln-9481"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9482"></a><span class="c">! ==========  other internal routines</span>
<a name="ln-9483"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9484"></a><span class="c">! extern void verror(char *str);</span>
<a name="ln-9485"></a>   <span class="k">interface</span>
<a name="ln-9486"></a><span class="k">      subroutine </span><span class="n">verror_F</span><span class="p">(</span><span class="n">STR</span><span class="p">)</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">NAME</span><span class="o">=</span><span class="s1">&#39;draw_verror&#39;</span><span class="p">)</span>
<a name="ln-9487"></a>         <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9488"></a><span class="nb">         </span><span class="k">implicit none</span>
<a name="ln-9489"></a><span class="k">         </span><span class="kt">character</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">STR</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-9490"></a>      <span class="k">end subroutine </span><span class="n">verror_F</span>
<a name="ln-9491"></a>   <span class="k">end interface</span>
<a name="ln-9492"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9493"></a><span class="c">! extern int    hershfont(char *fontname);</span>
<a name="ln-9494"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9495"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9496"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9497"></a><span class="c">! extensions in Fortran</span>
<a name="ln-9498"></a>
<a name="ln-9499"></a><span class="k">public</span>  <span class="kd">::</span> <span class="n">page</span>
<a name="ln-9500"></a><span class="k">public</span>  <span class="kd">::</span> <span class="n">invokeobj</span>
<a name="ln-9501"></a><span class="k">public</span>  <span class="kd">::</span> <span class="n">pop</span>
<a name="ln-9502"></a><span class="k">public</span>  <span class="kd">::</span> <span class="n">push</span>
<a name="ln-9503"></a><span class="k">public</span>  <span class="kd">::</span> <span class="k">print</span>
<a name="ln-9504"></a>
<a name="ln-9505"></a><span class="k">interface </span><span class="n">page</span>
<a name="ln-9506"></a>   <span class="k">module procedure</span> <span class="kd">::</span> <span class="n">biggest_ortho2</span>
<a name="ln-9507"></a>   <span class="k">module procedure</span> <span class="kd">::</span> <span class="n">page_rri</span>
<a name="ln-9508"></a><span class="k">end interface </span><span class="n">page</span>
<a name="ln-9509"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9510"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9511"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9512"></a><span class="k">contains</span>
<a name="ln-9513"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9514"></a><span class="c">!!call polyfill(.false.)</span>
<a name="ln-9515"></a> <span class="k">subroutine </span><span class="n">polyfill</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9516"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9517"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9518"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9519"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9520"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9521"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9522"></a>   <span class="k">else</span>
<a name="ln-9523"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9524"></a>   <span class="k">endif</span>
<a name="ln-9525"></a><span class="k">   call </span><span class="n">polyfill_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9526"></a><span class="k">end subroutine </span><span class="n">polyfill</span>
<a name="ln-9527"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9528"></a><span class="c">!!call backface(.false.)</span>
<a name="ln-9529"></a> <span class="k">subroutine </span><span class="n">backface</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9530"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9531"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9532"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9533"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9534"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9535"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9536"></a>   <span class="k">else</span>
<a name="ln-9537"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9538"></a>   <span class="k">endif</span>
<a name="ln-9539"></a><span class="k">   call </span><span class="n">backface_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9540"></a><span class="k">end subroutine </span><span class="n">backface</span>
<a name="ln-9541"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9542"></a><span class="c">!!call backfacedir(.false.)</span>
<a name="ln-9543"></a> <span class="k">subroutine </span><span class="n">backfacedir</span><span class="p">(</span><span class="n">CDIR</span><span class="p">)</span>
<a name="ln-9544"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9545"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9546"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CDIR</span>
<a name="ln-9547"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ICDIR</span>
<a name="ln-9548"></a>   <span class="k">if</span><span class="p">(</span><span class="n">CDIR</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9549"></a><span class="k">      </span><span class="n">ICDIR</span><span class="o">=</span><span class="mi">1</span> <span class="c">! CLOCKWISE (IN SCREEN COORDS)</span>
<a name="ln-9550"></a>   <span class="k">else</span>
<a name="ln-9551"></a><span class="k">      </span><span class="n">ICDIR</span><span class="o">=</span><span class="mi">0</span> <span class="c">! ANTICLOCKWISE</span>
<a name="ln-9552"></a>   <span class="k">endif</span>
<a name="ln-9553"></a><span class="k">   call </span><span class="n">backfacedir_F</span><span class="p">(</span><span class="n">ICDIR</span><span class="p">)</span>
<a name="ln-9554"></a><span class="k">end subroutine </span><span class="n">backfacedir</span>
<a name="ln-9555"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9556"></a><span class="c">!!call centertext(.false.)</span>
<a name="ln-9557"></a> <span class="k">subroutine </span><span class="n">centertext</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9558"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9559"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9560"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9561"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9562"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9563"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9564"></a>   <span class="k">else</span>
<a name="ln-9565"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9566"></a>   <span class="k">endif</span>
<a name="ln-9567"></a><span class="k">   call </span><span class="n">centertext_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9568"></a><span class="k">end subroutine </span><span class="n">centertext</span>
<a name="ln-9569"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9570"></a><span class="c">!!call clipping(.false.)</span>
<a name="ln-9571"></a> <span class="k">subroutine </span><span class="n">clipping</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9572"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9573"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9574"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9575"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9576"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9577"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9578"></a>   <span class="k">else</span>
<a name="ln-9579"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9580"></a>   <span class="k">endif</span>
<a name="ln-9581"></a><span class="k">   call </span><span class="n">clipping_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9582"></a><span class="k">end subroutine </span><span class="n">clipping</span>
<a name="ln-9583"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9584"></a><span class="c">!!call fixedwidth(.false.)</span>
<a name="ln-9585"></a> <span class="k">subroutine </span><span class="n">fixedwidth</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9586"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9587"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9588"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9589"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9590"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9591"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9592"></a>   <span class="k">else</span>
<a name="ln-9593"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9594"></a>   <span class="k">endif</span>
<a name="ln-9595"></a><span class="k">   call </span><span class="n">fixedwidth_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9596"></a><span class="k">end subroutine </span><span class="n">fixedwidth</span>
<a name="ln-9597"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9598"></a><span class="c">!!call polyhatch(.false.)</span>
<a name="ln-9599"></a> <span class="k">subroutine </span><span class="n">polyhatch</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9600"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9601"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9602"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9603"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9604"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9605"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9606"></a>   <span class="k">else</span>
<a name="ln-9607"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9608"></a>   <span class="k">endif</span>
<a name="ln-9609"></a><span class="k">   call </span><span class="n">polyhatch_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9610"></a><span class="k">end subroutine </span><span class="n">polyhatch</span>
<a name="ln-9611"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9612"></a><span class="c">!!vsetflush(.false.)</span>
<a name="ln-9613"></a> <span class="k">subroutine </span><span class="n">vsetflush</span><span class="p">(</span><span class="n">ONOFF</span><span class="p">)</span>
<a name="ln-9614"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9615"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9616"></a><span class="k">   </span><span class="kt">logical</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ONOFF</span>
<a name="ln-9617"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IONOFF</span>
<a name="ln-9618"></a>   <span class="k">if</span><span class="p">(</span><span class="n">ONOFF</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="k">then</span>
<a name="ln-9619"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">1</span> <span class="c">! ON</span>
<a name="ln-9620"></a>   <span class="k">else</span>
<a name="ln-9621"></a><span class="k">      </span><span class="n">IONOFF</span><span class="o">=</span><span class="mi">0</span> <span class="c">! OFF</span>
<a name="ln-9622"></a>   <span class="k">endif</span>
<a name="ln-9623"></a><span class="k">   call </span><span class="n">vsetflush_F</span><span class="p">(</span><span class="n">IONOFF</span><span class="p">)</span>
<a name="ln-9624"></a><span class="k">end subroutine </span><span class="n">vsetflush</span>
<a name="ln-9625"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9626"></a> <span class="k">function </span><span class="n">isobj</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-9627"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9628"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9629"></a><span class="k">   </span><span class="kt">logical</span> <span class="kd">::</span> <span class="n">isobj</span>
<a name="ln-9630"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-9631"></a>   <span class="k">if</span><span class="p">(</span><span class="n">isobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span><span class="k">then</span>
<a name="ln-9632"></a><span class="k">      </span><span class="n">isobj</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9633"></a>   <span class="k">else</span>
<a name="ln-9634"></a><span class="k">      </span><span class="n">isobj</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-9635"></a>   <span class="k">endif</span>
<a name="ln-9636"></a><span class="k">end function </span><span class="n">isobj</span>
<a name="ln-9637"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9638"></a> <span class="k">subroutine </span><span class="n">font</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9639"></a>   <span class="k">implicit none</span>
<a name="ln-9640"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9641"></a>   <span class="k">call </span><span class="n">font_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9642"></a> <span class="k">end subroutine </span><span class="n">font</span>
<a name="ln-9643"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9644"></a> <span class="k">subroutine </span><span class="n">linestyle</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9645"></a>   <span class="k">implicit none</span>
<a name="ln-9646"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9647"></a>   <span class="k">call </span><span class="n">linestyle_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9648"></a> <span class="k">end subroutine </span><span class="n">linestyle</span>
<a name="ln-9649"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9650"></a> <span class="k">subroutine </span><span class="n">printvdevice</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<a name="ln-9651"></a>   <span class="k">implicit none</span>
<a name="ln-9652"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span>
<a name="ln-9653"></a>   <span class="k">call </span><span class="n">printvdevice_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<a name="ln-9654"></a> <span class="k">end subroutine </span><span class="n">printvdevice</span>
<a name="ln-9655"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9656"></a> <span class="k">subroutine </span><span class="n">printattribs</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<a name="ln-9657"></a>   <span class="k">implicit none</span>
<a name="ln-9658"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">S</span>
<a name="ln-9659"></a>   <span class="k">call </span><span class="n">printattribs_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<a name="ln-9660"></a> <span class="k">end subroutine </span><span class="n">printattribs</span>
<a name="ln-9661"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9662"></a> <span class="k">subroutine </span><span class="n">vinit</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9663"></a>   <span class="k">implicit none</span>
<a name="ln-9664"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9665"></a>   <span class="k">call </span><span class="n">vinit_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9666"></a> <span class="k">end subroutine </span><span class="n">vinit</span>
<a name="ln-9667"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9668"></a> <span class="k">subroutine </span><span class="n">voutput</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9669"></a>   <span class="k">implicit none</span>
<a name="ln-9670"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9671"></a>   <span class="k">call </span><span class="n">voutput_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9672"></a> <span class="k">end subroutine </span><span class="n">voutput</span>
<a name="ln-9673"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9674"></a> <span class="k">subroutine </span><span class="n">vnewdev</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9675"></a>   <span class="k">implicit none</span>
<a name="ln-9676"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9677"></a>   <span class="k">call </span><span class="n">vnewdev_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9678"></a> <span class="k">end subroutine </span><span class="n">vnewdev</span>
<a name="ln-9679"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9680"></a> <span class="k">subroutine </span><span class="n">pushdev</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9681"></a>   <span class="k">implicit none</span>
<a name="ln-9682"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9683"></a>   <span class="k">call </span><span class="n">pushdev_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9684"></a> <span class="k">end subroutine </span><span class="n">pushdev</span>
<a name="ln-9685"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9686"></a> <span class="k">subroutine </span><span class="n">vgetdev</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9687"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9688"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9689"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9690"></a>   <span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">i</span>
<a name="ln-9691"></a>   <span class="n">NAME</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-9692"></a>   <span class="n">i</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9693"></a>   <span class="n">NAME</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">char</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9694"></a>   <span class="k">call </span><span class="n">vgetdev_F</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9695"></a>   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>  <span class="c">! convert nulls to spaces in returned value</span>
<a name="ln-9696"></a>      <span class="k">if</span><span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="nb">char</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="k">then</span>
<a name="ln-9697"></a><span class="k">         </span><span class="n">NAME</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-9698"></a>      <span class="k">endif</span>
<a name="ln-9699"></a><span class="k">   enddo</span>
<a name="ln-9700"></a><span class="k">end subroutine </span><span class="n">vgetdev</span>
<a name="ln-9701"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9702"></a> <span class="k">subroutine </span><span class="n">loadobj</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="k">FILE</span><span class="p">)</span>
<a name="ln-9703"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9704"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9705"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">FILE</span>
<a name="ln-9706"></a><span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">N</span>
<a name="ln-9707"></a>   <span class="k">call </span><span class="n">loadobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">s2c</span><span class="p">(</span><span class="k">FILE</span><span class="p">))</span>
<a name="ln-9708"></a> <span class="k">end subroutine </span><span class="n">loadobj</span>
<a name="ln-9709"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9710"></a> <span class="k">subroutine </span><span class="n">saveobj</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="k">FILE</span><span class="p">)</span>
<a name="ln-9711"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9712"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9713"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="k">FILE</span>
<a name="ln-9714"></a><span class="k">   </span><span class="kt">integer</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_INT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">N</span>
<a name="ln-9715"></a>   <span class="k">call </span><span class="n">saveobj_F</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">s2c</span><span class="p">(</span><span class="k">FILE</span><span class="p">))</span>
<a name="ln-9716"></a> <span class="k">end subroutine </span><span class="n">saveobj</span>
<a name="ln-9717"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9718"></a> <span class="k">function </span><span class="n">strlength</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9719"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9720"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9721"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9722"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">strlength</span>
<a name="ln-9723"></a>   <span class="n">strlength</span><span class="o">=</span><span class="n">strlength_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9724"></a> <span class="k">end function </span><span class="n">strlength</span>
<a name="ln-9725"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9726"></a> <span class="k">subroutine </span><span class="n">boxtext</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">)</span>
<a name="ln-9727"></a>   <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9728"></a><span class="nb">   </span><span class="k">implicit none</span>
<a name="ln-9729"></a><span class="k">   </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">X</span>
<a name="ln-9730"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Y</span>
<a name="ln-9731"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">L</span>
<a name="ln-9732"></a>   <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">H</span>
<a name="ln-9733"></a>   <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">S</span>
<a name="ln-9734"></a>   <span class="k">call </span><span class="n">boxtext_F</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">s2c</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>
<a name="ln-9735"></a><span class="k">end subroutine </span><span class="n">boxtext</span>
<a name="ln-9736"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9737"></a> <span class="k">subroutine </span><span class="n">drawstr</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9738"></a>   <span class="k">implicit none</span>
<a name="ln-9739"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9740"></a>   <span class="k">call </span><span class="n">drawstr_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9741"></a> <span class="k">end subroutine </span><span class="n">drawstr</span>
<a name="ln-9742"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9743"></a> <span class="k">subroutine </span><span class="n">drawchar</span><span class="p">(</span><span class="n">NAME</span><span class="p">)</span>
<a name="ln-9744"></a><span class="c">! issues between int and character and character string</span>
<a name="ln-9745"></a><span class="c">! make it easier to call drawstr()</span>
<a name="ln-9746"></a><span class="c">! maybe when ISO_C_BINDING has been around longer this can be eliminated</span>
<a name="ln-9747"></a><span class="c">! and change drawstr_F back to drawstr</span>
<a name="ln-9748"></a>   <span class="k">implicit none</span>
<a name="ln-9749"></a><span class="k">   </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NAME</span>
<a name="ln-9750"></a>   <span class="k">call </span><span class="n">drawstr_F</span><span class="p">(</span><span class="n">s2c</span><span class="p">(</span><span class="n">NAME</span><span class="p">))</span>
<a name="ln-9751"></a> <span class="k">end subroutine </span><span class="n">drawchar</span>
<a name="ln-9752"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9753"></a><span class="c">!subroutine verror(STR)</span>
<a name="ln-9754"></a><span class="c">!   implicit none</span>
<a name="ln-9755"></a><span class="c">!   character(len=*),intent(in) :: STR</span>
<a name="ln-9756"></a><span class="c">!   call verror_F(s2c(STR))</span>
<a name="ln-9757"></a><span class="c">! end subroutine verror</span>
<a name="ln-9758"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9759"></a><span class="c">! so fortran 77 does not have to have TYPE matrix</span>
<a name="ln-9760"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9761"></a> <span class="k">subroutine </span><span class="n">rcurve</span><span class="p">(</span><span class="n">GEOM</span><span class="p">)</span>
<a name="ln-9762"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9763"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9764"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9765"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9766"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9767"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOM</span>
<a name="ln-9768"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOM_matrix</span>
<a name="ln-9769"></a>    <span class="n">GEOM_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">geom</span>
<a name="ln-9770"></a>    <span class="k">call </span><span class="n">rcurve_F</span><span class="p">(</span><span class="n">geom_matrix</span><span class="p">)</span>
<a name="ln-9771"></a> <span class="k">end subroutine </span><span class="n">rcurve</span>
<a name="ln-9772"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9773"></a> <span class="k">subroutine </span><span class="n">curvebasis</span><span class="p">(</span><span class="n">BASIS</span><span class="p">)</span>
<a name="ln-9774"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9775"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9776"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9777"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9778"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9779"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BASIS</span>
<a name="ln-9780"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">basis_matrix</span>
<a name="ln-9781"></a>    <span class="n">basis_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">basis</span>
<a name="ln-9782"></a>    <span class="k">call </span><span class="n">curvebasis_F</span><span class="p">(</span><span class="n">basis_matrix</span><span class="p">)</span>
<a name="ln-9783"></a> <span class="k">end subroutine </span><span class="n">curvebasis</span>
<a name="ln-9784"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9785"></a> <span class="k">subroutine </span><span class="n">patch</span><span class="p">(</span><span class="n">GEOMX</span><span class="p">,</span><span class="n">GEOMY</span><span class="p">,</span><span class="n">GEOMZ</span><span class="p">)</span>
<a name="ln-9786"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9787"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9788"></a><span class="k">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMX</span>
<a name="ln-9789"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMY</span>
<a name="ln-9790"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMZ</span>
<a name="ln-9791"></a>    <span class="k">type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9792"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9793"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9794"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMX_matrix</span>
<a name="ln-9795"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMY_matrix</span>
<a name="ln-9796"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GEOMZ_matrix</span>
<a name="ln-9797"></a>    <span class="n">geomx_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">geomx</span>
<a name="ln-9798"></a>    <span class="n">geomy_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">geomy</span>
<a name="ln-9799"></a>    <span class="n">geomz_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">geomz</span>
<a name="ln-9800"></a>    <span class="k">call </span><span class="n">patch_F</span><span class="p">(</span><span class="n">geomx_matrix</span><span class="p">,</span><span class="n">geomy_matrix</span><span class="p">,</span><span class="n">geomz_matrix</span><span class="p">)</span>
<a name="ln-9801"></a> <span class="k">end subroutine </span><span class="n">patch</span>
<a name="ln-9802"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9803"></a>  <span class="k">subroutine </span><span class="n">patchbasis</span><span class="p">(</span><span class="n">TB</span><span class="p">,</span><span class="n">UB</span><span class="p">)</span>
<a name="ln-9804"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9805"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9806"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9807"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9808"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9809"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TB</span>
<a name="ln-9810"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UB</span>
<a name="ln-9811"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TB_matrix</span>
<a name="ln-9812"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">UB_matrix</span>
<a name="ln-9813"></a>    <span class="n">tb_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">tb</span>
<a name="ln-9814"></a>    <span class="n">ub_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">ub</span>
<a name="ln-9815"></a>    <span class="k">call </span><span class="n">patchbasis_F</span><span class="p">(</span><span class="n">tb_matrix</span><span class="p">,</span><span class="n">ub_matrix</span><span class="p">)</span>
<a name="ln-9816"></a> <span class="k">end subroutine </span><span class="n">patchbasis</span>
<a name="ln-9817"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9818"></a> <span class="k">subroutine </span><span class="n">getmatrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-9819"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9820"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9821"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9822"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9823"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9824"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9825"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M_matrix</span>
<a name="ln-9826"></a>    <span class="k">call </span><span class="n">getmatrix_F</span><span class="p">(</span><span class="n">m_matrix</span><span class="p">)</span>
<a name="ln-9827"></a>    <span class="n">M</span><span class="o">=</span><span class="n">M_matrix</span><span class="p">%</span><span class="k">array</span>
<a name="ln-9828"></a><span class="k"> end subroutine </span><span class="n">getmatrix</span>
<a name="ln-9829"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9830"></a>  <span class="k">subroutine </span><span class="n">loadmatrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-9831"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9832"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9833"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9834"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9835"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9836"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9837"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M_matrix</span>
<a name="ln-9838"></a>    <span class="n">M_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">M</span>
<a name="ln-9839"></a>    <span class="k">call </span><span class="n">loadmatrix_F</span><span class="p">(</span><span class="n">m_matrix</span><span class="p">)</span>
<a name="ln-9840"></a> <span class="k">end subroutine </span><span class="n">loadmatrix</span>
<a name="ln-9841"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9842"></a>  <span class="k">subroutine </span><span class="n">multmatrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-9843"></a>    <span class="k">use </span><span class="nb">ISO_C_BINDING</span>
<a name="ln-9844"></a><span class="nb">    </span><span class="k">implicit none</span>
<a name="ln-9845"></a><span class="k">    type</span><span class="p">,</span> <span class="k">bind</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MATRIX</span>
<a name="ln-9846"></a>       <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="k">ARRAY</span>
<a name="ln-9847"></a><span class="k">    end type </span><span class="n">MATRIX</span>
<a name="ln-9848"></a>    <span class="kt">real</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="kt">C_FLOAT</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M</span>
<a name="ln-9849"></a>    <span class="k">type</span><span class="p">(</span><span class="n">MATRIX</span><span class="p">)</span> <span class="kd">::</span> <span class="n">M_matrix</span>
<a name="ln-9850"></a>    <span class="n">M_matrix</span><span class="p">%</span><span class="k">array</span><span class="o">=</span><span class="n">M</span>
<a name="ln-9851"></a>    <span class="k">call </span><span class="n">multmatrix_F</span><span class="p">(</span><span class="n">m_matrix</span><span class="p">)</span>
<a name="ln-9852"></a> <span class="k">end subroutine </span><span class="n">multmatrix</span>
<a name="ln-9853"></a><span class="c">!-------------------------------------------------------------------------------</span>
<a name="ln-9854"></a><span class="k">pure function </span><span class="n">s2c</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>  <span class="k">RESULT</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span>
<a name="ln-9855"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">parameter</span>      <span class="kd">::</span> <span class="n">ident</span><span class="o">=</span><span class="s2">&quot;@(#)s2c(3fp):copy string(1:Clen(string)) to char array with null terminator&quot;</span>
<a name="ln-9856"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">string</span>
<a name="ln-9857"></a>   <span class="kt">character</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="kt">C_CHAR</span><span class="p">,</span><span class="nb">len</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="k">array</span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9858"></a>   <span class="kt">integer</span>                      <span class="kd">::</span> <span class="n">i</span>
<a name="ln-9859"></a>   <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-9860"></a>      <span class="k">array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span>
<a name="ln-9861"></a>   <span class="k">enddo</span>
<a name="ln-9862"></a><span class="k">   array</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="k">array</span><span class="p">):)</span><span class="o">=</span><span class="nb">achar</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-9863"></a><span class="k">end function </span><span class="n">s2c</span>
<a name="ln-9864"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9865"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9866"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9867"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9868"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9869"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9870"></a><span class="c">!&gt;</span>
<a name="ln-9871"></a><span class="c">!!##NAME</span>
<a name="ln-9872"></a><span class="c">!!    invokeobj(3f) - [M_draw] invoke object with specified transformations</span>
<a name="ln-9873"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-9874"></a><span class="c">!!</span>
<a name="ln-9875"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-9876"></a><span class="c">!!</span>
<a name="ln-9877"></a><span class="c">!!    subroutine invokeobj(xt,yt,zt,xs,ys,zs,xr,yr,zr,iobject)</span>
<a name="ln-9878"></a><span class="c">!!</span>
<a name="ln-9879"></a><span class="c">!!     real,intent(in)    :: xt,yt,zt</span>
<a name="ln-9880"></a><span class="c">!!     real,intent(in)    :: xs,ys,zs</span>
<a name="ln-9881"></a><span class="c">!!     real,intent(in)    :: xr,yr,zr</span>
<a name="ln-9882"></a><span class="c">!!     integer,intent(in) :: iobject</span>
<a name="ln-9883"></a><span class="c">!!</span>
<a name="ln-9884"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-9885"></a><span class="c">!!    save and restore the coordinate system while invoking an object with</span>
<a name="ln-9886"></a><span class="c">!!    specified translation, rotation, and scaling.</span>
<a name="ln-9887"></a><span class="c">!!</span>
<a name="ln-9888"></a><span class="c">!!##OPTIONS</span>
<a name="ln-9889"></a><span class="c">!!    xt,yt,zt    linear transforms</span>
<a name="ln-9890"></a><span class="c">!!    xs,ys,zs    scaling</span>
<a name="ln-9891"></a><span class="c">!!    xr,yr,zr    rotation in degrees</span>
<a name="ln-9892"></a><span class="c">!!    iobject     object to invoke</span>
<a name="ln-9893"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-9894"></a><span class="c">!!</span>
<a name="ln-9895"></a><span class="c">!!  Sample program</span>
<a name="ln-9896"></a><span class="c">!!</span>
<a name="ln-9897"></a><span class="c">!!    program demo_invokeobj</span>
<a name="ln-9898"></a><span class="c">!!    use M_draw</span>
<a name="ln-9899"></a><span class="c">!!    implicit none</span>
<a name="ln-9900"></a><span class="c">!!    real :: a, angle, step</span>
<a name="ln-9901"></a><span class="c">!!    integer :: i, idum</span>
<a name="ln-9902"></a><span class="c">!!    ! set window size</span>
<a name="ln-9903"></a><span class="c">!!       call prefsize(700,700)</span>
<a name="ln-9904"></a><span class="c">!!       call prefposition( 0, 0)</span>
<a name="ln-9905"></a><span class="c">!!       call vinit (&#39;X11&#39;)</span>
<a name="ln-9906"></a><span class="c">!!       a=1.0</span>
<a name="ln-9907"></a><span class="c">!!    ! make an object to draw ( a disk with an arrow on it)</span>
<a name="ln-9908"></a><span class="c">!!       call makeobj(12345)</span>
<a name="ln-9909"></a><span class="c">!!       call polyfill(.TRUE.)</span>
<a name="ln-9910"></a><span class="c">!!       call color( 5)</span>
<a name="ln-9911"></a><span class="c">!!       call circle( 0.0, 0.0, a)</span>
<a name="ln-9912"></a><span class="c">!!       call color( 3)</span>
<a name="ln-9913"></a><span class="c">!!       call makepoly()</span>
<a name="ln-9914"></a><span class="c">!!       call move2( 0.00*a, 0.80*a)</span>
<a name="ln-9915"></a><span class="c">!!       call draw2( 0.50*a, 0.30*a)</span>
<a name="ln-9916"></a><span class="c">!!       call draw2( 0.20*a, 0.30*a)</span>
<a name="ln-9917"></a><span class="c">!!       call draw2( 0.20*a,-0.80*a)</span>
<a name="ln-9918"></a><span class="c">!!       call draw2(-0.20*a,-0.80*a)</span>
<a name="ln-9919"></a><span class="c">!!       call draw2(-0.20*a, 0.30*a)</span>
<a name="ln-9920"></a><span class="c">!!       call draw2(-0.50*a, 0.30*a)</span>
<a name="ln-9921"></a><span class="c">!!       call draw2( 0.00*a, 0.80*a)</span>
<a name="ln-9922"></a><span class="c">!!       call closepoly()</span>
<a name="ln-9923"></a><span class="c">!!       call polyfill(.FALSE.)</span>
<a name="ln-9924"></a><span class="c">!!       call color(7)</span>
<a name="ln-9925"></a><span class="c">!!       call linewidth(20)</span>
<a name="ln-9926"></a><span class="c">!!       call circleprecision(200)</span>
<a name="ln-9927"></a><span class="c">!!       call circle( 0.0, 0.0, a)</span>
<a name="ln-9928"></a><span class="c">!!       call vflush()</span>
<a name="ln-9929"></a><span class="c">!!       call closeobj()</span>
<a name="ln-9930"></a><span class="c">!!    ! draw the disk invoking different rotation</span>
<a name="ln-9931"></a><span class="c">!!       ANGLE=0.0</span>
<a name="ln-9932"></a><span class="c">!!       STEP=0.4</span>
<a name="ln-9933"></a><span class="c">!!       idum=backbuffer()</span>
<a name="ln-9934"></a><span class="c">!!       idum=-1</span>
<a name="ln-9935"></a><span class="c">!!       if(idum.ne.-1)then</span>
<a name="ln-9936"></a><span class="c">!!          do i=1,int(360/STEP*10)</span>
<a name="ln-9937"></a><span class="c">!!             idum=backbuffer()</span>
<a name="ln-9938"></a><span class="c">!!             call clear()</span>
<a name="ln-9939"></a><span class="c">!!             call invokeobj( 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, ANGLE, ANGLE, ANGLE,12345)</span>
<a name="ln-9940"></a><span class="c">!!             ANGLE=ANGLE+STEP</span>
<a name="ln-9941"></a><span class="c">!!             call swapbuffers()</span>
<a name="ln-9942"></a><span class="c">!!          enddo</span>
<a name="ln-9943"></a><span class="c">!!       else</span>
<a name="ln-9944"></a><span class="c">!!          ANGLE=45.0</span>
<a name="ln-9945"></a><span class="c">!!          call invokeobj( 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, ANGLE, ANGLE, ANGLE,12345)</span>
<a name="ln-9946"></a><span class="c">!!          idum=getkey()</span>
<a name="ln-9947"></a><span class="c">!!       endif</span>
<a name="ln-9948"></a><span class="c">!!       call vexit()</span>
<a name="ln-9949"></a><span class="c">!!    end program demo_invokeobj</span>
<a name="ln-9950"></a><span class="c">!!##AUTHOR</span>
<a name="ln-9951"></a><span class="c">!!    John S. Urban</span>
<a name="ln-9952"></a><span class="c">!!##LICENSE</span>
<a name="ln-9953"></a><span class="c">!!    Public Domain</span>
<a name="ln-9954"></a><span class="k">subroutine </span><span class="n">invokeobj</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">zt</span><span class="p">,</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="n">zs</span><span class="p">,</span><span class="n">xr</span><span class="p">,</span><span class="n">yr</span><span class="p">,</span><span class="n">zr</span><span class="p">,</span><span class="n">iobject</span><span class="p">)</span>
<a name="ln-9955"></a>
<a name="ln-9956"></a><span class="c">! ident_2=&quot;@(#)M_draw::invokeobj(3f): invoke object with specified transformation applied and then restored&quot;</span>
<a name="ln-9957"></a>
<a name="ln-9958"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">zt</span>  <span class="c">! linear transforms</span>
<a name="ln-9959"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="n">zs</span>  <span class="c">! scaling</span>
<a name="ln-9960"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">xr</span><span class="p">,</span><span class="n">yr</span><span class="p">,</span><span class="n">zr</span>  <span class="c">! rotation</span>
<a name="ln-9961"></a><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iobject</span>
<a name="ln-9962"></a>
<a name="ln-9963"></a>   <span class="k">call </span><span class="n">pushmatrix</span><span class="p">()</span>
<a name="ln-9964"></a>   <span class="k">call </span><span class="n">translate</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span><span class="n">yt</span><span class="p">,</span><span class="n">zt</span><span class="p">)</span>
<a name="ln-9965"></a>   <span class="k">call </span><span class="nb">scale</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="n">zs</span><span class="p">)</span>
<a name="ln-9966"></a>   <span class="k">call </span><span class="n">rotate</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<a name="ln-9967"></a>   <span class="k">call </span><span class="n">rotate</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<a name="ln-9968"></a>   <span class="k">call </span><span class="n">rotate</span><span class="p">(</span><span class="n">zr</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<a name="ln-9969"></a>   <span class="k">call </span><span class="n">callobj</span><span class="p">(</span><span class="n">iobject</span><span class="p">)</span>
<a name="ln-9970"></a>   <span class="k">call </span><span class="n">popmatrix</span><span class="p">()</span>
<a name="ln-9971"></a>
<a name="ln-9972"></a><span class="k">end subroutine </span><span class="n">invokeobj</span>
<a name="ln-9973"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9974"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9975"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9976"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9977"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-9978"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-9979"></a><span class="c">!&gt;</span>
<a name="ln-9980"></a><span class="c">!!##NAME</span>
<a name="ln-9981"></a><span class="c">!!    page(3f) - [M_draw] set window into largest viewport available</span>
<a name="ln-9982"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-9983"></a><span class="c">!!</span>
<a name="ln-9984"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-9985"></a><span class="c">!!</span>
<a name="ln-9986"></a><span class="c">!!    subroutine page(xsmall,xlarge,ysmall,ylarge)</span>
<a name="ln-9987"></a><span class="c">!!    real, intent=(in) :: xsmall</span>
<a name="ln-9988"></a><span class="c">!!    real, intent=(in) :: xlarge</span>
<a name="ln-9989"></a><span class="c">!!    real, intent=(in) :: ysmall</span>
<a name="ln-9990"></a><span class="c">!!    real, intent=(in) :: ylarge</span>
<a name="ln-9991"></a><span class="c">!!</span>
<a name="ln-9992"></a><span class="c">!!    subroutine page(xsize,ysize,icolor)</span>
<a name="ln-9993"></a><span class="c">!!    real, intent=(in)    :: xsize</span>
<a name="ln-9994"></a><span class="c">!!    real, intent=(in)    :: ysize</span>
<a name="ln-9995"></a><span class="c">!!    integer, intent=(in) :: icolor</span>
<a name="ln-9996"></a><span class="c">!!</span>
<a name="ln-9997"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-9998"></a><span class="c">!!    FORM SUBROUTINE PAGE(XSMALL,XLARGE,YSMALL,YLARGE)</span>
<a name="ln-9999"></a><span class="c">!!</span>
<a name="ln-10000"></a><span class="c">!!    Set the window to the rectangle defined by the corner points</span>
<a name="ln-10001"></a><span class="c">!!    &lt;xsmall,ysmall&gt; and &lt;xlarge,ylarge&gt;.</span>
<a name="ln-10002"></a><span class="c">!!</span>
<a name="ln-10003"></a><span class="c">!!    Also, given the window size, and assuming a one-to-one correspondence</span>
<a name="ln-10004"></a><span class="c">!!    of window units (ie. an &quot;x-unit&quot; is as long as a &quot;y-unit&quot;), find the</span>
<a name="ln-10005"></a><span class="c">!!    largest area on the display surface that has the same aspect ratio,</span>
<a name="ln-10006"></a><span class="c">!!    and set the viewport to it.</span>
<a name="ln-10007"></a><span class="c">!!</span>
<a name="ln-10008"></a><span class="c">!!    FORM SUBROUTINE PAGE(XSIZE,YSIZE,ICOLOR)</span>
<a name="ln-10009"></a><span class="c">!!</span>
<a name="ln-10010"></a><span class="c">!!    Size the window to the rectangle defined by the corner points</span>
<a name="ln-10011"></a><span class="c">!!    &lt;0.0,0.0&gt; and &lt;xsize,ysize&gt; and the viewport to the largest centered</span>
<a name="ln-10012"></a><span class="c">!!    area that has the same aspect ratio, and set the background color to</span>
<a name="ln-10013"></a><span class="c">!!    the value mapped to color ICOLOR.</span>
<a name="ln-10014"></a><span class="c">!!</span>
<a name="ln-10015"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-10016"></a><span class="c">!!</span>
<a name="ln-10017"></a><span class="c">!!   Sample program:</span>
<a name="ln-10018"></a><span class="c">!!</span>
<a name="ln-10019"></a><span class="c">!!    program demo_page</span>
<a name="ln-10020"></a><span class="c">!!    use M_draw</span>
<a name="ln-10021"></a><span class="c">!!    use M_draw,    only  : D_BLACK,   D_WHITE</span>
<a name="ln-10022"></a><span class="c">!!    use M_draw,    only  : D_RED,     D_GREEN,    D_BLUE</span>
<a name="ln-10023"></a><span class="c">!!    use M_draw,    only  : D_YELLOW,  D_MAGENTA,  D_CYAN</span>
<a name="ln-10024"></a><span class="c">!!    implicit none</span>
<a name="ln-10025"></a><span class="c">!!    integer :: ipaws</span>
<a name="ln-10026"></a><span class="c">!!    real,parameter :: radius=25.0</span>
<a name="ln-10027"></a><span class="c">!!       call prefsize(600,600)</span>
<a name="ln-10028"></a><span class="c">!!       call vinit(&#39; &#39;) ! start graphics using device $M_draw_DEVICE</span>
<a name="ln-10029"></a><span class="c">!!       call page(-radius, radius, -radius, radius)</span>
<a name="ln-10030"></a><span class="c">!!       call linewidth(200)</span>
<a name="ln-10031"></a><span class="c">!!       call clear()</span>
<a name="ln-10032"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-10033"></a><span class="c">!!       call move2(-radius, -radius)</span>
<a name="ln-10034"></a><span class="c">!!       call draw2(-radius, radius)</span>
<a name="ln-10035"></a><span class="c">!!       call draw2(radius, radius)</span>
<a name="ln-10036"></a><span class="c">!!       call draw2(radius, -radius)</span>
<a name="ln-10037"></a><span class="c">!!       call draw2(-radius, -radius)</span>
<a name="ln-10038"></a><span class="c">!!       call color(D_CYAN)</span>
<a name="ln-10039"></a><span class="c">!!       call circle(0.0,0.0,radius)</span>
<a name="ln-10040"></a><span class="c">!!       call vflush()</span>
<a name="ln-10041"></a><span class="c">!!       ipaws=getkey()</span>
<a name="ln-10042"></a><span class="c">!!       call vexit()</span>
<a name="ln-10043"></a><span class="c">!!    end program demo_page</span>
<a name="ln-10044"></a><span class="c">!!##AUTHOR</span>
<a name="ln-10045"></a><span class="c">!!    John S. Urban</span>
<a name="ln-10046"></a><span class="c">!!##LICENSE</span>
<a name="ln-10047"></a><span class="c">!!    Public Domain</span>
<a name="ln-10048"></a><span class="k">subroutine </span><span class="n">biggest_ortho2</span><span class="p">(</span><span class="n">xsmall</span><span class="p">,</span><span class="n">xlarge</span><span class="p">,</span><span class="n">ysmall</span><span class="p">,</span><span class="n">ylarge</span><span class="p">)</span>
<a name="ln-10049"></a>
<a name="ln-10050"></a><span class="c">! ident_3=&quot;@(#)M_draw::page(3f): given a window size, find and set to largest accommodating viewport&quot;</span>
<a name="ln-10051"></a>
<a name="ln-10052"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">xsmall</span>
<a name="ln-10053"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">xlarge</span>
<a name="ln-10054"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ysmall</span>
<a name="ln-10055"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ylarge</span>
<a name="ln-10056"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">rps</span>
<a name="ln-10057"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">spr</span>
<a name="ln-10058"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">tryx</span>
<a name="ln-10059"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">tryy</span>
<a name="ln-10060"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">vhigh</span>
<a name="ln-10061"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">vwide</span>
<a name="ln-10062"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">xdelta</span>
<a name="ln-10063"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">xmax</span>
<a name="ln-10064"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">xmin</span>
<a name="ln-10065"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">xsplit</span>
<a name="ln-10066"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">ydelta</span>
<a name="ln-10067"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">ymax</span>
<a name="ln-10068"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">ymin</span>
<a name="ln-10069"></a><span class="kt">real</span>             <span class="kd">::</span> <span class="n">ysplit</span>
<a name="ln-10070"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10071"></a>      <span class="k">call </span><span class="n">getdisplaysize</span><span class="p">(</span><span class="n">vwide</span><span class="p">,</span><span class="n">vhigh</span><span class="p">)</span> <span class="c">!get screen size in terms of raster units</span>
<a name="ln-10072"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10073"></a><span class="c">!     the default viewport is in &quot;screen units&quot;, and goes from -1,-1 to 1,1</span>
<a name="ln-10074"></a><span class="c">!     all new viewports are defined in terms of this original viewport, which</span>
<a name="ln-10075"></a><span class="c">!     is 2 units wide and 2 units tall.</span>
<a name="ln-10076"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10077"></a>      <span class="n">rps</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">vwide</span><span class="p">,</span><span class="n">vhigh</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>         <span class="c">! number of rasters per screen unit</span>
<a name="ln-10078"></a>      <span class="n">spr</span><span class="o">=</span><span class="mf">2.0</span><span class="o">/</span><span class="nb">min</span><span class="p">(</span><span class="n">vwide</span><span class="p">,</span><span class="n">vhigh</span><span class="p">)</span>         <span class="c">! number of screen units per raster</span>
<a name="ln-10079"></a>      <span class="n">tryx</span><span class="o">=</span><span class="n">vwide</span>                       <span class="c">! make as wide as display as a trial fit</span>
<a name="ln-10080"></a>      <span class="k">if</span><span class="p">(</span><span class="n">xlarge</span><span class="o">-</span><span class="n">xsmall</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-10081"></a><span class="k">         </span><span class="n">tryy</span><span class="o">=</span><span class="n">vwide</span><span class="o">*</span><span class="p">(</span><span class="n">ylarge</span><span class="o">-</span><span class="n">ysmall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">xlarge</span><span class="o">-</span><span class="n">xsmall</span><span class="p">)</span> <span class="c">! calculate required height</span>
<a name="ln-10082"></a>      <span class="k">else</span>                             <span class="c">! ERROR: do something desperate</span>
<a name="ln-10083"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*page* window has a zero X dimension&#39;</span><span class="p">)</span>
<a name="ln-10084"></a>         <span class="n">tryy</span><span class="o">=</span><span class="n">vhigh</span>
<a name="ln-10085"></a>      <span class="k">endif</span>
<a name="ln-10086"></a><span class="k">      if</span><span class="p">(</span><span class="n">tryy</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">vhigh</span><span class="p">)</span><span class="k">then</span> <span class="c">! if required height too great, fit with y maximized</span>
<a name="ln-10087"></a>         <span class="n">tryy</span><span class="o">=</span><span class="n">vhigh</span>
<a name="ln-10088"></a>         <span class="k">if</span><span class="p">(</span><span class="n">ylarge</span><span class="o">-</span><span class="n">ysmall</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-10089"></a><span class="k">            </span><span class="n">tryx</span><span class="o">=</span><span class="n">vhigh</span><span class="o">*</span><span class="p">(</span><span class="n">xlarge</span><span class="o">-</span><span class="n">xsmall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ylarge</span><span class="o">-</span><span class="n">ysmall</span><span class="p">)</span>
<a name="ln-10090"></a>         <span class="k">else</span>                          <span class="c">! ERROR: do something desperate</span>
<a name="ln-10091"></a>            <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*page* window has a zero Y dimension&#39;</span><span class="p">)</span>
<a name="ln-10092"></a>            <span class="n">tryx</span><span class="o">=</span><span class="n">vwide</span>
<a name="ln-10093"></a>         <span class="k">endif</span>
<a name="ln-10094"></a><span class="k">      endif</span>
<a name="ln-10095"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10096"></a><span class="c">!   tryx and tryy are now the required viewport in raster units. The raster</span>
<a name="ln-10097"></a><span class="c">!   units now need converted to screen units to be used in viewport procedure</span>
<a name="ln-10098"></a><span class="c">!</span>
<a name="ln-10099"></a><span class="c">!   some explanation of physical viewport units is required:</span>
<a name="ln-10100"></a><span class="c">!   assuming maximizing the required aspect ratio in the available drawing area,</span>
<a name="ln-10101"></a><span class="c">!   and that the original viewport &quot;origin&quot; 0,0 stays in its original position,</span>
<a name="ln-10102"></a><span class="c">!   and that the original -1,1,-1,1 viewport is the largest square that can fit</span>
<a name="ln-10103"></a><span class="c">!   on the display, bottom left justified.</span>
<a name="ln-10104"></a><span class="c">!   the screen coordinate system is a right-handed Cartesian coordinate system</span>
<a name="ln-10105"></a><span class="c">!   with positive x to the viewer&#39;s right, positive y up.</span>
<a name="ln-10106"></a><span class="c">!</span>
<a name="ln-10107"></a><span class="c">!   at this point,</span>
<a name="ln-10108"></a><span class="c">!    vwide=width in rasters of entire display</span>
<a name="ln-10109"></a><span class="c">!    vhigh=height in rasters of entire display</span>
<a name="ln-10110"></a><span class="c">!   assuming a square raster</span>
<a name="ln-10111"></a><span class="c">!     tryx is desired width in rasters</span>
<a name="ln-10112"></a><span class="c">!     tryy is desired height in rasters</span>
<a name="ln-10113"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10114"></a>      <span class="n">xdelta</span><span class="o">=</span><span class="n">tryx</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">rps</span>  <span class="c">! need this many more rasters in x direction from 1,1</span>
<a name="ln-10115"></a>      <span class="n">ydelta</span><span class="o">=</span><span class="n">tryy</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">rps</span>  <span class="c">! need this many more rasters in y direction from 1,1</span>
<a name="ln-10116"></a>      <span class="c">! to center (to left bottom justify, make xsplit and ysplit 0)</span>
<a name="ln-10117"></a>      <span class="n">xsplit</span><span class="o">=</span><span class="p">(</span><span class="n">vwide</span><span class="o">-</span><span class="n">tryx</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
<a name="ln-10118"></a>      <span class="n">ysplit</span><span class="o">=</span><span class="p">(</span><span class="n">vhigh</span><span class="o">-</span><span class="n">tryy</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
<a name="ln-10119"></a>      <span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">xdelta</span><span class="o">*</span><span class="n">spr</span><span class="o">+</span><span class="n">xsplit</span><span class="o">*</span><span class="n">spr</span>
<a name="ln-10120"></a>      <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">ydelta</span><span class="o">*</span><span class="n">spr</span><span class="o">+</span><span class="n">ysplit</span><span class="o">*</span><span class="n">spr</span>
<a name="ln-10121"></a>      <span class="n">xmin</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="n">xsplit</span><span class="o">*</span><span class="n">spr</span>
<a name="ln-10122"></a>      <span class="n">ymin</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="n">ysplit</span><span class="o">*</span><span class="n">spr</span>
<a name="ln-10123"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10124"></a><span class="c">!      write(*,*)&#39;max. display area is&#39;, vwide, &#39; by &#39;,vhigh,&#39; rasters&#39;</span>
<a name="ln-10125"></a><span class="c">!      write(*,*)&#39;shape is &#39;,xsmall,xlarge,ysmall,ylarge</span>
<a name="ln-10126"></a><span class="c">!      write(*,*)&#39;attempting to get a viewport of &#39;,tryx,&#39; by &#39;,tryy</span>
<a name="ln-10127"></a><span class="c">!      write(*,*)&#39;needed more rasters, &#39;,xdelta,&#39; by &#39;,ydelta</span>
<a name="ln-10128"></a><span class="c">!      write(*,*)&#39;resulted in viewport &#39;,-1,xmax,-1,ymax</span>
<a name="ln-10129"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10130"></a>      <span class="k">if</span><span class="p">(</span><span class="n">xmin</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">xmax</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">ymin</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ymax</span><span class="p">)</span><span class="k">then</span>
<a name="ln-10131"></a><span class="k">         call </span><span class="n">viewport</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
<a name="ln-10132"></a>      <span class="k">else</span>
<a name="ln-10133"></a><span class="k">         call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*page* window has zero dimension,no viewport set&#39;</span><span class="p">)</span>
<a name="ln-10134"></a>      <span class="k">endif</span>
<a name="ln-10135"></a><span class="c">!     to prevent clipping lines that are right on edge of window fudge a bit</span>
<a name="ln-10136"></a>      <span class="c">!bugx=.001*(xlarge-xsmall)</span>
<a name="ln-10137"></a>      <span class="c">!bugy=.001*(ylarge-ysmall)</span>
<a name="ln-10138"></a>      <span class="c">!xsmall1=xsmall-bugx</span>
<a name="ln-10139"></a>      <span class="c">!xlarge1=xlarge+bugx</span>
<a name="ln-10140"></a>      <span class="c">!ysmall1=ysmall-bugy</span>
<a name="ln-10141"></a>      <span class="c">!ylarge1=ylarge+bugy</span>
<a name="ln-10142"></a>      <span class="c">!call ortho2(xsmall1,xlarge1,ysmall1,ylarge1)</span>
<a name="ln-10143"></a>      <span class="k">if</span><span class="p">(</span><span class="n">xsmall</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">xlarge</span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">ysmall</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="n">ylarge</span><span class="p">)</span><span class="k">then</span>
<a name="ln-10144"></a><span class="k">         call </span><span class="n">ortho2</span><span class="p">(</span><span class="n">xsmall</span><span class="p">,</span><span class="n">xlarge</span><span class="p">,</span><span class="n">ysmall</span><span class="p">,</span><span class="n">ylarge</span><span class="p">)</span>
<a name="ln-10145"></a>      <span class="k">else</span>    <span class="c">! ERROR: do something desperate</span>
<a name="ln-10146"></a>         <span class="k">call </span><span class="n">journal</span><span class="p">(</span><span class="s1">&#39;*page* window has zero dimension, no window set&#39;</span><span class="p">)</span>
<a name="ln-10147"></a>      <span class="k">endif</span>
<a name="ln-10148"></a><span class="k">end subroutine </span><span class="n">biggest_ortho2</span>
<a name="ln-10149"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10150"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10151"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10152"></a><span class="c">!&gt;</span>
<a name="ln-10153"></a><span class="c">!!##NAME</span>
<a name="ln-10154"></a><span class="c">!!       page_rri(3fp) - [M_draw] - new world window with viewport set to largest area with same aspect ratio</span>
<a name="ln-10155"></a><span class="c">!!       (LICENSE:PD)</span>
<a name="ln-10156"></a><span class="c">!!</span>
<a name="ln-10157"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-10158"></a><span class="c">!!</span>
<a name="ln-10159"></a><span class="c">!!   subroutine page_rri(xsize,ysize,icolor)</span>
<a name="ln-10160"></a><span class="c">!!</span>
<a name="ln-10161"></a><span class="c">!!    integer,intent(in)          :: xsize</span>
<a name="ln-10162"></a><span class="c">!!    integer,intent(in)          :: ysize</span>
<a name="ln-10163"></a><span class="c">!!    integer,intent(in)          :: icolor</span>
<a name="ln-10164"></a><span class="c">!!</span>
<a name="ln-10165"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-10166"></a><span class="c">!!    Given a horizontal size and vertical size and color set the window to</span>
<a name="ln-10167"></a><span class="c">!!    the rectangle defined by the corner points &lt;0.0,0.0&gt; and &lt;xsize,ysize&gt;</span>
<a name="ln-10168"></a><span class="c">!!    and set the viewport to the largest viewport on the display with the</span>
<a name="ln-10169"></a><span class="c">!!    same aspect ratio and start a new page with the specified background</span>
<a name="ln-10170"></a><span class="c">!!    color if background color is supported on the device.</span>
<a name="ln-10171"></a><span class="c">!!</span>
<a name="ln-10172"></a><span class="c">!!##OPTIONS</span>
<a name="ln-10173"></a><span class="c">!!    XSIZE    X size of requested window</span>
<a name="ln-10174"></a><span class="c">!!    YSIZE    Y size of requested window</span>
<a name="ln-10175"></a><span class="c">!!    ICOLOR   Color to set background.</span>
<a name="ln-10176"></a><span class="c">!!</span>
<a name="ln-10177"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-10178"></a><span class="c">!!</span>
<a name="ln-10179"></a><span class="c">!!   Sample program:</span>
<a name="ln-10180"></a><span class="c">!!</span>
<a name="ln-10181"></a><span class="c">!!      program demo_page_rri</span>
<a name="ln-10182"></a><span class="c">!!      use M_draw</span>
<a name="ln-10183"></a><span class="c">!!      use M_drawplus, only : polyline2</span>
<a name="ln-10184"></a><span class="c">!!      implicit none</span>
<a name="ln-10185"></a><span class="c">!!      integer :: ipaws</span>
<a name="ln-10186"></a><span class="c">!!      call prefsize(300,300)</span>
<a name="ln-10187"></a><span class="c">!!      call vinit(&#39; &#39;)</span>
<a name="ln-10188"></a><span class="c">!!      call page(8.5,11.0,3)</span>
<a name="ln-10189"></a><span class="c">!!      call color(2)</span>
<a name="ln-10190"></a><span class="c">!!      call linewidth(100)</span>
<a name="ln-10191"></a><span class="c">!!      call circle(8.5/0.0,11.0/0.0,8.5/2.0)</span>
<a name="ln-10192"></a><span class="c">!!      call color(1)</span>
<a name="ln-10193"></a><span class="c">!!      call polyline2([0.0,0,0,8.5,11.0]</span>
<a name="ln-10194"></a><span class="c">!!      call polyline2([8.5,0,0,0.0,11.0]</span>
<a name="ln-10195"></a><span class="c">!!      ipaws=getkey()</span>
<a name="ln-10196"></a><span class="c">!!      call vexit()</span>
<a name="ln-10197"></a><span class="c">!!      end</span>
<a name="ln-10198"></a><span class="c">!!      program demo_page_rri</span>
<a name="ln-10199"></a><span class="c">!!##AUTHOR</span>
<a name="ln-10200"></a><span class="c">!!    John S. Urban</span>
<a name="ln-10201"></a><span class="c">!!##LICENSE</span>
<a name="ln-10202"></a><span class="c">!!    Public Domain</span>
<a name="ln-10203"></a><span class="k">subroutine </span><span class="n">journal</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-10204"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">string</span>
<a name="ln-10205"></a><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span><span class="n">string</span>
<a name="ln-10206"></a><span class="k">end subroutine </span><span class="n">journal</span>
<a name="ln-10207"></a><span class="k">subroutine </span><span class="n">page_rri</span><span class="p">(</span><span class="n">xsize</span><span class="p">,</span><span class="n">ysize</span><span class="p">,</span><span class="n">icolor</span><span class="p">)</span>
<a name="ln-10208"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">xsize</span>
<a name="ln-10209"></a><span class="kt">real</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">ysize</span>
<a name="ln-10210"></a><span class="kt">integer</span>                     <span class="kd">::</span> <span class="n">icolor</span>
<a name="ln-10211"></a>   <span class="k">call </span><span class="n">page</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">xsize</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">ysize</span><span class="p">)</span>
<a name="ln-10212"></a>   <span class="k">call </span><span class="n">pushattributes</span><span class="p">()</span>
<a name="ln-10213"></a>      <span class="k">call </span><span class="n">color</span><span class="p">(</span><span class="n">icolor</span><span class="p">)</span>
<a name="ln-10214"></a>      <span class="k">call </span><span class="n">clear</span><span class="p">()</span>
<a name="ln-10215"></a>   <span class="k">call </span><span class="n">popattributes</span><span class="p">()</span>
<a name="ln-10216"></a><span class="k">end subroutine </span><span class="n">page_rri</span>
<a name="ln-10217"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10218"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10219"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10220"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10221"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10222"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10223"></a><span class="c">!&gt;</span>
<a name="ln-10224"></a><span class="c">!!##NAME</span>
<a name="ln-10225"></a><span class="c">!!    pop(3f) - [M_draw] call popviewport(), popmatrix(), popattributes()</span>
<a name="ln-10226"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-10227"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-10228"></a><span class="c">!!</span>
<a name="ln-10229"></a><span class="c">!!    subroutine pop()</span>
<a name="ln-10230"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-10231"></a><span class="c">!!    call popviewport(), popmatrix(), popattributes()</span>
<a name="ln-10232"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-10233"></a><span class="c">!!</span>
<a name="ln-10234"></a><span class="c">!!##AUTHOR</span>
<a name="ln-10235"></a><span class="c">!!    John S. Urban</span>
<a name="ln-10236"></a><span class="c">!!##LICENSE</span>
<a name="ln-10237"></a><span class="c">!!    Public Domain</span>
<a name="ln-10238"></a><span class="k">subroutine </span><span class="n">pop</span><span class="p">()</span>
<a name="ln-10239"></a>
<a name="ln-10240"></a><span class="c">! ident_4=&quot;@(#)M_draw::pop(3f): call popviewport(), popmatrix(), popattributes()&quot;</span>
<a name="ln-10241"></a>
<a name="ln-10242"></a>   <span class="k">call </span><span class="n">popviewport</span><span class="p">()</span>
<a name="ln-10243"></a>   <span class="k">call </span><span class="n">popmatrix</span><span class="p">()</span>
<a name="ln-10244"></a>   <span class="k">call </span><span class="n">popattributes</span><span class="p">()</span>
<a name="ln-10245"></a><span class="k">end subroutine </span><span class="n">pop</span>
<a name="ln-10246"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10247"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10248"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10249"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10250"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10251"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10252"></a><span class="c">!&gt;</span>
<a name="ln-10253"></a><span class="c">!!##NAME</span>
<a name="ln-10254"></a><span class="c">!!    print(3f) - [M_draw] call DRAWSTR(3f) with up to nine arbitrary intrinsic scalar values</span>
<a name="ln-10255"></a><span class="c">!!</span>
<a name="ln-10256"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-10257"></a><span class="c">!!</span>
<a name="ln-10258"></a><span class="c">!!    subroutine print(g1, g2, g3, g4, g5, g6, g7, g8, g9)</span>
<a name="ln-10259"></a><span class="c">!!</span>
<a name="ln-10260"></a><span class="c">!!    class(*),intent(in),optional :: g1 ,g2 ,g3 ,g4 ,g5, g6 ,g7 ,g8 ,g9</span>
<a name="ln-10261"></a><span class="c">!!</span>
<a name="ln-10262"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-10263"></a><span class="c">!!    Call DRAWSTR(3f) with up to nine intrinsic scalar values. They will be composed into a</span>
<a name="ln-10264"></a><span class="c">!!    string with spaces between the argument values. Trailing spaces of strings</span>
<a name="ln-10265"></a><span class="c">!!    are trimmed unless the entire variable is blank.</span>
<a name="ln-10266"></a><span class="c">!!##OPTIONS</span>
<a name="ln-10267"></a><span class="c">!!    g1-g9  intrinsic scalar values to plot at the current point.</span>
<a name="ln-10268"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-10269"></a><span class="c">!!</span>
<a name="ln-10270"></a><span class="c">!!   Sample program:</span>
<a name="ln-10271"></a><span class="c">!!</span>
<a name="ln-10272"></a><span class="c">!!    program demo_print</span>
<a name="ln-10273"></a><span class="c">!!    use M_draw</span>
<a name="ln-10274"></a><span class="c">!!    implicit none</span>
<a name="ln-10275"></a><span class="c">!!    real :: angle</span>
<a name="ln-10276"></a><span class="c">!!    integer :: idum</span>
<a name="ln-10277"></a><span class="c">!!    character(len=*),parameter :: space=&#39;       &#39;</span>
<a name="ln-10278"></a><span class="c">!!       ! set window size</span>
<a name="ln-10279"></a><span class="c">!!       call prefsize(700,700)</span>
<a name="ln-10280"></a><span class="c">!!       call prefposition( 0, 0)</span>
<a name="ln-10281"></a><span class="c">!!       call vinit(&#39;X11&#39;)</span>
<a name="ln-10282"></a><span class="c">!!       call page(-5.0,5.0,-5.0,5.0)</span>
<a name="ln-10283"></a><span class="c">!!       call textsize(0.3,0.3)</span>
<a name="ln-10284"></a><span class="c">!!       call color(D_BLUE)</span>
<a name="ln-10285"></a><span class="c">!!       angle=0.0</span>
<a name="ln-10286"></a><span class="c">!!       call turn()</span>
<a name="ln-10287"></a><span class="c">!!       call print(space,&#39;a logical such as &#39;,.true.)</span>
<a name="ln-10288"></a><span class="c">!!       call turn()</span>
<a name="ln-10289"></a><span class="c">!!       call print(space,&#39;a real value&#39;,3.1416)</span>
<a name="ln-10290"></a><span class="c">!!       call turn()</span>
<a name="ln-10291"></a><span class="c">!!       call print(space,&#39;double precision&#39;,7890.123456d0)</span>
<a name="ln-10292"></a><span class="c">!!       call turn()</span>
<a name="ln-10293"></a><span class="c">!!       call print(space,&#39;integer &#39;,1234)</span>
<a name="ln-10294"></a><span class="c">!!       call turn()</span>
<a name="ln-10295"></a><span class="c">!!       call print(space,&#39;lots of stuff&#39;,1234,.false.,cmplx(20.0,30.0))</span>
<a name="ln-10296"></a><span class="c">!!       idum=getkey()</span>
<a name="ln-10297"></a><span class="c">!!       call vexit()</span>
<a name="ln-10298"></a><span class="c">!!    contains</span>
<a name="ln-10299"></a><span class="c">!!       subroutine turn()</span>
<a name="ln-10300"></a><span class="c">!!          call move2(-4.0,-3.5)</span>
<a name="ln-10301"></a><span class="c">!!          call textang(angle)</span>
<a name="ln-10302"></a><span class="c">!!          angle=angle+15.0</span>
<a name="ln-10303"></a><span class="c">!!       end subroutine turn</span>
<a name="ln-10304"></a><span class="c">!!    end program demo_print</span>
<a name="ln-10305"></a><span class="c">!!</span>
<a name="ln-10306"></a><span class="c">!!##AUTHOR</span>
<a name="ln-10307"></a><span class="c">!!    John S. Urban</span>
<a name="ln-10308"></a><span class="c">!!##LICENSE</span>
<a name="ln-10309"></a><span class="c">!!    Public Domain</span>
<a name="ln-10310"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10311"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10312"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10313"></a><span class="k">subroutine print</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">g4</span><span class="p">,</span> <span class="n">g5</span><span class="p">,</span> <span class="n">g6</span><span class="p">,</span> <span class="n">g7</span><span class="p">,</span> <span class="n">g8</span><span class="p">,</span> <span class="n">g9</span><span class="p">)</span>
<a name="ln-10314"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">g1</span> <span class="p">,</span><span class="n">g2</span> <span class="p">,</span><span class="n">g3</span> <span class="p">,</span><span class="n">g4</span> <span class="p">,</span><span class="n">g5</span><span class="p">,</span> <span class="n">g6</span> <span class="p">,</span><span class="n">g7</span> <span class="p">,</span><span class="n">g8</span> <span class="p">,</span><span class="n">g9</span>
<a name="ln-10315"></a>   <span class="k">call </span><span class="n">drawstr</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">g4</span><span class="p">,</span> <span class="n">g5</span><span class="p">,</span> <span class="n">g6</span><span class="p">,</span> <span class="n">g7</span><span class="p">,</span> <span class="n">g8</span><span class="p">,</span> <span class="n">g9</span><span class="p">))</span>
<a name="ln-10316"></a><span class="k">end subroutine print</span>
<a name="ln-10317"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10318"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10319"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10320"></a><span class="k">function </span><span class="n">str</span><span class="p">(</span><span class="n">generic0</span><span class="p">,</span> <span class="n">generic1</span><span class="p">,</span> <span class="n">generic2</span><span class="p">,</span> <span class="n">generic3</span><span class="p">,</span> <span class="n">generic4</span><span class="p">,</span> <span class="n">generic5</span><span class="p">,</span> <span class="n">generic6</span><span class="p">,</span> <span class="n">generic7</span><span class="p">,</span> <span class="n">generic8</span><span class="p">,</span> <span class="n">generic9</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10321"></a>                  <span class="p">&amp;</span> <span class="n">generica</span><span class="p">,</span> <span class="n">genericb</span><span class="p">,</span> <span class="n">genericc</span><span class="p">,</span> <span class="n">genericd</span><span class="p">,</span> <span class="n">generice</span><span class="p">,</span> <span class="n">genericf</span><span class="p">,</span> <span class="n">genericg</span><span class="p">,</span> <span class="n">generich</span><span class="p">,</span> <span class="n">generici</span><span class="p">,</span> <span class="n">genericj</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10322"></a>                  <span class="p">&amp;</span> <span class="n">sep</span><span class="p">)</span>
<a name="ln-10323"></a><span class="k">implicit none</span>
<a name="ln-10324"></a>
<a name="ln-10325"></a><span class="c">! ident_2=&quot;@(#)M_msg::str(3fp): writes a message to a string composed of any standard scalar types&quot;</span>
<a name="ln-10326"></a>
<a name="ln-10327"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>  <span class="kd">::</span> <span class="n">generic0</span><span class="p">,</span> <span class="n">generic1</span><span class="p">,</span> <span class="n">generic2</span><span class="p">,</span> <span class="n">generic3</span><span class="p">,</span> <span class="n">generic4</span>
<a name="ln-10328"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>  <span class="kd">::</span> <span class="n">generic5</span><span class="p">,</span> <span class="n">generic6</span><span class="p">,</span> <span class="n">generic7</span><span class="p">,</span> <span class="n">generic8</span><span class="p">,</span> <span class="n">generic9</span>
<a name="ln-10329"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>  <span class="kd">::</span> <span class="n">generica</span><span class="p">,</span> <span class="n">genericb</span><span class="p">,</span> <span class="n">genericc</span><span class="p">,</span> <span class="n">genericd</span><span class="p">,</span> <span class="n">generice</span>
<a name="ln-10330"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span>  <span class="kd">::</span> <span class="n">genericf</span><span class="p">,</span> <span class="n">genericg</span><span class="p">,</span> <span class="n">generich</span><span class="p">,</span> <span class="n">generici</span><span class="p">,</span> <span class="n">genericj</span>
<a name="ln-10331"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">str</span>
<a name="ln-10332"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">line</span>
<a name="ln-10333"></a><span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">istart</span>
<a name="ln-10334"></a><span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">increment</span>
<a name="ln-10335"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span><span class="k">optional</span> <span class="kd">::</span> <span class="n">sep</span>
<a name="ln-10336"></a><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span><span class="k">allocatable</span>  <span class="kd">::</span> <span class="n">sep_local</span>
<a name="ln-10337"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span><span class="k">then</span>
<a name="ln-10338"></a><span class="k">      </span><span class="n">increment</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10339"></a>      <span class="n">sep_local</span><span class="o">=</span><span class="n">sep</span>
<a name="ln-10340"></a>   <span class="k">else</span>
<a name="ln-10341"></a><span class="k">      </span><span class="n">increment</span><span class="o">=</span><span class="mi">2</span>
<a name="ln-10342"></a>      <span class="n">sep_local</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-10343"></a>   <span class="k">endif</span>
<a name="ln-10344"></a>
<a name="ln-10345"></a><span class="k">   </span><span class="n">istart</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-10346"></a>   <span class="n">line</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
<a name="ln-10347"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic0</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic0</span><span class="p">)</span>
<a name="ln-10348"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic1</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic1</span><span class="p">)</span>
<a name="ln-10349"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic2</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic2</span><span class="p">)</span>
<a name="ln-10350"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic3</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic3</span><span class="p">)</span>
<a name="ln-10351"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic4</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic4</span><span class="p">)</span>
<a name="ln-10352"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic5</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic5</span><span class="p">)</span>
<a name="ln-10353"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic6</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic6</span><span class="p">)</span>
<a name="ln-10354"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic7</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic7</span><span class="p">)</span>
<a name="ln-10355"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic8</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic8</span><span class="p">)</span>
<a name="ln-10356"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generic9</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generic9</span><span class="p">)</span>
<a name="ln-10357"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generica</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generica</span><span class="p">)</span>
<a name="ln-10358"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericb</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericb</span><span class="p">)</span>
<a name="ln-10359"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericc</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericc</span><span class="p">)</span>
<a name="ln-10360"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericd</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericd</span><span class="p">)</span>
<a name="ln-10361"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generice</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generice</span><span class="p">)</span>
<a name="ln-10362"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericf</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericf</span><span class="p">)</span>
<a name="ln-10363"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericg</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericg</span><span class="p">)</span>
<a name="ln-10364"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generich</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generich</span><span class="p">)</span>
<a name="ln-10365"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">generici</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">generici</span><span class="p">)</span>
<a name="ln-10366"></a>   <span class="k">if</span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">genericj</span><span class="p">))</span><span class="k">call </span><span class="n">print_generic</span><span class="p">(</span><span class="n">genericj</span><span class="p">)</span>
<a name="ln-10367"></a>   <span class="n">str</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<a name="ln-10368"></a><span class="k">contains</span>
<a name="ln-10369"></a>
<a name="ln-10370"></a><span class="k">subroutine </span><span class="n">print_generic</span><span class="p">(</span><span class="k">generic</span><span class="p">)</span>
<a name="ln-10371"></a><span class="c">!use, intrinsic :: iso_fortran_env, only : int8, int16, int32, biggest=&gt;int64, real32, real64, dp=&gt;real128</span>
<a name="ln-10372"></a><span class="k">use</span><span class="p">,</span><span class="k">intrinsic</span> <span class="kd">::</span> <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">int8</span><span class="p">,</span> <span class="n">int16</span><span class="p">,</span> <span class="n">int32</span><span class="p">,</span> <span class="n">int64</span><span class="p">,</span> <span class="n">real32</span><span class="p">,</span> <span class="n">real64</span><span class="p">,</span> <span class="n">real128</span>
<a name="ln-10373"></a><span class="k">class</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="k">generic</span>
<a name="ln-10374"></a><span class="k">   select type</span><span class="p">(</span><span class="k">generic</span><span class="p">)</span>
<a name="ln-10375"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int8</span><span class="p">));</span>     <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(i0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10376"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int16</span><span class="p">));</span>    <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(i0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10377"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int32</span><span class="p">));</span>    <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(i0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10378"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">));</span>    <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(i0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10379"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">));</span>      <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(1pg0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10380"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real64</span><span class="p">));</span>      <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(1pg0)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10381"></a>      <span class="c">!type is (real(kind=real128));     write(line(istart:),&#39;(1pg0)&#39;) generic</span>
<a name="ln-10382"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">logical</span><span class="p">);</span>                <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(l1)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10383"></a><span class="k">      type is</span> <span class="p">(</span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">));</span>       <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="nb">trim</span><span class="p">(</span><span class="k">generic</span><span class="p">)</span>
<a name="ln-10384"></a>      <span class="k">type is</span> <span class="p">(</span><span class="kt">complex</span><span class="p">);</span>                <span class="k">write</span><span class="p">(</span><span class="n">line</span><span class="p">(</span><span class="n">istart</span><span class="p">:),</span><span class="s1">&#39;(&quot;(&quot;,1pg0,&quot;,&quot;,1pg0,&quot;)&quot;)&#39;</span><span class="p">)</span> <span class="k">generic</span>
<a name="ln-10385"></a><span class="k">   end select</span>
<a name="ln-10386"></a><span class="k">   </span><span class="n">istart</span><span class="o">=</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">+</span><span class="n">increment</span>
<a name="ln-10387"></a>   <span class="n">line</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">//</span><span class="n">sep_local</span>
<a name="ln-10388"></a><span class="k">end subroutine </span><span class="n">print_generic</span>
<a name="ln-10389"></a>
<a name="ln-10390"></a><span class="k">end function </span><span class="n">str</span>
<a name="ln-10391"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10392"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10393"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10394"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10395"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10396"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10397"></a><span class="c">!&gt;</span>
<a name="ln-10398"></a><span class="c">!!##NAME</span>
<a name="ln-10399"></a><span class="c">!!    push(3f) - [M_draw] call pushviewport(), pushmatrix(), pushattributes()</span>
<a name="ln-10400"></a><span class="c">!!    (LICENSE:PD)</span>
<a name="ln-10401"></a><span class="c">!!##SYNOPSIS</span>
<a name="ln-10402"></a><span class="c">!!</span>
<a name="ln-10403"></a><span class="c">!!     subroutine push()</span>
<a name="ln-10404"></a><span class="c">!!##DESCRIPTION</span>
<a name="ln-10405"></a><span class="c">!!    call pushattributes(), pushmatrix(), pushviewport()</span>
<a name="ln-10406"></a><span class="c">!!##EXAMPLE</span>
<a name="ln-10407"></a><span class="c">!!</span>
<a name="ln-10408"></a><span class="c">!!##AUTHOR</span>
<a name="ln-10409"></a><span class="c">!!    John S. Urban</span>
<a name="ln-10410"></a><span class="c">!!##LICENSE</span>
<a name="ln-10411"></a><span class="c">!!    Public Domain</span>
<a name="ln-10412"></a><span class="k">subroutine </span><span class="n">push</span><span class="p">()</span>
<a name="ln-10413"></a>
<a name="ln-10414"></a><span class="c">! ident_5=&quot;@(#)M_draw::push(3f): call pushattributes(), pushmatrix(), pushviewport()&quot;</span>
<a name="ln-10415"></a>
<a name="ln-10416"></a>   <span class="k">call </span><span class="n">pushattributes</span><span class="p">()</span>
<a name="ln-10417"></a>   <span class="k">call </span><span class="n">pushmatrix</span><span class="p">()</span>
<a name="ln-10418"></a>   <span class="k">call </span><span class="n">pushviewport</span><span class="p">()</span>
<a name="ln-10419"></a><span class="k">end subroutine </span><span class="n">push</span>
<a name="ln-10420"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10421"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10422"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10423"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10424"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()=</span>
<a name="ln-10425"></a><span class="c">!===================================================================================================================================</span>
<a name="ln-10426"></a><span class="k">end module </span><span class="n">M_draw</span>
<a name="ln-10427"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10428"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10429"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10430"></a><span class="c">! drawchar -- int versus char</span>
<a name="ln-10431"></a><span class="c">! textjustify -- UNSIGNED?</span>
<a name="ln-10432"></a><span class="c">! pdraw and pmove in sunfort? spoint2? srect? getfontwidth? getfontheight?  getprefposandsize?</span>
<a name="ln-10433"></a><span class="c">! getplanes? drawchar?</span>
<a name="ln-10434"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
<a name="ln-10435"></a><span class="c">!()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()()!</span>
<a name="ln-10436"></a><span class="c">!----------------------------------------------------------------------------------------------------------------------------------!</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2022 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2022-05-04 21:44  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> M_draw was developed by John S. Urban</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>